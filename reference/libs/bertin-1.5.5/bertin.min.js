!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).bertin={})}(this,(function(t){"use strict";function e(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function n(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function i(t){let i,s,o;function a(t,e,n=0,r=t.length){if(n<r){if(0!==i(e,e))return r;do{const i=n+r>>>1;s(t[i],e)<0?n=i+1:r=i}while(n<r)}return n}return 2!==t.length?(i=e,s=(n,i)=>e(t(n),i),o=(e,n)=>t(e)-n):(i=t===e||t===n?t:r,s=t,o=t),{left:a,center:function(t,e,n=0,i=t.length){const r=a(t,e,n,i-1);return r>n&&o(t[r-1],e)>-o(t[r],e)?r-1:r},right:function(t,e,n=0,r=t.length){if(n<r){if(0!==i(e,e))return r;do{const i=n+r>>>1;s(t[i],e)<=0?n=i+1:r=i}while(n<r)}return n}}}function r(){return 0}function s(t){return null===t?NaN:+t}function*o(t,e){if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&(yield e);else{let n=-1;for(let i of t)null!=(i=e(i,++n,t))&&(i=+i)>=i&&(yield i)}}const a=i(e),l=a.right,h=a.left,c=i(s).center;var u=l;const f=p(y),d=p((function(t){const e=y(t);return(t,n,i,r,s)=>{e(t,n,(i<<=2)+0,(r<<=2)+0,s<<=2),e(t,n,i+1,r+1,s),e(t,n,i+2,r+2,s),e(t,n,i+3,r+3,s)}}));function p(t){return function(e,n,i=n){if(!((n=+n)>=0))throw new RangeError("invalid rx");if(!((i=+i)>=0))throw new RangeError("invalid ry");let{data:r,width:s,height:o}=e;if(!((s=Math.floor(s))>=0))throw new RangeError("invalid width");if(!((o=Math.floor(void 0!==o?o:r.length/s))>=0))throw new RangeError("invalid height");if(!s||!o||!n&&!i)return e;const a=n&&t(n),l=i&&t(i),h=r.slice();return a&&l?(g(a,h,r,s,o),g(a,r,h,s,o),g(a,h,r,s,o),_(l,r,h,s,o),_(l,h,r,s,o),_(l,r,h,s,o)):a?(g(a,r,h,s,o),g(a,h,r,s,o),g(a,r,h,s,o)):l&&(_(l,r,h,s,o),_(l,h,r,s,o),_(l,r,h,s,o)),e}}function g(t,e,n,i,r){for(let s=0,o=i*r;s<o;)t(e,n,s,s+=i,1)}function _(t,e,n,i,r){for(let s=0,o=i*r;s<i;++s)t(e,n,s,s+o,i)}function y(t){const e=Math.floor(t);if(e===t)return function(t){const e=2*t+1;return(n,i,r,s,o)=>{if(!((s-=o)>=r))return;let a=t*i[r];const l=o*t;for(let t=r,e=r+l;t<e;t+=o)a+=i[Math.min(s,t)];for(let t=r,h=s;t<=h;t+=o)a+=i[Math.min(s,t+l)],n[t]=a/e,a-=i[Math.max(r,t-l)]}}(t);const n=t-e,i=2*t+1;return(t,r,s,o,a)=>{if(!((o-=a)>=s))return;let l=e*r[s];const h=a*e,c=h+a;for(let t=s,e=s+h;t<e;t+=a)l+=r[Math.min(o,t)];for(let e=s,u=o;e<=u;e+=a)l+=r[Math.min(o,e+h)],t[e]=(l+n*(r[Math.max(s,e-c)]+r[Math.min(o,e+c)]))/i,l-=r[Math.max(s,e-h)]}}function m(t,e){let n=0;if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&++n;else{let i=-1;for(let r of t)null!=(r=e(r,++i,t))&&(r=+r)>=r&&++n}return n}function x(t){return 0|t.length}function v(t){return!(t>0)}function b(t){return"object"!=typeof t||"length"in t?t:Array.from(t)}function M(t,e){let n,i=0,r=0,s=0;if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&(n=e-r,r+=n/++i,s+=n*(e-r));else{let o=-1;for(let a of t)null!=(a=e(a,++o,t))&&(a=+a)>=a&&(n=a-r,r+=n/++i,s+=n*(a-r))}if(i>1)return s/(i-1)}function w(t,e){const n=M(t,e);return n?Math.sqrt(n):n}function E(t,e){let n,i;if(void 0===e)for(const e of t)null!=e&&(void 0===n?e>=e&&(n=i=e):(n>e&&(n=e),i<e&&(i=e)));else{let r=-1;for(let s of t)null!=(s=e(s,++r,t))&&(void 0===n?s>=s&&(n=i=s):(n>s&&(n=s),i<s&&(i=s)))}return[n,i]}class N{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let n=0;for(let i=0;i<this._n&&i<32;i++){const r=e[i],s=t+r,o=Math.abs(t)<Math.abs(r)?t-(s-r):r-(s-t);o&&(e[n++]=o),t=s}return e[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let e,n,i,r=this._n,s=0;if(r>0){for(s=t[--r];r>0&&(e=s,n=t[--r],s=e+n,i=n-(s-e),!i););r>0&&(i<0&&t[r-1]<0||i>0&&t[r-1]>0)&&(n=2*i,e=s+n,n==e-s&&(s=e))}return s}}class S extends Map{constructor(t,e=T){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[e,n]of t)this.set(e,n)}get(t){return super.get(k(this,t))}has(t){return super.has(k(this,t))}set(t,e){return super.set(O(this,t),e)}delete(t){return super.delete(C(this,t))}}class I extends Set{constructor(t,e=T){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const e of t)this.add(e)}has(t){return super.has(k(this,t))}add(t){return super.add(O(this,t))}delete(t){return super.delete(C(this,t))}}function k({_intern:t,_key:e},n){const i=e(n);return t.has(i)?t.get(i):n}function O({_intern:t,_key:e},n){const i=e(n);return t.has(i)?t.get(i):(t.set(i,n),n)}function C({_intern:t,_key:e},n){const i=e(n);return t.has(i)&&(n=t.get(i),t.delete(i)),n}function T(t){return null!==t&&"object"==typeof t?t.valueOf():t}function R(t){return t}function A(t,...e){return j(t,R,R,e)}function L(t,...e){return j(t,Array.from,R,e)}function P(t,e){for(let n=1,i=e.length;n<i;++n)t=t.flatMap((t=>t.pop().map((([e,n])=>[...t,e,n]))));return t}function D(t,...e){return P(L(t,...e),e)}function z(t,e,...n){return j(t,R,e,n)}function F(t,e,...n){return j(t,Array.from,e,n)}function G(t,...e){return j(t,R,q,e)}function q(t){if(1!==t.length)throw new Error("duplicate key");return t[0]}function j(t,e,n,i){return function t(r,s){if(s>=i.length)return n(r);const o=new S,a=i[s++];let l=-1;for(const t of r){const e=a(t,++l,r),n=o.get(e);n?n.push(t):o.set(e,[t])}for(const[e,n]of o)o.set(e,t(n,s));return e(o)}(t,0)}function B(t,e){return Array.from(e,(e=>t[e]))}function U(t,...e){if("function"!=typeof t[Symbol.iterator])throw new TypeError("values is not iterable");t=Array.from(t);let[n]=e;if(n&&2!==n.length||e.length>1){const i=Uint32Array.from(t,((t,e)=>e));return e.length>1?(e=e.map((e=>t.map(e))),i.sort(((t,n)=>{for(const i of e){const e=W(i[t],i[n]);if(e)return e}}))):(n=t.map(n),i.sort(((t,e)=>W(n[t],n[e])))),B(t,i)}return t.sort(Y(n))}function Y(t=e){if(t===e)return W;if("function"!=typeof t)throw new TypeError("compare is not a function");return(e,n)=>{const i=t(e,n);return i||0===i?i:(0===t(n,n))-(0===t(e,e))}}function W(t,e){return(null==t||!(t>=t))-(null==e||!(e>=e))||(t<e?-1:t>e?1:0)}var $=Array.prototype.slice;function X(t){return()=>t}var V=Math.sqrt(50),H=Math.sqrt(10),Z=Math.sqrt(2);function J(t,e,n){var i,r,s,o,a=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((i=e<t)&&(r=t,t=e,e=r),0===(o=Q(t,e,n))||!isFinite(o))return[];if(o>0){let n=Math.round(t/o),i=Math.round(e/o);for(n*o<t&&++n,i*o>e&&--i,s=new Array(r=i-n+1);++a<r;)s[a]=(n+a)*o}else{o=-o;let n=Math.round(t*o),i=Math.round(e*o);for(n/o<t&&++n,i/o>e&&--i,s=new Array(r=i-n+1);++a<r;)s[a]=(n+a)/o}return i&&s.reverse(),s}function Q(t,e,n){var i=(e-t)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),s=i/Math.pow(10,r);return r>=0?(s>=V?10:s>=H?5:s>=Z?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(s>=V?10:s>=H?5:s>=Z?2:1)}function K(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),s=i/r;return s>=V?r*=10:s>=H?r*=5:s>=Z&&(r*=2),e<t?-r:r}function tt(t,e,n){let i;for(;;){const r=Q(t,e,n);if(r===i||0===r||!isFinite(r))return[t,e];r>0?(t=Math.floor(t/r)*r,e=Math.ceil(e/r)*r):r<0&&(t=Math.ceil(t*r)/r,e=Math.floor(e*r)/r),i=r}}function et(t){return Math.ceil(Math.log(m(t))/Math.LN2)+1}function nt(){var t=R,e=E,n=et;function i(i){Array.isArray(i)||(i=Array.from(i));var r,s,o,a=i.length,l=new Array(a);for(r=0;r<a;++r)l[r]=t(i[r],r,i);var h=e(l),c=h[0],f=h[1],d=n(l,c,f);if(!Array.isArray(d)){const t=f,n=+d;if(e===E&&([c,f]=tt(c,f,n)),(d=J(c,f,n))[0]<=c&&(o=Q(c,f,n)),d[d.length-1]>=f)if(t>=f&&e===E){const t=Q(c,f,n);isFinite(t)&&(t>0?f=(Math.floor(f/t)+1)*t:t<0&&(f=(Math.ceil(f*-t)+1)/-t))}else d.pop()}for(var p=d.length;d[0]<=c;)d.shift(),--p;for(;d[p-1]>f;)d.pop(),--p;var g,_=new Array(p+1);for(r=0;r<=p;++r)(g=_[r]=[]).x0=r>0?d[r-1]:c,g.x1=r<p?d[r]:f;if(isFinite(o)){if(o>0)for(r=0;r<a;++r)null!=(s=l[r])&&c<=s&&s<=f&&_[Math.min(p,Math.floor((s-c)/o))].push(i[r]);else if(o<0)for(r=0;r<a;++r)if(null!=(s=l[r])&&c<=s&&s<=f){const t=Math.floor((c-s)*o);_[Math.min(p,t+(d[t]<=s))].push(i[r])}}else for(r=0;r<a;++r)null!=(s=l[r])&&c<=s&&s<=f&&_[u(d,s,0,p)].push(i[r]);return _}return i.value=function(e){return arguments.length?(t="function"==typeof e?e:X(e),i):t},i.domain=function(t){return arguments.length?(e="function"==typeof t?t:X([t[0],t[1]]),i):e},i.thresholds=function(t){return arguments.length?(n="function"==typeof t?t:Array.isArray(t)?X($.call(t)):X(t),i):n},i}function it(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n<e||void 0===n&&e>=e)&&(n=e);else{let i=-1;for(let r of t)null!=(r=e(r,++i,t))&&(n<r||void 0===n&&r>=r)&&(n=r)}return n}function rt(t,e){let n,i=-1,r=-1;if(void 0===e)for(const e of t)++r,null!=e&&(n<e||void 0===n&&e>=e)&&(n=e,i=r);else for(let s of t)null!=(s=e(s,++r,t))&&(n<s||void 0===n&&s>=s)&&(n=s,i=r);return i}function st(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n>e||void 0===n&&e>=e)&&(n=e);else{let i=-1;for(let r of t)null!=(r=e(r,++i,t))&&(n>r||void 0===n&&r>=r)&&(n=r)}return n}function ot(t,e){let n,i=-1,r=-1;if(void 0===e)for(const e of t)++r,null!=e&&(n>e||void 0===n&&e>=e)&&(n=e,i=r);else for(let s of t)null!=(s=e(s,++r,t))&&(n>s||void 0===n&&s>=s)&&(n=s,i=r);return i}function at(t,e,n=0,i=t.length-1,r){for(r=void 0===r?W:Y(r);i>n;){if(i-n>600){const s=i-n+1,o=e-n+1,a=Math.log(s),l=.5*Math.exp(2*a/3),h=.5*Math.sqrt(a*l*(s-l)/s)*(o-s/2<0?-1:1);at(t,e,Math.max(n,Math.floor(e-o*l/s+h)),Math.min(i,Math.floor(e+(s-o)*l/s+h)),r)}const s=t[e];let o=n,a=i;for(lt(t,n,e),r(t[i],s)>0&&lt(t,n,i);o<a;){for(lt(t,o,a),++o,--a;r(t[o],s)<0;)++o;for(;r(t[a],s)>0;)--a}0===r(t[n],s)?lt(t,n,a):(++a,lt(t,a,i)),a<=e&&(n=a+1),e<=a&&(i=a-1)}return t}function lt(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}function ht(t,n=e){let i,r=!1;if(1===n.length){let s;for(const o of t){const t=n(o);(r?e(t,s)>0:0===e(t,t))&&(i=o,s=t,r=!0)}}else for(const e of t)(r?n(e,i)>0:0===n(e,e))&&(i=e,r=!0);return i}function ct(t,e,n){if(i=(t=Float64Array.from(o(t,n))).length){if((e=+e)<=0||i<2)return st(t);if(e>=1)return it(t);var i,r=(i-1)*e,s=Math.floor(r),a=it(at(t,s).subarray(0,s+1));return a+(st(t.subarray(s+1))-a)*(r-s)}}function ut(t,e,n=s){if(i=t.length){if((e=+e)<=0||i<2)return+n(t[0],0,t);if(e>=1)return+n(t[i-1],i-1,t);var i,r=(i-1)*e,o=Math.floor(r),a=+n(t[o],o,t);return a+(+n(t[o+1],o+1,t)-a)*(r-o)}}function ft(t,e,n){if(i=(t=Float64Array.from(o(t,n))).length){if((e=+e)<=0||i<2)return ot(t);if(e>=1)return rt(t);var i,r=Math.floor((i-1)*e),s=at(Uint32Array.from(t,((t,e)=>e)),r,0,i-1,((e,n)=>W(t[e],t[n])));return ht(s.subarray(0,r+1),(e=>t[e]))}}function dt(t){return Array.from(function*(t){for(const e of t)yield*e}(t))}function pt(t,e){return[t,e]}function gt(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=0|Math.max(0,Math.ceil((e-t)/n)),s=new Array(r);++i<r;)s[i]=t+i*n;return s}function _t(t,n=e){if(1===n.length)return ot(t,n);let i,r=-1,s=-1;for(const e of t)++s,(r<0?0===n(e,e):n(e,i)<0)&&(i=e,r=s);return r}var yt=mt(Math.random);function mt(t){return function(e,n=0,i=e.length){let r=i-(n=+n);for(;r;){const i=t()*r--|0,s=e[r+n];e[r+n]=e[i+n],e[i+n]=s}return e}}function xt(t,e){let n=0;if(void 0===e)for(let e of t)(e=+e)&&(n+=e);else{let i=-1;for(let r of t)(r=+e(r,++i,t))&&(n+=r)}return n}function vt(t){if(!(r=t.length))return[];for(var e=-1,n=st(t,bt),i=new Array(n);++e<n;)for(var r,s=-1,o=i[e]=new Array(r);++s<r;)o[s]=t[s][e];return i}function bt(t){return t.length}function Mt(t){if("function"!=typeof t[Symbol.iterator])throw new TypeError("values is not iterable");return Array.from(t).reverse()}function wt(t){return t instanceof I?t:new I(t)}function Et(t,e){const n=t[Symbol.iterator](),i=new Set;for(const t of e){const e=Nt(t);if(i.has(e))continue;let r,s;for(;({value:r,done:s}=n.next());){if(s)return!1;const t=Nt(r);if(i.add(t),Object.is(e,t))break}}return!0}function Nt(t){return null!==t&&"object"==typeof t?t.valueOf():t}var St=Object.freeze({__proto__:null,bisect:u,bisectRight:l,bisectLeft:h,bisectCenter:c,ascending:e,bisector:i,blur:function(t,e){if(!((e=+e)>=0))throw new RangeError("invalid r");let n=t.length;if(!((n=Math.floor(n))>=0))throw new RangeError("invalid length");if(!n||!e)return t;const i=y(e),r=t.slice();return i(t,r,0,n,1),i(r,t,0,n,1),i(t,r,0,n,1),t},blur2:f,blurImage:d,count:m,cross:function(...t){const e="function"==typeof t[t.length-1]&&function(t){return e=>t(...e)}(t.pop()),n=(t=t.map(b)).map(x),i=t.length-1,r=new Array(i+1).fill(0),s=[];if(i<0||n.some(v))return s;for(;;){s.push(r.map(((e,n)=>t[n][e])));let o=i;for(;++r[o]===n[o];){if(0===o)return e?s.map(e):s;r[o--]=0}}},cumsum:function(t,e){var n=0,i=0;return Float64Array.from(t,void 0===e?t=>n+=+t||0:r=>n+=+e(r,i++,t)||0)},descending:n,deviation:w,extent:E,Adder:N,fsum:function(t,e){const n=new N;if(void 0===e)for(let e of t)(e=+e)&&n.add(e);else{let i=-1;for(let r of t)(r=+e(r,++i,t))&&n.add(r)}return+n},fcumsum:function(t,e){const n=new N;let i=-1;return Float64Array.from(t,void 0===e?t=>n.add(+t||0):r=>n.add(+e(r,++i,t)||0))},group:A,flatGroup:D,flatRollup:function(t,e,...n){return P(F(t,e,...n),n)},groups:L,index:G,indexes:function(t,...e){return j(t,Array.from,q,e)},rollup:z,rollups:F,groupSort:function(t,n,i){return(2!==n.length?U(z(t,n,i),(([t,n],[i,r])=>e(n,r)||e(t,i))):U(A(t,i),(([t,i],[r,s])=>n(i,s)||e(t,r)))).map((([t])=>t))},bin:nt,histogram:nt,thresholdFreedmanDiaconis:function(t,e,n){return Math.ceil((n-e)/(2*(ct(t,.75)-ct(t,.25))*Math.pow(m(t),-1/3)))},thresholdScott:function(t,e,n){return Math.ceil((n-e)*Math.cbrt(m(t))/(3.49*w(t)))},thresholdSturges:et,max:it,maxIndex:rt,mean:function(t,e){let n=0,i=0;if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&(++n,i+=e);else{let r=-1;for(let s of t)null!=(s=e(s,++r,t))&&(s=+s)>=s&&(++n,i+=s)}if(n)return i/n},median:function(t,e){return ct(t,.5,e)},medianIndex:function(t,e){return ft(t,.5,e)},merge:dt,min:st,minIndex:ot,mode:function(t,e){const n=new S;if(void 0===e)for(let e of t)null!=e&&e>=e&&n.set(e,(n.get(e)||0)+1);else{let i=-1;for(let r of t)null!=(r=e(r,++i,t))&&r>=r&&n.set(r,(n.get(r)||0)+1)}let i,r=0;for(const[t,e]of n)e>r&&(r=e,i=t);return i},nice:tt,pairs:function(t,e=pt){const n=[];let i,r=!1;for(const s of t)r&&n.push(e(i,s)),i=s,r=!0;return n},permute:B,quantile:ct,quantileIndex:ft,quantileSorted:ut,quickselect:at,range:gt,rank:function(t,n=e){if("function"!=typeof t[Symbol.iterator])throw new TypeError("values is not iterable");let i=Array.from(t);const r=new Float64Array(i.length);2!==n.length&&(i=i.map(n),n=e);const s=(t,e)=>n(i[t],i[e]);let o,a;return Uint32Array.from(i,((t,e)=>e)).sort(n===e?(t,e)=>W(i[t],i[e]):Y(s)).forEach(((t,e)=>{const n=s(t,void 0===o?t:o);n>=0?((void 0===o||n>0)&&(o=t,a=e),r[t]=a):r[t]=NaN})),r},least:function(t,n=e){let i,r=!1;if(1===n.length){let s;for(const o of t){const t=n(o);(r?e(t,s)<0:0===e(t,t))&&(i=o,s=t,r=!0)}}else for(const e of t)(r?n(e,i)<0:0===n(e,e))&&(i=e,r=!0);return i},leastIndex:_t,greatest:ht,greatestIndex:function(t,n=e){if(1===n.length)return rt(t,n);let i,r=-1,s=-1;for(const e of t)++s,(r<0?0===n(e,e):n(e,i)>0)&&(i=e,r=s);return r},scan:function(t,e){const n=_t(t,e);return n<0?void 0:n},shuffle:yt,shuffler:mt,sum:xt,ticks:J,tickIncrement:Q,tickStep:K,transpose:vt,variance:M,zip:function(){return vt(arguments)},every:function(t,e){if("function"!=typeof e)throw new TypeError("test is not a function");let n=-1;for(const i of t)if(!e(i,++n,t))return!1;return!0},some:function(t,e){if("function"!=typeof e)throw new TypeError("test is not a function");let n=-1;for(const i of t)if(e(i,++n,t))return!0;return!1},filter:function(t,e){if("function"!=typeof e)throw new TypeError("test is not a function");const n=[];let i=-1;for(const r of t)e(r,++i,t)&&n.push(r);return n},map:function(t,e){if("function"!=typeof t[Symbol.iterator])throw new TypeError("values is not iterable");if("function"!=typeof e)throw new TypeError("mapper is not a function");return Array.from(t,((n,i)=>e(n,i,t)))},reduce:function(t,e,n){if("function"!=typeof e)throw new TypeError("reducer is not a function");const i=t[Symbol.iterator]();let r,s,o=-1;if(arguments.length<3){if(({done:r,value:n}=i.next()),r)return;++o}for(;({done:r,value:s}=i.next()),!r;)n=e(n,s,++o,t);return n},reverse:Mt,sort:U,difference:function(t,...e){t=new I(t);for(const n of e)for(const e of n)t.delete(e);return t},disjoint:function(t,e){const n=e[Symbol.iterator](),i=new I;for(const e of t){if(i.has(e))return!1;let t,r;for(;({value:t,done:r}=n.next())&&!r;){if(Object.is(e,t))return!1;i.add(t)}}return!0},intersection:function(t,...e){t=new I(t),e=e.map(wt);t:for(const n of t)for(const i of e)if(!i.has(n)){t.delete(n);continue t}return t},subset:function(t,e){return Et(e,t)},superset:Et,union:function(...t){const e=new I;for(const n of t)for(const t of n)e.add(t);return e},InternMap:S,InternSet:I}),It=1e-6,kt=1e-12,Ot=Math.PI,Ct=Ot/2,Tt=Ot/4,Rt=2*Ot,At=180/Ot,Lt=Ot/180,Pt=Math.abs,Dt=Math.atan,zt=Math.atan2,Ft=Math.cos,Gt=Math.ceil,qt=Math.exp,jt=Math.hypot,Bt=Math.log,Ut=Math.pow,Yt=Math.sin,Wt=Math.sign||function(t){return t>0?1:t<0?-1:0},$t=Math.sqrt,Xt=Math.tan;function Vt(t){return t>1?0:t<-1?Ot:Math.acos(t)}function Ht(t){return t>1?Ct:t<-1?-Ct:Math.asin(t)}function Zt(t){return(t=Yt(t/2))*t}function Jt(){}function Qt(t,e){t&&te.hasOwnProperty(t.type)&&te[t.type](t,e)}var Kt={Feature:function(t,e){Qt(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)Qt(n[i].geometry,e)}},te={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){ee(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)ee(n[i],e,0)},Polygon:function(t,e){ne(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)ne(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)Qt(n[i],e)}};function ee(t,e,n){var i,r=-1,s=t.length-n;for(e.lineStart();++r<s;)i=t[r],e.point(i[0],i[1],i[2]);e.lineEnd()}function ne(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)ee(t[n],e,1);e.polygonEnd()}function ie(t,e){t&&Kt.hasOwnProperty(t.type)?Kt[t.type](t,e):Qt(t,e)}var re,se,oe,ae,le,he,ce,ue,fe,de,pe,ge,_e,ye,me,xe,ve=new N,be=new N,Me={point:Jt,lineStart:Jt,lineEnd:Jt,polygonStart:function(){ve=new N,Me.lineStart=we,Me.lineEnd=Ee},polygonEnd:function(){var t=+ve;be.add(t<0?Rt+t:t),this.lineStart=this.lineEnd=this.point=Jt},sphere:function(){be.add(Rt)}};function we(){Me.point=Ne}function Ee(){Se(re,se)}function Ne(t,e){Me.point=Se,re=t,se=e,oe=t*=Lt,ae=Ft(e=(e*=Lt)/2+Tt),le=Yt(e)}function Se(t,e){var n=(t*=Lt)-oe,i=n>=0?1:-1,r=i*n,s=Ft(e=(e*=Lt)/2+Tt),o=Yt(e),a=le*o,l=ae*s+a*Ft(r),h=a*i*Yt(r);ve.add(zt(h,l)),oe=t,ae=s,le=o}function Ie(t){return be=new N,ie(t,Me),2*be}function ke(t){return[zt(t[1],t[0]),Ht(t[2])]}function Oe(t){var e=t[0],n=t[1],i=Ft(n);return[i*Ft(e),i*Yt(e),Yt(n)]}function Ce(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Te(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Re(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Ae(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Le(t){var e=$t(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}var Pe,De,ze,Fe,Ge,qe,je,Be,Ue,Ye,We,$e,Xe,Ve,He,Ze,Je={point:Qe,lineStart:tn,lineEnd:en,polygonStart:function(){Je.point=nn,Je.lineStart=rn,Je.lineEnd=sn,ye=new N,Me.polygonStart()},polygonEnd:function(){Me.polygonEnd(),Je.point=Qe,Je.lineStart=tn,Je.lineEnd=en,ve<0?(he=-(ue=180),ce=-(fe=90)):ye>It?fe=90:ye<-1e-6&&(ce=-90),xe[0]=he,xe[1]=ue},sphere:function(){he=-(ue=180),ce=-(fe=90)}};function Qe(t,e){me.push(xe=[he=t,ue=t]),e<ce&&(ce=e),e>fe&&(fe=e)}function Ke(t,e){var n=Oe([t*Lt,e*Lt]);if(_e){var i=Te(_e,n),r=Te([i[1],-i[0],0],i);Le(r),r=ke(r);var s,o=t-de,a=o>0?1:-1,l=r[0]*At*a,h=Pt(o)>180;h^(a*de<l&&l<a*t)?(s=r[1]*At)>fe&&(fe=s):h^(a*de<(l=(l+360)%360-180)&&l<a*t)?(s=-r[1]*At)<ce&&(ce=s):(e<ce&&(ce=e),e>fe&&(fe=e)),h?t<de?on(he,t)>on(he,ue)&&(ue=t):on(t,ue)>on(he,ue)&&(he=t):ue>=he?(t<he&&(he=t),t>ue&&(ue=t)):t>de?on(he,t)>on(he,ue)&&(ue=t):on(t,ue)>on(he,ue)&&(he=t)}else me.push(xe=[he=t,ue=t]);e<ce&&(ce=e),e>fe&&(fe=e),_e=n,de=t}function tn(){Je.point=Ke}function en(){xe[0]=he,xe[1]=ue,Je.point=Qe,_e=null}function nn(t,e){if(_e){var n=t-de;ye.add(Pt(n)>180?n+(n>0?360:-360):n)}else pe=t,ge=e;Me.point(t,e),Ke(t,e)}function rn(){Me.lineStart()}function sn(){nn(pe,ge),Me.lineEnd(),Pt(ye)>It&&(he=-(ue=180)),xe[0]=he,xe[1]=ue,_e=null}function on(t,e){return(e-=t)<0?e+360:e}function an(t,e){return t[0]-e[0]}function ln(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}function hn(t){var e,n,i,r,s,o,a;if(fe=ue=-(he=ce=1/0),me=[],ie(t,Je),n=me.length){for(me.sort(an),e=1,s=[i=me[0]];e<n;++e)ln(i,(r=me[e])[0])||ln(i,r[1])?(on(i[0],r[1])>on(i[0],i[1])&&(i[1]=r[1]),on(r[0],i[1])>on(i[0],i[1])&&(i[0]=r[0])):s.push(i=r);for(o=-1/0,e=0,i=s[n=s.length-1];e<=n;i=r,++e)r=s[e],(a=on(i[1],r[0]))>o&&(o=a,he=r[0],ue=i[1])}return me=xe=null,he===1/0||ce===1/0?[[NaN,NaN],[NaN,NaN]]:[[he,ce],[ue,fe]]}var cn={sphere:Jt,point:un,lineStart:dn,lineEnd:_n,polygonStart:function(){cn.lineStart=yn,cn.lineEnd=mn},polygonEnd:function(){cn.lineStart=dn,cn.lineEnd=_n}};function un(t,e){t*=Lt;var n=Ft(e*=Lt);fn(n*Ft(t),n*Yt(t),Yt(e))}function fn(t,e,n){++Pe,ze+=(t-ze)/Pe,Fe+=(e-Fe)/Pe,Ge+=(n-Ge)/Pe}function dn(){cn.point=pn}function pn(t,e){t*=Lt;var n=Ft(e*=Lt);Ve=n*Ft(t),He=n*Yt(t),Ze=Yt(e),cn.point=gn,fn(Ve,He,Ze)}function gn(t,e){t*=Lt;var n=Ft(e*=Lt),i=n*Ft(t),r=n*Yt(t),s=Yt(e),o=zt($t((o=He*s-Ze*r)*o+(o=Ze*i-Ve*s)*o+(o=Ve*r-He*i)*o),Ve*i+He*r+Ze*s);De+=o,qe+=o*(Ve+(Ve=i)),je+=o*(He+(He=r)),Be+=o*(Ze+(Ze=s)),fn(Ve,He,Ze)}function _n(){cn.point=un}function yn(){cn.point=xn}function mn(){vn($e,Xe),cn.point=un}function xn(t,e){$e=t,Xe=e,t*=Lt,e*=Lt,cn.point=vn;var n=Ft(e);Ve=n*Ft(t),He=n*Yt(t),Ze=Yt(e),fn(Ve,He,Ze)}function vn(t,e){t*=Lt;var n=Ft(e*=Lt),i=n*Ft(t),r=n*Yt(t),s=Yt(e),o=He*s-Ze*r,a=Ze*i-Ve*s,l=Ve*r-He*i,h=jt(o,a,l),c=Ht(h),u=h&&-c/h;Ue.add(u*o),Ye.add(u*a),We.add(u*l),De+=c,qe+=c*(Ve+(Ve=i)),je+=c*(He+(He=r)),Be+=c*(Ze+(Ze=s)),fn(Ve,He,Ze)}function bn(t){Pe=De=ze=Fe=Ge=qe=je=Be=0,Ue=new N,Ye=new N,We=new N,ie(t,cn);var e=+Ue,n=+Ye,i=+We,r=jt(e,n,i);return r<kt&&(e=qe,n=je,i=Be,De<It&&(e=ze,n=Fe,i=Ge),(r=jt(e,n,i))<kt)?[NaN,NaN]:[zt(n,e)*At,Ht(i/r)*At]}function Mn(t){return function(){return t}}function wn(t,e){function n(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,i){return(n=e.invert(n,i))&&t.invert(n[0],n[1])}),n}function En(t,e){return[Pt(t)>Ot?t+Math.round(-t/Rt)*Rt:t,e]}function Nn(t,e,n){return(t%=Rt)?e||n?wn(In(t),kn(e,n)):In(t):e||n?kn(e,n):En}function Sn(t){return function(e,n){return[(e+=t)>Ot?e-Rt:e<-Ot?e+Rt:e,n]}}function In(t){var e=Sn(t);return e.invert=Sn(-t),e}function kn(t,e){var n=Ft(t),i=Yt(t),r=Ft(e),s=Yt(e);function o(t,e){var o=Ft(e),a=Ft(t)*o,l=Yt(t)*o,h=Yt(e),c=h*n+a*i;return[zt(l*r-c*s,a*n-h*i),Ht(c*r+l*s)]}return o.invert=function(t,e){var o=Ft(e),a=Ft(t)*o,l=Yt(t)*o,h=Yt(e),c=h*r-l*s;return[zt(l*r+h*s,a*n+c*i),Ht(c*n-a*i)]},o}function On(t){function e(e){return(e=t(e[0]*Lt,e[1]*Lt))[0]*=At,e[1]*=At,e}return t=Nn(t[0]*Lt,t[1]*Lt,t.length>2?t[2]*Lt:0),e.invert=function(e){return(e=t.invert(e[0]*Lt,e[1]*Lt))[0]*=At,e[1]*=At,e},e}function Cn(t,e,n,i,r,s){if(n){var o=Ft(e),a=Yt(e),l=i*n;null==r?(r=e+i*Rt,s=e-l/2):(r=Tn(o,r),s=Tn(o,s),(i>0?r<s:r>s)&&(r+=i*Rt));for(var h,c=r;i>0?c>s:c<s;c-=l)h=ke([o,-a*Ft(c),-a*Yt(c)]),t.point(h[0],h[1])}}function Tn(t,e){(e=Oe(e))[0]-=t,Le(e);var n=Vt(-e[1]);return((-e[2]<0?-n:n)+Rt-It)%Rt}function Rn(){var t,e,n=Mn([0,0]),i=Mn(90),r=Mn(6),s={point:function(n,i){t.push(n=e(n,i)),n[0]*=At,n[1]*=At}};function o(){var o=n.apply(this,arguments),a=i.apply(this,arguments)*Lt,l=r.apply(this,arguments)*Lt;return t=[],e=Nn(-o[0]*Lt,-o[1]*Lt,0).invert,Cn(s,a,l,1),o={type:"Polygon",coordinates:[t]},t=e=null,o}return o.center=function(t){return arguments.length?(n="function"==typeof t?t:Mn([+t[0],+t[1]]),o):n},o.radius=function(t){return arguments.length?(i="function"==typeof t?t:Mn(+t),o):i},o.precision=function(t){return arguments.length?(r="function"==typeof t?t:Mn(+t),o):r},o}function An(){var t,e=[];return{point:function(e,n,i){t.push([e,n,i])},lineStart:function(){e.push(t=[])},lineEnd:Jt,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function Ln(t,e){return Pt(t[0]-e[0])<It&&Pt(t[1]-e[1])<It}function Pn(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function Dn(t,e,n,i,r){var s,o,a=[],l=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,i=t[0],o=t[e];if(Ln(i,o)){if(!i[2]&&!o[2]){for(r.lineStart(),s=0;s<e;++s)r.point((i=t[s])[0],i[1]);return void r.lineEnd()}o[0]+=2e-6}a.push(n=new Pn(i,t,null,!0)),l.push(n.o=new Pn(i,null,n,!1)),a.push(n=new Pn(o,t,null,!1)),l.push(n.o=new Pn(o,null,n,!0))}})),a.length){for(l.sort(e),zn(a),zn(l),s=0,o=l.length;s<o;++s)l[s].e=n=!n;for(var h,c,u=a[0];;){for(var f=u,d=!0;f.v;)if((f=f.n)===u)return;h=f.z,r.lineStart();do{if(f.v=f.o.v=!0,f.e){if(d)for(s=0,o=h.length;s<o;++s)r.point((c=h[s])[0],c[1]);else i(f.x,f.n.x,1,r);f=f.n}else{if(d)for(h=f.p.z,s=h.length-1;s>=0;--s)r.point((c=h[s])[0],c[1]);else i(f.x,f.p.x,-1,r);f=f.p}h=(f=f.o).z,d=!d}while(!f.v);r.lineEnd()}}}function zn(t){if(e=t.length){for(var e,n,i=0,r=t[0];++i<e;)r.n=n=t[i],n.p=r,r=n;r.n=n=t[0],n.p=r}}function Fn(t){return Pt(t[0])<=Ot?t[0]:Wt(t[0])*((Pt(t[0])+Ot)%Rt-Ot)}function Gn(t,e){var n=Fn(e),i=e[1],r=Yt(i),s=[Yt(n),-Ft(n),0],o=0,a=0,l=new N;1===r?i=Ct+It:-1===r&&(i=-Ct-It);for(var h=0,c=t.length;h<c;++h)if(f=(u=t[h]).length)for(var u,f,d=u[f-1],p=Fn(d),g=d[1]/2+Tt,_=Yt(g),y=Ft(g),m=0;m<f;++m,p=v,_=M,y=w,d=x){var x=u[m],v=Fn(x),b=x[1]/2+Tt,M=Yt(b),w=Ft(b),E=v-p,S=E>=0?1:-1,I=S*E,k=I>Ot,O=_*M;if(l.add(zt(O*S*Yt(I),y*w+O*Ft(I))),o+=k?E+S*Rt:E,k^p>=n^v>=n){var C=Te(Oe(d),Oe(x));Le(C);var T=Te(s,C);Le(T);var R=(k^E>=0?-1:1)*Ht(T[2]);(i>R||i===R&&(C[0]||C[1]))&&(a+=k^E>=0?1:-1)}}return(o<-1e-6||o<It&&l<-1e-12)^1&a}function qn(t,e,n,i){return function(r){var s,o,a,l=e(r),h=An(),c=e(h),u=!1,f={point:d,lineStart:g,lineEnd:_,polygonStart:function(){f.point=y,f.lineStart=m,f.lineEnd=x,o=[],s=[]},polygonEnd:function(){f.point=d,f.lineStart=g,f.lineEnd=_,o=dt(o);var t=Gn(s,i);o.length?(u||(r.polygonStart(),u=!0),Dn(o,Bn,t,n,r)):t&&(u||(r.polygonStart(),u=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),u&&(r.polygonEnd(),u=!1),o=s=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function d(e,n){t(e,n)&&r.point(e,n)}function p(t,e){l.point(t,e)}function g(){f.point=p,l.lineStart()}function _(){f.point=d,l.lineEnd()}function y(t,e){a.push([t,e]),c.point(t,e)}function m(){c.lineStart(),a=[]}function x(){y(a[0][0],a[0][1]),c.lineEnd();var t,e,n,i,l=c.clean(),f=h.result(),d=f.length;if(a.pop(),s.push(a),a=null,d)if(1&l){if((e=(n=f[0]).length-1)>0){for(u||(r.polygonStart(),u=!0),r.lineStart(),t=0;t<e;++t)r.point((i=n[t])[0],i[1]);r.lineEnd()}}else d>1&&2&l&&f.push(f.pop().concat(f.shift())),o.push(f.filter(jn))}return f}}function jn(t){return t.length>1}function Bn(t,e){return((t=t.x)[0]<0?t[1]-Ct-It:Ct-t[1])-((e=e.x)[0]<0?e[1]-Ct-It:Ct-e[1])}En.invert=En;var Un=qn((function(){return!0}),(function(t){var e,n=NaN,i=NaN,r=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(s,o){var a=s>0?Ot:-Ot,l=Pt(s-n);Pt(l-Ot)<It?(t.point(n,i=(i+o)/2>0?Ct:-Ct),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(a,i),t.point(s,i),e=0):r!==a&&l>=Ot&&(Pt(n-r)<It&&(n-=r*It),Pt(s-a)<It&&(s-=a*It),i=function(t,e,n,i){var r,s,o=Yt(t-n);return Pt(o)>It?Dt((Yt(e)*(s=Ft(i))*Yt(n)-Yt(i)*(r=Ft(e))*Yt(t))/(r*s*o)):(e+i)/2}(n,i,s,o),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(a,i),e=0),t.point(n=s,i=o),r=a},lineEnd:function(){t.lineEnd(),n=i=NaN},clean:function(){return 2-e}}}),(function(t,e,n,i){var r;if(null==t)r=n*Ct,i.point(-Ot,r),i.point(0,r),i.point(Ot,r),i.point(Ot,0),i.point(Ot,-r),i.point(0,-r),i.point(-Ot,-r),i.point(-Ot,0),i.point(-Ot,r);else if(Pt(t[0]-e[0])>It){var s=t[0]<e[0]?Ot:-Ot;r=n*s/2,i.point(-s,r),i.point(0,r),i.point(s,r)}else i.point(e[0],e[1])}),[-Ot,-Ct]);function Yn(t){var e=Ft(t),n=6*Lt,i=e>0,r=Pt(e)>It;function s(t,n){return Ft(t)*Ft(n)>e}function o(t,n,i){var r=[1,0,0],s=Te(Oe(t),Oe(n)),o=Ce(s,s),a=s[0],l=o-a*a;if(!l)return!i&&t;var h=e*o/l,c=-e*a/l,u=Te(r,s),f=Ae(r,h);Re(f,Ae(s,c));var d=u,p=Ce(f,d),g=Ce(d,d),_=p*p-g*(Ce(f,f)-1);if(!(_<0)){var y=$t(_),m=Ae(d,(-p-y)/g);if(Re(m,f),m=ke(m),!i)return m;var x,v=t[0],b=n[0],M=t[1],w=n[1];b<v&&(x=v,v=b,b=x);var E=b-v,N=Pt(E-Ot)<It;if(!N&&w<M&&(x=M,M=w,w=x),N||E<It?N?M+w>0^m[1]<(Pt(m[0]-v)<It?M:w):M<=m[1]&&m[1]<=w:E>Ot^(v<=m[0]&&m[0]<=b)){var S=Ae(d,(-p+y)/g);return Re(S,f),[m,ke(S)]}}}function a(e,n){var r=i?t:Ot-t,s=0;return e<-r?s|=1:e>r&&(s|=2),n<-r?s|=4:n>r&&(s|=8),s}return qn(s,(function(t){var e,n,l,h,c;return{lineStart:function(){h=l=!1,c=1},point:function(u,f){var d,p=[u,f],g=s(u,f),_=i?g?0:a(u,f):g?a(u+(u<0?Ot:-Ot),f):0;if(!e&&(h=l=g)&&t.lineStart(),g!==l&&(!(d=o(e,p))||Ln(e,d)||Ln(p,d))&&(p[2]=1),g!==l)c=0,g?(t.lineStart(),d=o(p,e),t.point(d[0],d[1])):(d=o(e,p),t.point(d[0],d[1],2),t.lineEnd()),e=d;else if(r&&e&&i^g){var y;_&n||!(y=o(p,e,!0))||(c=0,i?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1],3)))}!g||e&&Ln(e,p)||t.point(p[0],p[1]),e=p,l=g,n=_},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return c|(h&&l)<<1}}}),(function(e,i,r,s){Cn(s,t,n,r,e,i)}),i?[0,-t]:[-Ot,t-Ot])}var Wn,$n,Xn,Vn,Hn=1e9,Zn=-Hn;function Jn(t,e,n,i){function r(r,s){return t<=r&&r<=n&&e<=s&&s<=i}function s(r,s,a,h){var c=0,u=0;if(null==r||(c=o(r,a))!==(u=o(s,a))||l(r,s)<0^a>0)do{h.point(0===c||3===c?t:n,c>1?i:e)}while((c=(c+a+4)%4)!==u);else h.point(s[0],s[1])}function o(i,r){return Pt(i[0]-t)<It?r>0?0:3:Pt(i[0]-n)<It?r>0?2:1:Pt(i[1]-e)<It?r>0?1:0:r>0?3:2}function a(t,e){return l(t.x,e.x)}function l(t,e){var n=o(t,1),i=o(e,1);return n!==i?n-i:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(o){var l,h,c,u,f,d,p,g,_,y,m,x=o,v=An(),b={point:M,lineStart:function(){b.point=w,h&&h.push(c=[]);y=!0,_=!1,p=g=NaN},lineEnd:function(){l&&(w(u,f),d&&_&&v.rejoin(),l.push(v.result()));b.point=M,_&&x.lineEnd()},polygonStart:function(){x=v,l=[],h=[],m=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,r=h.length;n<r;++n)for(var s,o,a=h[n],l=1,c=a.length,u=a[0],f=u[0],d=u[1];l<c;++l)s=f,o=d,f=(u=a[l])[0],d=u[1],o<=i?d>i&&(f-s)*(i-o)>(d-o)*(t-s)&&++e:d<=i&&(f-s)*(i-o)<(d-o)*(t-s)&&--e;return e}(),n=m&&e,r=(l=dt(l)).length;(n||r)&&(o.polygonStart(),n&&(o.lineStart(),s(null,null,1,o),o.lineEnd()),r&&Dn(l,a,e,s,o),o.polygonEnd());x=o,l=h=c=null}};function M(t,e){r(t,e)&&x.point(t,e)}function w(s,o){var a=r(s,o);if(h&&c.push([s,o]),y)u=s,f=o,d=a,y=!1,a&&(x.lineStart(),x.point(s,o));else if(a&&_)x.point(s,o);else{var l=[p=Math.max(Zn,Math.min(Hn,p)),g=Math.max(Zn,Math.min(Hn,g))],v=[s=Math.max(Zn,Math.min(Hn,s)),o=Math.max(Zn,Math.min(Hn,o))];!function(t,e,n,i,r,s){var o,a=t[0],l=t[1],h=0,c=1,u=e[0]-a,f=e[1]-l;if(o=n-a,u||!(o>0)){if(o/=u,u<0){if(o<h)return;o<c&&(c=o)}else if(u>0){if(o>c)return;o>h&&(h=o)}if(o=r-a,u||!(o<0)){if(o/=u,u<0){if(o>c)return;o>h&&(h=o)}else if(u>0){if(o<h)return;o<c&&(c=o)}if(o=i-l,f||!(o>0)){if(o/=f,f<0){if(o<h)return;o<c&&(c=o)}else if(f>0){if(o>c)return;o>h&&(h=o)}if(o=s-l,f||!(o<0)){if(o/=f,f<0){if(o>c)return;o>h&&(h=o)}else if(f>0){if(o<h)return;o<c&&(c=o)}return h>0&&(t[0]=a+h*u,t[1]=l+h*f),c<1&&(e[0]=a+c*u,e[1]=l+c*f),!0}}}}}(l,v,t,e,n,i)?a&&(x.lineStart(),x.point(s,o),m=!1):(_||(x.lineStart(),x.point(l[0],l[1])),x.point(v[0],v[1]),a||x.lineEnd(),m=!1)}p=s,g=o,_=a}return b}}var Qn={sphere:Jt,point:Jt,lineStart:function(){Qn.point=ti,Qn.lineEnd=Kn},lineEnd:Jt,polygonStart:Jt,polygonEnd:Jt};function Kn(){Qn.point=Qn.lineEnd=Jt}function ti(t,e){$n=t*=Lt,Xn=Yt(e*=Lt),Vn=Ft(e),Qn.point=ei}function ei(t,e){t*=Lt;var n=Yt(e*=Lt),i=Ft(e),r=Pt(t-$n),s=Ft(r),o=i*Yt(r),a=Vn*n-Xn*i*s,l=Xn*n+Vn*i*s;Wn.add(zt($t(o*o+a*a),l)),$n=t,Xn=n,Vn=i}function ni(t){return Wn=new N,ie(t,Qn),+Wn}var ii=[null,null],ri={type:"LineString",coordinates:ii};function si(t,e){return ii[0]=t,ii[1]=e,ni(ri)}var oi={Feature:function(t,e){return li(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)if(li(n[i].geometry,e))return!0;return!1}},ai={Sphere:function(){return!0},Point:function(t,e){return hi(t.coordinates,e)},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)if(hi(n[i],e))return!0;return!1},LineString:function(t,e){return ci(t.coordinates,e)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)if(ci(n[i],e))return!0;return!1},Polygon:function(t,e){return ui(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)if(ui(n[i],e))return!0;return!1},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)if(li(n[i],e))return!0;return!1}};function li(t,e){return!(!t||!ai.hasOwnProperty(t.type))&&ai[t.type](t,e)}function hi(t,e){return 0===si(t,e)}function ci(t,e){for(var n,i,r,s=0,o=t.length;s<o;s++){if(0===(i=si(t[s],e)))return!0;if(s>0&&(r=si(t[s],t[s-1]))>0&&n<=r&&i<=r&&(n+i-r)*(1-Math.pow((n-i)/r,2))<kt*r)return!0;n=i}return!1}function ui(t,e){return!!Gn(t.map(fi),di(e))}function fi(t){return(t=t.map(di)).pop(),t}function di(t){return[t[0]*Lt,t[1]*Lt]}function pi(t,e,n){var i=gt(t,e-It,n).concat(e);return function(t){return i.map((function(e){return[t,e]}))}}function gi(t,e,n){var i=gt(t,e-It,n).concat(e);return function(t){return i.map((function(e){return[e,t]}))}}function _i(){var t,e,n,i,r,s,o,a,l,h,c,u,f=10,d=f,p=90,g=360,_=2.5;function y(){return{type:"MultiLineString",coordinates:m()}}function m(){return gt(Gt(i/p)*p,n,p).map(c).concat(gt(Gt(a/g)*g,o,g).map(u)).concat(gt(Gt(e/f)*f,t,f).filter((function(t){return Pt(t%p)>It})).map(l)).concat(gt(Gt(s/d)*d,r,d).filter((function(t){return Pt(t%g)>It})).map(h))}return y.lines=function(){return m().map((function(t){return{type:"LineString",coordinates:t}}))},y.outline=function(){return{type:"Polygon",coordinates:[c(i).concat(u(o).slice(1),c(n).reverse().slice(1),u(a).reverse().slice(1))]}},y.extent=function(t){return arguments.length?y.extentMajor(t).extentMinor(t):y.extentMinor()},y.extentMajor=function(t){return arguments.length?(i=+t[0][0],n=+t[1][0],a=+t[0][1],o=+t[1][1],i>n&&(t=i,i=n,n=t),a>o&&(t=a,a=o,o=t),y.precision(_)):[[i,a],[n,o]]},y.extentMinor=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],s=+n[0][1],r=+n[1][1],e>t&&(n=e,e=t,t=n),s>r&&(n=s,s=r,r=n),y.precision(_)):[[e,s],[t,r]]},y.step=function(t){return arguments.length?y.stepMajor(t).stepMinor(t):y.stepMinor()},y.stepMajor=function(t){return arguments.length?(p=+t[0],g=+t[1],y):[p,g]},y.stepMinor=function(t){return arguments.length?(f=+t[0],d=+t[1],y):[f,d]},y.precision=function(f){return arguments.length?(_=+f,l=pi(s,r,90),h=gi(e,t,_),c=pi(a,o,90),u=gi(i,n,_),y):_},y.extentMajor([[-180,-89.999999],[180,89.999999]]).extentMinor([[-180,-80.000001],[180,80.000001]])}function yi(t,e){var n=t[0]*Lt,i=t[1]*Lt,r=e[0]*Lt,s=e[1]*Lt,o=Ft(i),a=Yt(i),l=Ft(s),h=Yt(s),c=o*Ft(n),u=o*Yt(n),f=l*Ft(r),d=l*Yt(r),p=2*Ht($t(Zt(s-i)+o*l*Zt(r-n))),g=Yt(p),_=p?function(t){var e=Yt(t*=p)/g,n=Yt(p-t)/g,i=n*c+e*f,r=n*u+e*d,s=n*a+e*h;return[zt(r,i)*At,zt(s,$t(i*i+r*r))*At]}:function(){return[n*At,i*At]};return _.distance=p,_}var mi,xi,vi,bi,Mi=t=>t,wi=new N,Ei=new N,Ni={point:Jt,lineStart:Jt,lineEnd:Jt,polygonStart:function(){Ni.lineStart=Si,Ni.lineEnd=Oi},polygonEnd:function(){Ni.lineStart=Ni.lineEnd=Ni.point=Jt,wi.add(Pt(Ei)),Ei=new N},result:function(){var t=wi/2;return wi=new N,t}};function Si(){Ni.point=Ii}function Ii(t,e){Ni.point=ki,mi=vi=t,xi=bi=e}function ki(t,e){Ei.add(bi*t-vi*e),vi=t,bi=e}function Oi(){ki(mi,xi)}var Ci=Ni,Ti=1/0,Ri=Ti,Ai=-Ti,Li=Ai,Pi={point:function(t,e){t<Ti&&(Ti=t);t>Ai&&(Ai=t);e<Ri&&(Ri=e);e>Li&&(Li=e)},lineStart:Jt,lineEnd:Jt,polygonStart:Jt,polygonEnd:Jt,result:function(){var t=[[Ti,Ri],[Ai,Li]];return Ai=Li=-(Ri=Ti=1/0),t}};var Di,zi,Fi,Gi,qi=Pi,ji=0,Bi=0,Ui=0,Yi=0,Wi=0,$i=0,Xi=0,Vi=0,Hi=0,Zi={point:Ji,lineStart:Qi,lineEnd:er,polygonStart:function(){Zi.lineStart=nr,Zi.lineEnd=ir},polygonEnd:function(){Zi.point=Ji,Zi.lineStart=Qi,Zi.lineEnd=er},result:function(){var t=Hi?[Xi/Hi,Vi/Hi]:$i?[Yi/$i,Wi/$i]:Ui?[ji/Ui,Bi/Ui]:[NaN,NaN];return ji=Bi=Ui=Yi=Wi=$i=Xi=Vi=Hi=0,t}};function Ji(t,e){ji+=t,Bi+=e,++Ui}function Qi(){Zi.point=Ki}function Ki(t,e){Zi.point=tr,Ji(Fi=t,Gi=e)}function tr(t,e){var n=t-Fi,i=e-Gi,r=$t(n*n+i*i);Yi+=r*(Fi+t)/2,Wi+=r*(Gi+e)/2,$i+=r,Ji(Fi=t,Gi=e)}function er(){Zi.point=Ji}function nr(){Zi.point=rr}function ir(){sr(Di,zi)}function rr(t,e){Zi.point=sr,Ji(Di=Fi=t,zi=Gi=e)}function sr(t,e){var n=t-Fi,i=e-Gi,r=$t(n*n+i*i);Yi+=r*(Fi+t)/2,Wi+=r*(Gi+e)/2,$i+=r,Xi+=(r=Gi*t-Fi*e)*(Fi+t),Vi+=r*(Gi+e),Hi+=3*r,Ji(Fi=t,Gi=e)}var or=Zi;function ar(t){this._context=t}ar.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,Rt)}},result:Jt};var lr,hr,cr,ur,fr,dr=new N,pr={point:Jt,lineStart:function(){pr.point=gr},lineEnd:function(){lr&&_r(hr,cr),pr.point=Jt},polygonStart:function(){lr=!0},polygonEnd:function(){lr=null},result:function(){var t=+dr;return dr=new N,t}};function gr(t,e){pr.point=_r,hr=ur=t,cr=fr=e}function _r(t,e){ur-=t,fr-=e,dr.add($t(ur*ur+fr*fr)),ur=t,fr=e}var yr=pr;function mr(){this._string=[]}function xr(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function vr(t,e){var n,i,r=4.5;function s(t){return t&&("function"==typeof r&&i.pointRadius(+r.apply(this,arguments)),ie(t,n(i))),i.result()}return s.area=function(t){return ie(t,n(Ci)),Ci.result()},s.measure=function(t){return ie(t,n(yr)),yr.result()},s.bounds=function(t){return ie(t,n(qi)),qi.result()},s.centroid=function(t){return ie(t,n(or)),or.result()},s.projection=function(e){return arguments.length?(n=null==e?(t=null,Mi):(t=e).stream,s):t},s.context=function(t){return arguments.length?(i=null==t?(e=null,new mr):new ar(e=t),"function"!=typeof r&&i.pointRadius(r),s):e},s.pointRadius=function(t){return arguments.length?(r="function"==typeof t?t:(i.pointRadius(+t),+t),s):r},s.projection(t).context(e)}function br(t){return function(e){var n=new Mr;for(var i in t)n[i]=t[i];return n.stream=e,n}}function Mr(){}function wr(t,e,n){var i=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=i&&t.clipExtent(null),ie(n,t.stream(qi)),e(qi.result()),null!=i&&t.clipExtent(i),t}function Er(t,e,n){return wr(t,(function(n){var i=e[1][0]-e[0][0],r=e[1][1]-e[0][1],s=Math.min(i/(n[1][0]-n[0][0]),r/(n[1][1]-n[0][1])),o=+e[0][0]+(i-s*(n[1][0]+n[0][0]))/2,a=+e[0][1]+(r-s*(n[1][1]+n[0][1]))/2;t.scale(150*s).translate([o,a])}),n)}function Nr(t,e,n){return Er(t,[[0,0],e],n)}function Sr(t,e,n){return wr(t,(function(n){var i=+e,r=i/(n[1][0]-n[0][0]),s=(i-r*(n[1][0]+n[0][0]))/2,o=-r*n[0][1];t.scale(150*r).translate([s,o])}),n)}function Ir(t,e,n){return wr(t,(function(n){var i=+e,r=i/(n[1][1]-n[0][1]),s=-r*n[0][0],o=(i-r*(n[1][1]+n[0][1]))/2;t.scale(150*r).translate([s,o])}),n)}mr.prototype={_radius:4.5,_circle:xr(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=xr(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}},Mr.prototype={constructor:Mr,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var kr=Ft(30*Lt);function Or(t,e){return+e?function(t,e){function n(i,r,s,o,a,l,h,c,u,f,d,p,g,_){var y=h-i,m=c-r,x=y*y+m*m;if(x>4*e&&g--){var v=o+f,b=a+d,M=l+p,w=$t(v*v+b*b+M*M),E=Ht(M/=w),N=Pt(Pt(M)-1)<It||Pt(s-u)<It?(s+u)/2:zt(b,v),S=t(N,E),I=S[0],k=S[1],O=I-i,C=k-r,T=m*O-y*C;(T*T/x>e||Pt((y*O+m*C)/x-.5)>.3||o*f+a*d+l*p<kr)&&(n(i,r,s,o,a,l,I,k,N,v/=w,b/=w,M,g,_),_.point(I,k),n(I,k,N,v,b,M,h,c,u,f,d,p,g,_))}}return function(e){var i,r,s,o,a,l,h,c,u,f,d,p,g={point:_,lineStart:y,lineEnd:x,polygonStart:function(){e.polygonStart(),g.lineStart=v},polygonEnd:function(){e.polygonEnd(),g.lineStart=y}};function _(n,i){n=t(n,i),e.point(n[0],n[1])}function y(){c=NaN,g.point=m,e.lineStart()}function m(i,r){var s=Oe([i,r]),o=t(i,r);n(c,u,h,f,d,p,c=o[0],u=o[1],h=i,f=s[0],d=s[1],p=s[2],16,e),e.point(c,u)}function x(){g.point=_,e.lineEnd()}function v(){y(),g.point=b,g.lineEnd=M}function b(t,e){m(i=t,e),r=c,s=u,o=f,a=d,l=p,g.point=m}function M(){n(c,u,h,f,d,p,r,s,i,o,a,l,16,e),g.lineEnd=x,x()}return g}}(t,e):function(t){return br({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)}var Cr=br({point:function(t,e){this.stream.point(t*Lt,e*Lt)}});function Tr(t,e,n,i,r,s){if(!s)return function(t,e,n,i,r){function s(s,o){return[e+t*(s*=i),n-t*(o*=r)]}return s.invert=function(s,o){return[(s-e)/t*i,(n-o)/t*r]},s}(t,e,n,i,r);var o=Ft(s),a=Yt(s),l=o*t,h=a*t,c=o/t,u=a/t,f=(a*n-o*e)/t,d=(a*e+o*n)/t;function p(t,s){return[l*(t*=i)-h*(s*=r)+e,n-h*t-l*s]}return p.invert=function(t,e){return[i*(c*t-u*e+f),r*(d-u*t-c*e)]},p}function Rr(t){return Ar((function(){return t}))()}function Ar(t){var e,n,i,r,s,o,a,l,h,c,u=150,f=480,d=250,p=0,g=0,_=0,y=0,m=0,x=0,v=1,b=1,M=null,w=Un,E=null,N=Mi,S=.5;function I(t){return l(t[0]*Lt,t[1]*Lt)}function k(t){return(t=l.invert(t[0],t[1]))&&[t[0]*At,t[1]*At]}function O(){var t=Tr(u,0,0,v,b,x).apply(null,e(p,g)),i=Tr(u,f-t[0],d-t[1],v,b,x);return n=Nn(_,y,m),a=wn(e,i),l=wn(n,a),o=Or(a,S),C()}function C(){return h=c=null,I}return I.stream=function(t){return h&&c===t?h:h=Cr(function(t){return br({point:function(e,n){var i=t(e,n);return this.stream.point(i[0],i[1])}})}(n)(w(o(N(c=t)))))},I.preclip=function(t){return arguments.length?(w=t,M=void 0,C()):w},I.postclip=function(t){return arguments.length?(N=t,E=i=r=s=null,C()):N},I.clipAngle=function(t){return arguments.length?(w=+t?Yn(M=t*Lt):(M=null,Un),C()):M*At},I.clipExtent=function(t){return arguments.length?(N=null==t?(E=i=r=s=null,Mi):Jn(E=+t[0][0],i=+t[0][1],r=+t[1][0],s=+t[1][1]),C()):null==E?null:[[E,i],[r,s]]},I.scale=function(t){return arguments.length?(u=+t,O()):u},I.translate=function(t){return arguments.length?(f=+t[0],d=+t[1],O()):[f,d]},I.center=function(t){return arguments.length?(p=t[0]%360*Lt,g=t[1]%360*Lt,O()):[p*At,g*At]},I.rotate=function(t){return arguments.length?(_=t[0]%360*Lt,y=t[1]%360*Lt,m=t.length>2?t[2]%360*Lt:0,O()):[_*At,y*At,m*At]},I.angle=function(t){return arguments.length?(x=t%360*Lt,O()):x*At},I.reflectX=function(t){return arguments.length?(v=t?-1:1,O()):v<0},I.reflectY=function(t){return arguments.length?(b=t?-1:1,O()):b<0},I.precision=function(t){return arguments.length?(o=Or(a,S=t*t),C()):$t(S)},I.fitExtent=function(t,e){return Er(I,t,e)},I.fitSize=function(t,e){return Nr(I,t,e)},I.fitWidth=function(t,e){return Sr(I,t,e)},I.fitHeight=function(t,e){return Ir(I,t,e)},function(){return e=t.apply(this,arguments),I.invert=e.invert&&k,O()}}function Lr(t){var e=0,n=Ot/3,i=Ar(t),r=i(e,n);return r.parallels=function(t){return arguments.length?i(e=t[0]*Lt,n=t[1]*Lt):[e*At,n*At]},r}function Pr(t,e){var n=Yt(t),i=(n+Yt(e))/2;if(Pt(i)<It)return function(t){var e=Ft(t);function n(t,n){return[t*e,Yt(n)/e]}return n.invert=function(t,n){return[t/e,Ht(n*e)]},n}(t);var r=1+n*(2*i-n),s=$t(r)/i;function o(t,e){var n=$t(r-2*i*Yt(e))/i;return[n*Yt(t*=i),s-n*Ft(t)]}return o.invert=function(t,e){var n=s-e,o=zt(t,Pt(n))*Wt(n);return n*i<0&&(o-=Ot*Wt(t)*Wt(n)),[o/i,Ht((r-(t*t+n*n)*i*i)/(2*i))]},o}function Dr(){return Lr(Pr).scale(155.424).center([0,33.6442])}function zr(){return Dr().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Fr(t){return function(e,n){var i=Ft(e),r=Ft(n),s=t(i*r);return s===1/0?[2,0]:[s*r*Yt(e),s*Yt(n)]}}function Gr(t){return function(e,n){var i=$t(e*e+n*n),r=t(i),s=Yt(r),o=Ft(r);return[zt(e*s,i*o),Ht(i&&n*s/i)]}}var qr=Fr((function(t){return $t(2/(1+t))}));qr.invert=Gr((function(t){return 2*Ht(t/2)}));var jr=Fr((function(t){return(t=Vt(t))&&t/Yt(t)}));function Br(){return Rr(jr).scale(79.4188).clipAngle(179.999)}function Ur(t,e){return[t,Bt(Xt((Ct+e)/2))]}function Yr(){return Wr(Ur).scale(961/Rt)}function Wr(t){var e,n,i,r=Rr(t),s=r.center,o=r.scale,a=r.translate,l=r.clipExtent,h=null;function c(){var s=Ot*o(),a=r(On(r.rotate()).invert([0,0]));return l(null==h?[[a[0]-s,a[1]-s],[a[0]+s,a[1]+s]]:t===Ur?[[Math.max(a[0]-s,h),e],[Math.min(a[0]+s,n),i]]:[[h,Math.max(a[1]-s,e)],[n,Math.min(a[1]+s,i)]])}return r.scale=function(t){return arguments.length?(o(t),c()):o()},r.translate=function(t){return arguments.length?(a(t),c()):a()},r.center=function(t){return arguments.length?(s(t),c()):s()},r.clipExtent=function(t){return arguments.length?(null==t?h=e=n=i=null:(h=+t[0][0],e=+t[0][1],n=+t[1][0],i=+t[1][1]),c()):null==h?null:[[h,e],[n,i]]},c()}function $r(t){return Xt((Ct+t)/2)}function Xr(t,e){var n=Ft(t),i=t===e?Yt(t):Bt(n/Ft(e))/Bt($r(e)/$r(t)),r=n*Ut($r(t),i)/i;if(!i)return Ur;function s(t,e){r>0?e<-Ct+It&&(e=-Ct+It):e>Ct-It&&(e=Ct-It);var n=r/Ut($r(e),i);return[n*Yt(i*t),r-n*Ft(i*t)]}return s.invert=function(t,e){var n=r-e,s=Wt(i)*$t(t*t+n*n),o=zt(t,Pt(n))*Wt(n);return n*i<0&&(o-=Ot*Wt(t)*Wt(n)),[o/i,2*Dt(Ut(r/s,1/i))-Ct]},s}function Vr(t,e){return[t,e]}function Hr(){return Rr(Vr).scale(152.63)}function Zr(t,e){var n=Ft(t),i=t===e?Yt(t):(n-Ft(e))/(e-t),r=n/i+t;if(Pt(i)<It)return Vr;function s(t,e){var n=r-e,s=i*t;return[n*Yt(s),r-n*Ft(s)]}return s.invert=function(t,e){var n=r-e,s=zt(t,Pt(n))*Wt(n);return n*i<0&&(s-=Ot*Wt(t)*Wt(n)),[s/i,r-Wt(i)*$t(t*t+n*n)]},s}jr.invert=Gr((function(t){return t})),Ur.invert=function(t,e){return[t,2*Dt(qt(e))-Ct]},Vr.invert=Vr;var Jr=1.340264,Qr=-.081106,Kr=893e-6,ts=.003796,es=$t(3)/2;function ns(t,e){var n=Ht(es*Yt(e)),i=n*n,r=i*i*i;return[t*Ft(n)/(es*(Jr+3*Qr*i+r*(7*Kr+9*ts*i))),n*(Jr+Qr*i+r*(Kr+ts*i))]}function is(t,e){var n=Ft(e),i=Ft(t)*n;return[n*Yt(t)/i,Yt(e)/i]}function rs(){return Rr(is).scale(144.049).clipAngle(60)}function ss(){var t,e,n,i,r,s,o,a=1,l=0,h=0,c=1,u=1,f=0,d=null,p=1,g=1,_=br({point:function(t,e){var n=x([t,e]);this.stream.point(n[0],n[1])}}),y=Mi;function m(){return p=a*c,g=a*u,s=o=null,x}function x(n){var i=n[0]*p,r=n[1]*g;if(f){var s=r*t-i*e;i=i*t+r*e,r=s}return[i+l,r+h]}return x.invert=function(n){var i=n[0]-l,r=n[1]-h;if(f){var s=r*t+i*e;i=i*t-r*e,r=s}return[i/p,r/g]},x.stream=function(t){return s&&o===t?s:s=_(y(o=t))},x.postclip=function(t){return arguments.length?(y=t,d=n=i=r=null,m()):y},x.clipExtent=function(t){return arguments.length?(y=null==t?(d=n=i=r=null,Mi):Jn(d=+t[0][0],n=+t[0][1],i=+t[1][0],r=+t[1][1]),m()):null==d?null:[[d,n],[i,r]]},x.scale=function(t){return arguments.length?(a=+t,m()):a},x.translate=function(t){return arguments.length?(l=+t[0],h=+t[1],m()):[l,h]},x.angle=function(n){return arguments.length?(e=Yt(f=n%360*Lt),t=Ft(f),m()):f*At},x.reflectX=function(t){return arguments.length?(c=t?-1:1,m()):c<0},x.reflectY=function(t){return arguments.length?(u=t?-1:1,m()):u<0},x.fitExtent=function(t,e){return Er(x,t,e)},x.fitSize=function(t,e){return Nr(x,t,e)},x.fitWidth=function(t,e){return Sr(x,t,e)},x.fitHeight=function(t,e){return Ir(x,t,e)},x}function os(t,e){var n=e*e,i=n*n;return[t*(.8707-.131979*n+i*(i*(.003971*n-.001529*i)-.013791)),e*(1.007226+n*(.015085+i*(.028874*n-.044475-.005916*i)))]}function as(t,e){return[Ft(e)*Yt(t),Yt(e)]}function ls(){return Rr(as).scale(249.5).clipAngle(90.000001)}function hs(t,e){var n=Ft(e),i=1+Ft(t)*n;return[n*Yt(t)/i,Yt(e)/i]}function cs(t,e){return[Bt(Xt((Ct+e)/2)),-t]}ns.invert=function(t,e){for(var n,i=e,r=i*i,s=r*r*r,o=0;o<12&&(s=(r=(i-=n=(i*(Jr+Qr*r+s*(Kr+ts*r))-e)/(Jr+3*Qr*r+s*(7*Kr+9*ts*r)))*i)*r*r,!(Pt(n)<kt));++o);return[es*t*(Jr+3*Qr*r+s*(7*Kr+9*ts*r))/Ft(i),Ht(Yt(i)/es)]},is.invert=Gr(Dt),os.invert=function(t,e){var n,i=e,r=25;do{var s=i*i,o=s*s;i-=n=(i*(1.007226+s*(.015085+o*(.028874*s-.044475-.005916*o)))-e)/(1.007226+s*(.045255+o*(.259866*s-.311325-.005916*11*o)))}while(Pt(n)>It&&--r>0);return[t/(.8707+(s=i*i)*(s*(s*s*s*(.003971-.001529*s)-.013791)-.131979)),i]},as.invert=Gr(Ht),hs.invert=Gr((function(t){return 2*Dt(t)})),cs.invert=function(t,e){return[-e,2*Dt(qt(t))-Ct]};var us=Object.freeze({__proto__:null,geoArea:Ie,geoBounds:hn,geoCentroid:bn,geoCircle:Rn,geoClipAntimeridian:Un,geoClipCircle:Yn,geoClipExtent:function(){var t,e,n,i=0,r=0,s=960,o=500;return n={stream:function(n){return t&&e===n?t:t=Jn(i,r,s,o)(e=n)},extent:function(a){return arguments.length?(i=+a[0][0],r=+a[0][1],s=+a[1][0],o=+a[1][1],t=e=null,n):[[i,r],[s,o]]}}},geoClipRectangle:Jn,geoContains:function(t,e){return(t&&oi.hasOwnProperty(t.type)?oi[t.type]:li)(t,e)},geoDistance:si,geoGraticule:_i,geoGraticule10:function(){return _i()()},geoInterpolate:yi,geoLength:ni,geoPath:vr,geoAlbers:zr,geoAlbersUsa:function(){var t,e,n,i,r,s,o=zr(),a=Dr().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=Dr().rotate([157,0]).center([-3,19.9]).parallels([8,18]),h={point:function(t,e){s=[t,e]}};function c(t){var e=t[0],o=t[1];return s=null,n.point(e,o),s||(i.point(e,o),s)||(r.point(e,o),s)}function u(){return t=e=null,c}return c.invert=function(t){var e=o.scale(),n=o.translate(),i=(t[0]-n[0])/e,r=(t[1]-n[1])/e;return(r>=.12&&r<.234&&i>=-.425&&i<-.214?a:r>=.166&&r<.234&&i>=-.214&&i<-.115?l:o).invert(t)},c.stream=function(n){return t&&e===n?t:(i=[o.stream(e=n),a.stream(n),l.stream(n)],r=i.length,t={point:function(t,e){for(var n=-1;++n<r;)i[n].point(t,e)},sphere:function(){for(var t=-1;++t<r;)i[t].sphere()},lineStart:function(){for(var t=-1;++t<r;)i[t].lineStart()},lineEnd:function(){for(var t=-1;++t<r;)i[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<r;)i[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<r;)i[t].polygonEnd()}});var i,r},c.precision=function(t){return arguments.length?(o.precision(t),a.precision(t),l.precision(t),u()):o.precision()},c.scale=function(t){return arguments.length?(o.scale(t),a.scale(.35*t),l.scale(t),c.translate(o.translate())):o.scale()},c.translate=function(t){if(!arguments.length)return o.translate();var e=o.scale(),s=+t[0],c=+t[1];return n=o.translate(t).clipExtent([[s-.455*e,c-.238*e],[s+.455*e,c+.238*e]]).stream(h),i=a.translate([s-.307*e,c+.201*e]).clipExtent([[s-.425*e+It,c+.12*e+It],[s-.214*e-It,c+.234*e-It]]).stream(h),r=l.translate([s-.205*e,c+.212*e]).clipExtent([[s-.214*e+It,c+.166*e+It],[s-.115*e-It,c+.234*e-It]]).stream(h),u()},c.fitExtent=function(t,e){return Er(c,t,e)},c.fitSize=function(t,e){return Nr(c,t,e)},c.fitWidth=function(t,e){return Sr(c,t,e)},c.fitHeight=function(t,e){return Ir(c,t,e)},c.scale(1070)},geoAzimuthalEqualArea:function(){return Rr(qr).scale(124.75).clipAngle(179.999)},geoAzimuthalEqualAreaRaw:qr,geoAzimuthalEquidistant:Br,geoAzimuthalEquidistantRaw:jr,geoConicConformal:function(){return Lr(Xr).scale(109.5).parallels([30,30])},geoConicConformalRaw:Xr,geoConicEqualArea:Dr,geoConicEqualAreaRaw:Pr,geoConicEquidistant:function(){return Lr(Zr).scale(131.154).center([0,13.9389])},geoConicEquidistantRaw:Zr,geoEqualEarth:function(){return Rr(ns).scale(177.158)},geoEqualEarthRaw:ns,geoEquirectangular:Hr,geoEquirectangularRaw:Vr,geoGnomonic:rs,geoGnomonicRaw:is,geoIdentity:ss,geoProjection:Rr,geoProjectionMutator:Ar,geoMercator:Yr,geoMercatorRaw:Ur,geoNaturalEarth1:function(){return Rr(os).scale(175.295)},geoNaturalEarth1Raw:os,geoOrthographic:ls,geoOrthographicRaw:as,geoStereographic:function(){return Rr(hs).scale(250).clipAngle(142)},geoStereographicRaw:hs,geoTransverseMercator:function(){var t=Wr(cs),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)},geoTransverseMercatorRaw:cs,geoRotation:On,geoStream:ie,geoTransform:function(t){return{stream:br(t)}}}),fs="http://www.w3.org/1999/xhtml",ds={svg:"http://www.w3.org/2000/svg",xhtml:fs,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ps(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),ds.hasOwnProperty(e)?{space:ds[e],local:t}:t}function gs(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===fs&&e.documentElement.namespaceURI===fs?e.createElement(t):e.createElementNS(n,t)}}function _s(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function ys(t){var e=ps(t);return(e.local?_s:gs)(e)}function ms(){}function xs(t){return null==t?ms:function(){return this.querySelector(t)}}function vs(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function bs(){return[]}function Ms(t){return null==t?bs:function(){return this.querySelectorAll(t)}}function ws(t){return function(){return this.matches(t)}}function Es(t){return function(e){return e.matches(t)}}var Ns=Array.prototype.find;function Ss(){return this.firstElementChild}var Is=Array.prototype.filter;function ks(){return Array.from(this.children)}function Os(t){return new Array(t.length)}function Cs(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function Ts(t){return function(){return t}}function Rs(t,e,n,i,r,s){for(var o,a=0,l=e.length,h=s.length;a<h;++a)(o=e[a])?(o.__data__=s[a],i[a]=o):n[a]=new Cs(t,s[a]);for(;a<l;++a)(o=e[a])&&(r[a]=o)}function As(t,e,n,i,r,s,o){var a,l,h,c=new Map,u=e.length,f=s.length,d=new Array(u);for(a=0;a<u;++a)(l=e[a])&&(d[a]=h=o.call(l,l.__data__,a,e)+"",c.has(h)?r[a]=l:c.set(h,l));for(a=0;a<f;++a)h=o.call(t,s[a],a,s)+"",(l=c.get(h))?(i[a]=l,l.__data__=s[a],c.delete(h)):n[a]=new Cs(t,s[a]);for(a=0;a<u;++a)(l=e[a])&&c.get(d[a])===l&&(r[a]=l)}function Ls(t){return t.__data__}function Ps(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function Ds(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function zs(t){return function(){this.removeAttribute(t)}}function Fs(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Gs(t,e){return function(){this.setAttribute(t,e)}}function qs(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function js(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function Bs(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Us(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Ys(t){return function(){this.style.removeProperty(t)}}function Ws(t,e,n){return function(){this.style.setProperty(t,e,n)}}function $s(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function Xs(t,e){return t.style.getPropertyValue(e)||Us(t).getComputedStyle(t,null).getPropertyValue(e)}function Vs(t){return function(){delete this[t]}}function Hs(t,e){return function(){this[t]=e}}function Zs(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function Js(t){return t.trim().split(/^|\s+/)}function Qs(t){return t.classList||new Ks(t)}function Ks(t){this._node=t,this._names=Js(t.getAttribute("class")||"")}function to(t,e){for(var n=Qs(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function eo(t,e){for(var n=Qs(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function no(t){return function(){to(this,t)}}function io(t){return function(){eo(this,t)}}function ro(t,e){return function(){(e.apply(this,arguments)?to:eo)(this,t)}}function so(){this.textContent=""}function oo(t){return function(){this.textContent=t}}function ao(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function lo(){this.innerHTML=""}function ho(t){return function(){this.innerHTML=t}}function co(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function uo(){this.nextSibling&&this.parentNode.appendChild(this)}function fo(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function po(){return null}function go(){var t=this.parentNode;t&&t.removeChild(this)}function _o(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function yo(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function mo(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function xo(t){return function(){var e=this.__on;if(e){for(var n,i=0,r=-1,s=e.length;i<s;++i)n=e[i],t.type&&n.type!==t.type||n.name!==t.name?e[++r]=n:this.removeEventListener(n.type,n.listener,n.options);++r?e.length=r:delete this.__on}}}function vo(t,e,n){return function(){var i,r=this.__on,s=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(r)for(var o=0,a=r.length;o<a;++o)if((i=r[o]).type===t.type&&i.name===t.name)return this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),void(i.value=e);this.addEventListener(t.type,s,n),i={type:t.type,name:t.name,value:e,listener:s,options:n},r?r.push(i):this.__on=[i]}}function bo(t,e,n){var i=Us(t),r=i.CustomEvent;"function"==typeof r?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function Mo(t,e){return function(){return bo(this,t,e)}}function wo(t,e){return function(){return bo(this,t,e.apply(this,arguments))}}Cs.prototype={constructor:Cs,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},Ks.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Eo=[null];function No(t,e){this._groups=t,this._parents=e}function So(){return new No([[document.documentElement]],Eo)}function Io(t){return"string"==typeof t?new No([[document.querySelector(t)]],[document.documentElement]):new No([[t]],Eo)}function ko(t){return Io(ys(t).call(document.documentElement))}No.prototype=So.prototype={constructor:No,select:function(t){"function"!=typeof t&&(t=xs(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s,o,a=e[r],l=a.length,h=i[r]=new Array(l),c=0;c<l;++c)(s=a[c])&&(o=t.call(s,s.__data__,c,a))&&("__data__"in s&&(o.__data__=s.__data__),h[c]=o);return new No(i,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return vs(t.apply(this,arguments))}}(t):Ms(t);for(var e=this._groups,n=e.length,i=[],r=[],s=0;s<n;++s)for(var o,a=e[s],l=a.length,h=0;h<l;++h)(o=a[h])&&(i.push(t.call(o,o.__data__,h,a)),r.push(o));return new No(i,r)},selectChild:function(t){return this.select(null==t?Ss:function(t){return function(){return Ns.call(this.children,t)}}("function"==typeof t?t:Es(t)))},selectChildren:function(t){return this.selectAll(null==t?ks:function(t){return function(){return Is.call(this.children,t)}}("function"==typeof t?t:Es(t)))},filter:function(t){"function"!=typeof t&&(t=ws(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s,o=e[r],a=o.length,l=i[r]=[],h=0;h<a;++h)(s=o[h])&&t.call(s,s.__data__,h,o)&&l.push(s);return new No(i,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,Ls);var n=e?As:Rs,i=this._parents,r=this._groups;"function"!=typeof t&&(t=Ts(t));for(var s=r.length,o=new Array(s),a=new Array(s),l=new Array(s),h=0;h<s;++h){var c=i[h],u=r[h],f=u.length,d=Ps(t.call(c,c&&c.__data__,h,i)),p=d.length,g=a[h]=new Array(p),_=o[h]=new Array(p),y=l[h]=new Array(f);n(c,u,g,_,y,d,e);for(var m,x,v=0,b=0;v<p;++v)if(m=g[v]){for(v>=b&&(b=v+1);!(x=_[b])&&++b<p;);m._next=x||null}}return(o=new No(o,i))._enter=a,o._exit=l,o},enter:function(){return new No(this._enter||this._groups.map(Os),this._parents)},exit:function(){return new No(this._exit||this._groups.map(Os),this._parents)},join:function(t,e,n){var i=this.enter(),r=this,s=this.exit();return"function"==typeof t?(i=t(i))&&(i=i.selection()):i=i.append(t+""),null!=e&&(r=e(r))&&(r=r.selection()),null==n?s.remove():n(s),i&&r?i.merge(r).order():r},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,r=n.length,s=i.length,o=Math.min(r,s),a=new Array(r),l=0;l<o;++l)for(var h,c=n[l],u=i[l],f=c.length,d=a[l]=new Array(f),p=0;p<f;++p)(h=c[p]||u[p])&&(d[p]=h);for(;l<r;++l)a[l]=n[l];return new No(a,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,r=t[e],s=r.length-1,o=r[s];--s>=0;)(i=r[s])&&(o&&4^i.compareDocumentPosition(o)&&o.parentNode.insertBefore(i,o),o=i);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=Ds);for(var n=this._groups,i=n.length,r=new Array(i),s=0;s<i;++s){for(var o,a=n[s],l=a.length,h=r[s]=new Array(l),c=0;c<l;++c)(o=a[c])&&(h[c]=o);h.sort(e)}return new No(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,s=i.length;r<s;++r){var o=i[r];if(o)return o}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r,s=e[n],o=0,a=s.length;o<a;++o)(r=s[o])&&t.call(r,r.__data__,o,s);return this},attr:function(t,e){var n=ps(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==e?n.local?Fs:zs:"function"==typeof e?n.local?Bs:js:n.local?qs:Gs)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?Ys:"function"==typeof e?$s:Ws)(t,e,null==n?"":n)):Xs(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?Vs:"function"==typeof e?Zs:Hs)(t,e)):this.node()[t]},classed:function(t,e){var n=Js(t+"");if(arguments.length<2){for(var i=Qs(this.node()),r=-1,s=n.length;++r<s;)if(!i.contains(n[r]))return!1;return!0}return this.each(("function"==typeof e?ro:e?no:io)(n,e))},text:function(t){return arguments.length?this.each(null==t?so:("function"==typeof t?ao:oo)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?lo:("function"==typeof t?co:ho)(t)):this.node().innerHTML},raise:function(){return this.each(uo)},lower:function(){return this.each(fo)},append:function(t){var e="function"==typeof t?t:ys(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:ys(t),i=null==e?po:"function"==typeof e?e:xs(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)}))},remove:function(){return this.each(go)},clone:function(t){return this.select(t?yo:_o)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var i,r,s=mo(t+""),o=s.length;if(!(arguments.length<2)){for(a=e?vo:xo,i=0;i<o;++i)this.each(a(s[i],e,n));return this}var a=this.node().__on;if(a)for(var l,h=0,c=a.length;h<c;++h)for(i=0,l=a[h];i<o;++i)if((r=s[i]).type===l.type&&r.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?wo:Mo)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i,r=t[e],s=0,o=r.length;s<o;++s)(i=r[s])&&(yield i)}};var Oo=0;function Co(){return new To}function To(){this._="@"+(++Oo).toString(36)}function Ro(t){let e;for(;e=t.sourceEvent;)t=e;return t}function Ao(t,e){if(t=Ro(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,[(i=i.matrixTransform(e.getScreenCTM().inverse())).x,i.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]}To.prototype=Co.prototype={constructor:To,get:function(t){for(var e=this._;!(e in t);)if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};var Lo=Object.freeze({__proto__:null,create:ko,creator:ys,local:Co,matcher:ws,namespace:ps,namespaces:ds,pointer:Ao,pointers:function(t,e){return t.target&&(t=Ro(t),void 0===e&&(e=t.currentTarget),t=t.touches||[t]),Array.from(t,(t=>Ao(t,e)))},select:Io,selectAll:function(t){return"string"==typeof t?new No([document.querySelectorAll(t)],[document.documentElement]):new No([vs(t)],Eo)},selection:So,selector:xs,selectorAll:Ms,style:Xs,window:Us});function Po(t){return t}function Do(t,e){var n=e.id,i=e.bbox,r=null==e.properties?{}:e.properties,s=zo(t,e);return null==n&&null==i?{type:"Feature",properties:r,geometry:s}:null==i?{type:"Feature",id:n,properties:r,geometry:s}:{type:"Feature",id:n,bbox:i,properties:r,geometry:s}}function zo(t,e){var n=function(t){if(null==t)return Po;var e,n,i=t.scale[0],r=t.scale[1],s=t.translate[0],o=t.translate[1];return function(t,a){a||(e=n=0);var l=2,h=t.length,c=new Array(h);for(c[0]=(e+=t[0])*i+s,c[1]=(n+=t[1])*r+o;l<h;)c[l]=t[l],++l;return c}}(t.transform),i=t.arcs;function r(t,e){e.length&&e.pop();for(var r=i[t<0?~t:t],s=0,o=r.length;s<o;++s)e.push(n(r[s],s));t<0&&function(t,e){for(var n,i=t.length,r=i-e;r<--i;)n=t[r],t[r++]=t[i],t[i]=n}(e,o)}function s(t){return n(t)}function o(t){for(var e=[],n=0,i=t.length;n<i;++n)r(t[n],e);return e.length<2&&e.push(e[0]),e}function a(t){for(var e=o(t);e.length<4;)e.push(e[0]);return e}function l(t){return t.map(a)}return function t(e){var n,i=e.type;switch(i){case"GeometryCollection":return{type:i,geometries:e.geometries.map(t)};case"Point":n=s(e.coordinates);break;case"MultiPoint":n=e.coordinates.map(s);break;case"LineString":n=o(e.arcs);break;case"MultiLineString":n=e.arcs.map(o);break;case"Polygon":n=l(e.arcs);break;case"MultiPolygon":n=e.arcs.map(l);break;default:return null}return{type:i,coordinates:n}}(e)}function Fo(t,e){var n={},i={},r={},s=[],o=-1;function a(t,e){for(var i in t){var r=t[i];delete e[r.start],delete r.start,delete r.end,r.forEach((function(t){n[t<0?~t:t]=1})),s.push(r)}}return e.forEach((function(n,i){var r,s=t.arcs[n<0?~n:n];s.length<3&&!s[1][0]&&!s[1][1]&&(r=e[++o],e[o]=n,e[i]=r)})),e.forEach((function(e){var n,s,o=function(e){var n,i=t.arcs[e<0?~e:e],r=i[0];t.transform?(n=[0,0],i.forEach((function(t){n[0]+=t[0],n[1]+=t[1]}))):n=i[i.length-1];return e<0?[n,r]:[r,n]}(e),a=o[0],l=o[1];if(n=r[a])if(delete r[n.end],n.push(e),n.end=l,s=i[l]){delete i[s.start];var h=s===n?n:n.concat(s);i[h.start=n.start]=r[h.end=s.end]=h}else i[n.start]=r[n.end]=n;else if(n=i[l])if(delete i[n.start],n.unshift(e),n.start=a,s=r[a]){delete r[s.end];var c=s===n?n:s.concat(n);i[c.start=s.start]=r[c.end=n.end]=c}else i[n.start]=r[n.end]=n;else i[(n=[e]).start=a]=r[n.end=l]=n})),a(r,i),a(i,r),e.forEach((function(t){n[t<0?~t:t]||s.push([t])})),s}function Go(t,e,n){var i,r,s;if(arguments.length>1)i=qo(t,e,n);else for(r=0,i=new Array(s=t.arcs.length);r<s;++r)i[r]=r;return{type:"MultiLineString",arcs:Fo(t,i)}}function qo(t,e,n){var i,r=[],s=[];function o(t){var e=t<0?~t:t;(s[e]||(s[e]=[])).push({i:t,g:i})}function a(t){t.forEach(o)}function l(t){t.forEach(a)}return function t(e){switch(i=e,e.type){case"GeometryCollection":e.geometries.forEach(t);break;case"LineString":a(e.arcs);break;case"MultiLineString":case"Polygon":l(e.arcs);break;case"MultiPolygon":!function(t){t.forEach(l)}(e.arcs)}}(e),s.forEach(null==n?function(t){r.push(t[0].i)}:function(t){n(t[0].g,t[t.length-1].g)&&r.push(t[0].i)}),r}function jo(t,e){for(var n=0,i=t.length;n<i;){var r=n+i>>>1;t[r]<e?n=r+1:i=r}return n}const Bo=Object.assign({},{feature:function(t,e){return"string"==typeof e&&(e=t.objects[e]),"GeometryCollection"===e.type?{type:"FeatureCollection",features:e.geometries.map((function(e){return Do(t,e)}))}:Do(t,e)}});function Uo(t){return"Topology"==t.type?Bo.feature(t,Object.keys(t.objects)[0]):JSON.parse(JSON.stringify(t))}const Yo=Object.assign({},{geoPath:vr});function Wo(t){return"FeatureCollection"!=(t=JSON.parse(JSON.stringify(t))).type||Array.isArray(t)?Array.isArray(t)&&null!=t[0].type&&null!=t[0].properties&&null!=t[0].geometry?{type:"FeatureCollection",features:t}:Array.isArray(t)&&null!=t[0].type&&null!=t[0].coordinates?{type:"FeatureCollection",features:t.map((t=>({type:"Feature",properties:{},geometry:t})))}:t:t}const $o=Object.assign({},{geoEquirectangularRaw:Vr,geoBounds:hn});function Xo(t){let e;e=Array.isArray(t)?t:$o.geoBounds(Wo(t));let n=e[0][0],i=e[0][1],r=e[1][0],s=e[1][1];const o={type:"FeatureCollection",features:[{type:"Feature",properties:{id:1},geometry:{type:"Polygon",coordinates:-90===i?[[[n,s],[r,s]]]:[[[n,i],[n,s],[r+=360*(r<n),s],[r,i],[n,i]]]}}]};return Vo($o.geoEquirectangularRaw,.02)(o)}const Vo=(t,e)=>{const n=Math.PI/180,i=Math.tan(n*e/2)**2,r=function(e,n,s,o,a,l,h){if(l--){var c=Zo(e,s),u=t.invert(...c),f=Qo(u),d=Ko(f,n),p=Ko(f,o);Ho(f,n,o)*(1+.25*a)*(1+.25*a)/(i*a)+(d-p)/a*2*((d-p)/a)>1&d+p>i|d+p>.25&&(r(e,n,c,f,d,l,h),h.push(u),r(c,f,s,o,p,l,h))}},s=e=>{let n=[],i=e[0],s=t.invert(...i),o=Qo(s);n.push(s);for(var a=1,l=e.length;a<l;a++){let s=e[a],l=t.invert(...s),h=Qo(l);r(i,o,s,h,Ko(o,h),16,n),n.push(l),i=s,o=h}return n};let o,a=e=>t.invert(...e),l=t=>e=>e.forEach(((n,i)=>e[i]=t(n))),h={Point:t=>t.coordinates=a(t.coordinates),MultiPoint:t=>l(a)(t.coordinates),LineString:t=>t.coordinates=s(t.coordinates),Polygon:t=>l(s)(t.coordinates),MultiLineString:t=>l(s)(t.coordinates),MultiPolygon:t=>t.coordinates.forEach(l(s)),Feature:t=>o(t.geometry),GeometryCollection:t=>t.geometries.forEach(o),FeatureCollection:t=>t.features.forEach(o)};return o=t=>(h[t.type](t),t),function(t){return t=JSON.parse(JSON.stringify(t)),o(t)}},Ho=([t,e,n],[i,r,s],[o,a,l])=>{var h=t*((r-e)*(l-n)-(a-e)*(s-n))+e*((s-n)*(o-t)-(l-n)*(i-t))+n*((i-t)*(a-e)-(o-t)*(r-e)),c=(t+o)*(t+i)+(e+a)*(e+r)+(n+l)*(n+s);return(h*h+!(c*c))/(c*c)},Zo=([t,e],[n,i])=>[.5*(t+n),.5*(e+i)],Jo=Math.PI/180,Qo=([t,e])=>[Math.cos(Jo*e)*Math.cos(Jo*t),Math.cos(Jo*e)*Math.sin(Jo*t),Math.sin(Jo*e)],Ko=([t,e,n],[i,r,s])=>{var o=t*(r-e)-(i-t)*e,a=e*(s-n)-(r-e)*n,l=n*(i-t)-(s-n)*t,h=t*(i+t)+e*(r+e)+n*(s+n);return(o*o+a*a+l*l+!(h*h))/(h*h)};var ta=Math.abs,ea=Math.atan,na=Math.atan2,ia=Math.cos,ra=Math.exp,sa=Math.floor,oa=Math.log,aa=Math.max,la=Math.min,ha=Math.pow,ca=Math.round,ua=Math.sign||function(t){return t>0?1:t<0?-1:0},fa=Math.sin,da=Math.tan,pa=1e-6,ga=1e-12,_a=Math.PI,ya=_a/2,ma=_a/4,xa=Math.SQRT1_2,va=Ia(2),ba=Ia(_a),Ma=2*_a,wa=180/_a,Ea=_a/180;function Na(t){return t>1?ya:t<-1?-ya:Math.asin(t)}function Sa(t){return t>1?0:t<-1?_a:Math.acos(t)}function Ia(t){return t>0?Math.sqrt(t):0}function ka(t){return(ra(t)-ra(-t))/2}function Oa(t){return(ra(t)+ra(-t))/2}function Ca(t){var e=da(t/2),n=2*oa(ia(t/2))/(e*e);function i(t,e){var i=ia(t),r=ia(e),s=fa(e),o=r*i,a=-((1-o?oa((1+o)/2)/(1-o):-.5)+n/(1+o));return[a*r*fa(t),a*s]}return i.invert=function(e,i){var r,s=Ia(e*e+i*i),o=-t/2,a=50;if(!s)return[0,0];do{var l=o/2,h=ia(l),c=fa(l),u=c/h,f=-oa(ta(h));o-=r=(2/u*f-n*u-s)/(-f/(c*c)+1-n/(2*h*h))*(h<0?.7:1)}while(ta(r)>pa&&--a>0);var d=fa(o);return[na(e*d,s*ia(o)),Na(i*d/s)]},i}function Ta(t,e){var n=ia(e),i=function(t){return t?t/Math.sin(t):1}(Sa(n*ia(t/=2)));return[2*n*fa(t)*i,fa(e)*i]}function Ra(t){var e=fa(t),n=ia(t),i=t>=0?1:-1,r=da(i*t),s=(1+e-n)/2;function o(t,o){var a=ia(o),l=ia(t/=2);return[(1+a)*fa(t),(i*o>-na(l,r)-.001?0:10*-i)+s+fa(o)*n-(1+a)*e*l]}return o.invert=function(t,o){var a=0,l=0,h=50;do{var c=ia(a),u=fa(a),f=ia(l),d=fa(l),p=1+f,g=p*u-t,_=s+d*n-p*e*c-o,y=p*c/2,m=-u*d,x=e*p*u/2,v=n*f+e*c*d,b=m*x-v*y,M=(_*m-g*v)/b/2,w=(g*x-_*y)/b;ta(w)>2&&(w/=2),a-=M,l-=w}while((ta(M)>pa||ta(w)>pa)&&--h>0);return i*l>-na(ia(a),r)-.001?[2*a,l]:null},o}function Aa(t,e){var n=da(e/2),i=Ia(1-n*n),r=1+i*ia(t/=2),s=fa(t)*i/r,o=n/r,a=s*s,l=o*o;return[4/3*s*(3+a-3*l),4/3*o*(3+3*a-l)]}Ta.invert=function(t,e){if(!(t*t+4*e*e>_a*_a+pa)){var n=t,i=e,r=25;do{var s,o=fa(n),a=fa(n/2),l=ia(n/2),h=fa(i),c=ia(i),u=fa(2*i),f=h*h,d=c*c,p=a*a,g=1-d*l*l,_=g?Sa(c*l)*Ia(s=1/g):s=0,y=2*_*c*a-t,m=_*h-e,x=s*(d*p+_*c*l*f),v=s*(.5*o*u-2*_*h*a),b=.25*s*(u*a-_*h*d*o),M=s*(f*l+_*p*c),w=v*b-M*x;if(!w)break;var E=(m*v-y*M)/w,N=(y*b-m*x)/w;n-=E,i-=N}while((ta(E)>pa||ta(N)>pa)&&--r>0);return[n,i]}},Aa.invert=function(t,e){if(e*=3/8,!(t*=3/8)&&ta(e)>1)return null;var n=1+t*t+e*e,i=Ia((n-Ia(n*n-4*e*e))/2),r=Na(i)/3,s=i?function(t){return oa(t+Ia(t*t-1))}(ta(e/i))/3:function(t){return oa(t+Ia(t*t+1))}(ta(t))/3,o=ia(r),a=Oa(s),l=a*a-o*o;return[2*ua(t)*na(ka(s)*o,.25-l),2*ua(e)*na(a*fa(r),.25+l)]};var La=Ia(8),Pa=oa(1+va);function Da(t,e){var n=ta(e);return n<ma?[t,oa(da(ma+e/2))]:[t*ia(n)*(2*va-1/fa(n)),ua(e)*(2*va*(n-ma)-oa(da(n/2)))]}function za(t){var e=2*_a/t;function n(t,n){var i=jr(t,n);if(ta(t)>ya){var r=na(i[1],i[0]),s=Ia(i[0]*i[0]+i[1]*i[1]),o=e*ca((r-ya)/e)+ya,a=na(fa(r-=o),2-ia(r));r=o+Na(_a/s*fa(a))-a,i[0]=s*ia(r),i[1]=s*fa(r)}return i}return n.invert=function(t,n){var i=Ia(t*t+n*n);if(i>ya){var r=na(n,t),s=e*ca((r-ya)/e)+ya,o=r>s?-1:1,a=i*ia(s-r),l=1/da(o*Sa((a-_a)/Ia(_a*(_a-2*a)+i*i)));r=s+2*ea((l+o*Ia(l*l-3))/3),t=i*ia(r),n=i*fa(r)}return jr.invert(t,n)},n}function Fa(t,e){if(arguments.length<2&&(e=t),1===e)return qr;if(e===1/0)return Ga;function n(n,i){var r=qr(n/e,i);return r[0]*=t,r}return n.invert=function(n,i){var r=qr.invert(n/t,i);return r[0]*=e,r},n}function Ga(t,e){return[t*ia(e)/ia(e/=2),2*fa(e)]}function qa(t,e,n){var i,r,s,o=100;n=void 0===n?0:+n,e=+e;do{(r=t(n))===(s=t(n+pa))&&(s=r+pa),n-=i=-1e-6*(r-e)/(r-s)}while(o-- >0&&ta(i)>pa);return o<0?NaN:n}function ja(t,e,n){return void 0===e&&(e=40),void 0===n&&(n=ga),function(i,r,s,o){var a,l,h;s=void 0===s?0:+s,o=void 0===o?0:+o;for(var c=0;c<e;c++){var u=t(s,o),f=u[0]-i,d=u[1]-r;if(ta(f)<n&&ta(d)<n)break;var p=f*f+d*d;if(p>a)s-=l/=2,o-=h/=2;else{a=p;var g=(s>0?-1:1)*n,_=(o>0?-1:1)*n,y=t(s+g,o),m=t(s,o+_),x=(y[0]-u[0])/g,v=(y[1]-u[1])/g,b=(m[0]-u[0])/_,M=(m[1]-u[1])/_,w=M*x-v*b,E=(ta(w)<.5?.5:1)/w;if(s+=l=(d*b-f*M)*E,o+=h=(f*v-d*x)*E,ta(l)<n&&ta(h)<n)break}}return[s,o]}}function Ba(){var t=Fa(1.68,2);function e(e,n){if(e+n<-1.4){var i=(e-n+1.6)*(e+n+1.4)/8;e+=i,n-=.8*i*fa(n+_a/2)}var r=t(e,n),s=(1-ia(e*n))/12;return r[1]<0&&(r[0]*=1+s),r[1]>0&&(r[1]*=1+s/1.5*r[0]*r[0]),r}return e.invert=ja(e),e}function Ua(t,e){var n,i=t*fa(e),r=30;do{e-=n=(e+fa(e)-i)/(1+ia(e))}while(ta(n)>pa&&--r>0);return e/2}function Ya(t,e,n){function i(i,r){return[t*i*ia(r=Ua(n,r)),e*fa(r)]}return i.invert=function(i,r){return r=Na(r/e),[i/(t*ia(r)),Na((2*r+fa(2*r))/n)]},i}Da.invert=function(t,e){if((i=ta(e))<Pa)return[t,2*ea(ra(e))-ya];var n,i,r=ma,s=25;do{var o=ia(r/2),a=da(r/2);r-=n=(La*(r-ma)-oa(a)-i)/(La-o*o/(2*a))}while(ta(n)>ga&&--s>0);return[t/(ia(r)*(La-1/fa(r))),ua(e)*r]},Ga.invert=function(t,e){var n=2*Na(e/2);return[t*ia(n/2)/ia(n),n]};var Wa=Ya(va/ya,va,_a);var $a=2.00276,Xa=1.11072;function Va(t,e){var n=Ua(_a,e);return[$a*t/(1/ia(e)+Xa/ia(n)),(e+va*fa(n))/$a]}function Ha(t){var e=0,n=Ar(t),i=n(e);return i.parallel=function(t){return arguments.length?n(e=t*Ea):e*wa},i}function Za(t,e){return[t*ia(e),e]}function Ja(t){if(!t)return Za;var e=1/da(t);function n(n,i){var r=e+t-i,s=r?n*ia(i)/r:r;return[r*fa(s),e-r*ia(s)]}return n.invert=function(n,i){var r=Ia(n*n+(i=e-i)*i),s=e+t-r;return[r/ia(s)*na(n,i),s]},n}function Qa(t){function e(e,n){var i=ya-n,r=i?e*t*fa(i)/i:i;return[i*fa(r)/t,ya-i*ia(r)]}return e.invert=function(e,n){var i=e*t,r=ya-n,s=Ia(i*i+r*r),o=na(i,r);return[(s?s/fa(s):1)*o/t,ya-s]},e}Va.invert=function(t,e){var n,i,r=$a*e,s=e<0?-ma:ma,o=25;do{i=r-va*fa(s),s-=n=(fa(2*s)+2*s-_a*fa(i))/(2*ia(2*s)+2+_a*ia(i)*va*ia(s))}while(ta(n)>pa&&--o>0);return i=r-va*fa(s),[t*(1/ia(i)+Xa/ia(s))/$a,i]},Za.invert=function(t,e){return[t/ia(e),e]};var Ka=Ya(1,4/_a,_a);function tl(t,e,n,i,r,s){var o,a=ia(s);if(ta(t)>1||ta(s)>1)o=Sa(n*r+e*i*a);else{var l=fa(t/2),h=fa(s/2);o=2*Na(Ia(l*l+e*i*h*h))}return ta(o)>pa?[o,na(i*fa(s),e*r-n*i*a)]:[0,0]}function el(t,e,n){return Sa((t*t+e*e-n*n)/(2*t*e))}function nl(t){return t-2*_a*sa((t+_a)/(2*_a))}function il(t,e,n){for(var i,r=[[t[0],t[1],fa(t[1]),ia(t[1])],[e[0],e[1],fa(e[1]),ia(e[1])],[n[0],n[1],fa(n[1]),ia(n[1])]],s=r[2],o=0;o<3;++o,s=i)i=r[o],s.v=tl(i[1]-s[1],s[3],s[2],i[3],i[2],i[0]-s[0]),s.point=[0,0];var a=el(r[0].v[0],r[2].v[0],r[1].v[0]),l=el(r[0].v[0],r[1].v[0],r[2].v[0]),h=_a-a;r[2].point[1]=0,r[0].point[0]=-(r[1].point[0]=r[0].v[0]/2);var c=[r[2].point[0]=r[0].point[0]+r[2].v[0]*ia(a),2*(r[0].point[1]=r[1].point[1]=r[2].v[0]*fa(a))];return function(t,e){var n,i=fa(e),s=ia(e),o=new Array(3);for(n=0;n<3;++n){var a=r[n];if(o[n]=tl(e-a[1],a[3],a[2],s,i,t-a[0]),!o[n][0])return a.point;o[n][1]=nl(o[n][1]-a.v[1])}var u=c.slice();for(n=0;n<3;++n){var f=2==n?0:n+1,d=el(r[n].v[0],o[n][0],o[f][0]);o[n][1]<0&&(d=-d),n?1==n?(d=l-d,u[0]-=o[n][0]*ia(d),u[1]-=o[n][0]*fa(d)):(d=h-d,u[0]+=o[n][0]*ia(d),u[1]+=o[n][0]*fa(d)):(u[0]+=o[n][0]*ia(d),u[1]-=o[n][0]*fa(d))}return u[0]/=3,u[1]/=3,u}}function rl(t){return t[0]*=Ea,t[1]*=Ea,t}function sl(t,e,n){var i=bn({type:"MultiPoint",coordinates:[t,e,n]}),r=[-i[0],-i[1]],s=On(r),o=il(rl(s(t)),rl(s(e)),rl(s(n)));o.invert=ja(o);var a=Rr(o).rotate(r),l=a.center;return delete a.rotate,a.center=function(t){return arguments.length?l(s(t)):s.invert(l())},a.clipAngle(90)}function ol(t,e){var n=Ia(1-fa(e));return[2/ba*t*n,ba*(1-n)]}function al(t){var e=da(t);function n(t,n){return[t,(t?t/fa(t):1)*(fa(n)*ia(t)-e*ia(n))]}return n.invert=e?function(t,n){t&&(n*=fa(t)/t);var i=ia(t);return[t,2*na(Ia(i*i+e*e-n*n)-i,e-n)]}:function(t,e){return[t,Na(t?e*da(t)/t:e)]},n}ol.invert=function(t,e){var n=(n=e/ba-1)*n;return[n>0?t*Ia(_a/n)/2:0,Na(1-n)]};var ll=Ia(3);function hl(t,e){return[ll*t*(2*ia(2*e/3)-1)/ba,ll*ba*fa(e/3)]}function cl(t){var e=ia(t);function n(t,n){return[t*e,fa(n)/e]}return n.invert=function(t,n){return[t/e,Na(n*e)]},n}function ul(t){var e=ia(t);function n(t,n){return[t*e,(1+e)*da(n/2)]}return n.invert=function(t,n){return[t/e,2*ea(n/(1+e))]},n}function fl(t,e){var n=Ia(8/(3*_a));return[n*t*(1-ta(e)/_a),n*e]}function dl(t,e){var n=Ia(4-3*fa(ta(e)));return[2/Ia(6*_a)*t*n,ua(e)*Ia(2*_a/3)*(2-n)]}function pl(t,e){var n=Ia(_a*(4+_a));return[2/n*t*(1+Ia(1-4*e*e/(_a*_a))),4/n*e]}function gl(t,e){var n=(2+ya)*fa(e);e/=2;for(var i=0,r=1/0;i<10&&ta(r)>pa;i++){var s=ia(e);e-=r=(e+fa(e)*(s+2)-n)/(2*s*(1+s))}return[2/Ia(_a*(4+_a))*t*(1+ia(e)),2*Ia(_a/(4+_a))*fa(e)]}function _l(t,e){return[t*(1+ia(e))/Ia(2+_a),2*e/Ia(2+_a)]}function yl(t,e){for(var n=(1+ya)*fa(e),i=0,r=1/0;i<10&&ta(r)>pa;i++)e-=r=(e+fa(e)-n)/(1+ia(e));return n=Ia(2+_a),[t*(1+ia(e))/n,2*e/n]}hl.invert=function(t,e){var n=3*Na(e/(ll*ba));return[ba*t/(ll*(2*ia(2*n/3)-1)),n]},fl.invert=function(t,e){var n=Ia(8/(3*_a)),i=e/n;return[t/(n*(1-ta(i)/_a)),i]},dl.invert=function(t,e){var n=2-ta(e)/Ia(2*_a/3);return[t*Ia(6*_a)/(2*n),ua(e)*Na((4-n*n)/3)]},pl.invert=function(t,e){var n=Ia(_a*(4+_a))/2;return[t*n/(1+Ia(1-e*e*(4+_a)/(4*_a))),e*n/2]},gl.invert=function(t,e){var n=e*Ia((4+_a)/_a)/2,i=Na(n),r=ia(i);return[t/(2/Ia(_a*(4+_a))*(1+r)),Na((i+n*(r+2))/(2+ya))]},_l.invert=function(t,e){var n=Ia(2+_a),i=e*n/2;return[n*t/(1+ia(i)),i]},yl.invert=function(t,e){var n=1+ya,i=Ia(n/2);return[2*t*i/(1+ia(e*=i)),Na((e+fa(e))/n)]};var ml=3+2*va;function xl(t,e){var n=fa(t/=2),i=ia(t),r=Ia(ia(e)),s=ia(e/=2),o=fa(e)/(s+va*i*r),a=Ia(2/(1+o*o)),l=Ia((va*s+(i+n)*r)/(va*s+(i-n)*r));return[ml*(a*(l-1/l)-2*oa(l)),ml*(a*o*(l+1/l)-2*ea(o))]}xl.invert=function(t,e){if(!(n=Aa.invert(t/1.2,1.065*e)))return null;var n,i=n[0],r=n[1],s=20;t/=ml,e/=ml;do{var o=i/2,a=r/2,l=fa(o),h=ia(o),c=fa(a),u=ia(a),f=ia(r),d=Ia(f),p=c/(u+va*h*d),g=p*p,_=Ia(2/(1+g)),y=(va*u+(h+l)*d)/(va*u+(h-l)*d),m=Ia(y),x=m-1/m,v=m+1/m,b=_*x-2*oa(m)-t,M=_*p*v-2*ea(p)-e,w=c&&xa*d*l*g/c,E=(va*h*u+d)/(2*(u+va*h*d)*(u+va*h*d)*d),N=-.5*p*_*_*_,S=N*w,I=N*E,k=(k=2*u+va*d*(h-l))*k*m,O=(va*h*u*d+f)/k,C=-va*l*c/(d*k),T=x*S-2*O/m+_*(O+O/y),R=x*I-2*C/m+_*(C+C/y),A=p*v*S-2*w/(1+g)+_*v*w+_*p*(O-O/y),L=p*v*I-2*E/(1+g)+_*v*E+_*p*(C-C/y),P=R*A-L*T;if(!P)break;var D=(M*R-b*L)/P,z=(b*A-M*T)/P;i-=D,r=aa(-ya,la(ya,r-z))}while((ta(D)>pa||ta(z)>pa)&&--s>0);return ta(ta(r)-ya)<pa?[0,r]:s&&[i,r]};var vl=ia(35*Ea);function bl(t,e){var n=da(e/2);return[t*vl*Ia(1-n*n),(1+vl)*n]}function Ml(t,e){var n=e/2,i=ia(n);return[2*t/ba*ia(e)*i*i,ba*da(n)]}function wl(t){var e=1-t,n=r(_a,0)[0]-r(-_a,0)[0],i=Ia(2*(r(0,ya)[1]-r(0,-ya)[1])/n);function r(n,i){var r=ia(i),s=fa(i);return[r/(e+t*r)*n,e*i+t*s]}function s(t,e){var n=r(t,e);return[n[0]*i,n[1]/i]}function o(t){return s(0,t)[1]}return s.invert=function(n,r){var s=qa(o,r);return[n/i*(t+e/ia(s)),s]},s}function El(t){return[t[0]/2,Na(da(t[1]/2*Ea))*wa]}function Nl(t){return[2*t[0],2*ea(fa(t[1]*Ea))*wa]}function Sl(t,e){var n=2*_a/e,i=t*t;function r(e,r){var s=jr(e,r),o=s[0],a=s[1],l=o*o+a*a;if(l>i){var h=Ia(l),c=na(a,o),u=n*ca(c/n),f=c-u,d=t*ia(f),p=(t*fa(f)-f*fa(d))/(ya-d),g=Il(f,p),_=(_a-t)/kl(g,d,_a);o=h;var y,m=50;do{o-=y=(t+kl(g,d,o)*_-h)/(g(o)*_)}while(ta(y)>pa&&--m>0);a=f*fa(o),o<ya&&(a-=p*(o-ya));var x=fa(u),v=ia(u);s[0]=o*v-a*x,s[1]=o*x+a*v}return s}return r.invert=function(e,r){var s=e*e+r*r;if(s>i){var o=Ia(s),a=na(r,e),l=n*ca(a/n),h=a-l;e=o*ia(h),r=o*fa(h);for(var c=e-ya,u=fa(e),f=r/u,d=e<ya?1/0:0,p=10;;){var g=t*fa(f),_=t*ia(f),y=fa(_),m=ya-_,x=(g-f*y)/m,v=Il(f,x);if(ta(d)<ga||!--p)break;f-=d=(f*u-x*c-r)/(u-2*c*(m*(_+f*g*ia(_)-y)-g*(g-f*y))/(m*m))}e=(o=t+kl(v,_,e)*(_a-t)/kl(v,_,_a))*ia(a=l+f),r=o*fa(a)}return jr.invert(e,r)},r}function Il(t,e){return function(n){var i=t*ia(n);return n<ya&&(i-=e),Ia(1+i*i)}}function kl(t,e,n){for(var i=(n-e)/50,r=t(e)+t(n),s=1,o=e;s<50;++s)r+=2*t(o+=i);return.5*r*i}function Ol(t,e,n,i,r,s,o,a){function l(l,h){if(!h)return[t*l/_a,0];var c=h*h,u=t+c*(e+c*(n+c*i)),f=h*(r-1+c*(s-a+c*o)),d=(u*u+f*f)/(2*f),p=l*Na(u/d)/_a;return[d*fa(p),h*(1+c*a)+d*(1-ia(p))]}return arguments.length<8&&(a=0),l.invert=function(l,h){var c,u,f=_a*l/t,d=h,p=50;do{var g=d*d,_=t+g*(e+g*(n+g*i)),y=d*(r-1+g*(s-a+g*o)),m=_*_+y*y,x=2*y,v=m/x,b=v*v,M=Na(_/v)/_a,w=f*M,E=_*_,N=(2*e+g*(4*n+6*g*i))*d,S=r+g*(3*s+5*g*o),I=(2*(_*N+y*(S-1))*x-m*(2*(S-1)))/(x*x),k=ia(w),O=fa(w),C=v*k,T=v*O,R=f/_a*(1/Ia(1-E/b))*(N*v-_*I)/b,A=T-l,L=d*(1+g*a)+v-C-h,P=I*O+C*R,D=C*M,z=1+I-(I*k-T*R),F=T*M,G=P*F-z*D;if(!G)break;f-=c=(L*P-A*z)/G,d-=u=(A*F-L*D)/G}while((ta(c)>pa||ta(u)>pa)&&--p>0);return[f,d]},l}bl.invert=function(t,e){var n=e/(1+vl);return[t&&t/(vl*Ia(1-n*n)),2*ea(n)]},Ml.invert=function(t,e){var n=ea(e/ba),i=ia(n),r=2*n;return[t*ba/2/(ia(r)*i*i),r]};var Cl=Ol(2.8284,-1.6988,.75432,-.18071,1.76003,-.38914,.042555);var Tl=Ol(2.583819,-.835827,.170354,-.038094,1.543313,-.411435,.082742);var Rl=Ol(5/6*_a,-.62636,-.0344,0,1.3493,-.05524,0,.045);function Al(t,e){var n=t*t,i=e*e;return[t*(1-.162388*i)*(.87-952426e-9*n*n),e*(1+i/12)]}Al.invert=function(t,e){var n,i=t,r=e,s=50;do{var o=r*r;r-=n=(r*(1+o/12)-e)/(1+o/4)}while(ta(n)>pa&&--s>0);s=50,t/=1-.162388*o;do{var a=(a=i*i)*a;i-=n=(i*(.87-952426e-9*a)-t)/(.87-.00476213*a)}while(ta(n)>pa&&--s>0);return[i,r]};var Ll=Ol(2.6516,-.76534,.19123,-.047094,1.36289,-.13965,.031762);function Pl(t){var e=t(ya,0)[0]-t(-ya,0)[0];function n(n,i){var r=n>0?-.5:.5,s=t(n+r*_a,i);return s[0]-=r*e,s}return t.invert&&(n.invert=function(n,i){var r=n>0?-.5:.5,s=t.invert(n+r*e,i),o=s[0]-r*_a;return o<-_a?o+=2*_a:o>_a&&(o-=2*_a),s[0]=o,s}),n}function Dl(t,e){var n=ua(t),i=ua(e),r=ia(e),s=ia(t)*r,o=fa(t)*r,a=fa(i*e);t=ta(na(o,a)),e=Na(s),ta(t-ya)>pa&&(t%=ya);var l=function(t,e){if(e===ya)return[0,0];var n,i,r=fa(e),s=r*r,o=s*s,a=1+o,l=1+3*o,h=1-o,c=Na(1/Ia(a)),u=h+s*a*c,f=(1-r)/u,d=Ia(f),p=f*a,g=Ia(p),_=d*h;if(0===t)return[0,-(_+s*g)];var y,m=ia(e),x=1/m,v=2*r*m,b=(-u*m-(-3*s+c*l)*v*(1-r))/(u*u),M=-x*v,w=-x*(s*a*b+f*l*v),E=-2*x*(h*(.5*b/d)-2*s*d*v),N=4*t/_a;if(t>.222*_a||e<_a/4&&t>.175*_a){if(n=(_+s*Ia(p*(1+o)-_*_))/(1+o),t>_a/4)return[n,n];var S=n,I=.5*n;n=.5*(I+S),i=50;do{var k=n*(E+M*Ia(p-n*n))+w*Na(n/g)-N;if(!k)break;k<0?I=n:S=n,n=.5*(I+S)}while(ta(S-I)>pa&&--i>0)}else{n=pa,i=25;do{var O=n*n,C=Ia(p-O),T=E+M*C,R=n*T+w*Na(n/g)-N;n-=y=C?R/(T+(w-M*O)/C):0}while(ta(y)>pa&&--i>0)}return[n,-_-s*Ia(p-n*n)]}(t>_a/4?ya-t:t,e);return t>_a/4&&(a=l[0],l[0]=-l[1],l[1]=-a),l[0]*=n,l[1]*=-i,l}function zl(t,e){var n,i,r,s,o;if(e<pa)return[(s=fa(t))-(n=e*(t-s*(i=ia(t)))/4)*i,i+n*s,1-e*s*s/2,t-n];if(e>=.999999)return n=(1-e)/4,i=Oa(t),s=function(t){return((t=ra(2*t))-1)/(t+1)}(t),r=1/i,[s+n*((o=i*ka(t))-t)/(i*i),r-n*s*r*(o-t),r+n*s*r*(o+t),2*ea(ra(t))-ya+n*(o-t)/i];var a=[1,0,0,0,0,0,0,0,0],l=[Ia(e),0,0,0,0,0,0,0,0],h=0;for(i=Ia(1-e),o=1;ta(l[h]/a[h])>pa&&h<8;)n=a[h++],l[h]=(n-i)/2,a[h]=(n+i)/2,i=Ia(n*i),o*=2;r=o*a[h]*t;do{r=(Na(s=l[h]*fa(i=r)/a[h])+r)/2}while(--h);return[fa(r),s=ia(r),s/ia(r-i),r]}function Fl(t,e){if(!e)return t;if(1===e)return oa(da(t/2+ma));for(var n=1,i=Ia(1-e),r=Ia(e),s=0;ta(r)>pa;s++){if(t%_a){var o=ea(i*da(t)/n);o<0&&(o+=_a),t+=o+~~(t/_a)*_a}else t+=t;r=(n+i)/2,i=Ia(n*i),r=((n=r)-i)/2}return t/(ha(2,s)*n)}function Gl(t,e){var n=(va-1)/(va+1),i=Ia(1-n*n),r=Fl(ya,i*i),s=oa(da(_a/4+ta(e)/2)),o=ra(-1*s)/Ia(n),a=function(t,e){var n=t*t,i=e+1,r=1-n-e*e;return[.5*((t>=0?ya:-ya)-na(r,2*t)),-.25*oa(r*r+4*n)+.5*oa(i*i+n)]}(o*ia(-1*t),o*fa(-1*t)),l=function(t,e,n){var i=ta(t),r=ka(ta(e));if(i){var s=1/fa(i),o=1/(da(i)*da(i)),a=-(o+n*(r*r*s*s)-1+n),l=(-a+Ia(a*a-(n-1)*o*4))/2;return[Fl(ea(1/Ia(l)),n)*ua(t),Fl(ea(Ia((l/o-1)/n)),1-n)*ua(e)]}return[0,Fl(ea(r),1-n)*ua(e)]}(a[0],a[1],i*i);return[-l[1],(e>=0?1:-1)*(.5*r-l[0])]}function ql(t){var e=fa(t),n=ia(t),i=jl(t);function r(t,r){var s=i(t,r);t=s[0],r=s[1];var o=fa(r),a=ia(r),l=ia(t),h=Sa(e*o+n*a*l),c=fa(h),u=ta(c)>pa?h/c:1;return[u*n*fa(t),(ta(t)>ya?u:-u)*(e*a-n*o*l)]}return i.invert=jl(-t),r.invert=function(t,n){var r=Ia(t*t+n*n),s=-fa(r),o=ia(r),a=r*o,l=-n*s,h=r*e,c=Ia(a*a+l*l-h*h),u=na(a*h+l*c,l*h-a*c),f=(r>ya?-1:1)*na(t*s,r*ia(u)*o+n*fa(u)*s);return i.invert(f,u)},r}function jl(t){var e=fa(t),n=ia(t);return function(t,i){var r=ia(i),s=ia(t)*r,o=fa(t)*r,a=fa(i);return[na(o,s*n-a*e),Na(a*n+s*e)]}}Dl.invert=function(t,e){ta(t)>1&&(t=2*ua(t)-t),ta(e)>1&&(e=2*ua(e)-e);var n=ua(t),i=ua(e),r=-n*t,s=-i*e,o=s/r<1,a=function(t,e){var n=0,i=1,r=.5,s=50;for(;;){var o=r*r,a=Ia(r),l=Na(1/Ia(1+o)),h=1-o+r*(1+o)*l,c=(1-a)/h,u=Ia(c),f=c*(1+o),d=u*(1-o),p=Ia(f-t*t),g=e+d+r*p;if(ta(i-n)<ga||0==--s||0===g)break;g>0?n=r:i=r,r=.5*(n+i)}if(!s)return null;var _=Na(a),y=ia(_),m=1/y,x=2*a*y,v=(-h*y-(-3*r+l*(1+3*o))*x*(1-a))/(h*h);return[_a/4*(t*(-2*m*(.5*v/u*(1-o)-2*r*u*x)+-m*x*p)+-m*(r*(1+o)*v+c*(1+3*o)*x)*Na(t/Ia(f))),_]}(o?s:r,o?r:s),l=a[0],h=a[1],c=ia(h);return o&&(l=-ya-l),[n*(na(fa(l)*c,-fa(h))+_a),i*Na(ia(l)*c)]},Gl.invert=function(t,e){var n=(va-1)/(va+1),i=Ia(1-n*n),r=function(t,e,n){var i,r,s;return t?(i=zl(t,n),e?(s=(r=zl(e,1-n))[1]*r[1]+n*i[0]*i[0]*r[0]*r[0],[[i[0]*r[2]/s,i[1]*i[2]*r[0]*r[1]/s],[i[1]*r[1]/s,-i[0]*i[2]*r[0]*r[2]/s],[i[2]*r[1]*r[2]/s,-n*i[0]*i[1]*r[0]/s]]):[[i[0],0],[i[1],0],[i[2],0]]):[[0,(r=zl(e,1-n))[0]/r[1]],[1/r[1],0],[r[2]/r[1],0]]}(.5*Fl(ya,i*i)-e,-t,i*i),s=function(t,e){var n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}(r[0],r[1]);return[na(s[1],s[0])/-1,2*ea(ra(-.5*oa(n*s[0]*s[0]+n*s[1]*s[1])))-ya]};var Bl=Na(1-1/3)*wa,Ul=cl(0);function Yl(t){var e=Bl*Ea,n=ol(_a,e)[0]-ol(-_a,e)[0],i=Ul(0,e)[1],r=ol(0,e)[1],s=ba-r,o=Ma/t,a=4/Ma,l=i+s*s*4/Ma;function h(h,c){var u,f=ta(c);if(f>e){var d=la(t-1,aa(0,sa((h+_a)/o)));(u=ol(h+=_a*(t-1)/t-d*o,f))[0]=u[0]*Ma/n-Ma*(t-1)/(2*t)+d*Ma/t,u[1]=i+4*(u[1]-r)*s/Ma,c<0&&(u[1]=-u[1])}else u=Ul(h,c);return u[0]*=a,u[1]/=l,u}return h.invert=function(e,h){e/=a;var c=ta(h*=l);if(c>i){var u=la(t-1,aa(0,sa((e+_a)/o)));e=(e+_a*(t-1)/t-u*o)*n/Ma;var f=ol.invert(e,.25*(c-i)*Ma/s+r);return f[0]-=_a*(t-1)/t-u*o,h<0&&(f[1]=-f[1]),f}return Ul.invert(e,h)},h}function Wl(t,e){return[t,1&e?89.999999:Bl]}function $l(t,e){return[t,1&e?-89.999999:-Bl]}function Xl(t){return[.999999*t[0],t[1]]}function Vl(t){var e,n=1+t,i=Na(fa(1/n)),r=2*Ia(_a/(e=_a+4*i*n)),s=.5*r*(n+Ia(t*(2+t))),o=t*t,a=n*n;function l(l,h){var c,u,f=1-fa(h);if(f&&f<2){var d,p=ya-h,g=25;do{var _=fa(p),y=ia(p),m=i+na(_,n-y),x=1+a-2*n*y;p-=d=(p-o*i-n*_+x*m-.5*f*e)/(2*n*_*m)}while(ta(d)>ga&&--g>0);c=r*Ia(x),u=l*m/_a}else c=r*(t+f),u=l*i/_a;return[c*fa(u),s-c*ia(u)]}return l.invert=function(t,l){var h=t*t+(l-=s)*l,c=(1+a-h/(r*r))/(2*n),u=Sa(c),f=fa(u),d=i+na(f,n-c);return[Na(t/Ia(h))*_a/d,Na(1-2*(u-o*i-n*f+(1+a-2*n*c)*d)/e)]},l}var Hl=.7109889596207567,Zl=.0528035274542;function Jl(t,e){return e>-Hl?((t=Wa(t,e))[1]+=Zl,t):Za(t,e)}function Ql(t,e){return ta(e)>Hl?((t=Wa(t,e))[1]-=e>0?Zl:-Zl,t):Za(t,e)}function Kl(t,e,n,i){var r=Ia(4*_a/(2*n+(1+t-e/2)*fa(2*n)+(t+e)/2*fa(4*n)+e/2*fa(6*n))),s=Ia(i*fa(n)*Ia((1+t*ia(2*n)+e*ia(4*n))/(1+t+e))),o=n*l(1);function a(n){return Ia(1+t*ia(2*n)+e*ia(4*n))}function l(i){var r=i*n;return(2*r+(1+t-e/2)*fa(2*r)+(t+e)/2*fa(4*r)+e/2*fa(6*r))/n}function h(t){return a(t)*fa(t)}var c=function(t,e){var i=n*qa(l,o*fa(e)/n,e/_a);isNaN(i)&&(i=n*ua(e));var h=r*a(i);return[h*s*t/_a*ia(i),h/s*fa(i)]};return c.invert=function(t,e){var i=qa(h,e*s/r);return[t*_a/(ia(i)*r*s*a(i)),Na(n*l(i/n)/o)]},0===n&&(r=Ia(i/_a),(c=function(t,e){return[t*r,fa(e)/r]}).invert=function(t,e){return[t/r,Na(e*r)]}),c}function th(){var t=1,e=0,n=45*Ea,i=2,r=Ar(Kl),s=r(t,e,n,i);return s.a=function(s){return arguments.length?r(t=+s,e,n,i):t},s.b=function(s){return arguments.length?r(t,e=+s,n,i):e},s.psiMax=function(s){return arguments.length?r(t,e,n=+s*Ea,i):n*wa},s.ratio=function(s){return arguments.length?r(t,e,n,i=+s):i},s.scale(180.739)}function eh(t,e,n,i,r,s,o,a,l,h,c){if(c.nanEncountered)return NaN;var u,f,d,p,g,_,y,m,x,v;if(f=t(e+.25*(u=n-e)),d=t(n-.25*u),isNaN(f))c.nanEncountered=!0;else{if(!isNaN(d))return v=((_=(p=u*(i+4*f+r)/12)+(g=u*(r+4*d+s)/12))-o)/15,h>l?(c.maxDepthCount++,_+v):Math.abs(v)<a?_+v:(m=eh(t,e,y=e+.5*u,i,f,r,p,.5*a,l,h+1,c),isNaN(m)?(c.nanEncountered=!0,NaN):(x=eh(t,y,n,r,d,s,g,.5*a,l,h+1,c),isNaN(x)?(c.nanEncountered=!0,NaN):m+x));c.nanEncountered=!0}}function nh(t,e,n,i,r){void 0===i&&(i=1e-8),void 0===r&&(r=20);var s=t(e),o=t(.5*(e+n)),a=t(n);return eh(t,e,n,s,o,a,(s+4*o+a)*(n-e)/6,i,r,1,{maxDepthCount:0,nanEncountered:!1})}function ih(t,e,n){function i(n){return t+(1-t)*ha(1-ha(n,e),1/e)}function r(t){return nh(i,0,t,1e-4)}for(var s=1/r(1),o=1e3,a=(1+1e-8)*s,l=[],h=0;h<=o;h++)l.push(r(h/o)*a);function c(t){var e=0,n=o,i=500;do{l[i]>t?n=i:e=i,i=e+n>>1}while(i>e);var r=l[i+1]-l[i];return r&&(r=(t-l[i+1])/r),(i+1+r)/o}var u=2*c(1)/_a*s/n,f=function(t,e){var n=c(ta(fa(e))),r=i(n)*t;return n/=u,[r,e>=0?n:-n]};return f.invert=function(t,e){var n;return ta(e*=u)<1&&(n=ua(e)*Na(r(ta(e))*s)),[t/i(ta(e)),n]},f}function rh(t,e){return ta(t[0]-e[0])<pa&&ta(t[1]-e[1])<pa}function sh(t,e){for(var n,i,r,s=-1,o=t.length,a=t[0],l=[];++s<o;){i=((n=t[s])[0]-a[0])/e,r=(n[1]-a[1])/e;for(var h=0;h<e;++h)l.push([a[0]+h*i,a[1]+h*r]);a=n}return l.push(n),l}function oh(t){var e,n,i,r,s,o,a,l=[],h=t[0].length;for(a=0;a<h;++a)n=(e=t[0][a])[0][0],i=e[0][1],r=e[1][1],s=e[2][0],o=e[2][1],l.push(sh([[n+pa,i+pa],[n+pa,r-pa],[s-pa,r-pa],[s-pa,o+pa]],30));for(a=t[1].length-1;a>=0;--a)n=(e=t[1][a])[0][0],i=e[0][1],r=e[1][1],s=e[2][0],o=e[2][1],l.push(sh([[s-pa,o-pa],[s-pa,r+pa],[n+pa,r+pa],[n+pa,i-pa]],30));return{type:"Polygon",coordinates:[dt(l)]}}function ah(t,e,n){var i,r;function s(n,i){for(var r=i<0?-1:1,s=e[+(i<0)],o=0,a=s.length-1;o<a&&n>s[o][2][0];++o);var l=t(n-s[o][1][0],i);return l[0]+=t(s[o][1][0],r*i>r*s[o][0][1]?s[o][0][1]:i)[0],l}n?s.invert=n(s):t.invert&&(s.invert=function(n,i){for(var o=r[+(i<0)],a=e[+(i<0)],l=0,h=o.length;l<h;++l){var c=o[l];if(c[0][0]<=n&&n<c[1][0]&&c[0][1]<=i&&i<c[1][1]){var u=t.invert(n-t(a[l][1][0],0)[0],i);return u[0]+=a[l][1][0],rh(s(u[0],u[1]),[n,i])?u:null}}});var o=Rr(s),a=o.stream;return o.stream=function(t){var e=o.rotate(),n=a(t),r=(o.rotate([0,0]),a(t));return o.rotate(e),n.sphere=function(){ie(i,r)},n},o.lobes=function(n){return arguments.length?(i=oh(n),e=n.map((function(t){return t.map((function(t){return[[t[0][0]*Ea,t[0][1]*Ea],[t[1][0]*Ea,t[1][1]*Ea],[t[2][0]*Ea,t[2][1]*Ea]]}))})),r=e.map((function(e){return e.map((function(e){var n,i=t(e[0][0],e[0][1])[0],r=t(e[2][0],e[2][1])[0],s=t(e[1][0],e[0][1])[1],o=t(e[1][0],e[1][1])[1];return s>o&&(n=s,s=o,o=n),[[i,s],[r,o]]}))})),o):e.map((function(t){return t.map((function(t){return[[t[0][0]*wa,t[0][1]*wa],[t[1][0]*wa,t[1][1]*wa],[t[2][0]*wa,t[2][1]*wa]]}))}))},null!=e&&o.lobes(e),o}Jl.invert=function(t,e){return e>-Hl?Wa.invert(t,e-Zl):Za.invert(t,e)},Ql.invert=function(t,e){return ta(e)>Hl?Wa.invert(t,e+(e>0?Zl:-Zl)):Za.invert(t,e)};var lh=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]];var hh=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]];var ch=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]];var uh=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];var fh=[[[[-180,35],[-30,90],[0,35]],[[0,35],[30,90],[180,35]]],[[[-180,-10],[-102,-90],[-65,-10]],[[-65,-10],[5,-90],[77,-10]],[[77,-10],[103,-90],[180,-10]]]];var dh=[[[[-180,0],[-110,90],[-40,0]],[[-40,0],[0,90],[40,0]],[[40,0],[110,90],[180,0]]],[[[-180,0],[-110,-90],[-40,0]],[[-40,0],[0,-90],[40,0]],[[40,0],[110,-90],[180,0]]]];function ph(t,e){return[3/Ma*t*Ia(_a*_a/3-e*e),e]}function gh(t){function e(e,n){if(ta(ta(n)-ya)<pa)return[0,n<0?-2:2];var i=fa(n),r=ha((1+i)/(1-i),t/2),s=.5*(r+1/r)+ia(e*=t);return[2*fa(e)/s,(r-1/r)/s]}return e.invert=function(e,n){var i=ta(n);if(ta(i-2)<pa)return e?null:[0,ua(n)*ya];if(i>2)return null;var r=(e/=2)*e,s=(n/=2)*n,o=2*n/(1+r+s);return o=ha((1+o)/(1-o),1/t),[na(2*e,1-r-s)/t,Na((o-1)/(o+1))]},e}ph.invert=function(t,e){return[Ma/3*t/Ia(_a*_a/3-e*e),e]};var _h=_a/va;function yh(t,e){return[t*(1+Ia(ia(e)))/2,e/(ia(e/2)*ia(t/6))]}function mh(t,e){var n=t*t,i=e*e;return[t*(.975534+i*(-.0143059*n-.119161+-.0547009*i)),e*(1.00384+n*(.0802894+-.02855*i+199025e-9*n)+i*(.0998909+-.0491032*i))]}function xh(t,e){return[fa(t)/ia(e),da(e)*ia(t)]}function vh(t){var e=ia(t),n=da(ma+t/2);function i(i,r){var s=r-t,o=ta(s)<pa?i*e:ta(o=ma+r/2)<pa||ta(ta(o)-ya)<pa?0:i*s/oa(da(o)/n);return[o,s]}return i.invert=function(i,r){var s,o=r+t;return[ta(r)<pa?i/e:ta(s=ma+o/2)<pa||ta(ta(s)-ya)<pa?0:i*oa(da(s)/n)/r,o]},i}function bh(t,e){return[t,1.25*oa(da(ma+.4*e))]}function Mh(t){var e=t.length-1;function n(n,i){for(var r,s=ia(i),o=2/(1+s*ia(n)),a=o*s*fa(n),l=o*fa(i),h=e,c=t[h],u=c[0],f=c[1];--h>=0;)u=(c=t[h])[0]+a*(r=u)-l*f,f=c[1]+a*f+l*r;return[u=a*(r=u)-l*f,f=a*f+l*r]}return n.invert=function(n,i){var r=20,s=n,o=i;do{for(var a,l=e,h=t[l],c=h[0],u=h[1],f=0,d=0;--l>=0;)f=c+s*(a=f)-o*d,d=u+s*d+o*a,c=(h=t[l])[0]+s*(a=c)-o*u,u=h[1]+s*u+o*a;var p,g,_=(f=c+s*(a=f)-o*d)*f+(d=u+s*d+o*a)*d;s-=p=((c=s*(a=c)-o*u-n)*f+(u=s*u+o*a-i)*d)/_,o-=g=(u*f-c*d)/_}while(ta(p)+ta(g)>1e-12&&--r>0);if(r){var y=Ia(s*s+o*o),m=2*ea(.5*y),x=fa(m);return[na(s*x,y*ia(m)),y?Na(o*x/y):0]}},n}yh.invert=function(t,e){var n=ta(t),i=ta(e),r=pa,s=ya;i<_h?s*=i/_h:r+=6*Sa(_h/i);for(var o=0;o<25;o++){var a=fa(s),l=Ia(ia(s)),h=fa(s/2),c=ia(s/2),u=fa(r/6),f=ia(r/6),d=.5*r*(1+l)-n,p=s/(c*f)-i,g=l?-.25*r*a/l:0,_=.5*(1+l),y=(1+.5*s*h/c)/(c*f),m=s/c*(u/6)/(f*f),x=g*m-y*_,v=(d*m-p*_)/x,b=(p*g-d*y)/x;if(s-=v,r-=b,ta(v)<pa&&ta(b)<pa)break}return[t<0?-r:r,e<0?-s:s]},mh.invert=function(t,e){var n=ua(t)*_a,i=e/2,r=50;do{var s=n*n,o=i*i,a=n*i,l=n*(.975534+o*(-.0143059*s-.119161+-.0547009*o))-t,h=i*(1.00384+s*(.0802894+-.02855*o+199025e-9*s)+o*(.0998909+-.0491032*o))-e,c=.975534-o*(.119161+3*s*.0143059+.0547009*o),u=-a*(.238322+.2188036*o+.0286118*s),f=a*(.1605788+7961e-7*s+-.0571*o),d=1.00384+s*(.0802894+199025e-9*s)+o*(3*(.0998909-.02855*s)-.245516*o),p=u*f-d*c,g=(h*u-l*d)/p,_=(l*f-h*c)/p;n-=g,i-=_}while((ta(g)>pa||ta(_)>pa)&&--r>0);return r&&[n,i]},xh.invert=function(t,e){var n=t*t,i=e*e+1,r=n+i,s=t?xa*Ia((r-Ia(r*r-4*n))/n):1/Ia(i);return[Na(t*s),ua(e)*Sa(s)]},bh.invert=function(t,e){return[t,2.5*ea(ra(.8*e))-.625*_a]};var wh=[[.9972523,0],[.0052513,-.0041175],[.0074606,.0048125],[-.0153783,-.1968253],[.0636871,-.1408027],[.3660976,-.2937382]],Eh=[[.98879,0],[0,0],[-.050909,0],[0,0],[.075528,0]],Nh=[[.984299,0],[.0211642,.0037608],[-.1036018,-.0575102],[-.0329095,-.0320119],[.0499471,.1223335],[.026046,.0899805],[7388e-7,-.1435792],[.0075848,-.1334108],[-.0216473,.0776645],[-.0225161,.0853673]],Sh=[[.9245,0],[0,0],[.01943,0]],Ih=[[.721316,0],[0,0],[-.00881625,-.00617325]];function kh(t,e){var n=Rr(Mh(t)).rotate(e).clipAngle(90),i=On(e),r=n.center;return delete n.rotate,n.center=function(t){return arguments.length?r(i(t)):i.invert(r())},n}var Oh=Ia(6),Ch=Ia(7);function Th(t,e){var n=Na(7*fa(e)/(3*Oh));return[Oh*t*(2*ia(2*n/3)-1)/Ch,9*fa(n/3)/Ch]}function Rh(t,e){for(var n,i=(1+xa)*fa(e),r=e,s=0;s<25&&(r-=n=(fa(r/2)+fa(r)-i)/(.5*ia(r/2)+ia(r)),!(ta(n)<pa));s++);return[t*(1+2*ia(r)/ia(r/2))/(3*va),2*Ia(3)*fa(r/2)/Ia(2+va)]}function Ah(t,e){for(var n,i=Ia(6/(4+_a)),r=(1+_a/4)*fa(e),s=e/2,o=0;o<25&&(s-=n=(s/2+fa(s)-r)/(.5+ia(s)),!(ta(n)<pa));o++);return[i*(.5+ia(s))*t/1.5,i*s]}function Lh(t,e){var n=e*e,i=n*n,r=n*i;return[t*(.84719-.13063*n+r*r*(.05494*n-.04515-.02326*i+.00331*r)),e*(1.01183+i*i*(.01926*n-.02625-.00396*i))]}function Ph(t,e){return[t*(1+ia(e))/2,2*(e-da(e/2))]}Th.invert=function(t,e){var n=3*Na(e*Ch/9);return[t*Ch/(Oh*(2*ia(2*n/3)-1)),Na(3*fa(n)*Oh/7)]},Rh.invert=function(t,e){var n=e*Ia(2+va)/(2*Ia(3)),i=2*Na(n);return[3*va*t/(1+2*ia(i)/ia(i/2)),Na((n+fa(i))/(1+xa))]},Ah.invert=function(t,e){var n=Ia(6/(4+_a)),i=e/n;return ta(ta(i)-ya)<pa&&(i=i<0?-ya:ya),[1.5*t/(n*(.5+ia(i))),Na((i/2+fa(i))/(1+_a/4))]},Lh.invert=function(t,e){var n,i,r,s,o=e,a=25;do{o-=n=(o*(1.01183+(r=(i=o*o)*i)*r*(.01926*i-.02625-.00396*r))-e)/(1.01183+r*r*(.21186*i-.23625+-.05148*r))}while(ta(n)>ga&&--a>0);return[t/(.84719-.13063*(i=o*o)+(s=i*(r=i*i))*s*(.05494*i-.04515-.02326*r+.00331*s)),o]},Ph.invert=function(t,e){for(var n=e/2,i=0,r=1/0;i<10&&ta(r)>pa;++i){var s=ia(e/2);e-=r=(e-da(e/2)-n)/(1-.5/(s*s))}return[2*t/(1+ia(e)),e]};var Dh=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];function zh(t,e){var n=fa(e),i=ia(e),r=ua(t);if(0===t||ta(e)===ya)return[0,e];if(0===e)return[t,0];if(ta(t)===ya)return[t*i,ya*n];var s=_a/(2*t)-2*t/_a,o=2*e/_a,a=(1-o*o)/(n-o),l=s*s,h=a*a,c=1+l/h,u=1+h/l,f=(s*n/a-s/2)/c,d=(h*n/l+a/2)/u,p=d*d-(h*n*n/l+a*n-1)/u;return[ya*(f+Ia(f*f+i*i/c)*r),ya*(d+Ia(p<0?0:p)*ua(-e*s)*r)]}zh.invert=function(t,e){var n=(t/=ya)*t,i=n+(e/=ya)*e,r=_a*_a;return[t?(i-1+Ia((1-i)*(1-i)+4*n))/(2*t)*ya:0,qa((function(t){return i*(_a*fa(t)-2*t)*_a+4*t*t*(e-fa(t))+2*_a*t-r*e}),0)]};var Fh=1.0148,Gh=.23185,qh=-.14499,jh=.02406,Bh=1.790857183;function Uh(t,e){var n=e*e;return[t,e*(Fh+n*n*(Gh+n*(qh+jh*n)))]}function Yh(t,e){if(ta(e)<pa)return[t,0];var n=da(e),i=t*fa(e);return[fa(i)/n,e+(1-ia(i))/n]}function Wh(t,e){var n=Xh(t[1],t[0]),i=Xh(e[1],e[0]),r=function(t,e){return na(t[0]*e[1]-t[1]*e[0],t[0]*e[0]+t[1]*e[1])}(n,i),s=Vh(n)/Vh(i);return $h([1,0,t[0][0],0,1,t[0][1]],$h([s,0,0,0,s,0],$h([ia(r),fa(r),0,-fa(r),ia(r),0],[1,0,-e[0][0],0,1,-e[0][1]])))}function $h(t,e){return[t[0]*e[0]+t[1]*e[3],t[0]*e[1]+t[1]*e[4],t[0]*e[2]+t[1]*e[5]+t[2],t[3]*e[0]+t[4]*e[3],t[3]*e[1]+t[4]*e[4],t[3]*e[2]+t[4]*e[5]+t[5]]}function Xh(t,e){return[t[0]-e[0],t[1]-e[1]]}function Vh(t){return Ia(t[0]*t[0]+t[1]*t[1])}function Hh(t,e){function n(t,n){var i,r=e(t,n),s=r.project([t*wa,n*wa]);return(i=r.transform)?[i[0]*s[0]+i[1]*s[1]+i[2],-(i[3]*s[0]+i[4]*s[1]+i[5])]:(s[1]=-s[1],s)}function i(t,n){var r=t.project.invert,s=t.transform,o=n;if(s&&(s=function(t){var e=1/(t[0]*t[4]-t[1]*t[3]);return[e*t[4],-e*t[1],e*(t[1]*t[5]-t[2]*t[4]),-e*t[3],e*t[0],e*(t[2]*t[3]-t[0]*t[5])]}(s),o=[s[0]*o[0]+s[1]*o[1]+s[2],s[3]*o[0]+s[4]*o[1]+s[5]]),r&&t===function(t){return e(t[0]*Ea,t[1]*Ea)}(a=r(o)))return a;for(var a,l=t.children,h=0,c=l&&l.length;h<c;++h)if(a=i(l[h],n))return a}!function t(e,n){if(e.edges=function(t){for(var e=t.length,n=[],i=t[e-1],r=0;r<e;++r)n.push([i,i=t[r]]);return n}(e.face),n.face){var i=e.shared=function(t,e){for(var n,i,r=t.length,s=null,o=0;o<r;++o){n=t[o];for(var a=e.length;--a>=0;)if(i=e[a],n[0]===i[0]&&n[1]===i[1]){if(s)return[s,n];s=n}}}(e.face,n.face),r=Wh(i.map(n.project),i.map(e.project));e.transform=n.transform?$h(n.transform,r):r;for(var s=n.edges,o=0,a=s.length;o<a;++o)Jh(i[0],s[o][1])&&Jh(i[1],s[o][0])&&(s[o]=e),Jh(i[0],s[o][0])&&Jh(i[1],s[o][1])&&(s[o]=e);for(s=e.edges,o=0,a=s.length;o<a;++o)Jh(i[0],s[o][0])&&Jh(i[1],s[o][1])&&(s[o]=n),Jh(i[0],s[o][1])&&Jh(i[1],s[o][0])&&(s[o]=n)}else e.transform=n.transform;e.children&&e.children.forEach((function(n){t(n,e)}));return e}(t,{transform:null}),Qh(t)&&(n.invert=function(e,n){var r=i(t,[e,-n]);return r&&(r[0]*=Ea,r[1]*=Ea,r)});var r=Rr(n),s=r.stream;return r.stream=function(e){var n=r.rotate(),i=s(e),o=(r.rotate([0,0]),s(e));return r.rotate(n),i.sphere=function(){o.polygonStart(),o.lineStart(),Zh(o,t),o.lineEnd(),o.polygonEnd()},i},r.angle(-30)}function Zh(t,e,n){var i,r,s=e.edges,o=s.length,a={type:"MultiPoint",coordinates:e.face},l=hn({type:"MultiPoint",coordinates:e.face.filter((function(t){return 90!==ta(t[1])}))}),h=!1,c=-1,u=l[1][0]-l[0][0],f=180===u||360===u?[(l[0][0]+l[1][0])/2,(l[0][1]+l[1][1])/2]:bn(a);if(n)for(;++c<o&&s[c]!==n;);++c;for(var d=0;d<o;++d)r=s[(d+c)%o],Array.isArray(r)?(h||(t.point((i=yi(r[0],f)(pa))[0],i[1]),h=!0),t.point((i=yi(r[1],f)(pa))[0],i[1])):(h=!1,r!==n&&Zh(t,r,e))}function Jh(t,e){return t&&e&&t[0]===e[0]&&t[1]===e[1]}function Qh(t){return t.project.invert||t.children&&t.children.some(Qh)}Uh.invert=function(t,e){e>Bh?e=Bh:e<-1.790857183&&(e=-1.790857183);var n,i=e;do{var r=i*i;i-=n=(i*(Fh+r*r*(Gh+r*(qh+jh*r)))-e)/(1.0148+r*r*(1.1592500000000001+r*(.21654*r-1.01493)))}while(ta(n)>pa);return[t,i]},Yh.invert=function(t,e){if(ta(e)<pa)return[t,0];var n,i=t*t+e*e,r=.5*e,s=10;do{var o=da(r),a=1/ia(r),l=i-2*e*r+r*r;r-=n=(o*l+2*(r-e))/(2+l*a*a+2*(r-e)*o)}while(ta(n)>pa&&--s>0);return o=da(r),[(ta(e)<ta(r+1/o)?Na(t*o):ua(e)*ua(t)*(Sa(ta(t*o))+ya))/fa(r),r]};var Kh=[[0,90],[-90,0],[0,0],[90,0],[180,0],[0,-90]],tc=[[0,2,1],[0,3,2],[5,1,2],[5,2,3],[0,1,4],[0,4,3],[5,4,1],[5,3,4]].map((function(t){return t.map((function(t){return Kh[t]}))}));var ec=2/Ia(3);function nc(t,e){var n=ol(t,e);return[n[0]*ec,n[1]]}function ic(t,e){for(var n=0,i=t.length,r=0;n<i;++n)r+=t[n]*e[n];return r}function rc(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function sc(t){return[na(t[1],t[0])*wa,Na(aa(-1,la(1,t[2])))*wa]}function oc(t){var e=t[0]*Ea,n=t[1]*Ea,i=ia(n);return[i*ia(e),i*fa(e),fa(n)]}nc.invert=function(t,e){return ol.invert(t/ec,e)};var ac=()=>{};function lc(t,e){var n,i=e.stream;if(!i)throw new Error("invalid projection");switch(t&&t.type){case"Feature":n=cc;break;case"FeatureCollection":n=hc;break;default:n=uc}return n(t,i)}function hc(t,e){return{type:"FeatureCollection",features:t.features.map((function(t){return cc(t,e)}))}}function cc(t,e){return{type:"Feature",id:t.id,properties:t.properties,geometry:uc(t.geometry,e)}}function uc(t,e){if(!t)return null;if("GeometryCollection"===t.type)return function(t,e){return{type:"GeometryCollection",geometries:t.geometries.map((function(t){return uc(t,e)}))}}(t,e);var n;switch(t.type){case"Point":case"MultiPoint":n=pc;break;case"LineString":case"MultiLineString":n=gc;break;case"Polygon":case"MultiPolygon":case"Sphere":n=_c;break;default:return null}return ie(t,e(n)),n.result()}var fc=[],dc=[],pc={point:function(t,e){fc.push([t,e])},result:function(){var t=fc.length?fc.length<2?{type:"Point",coordinates:fc[0]}:{type:"MultiPoint",coordinates:fc}:null;return fc=[],t}},gc={lineStart:ac,point:function(t,e){fc.push([t,e])},lineEnd:function(){fc.length&&(dc.push(fc),fc=[])},result:function(){var t=dc.length?dc.length<2?{type:"LineString",coordinates:dc[0]}:{type:"MultiLineString",coordinates:dc}:null;return dc=[],t}},_c={polygonStart:ac,lineStart:ac,point:function(t,e){fc.push([t,e])},lineEnd:function(){var t=fc.length;if(t){do{fc.push(fc[0].slice())}while(++t<4);dc.push(fc),fc=[]}},polygonEnd:ac,result:function(){if(!dc.length)return null;var t=[],e=[];return dc.forEach((function(n){!function(t){if((e=t.length)<4)return!1;for(var e,n=0,i=t[e-1][1]*t[0][0]-t[e-1][0]*t[0][1];++n<e;)i+=t[n-1][1]*t[n][0]-t[n-1][0]*t[n][1];return i<=0}(n)?e.push(n):t.push([n])})),e.forEach((function(e){var n=e[0];t.some((function(t){if(function(t,e){for(var n=e[0],i=e[1],r=!1,s=0,o=t.length,a=o-1;s<o;a=s++){var l=t[s],h=l[0],c=l[1],u=t[a],f=u[0],d=u[1];c>i^d>i&&n<(f-h)*(i-c)/(d-c)+h&&(r=!r)}return r}(t[0],n))return t.push(e),!0}))||t.push([e])})),dc=[],t.length?t.length>1?{type:"MultiPolygon",coordinates:t}:{type:"Polygon",coordinates:t[0]}:null}};function yc(t){var e=t(ya,0)[0]-t(-ya,0)[0];function n(n,i){var r=ta(n)<ya,s=t(r?n:n>0?n-_a:n+_a,i),o=(s[0]-s[1])*xa,a=(s[0]+s[1])*xa;if(r)return[o,a];var l=e*xa,h=o>0^a>0?-1:1;return[h*o-ua(a)*l,h*a-ua(o)*l]}return t.invert&&(n.invert=function(n,i){var r=(n+i)*xa,s=(i-n)*xa,o=ta(r)<.5*e&&ta(s)<.5*e;if(!o){var a=e*xa,l=r>0^s>0?-1:1,h=-l*n+(s>0?1:-1)*a,c=-l*i+(r>0?1:-1)*a;r=(-h-c)*xa,s=(h-c)*xa}var u=t.invert(r,s);return o||(u[0]+=r>0?_a:-_a),u}),Rr(n).rotate([-90,-90,45]).clipAngle(179.999)}function mc(t){var e=fa(t);function n(n,i){var r=e?da(n*e/2)/e:n/2;if(!i)return[2*r,-t];var s=2*ea(r*fa(i)),o=1/da(i);return[fa(s)*o,i+(1-ia(s))*o-t]}return n.invert=function(n,i){if(ta(i+=t)<pa)return[e?2*ea(e*n/2)/e:n,0];var r,s=n*n+i*i,o=0,a=10;do{var l=da(o),h=1/ia(o),c=s-2*i*o+o*o;o-=r=(l*c+2*(o-i))/(2+c*h*h+2*(o-i)*l)}while(ta(r)>pa&&--a>0);var u=n*(l=da(o)),f=da(ta(i)<ta(o+1/l)?.5*Na(u):.5*Sa(u)+_a/4)/fa(o);return[e?2*ea(e*f)/e:2*f,o]},n}var xc=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];function vc(t,e){var n,i=la(18,36*ta(e)/_a),r=sa(i),s=i-r,o=(n=xc[r])[0],a=n[1],l=(n=xc[++r])[0],h=n[1],c=(n=xc[la(19,++r)])[0],u=n[1];return[t*(l+s*(c-o)/2+s*s*(c-2*l+o)/2),ua(e)*(h+s*(u-a)/2+s*s*(u-2*h+a)/2)]}function bc(t,e){var n=function(t){function e(e,n){var i=ia(n),r=(t-1)/(t-i*ia(e));return[r*i*fa(e),r*fa(n)]}return e.invert=function(e,n){var i=e*e+n*n,r=Ia(i),s=(t-Ia(1-i*(t+1)/(t-1)))/((t-1)/r+r/(t-1));return[na(e*s,r*Ia(1-s*s)),r?Na(n*s/r):0]},e}(t);if(!e)return n;var i=ia(e),r=fa(e);function s(e,s){var o=n(e,s),a=o[1],l=a*r/(t-1)+i;return[o[0]*i/l,a/l]}return s.invert=function(e,s){var o=(t-1)/(t-1-s*r);return n.invert(o*e,o*s*i)},s}xc.forEach((function(t){t[1]*=1.593415793900743})),vc.invert=function(t,e){var n=90*e,i=la(18,ta(n/5)),r=aa(0,sa(i));do{var s=xc[r][1],o=xc[r+1][1],a=xc[la(19,r+2)][1],l=a-s,h=a-2*o+s,c=2*(ta(e)-o)/l,u=h/l,f=c*(1-u*c*(1-2*u*c));if(f>=0||1===r){n=(e>=0?5:-5)*(f+i);var d,p=50;do{f=(i=la(18,ta(n)/5))-(r=sa(i)),s=xc[r][1],o=xc[r+1][1],a=xc[la(19,r+2)][1],n-=(d=ua(e)*(o+f*(a-s)/2+f*f*(a-2*o+s)/2)-e)*wa}while(ta(d)>ga&&--p>0);break}}while(--r>=0);var g=xc[r][0],_=xc[r+1][0],y=xc[la(19,r+2)][0];return[t/(_+f*(y-g)/2+f*f*(y-2*_+g)/2),n*Ea]};var Mc=-180,wc=-179.9999,Ec=179.9999,Nc=-89.9999,Sc=89.9999;function Ic(t){return t.length>0}function kc(t){return Math.floor(1e4*t)/1e4}function Oc(t){return-90===t||90===t?[0,t]:[Mc,kc(t)]}function Cc(t){var e=t[0],n=t[1],i=!1;return e<=wc?(e=Mc,i=!0):e>=Ec&&(e=180,i=!0),n<=Nc?(n=-90,i=!0):n>=Sc&&(n=90,i=!0),i?[e,n]:t}function Tc(t){return t.map(Cc)}function Rc(t,e,n){for(var i=0,r=t.length;i<r;++i){var s=t[i].slice();n.push({index:-1,polygon:e,ring:s});for(var o=0,a=s.length;o<a;++o){var l=s[o],h=l[0],c=l[1];if(h<=wc||h>=Ec||c<=Nc||c>=Sc){s[o]=Cc(l);for(var u=o+1;u<a;++u){var f=s[u],d=f[0],p=f[1];if(d>wc&&d<Ec&&p>Nc&&p<Sc)break}if(u===o+1)continue;if(o){var g={index:-1,polygon:e,ring:s.slice(0,o+1)};g.ring[g.ring.length-1]=Oc(c),n[n.length-1]=g}else n.pop();if(u>=a)break;n.push({index:-1,polygon:e,ring:s=s.slice(u-1)}),s[0]=Oc(s[0][1]),o=-1,a=s.length}}}}function Ac(t){var e,n,i,r,s,o,a=t.length,l={},h={};for(e=0;e<a;++e)i=(n=t[e]).ring[0],s=n.ring[n.ring.length-1],i[0]!==s[0]||i[1]!==s[1]?(n.index=e,l[i]=h[s]=n):(n.polygon.push(n.ring),t[e]=null);for(e=0;e<a;++e)if(n=t[e]){if(i=n.ring[0],s=n.ring[n.ring.length-1],r=h[i],o=l[s],delete l[i],delete h[s],i[0]===s[0]&&i[1]===s[1]){n.polygon.push(n.ring);continue}r?(delete h[i],delete l[r.ring[0]],r.ring.pop(),t[r.index]=null,n={index:-1,polygon:r.polygon,ring:r.ring.concat(n.ring)},r===o?n.polygon.push(n.ring):(n.index=a++,t.push(l[n.ring[0]]=h[n.ring[n.ring.length-1]]=n))):o?(delete l[s],delete h[o.ring[o.ring.length-1]],n.ring.pop(),n={index:a++,polygon:o.polygon,ring:n.ring.concat(o.ring)},t[o.index]=null,t.push(l[n.ring[0]]=h[n.ring[n.ring.length-1]]=n)):(n.ring.push(n.ring[0]),n.polygon.push(n.ring))}}function Lc(t){var e={type:"Feature",geometry:Pc(t.geometry)};return null!=t.id&&(e.id=t.id),null!=t.bbox&&(e.bbox=t.bbox),null!=t.properties&&(e.properties=t.properties),e}function Pc(t){if(null==t)return t;var e,n,i,r;switch(t.type){case"GeometryCollection":e={type:"GeometryCollection",geometries:t.geometries.map(Pc)};break;case"Point":e={type:"Point",coordinates:Cc(t.coordinates)};break;case"MultiPoint":case"LineString":e={type:t.type,coordinates:Tc(t.coordinates)};break;case"MultiLineString":e={type:"MultiLineString",coordinates:t.coordinates.map(Tc)};break;case"Polygon":var s=[];Rc(t.coordinates,s,n=[]),Ac(n),e={type:"Polygon",coordinates:s};break;case"MultiPolygon":n=[],i=-1,r=t.coordinates.length;for(var o=new Array(r);++i<r;)Rc(t.coordinates[i],o[i]=[],n);Ac(n),e={type:"MultiPolygon",coordinates:o.filter(Ic)};break;default:return t}return null!=t.bbox&&(e.bbox=t.bbox),e}function Dc(t,e){var n=da(e/2),i=fa(ma*n);return[t*(.74482-.34588*i*i),1.70711*n]}function zc(t,e,n){var i=yi(e,n),r=i(.5),s=On([-r[0],-r[1]])(e),o=i.distance/2,a=-Na(fa(s[1]*Ea)/fa(o)),l=[-r[0],-r[1],-(s[0]>0?_a-a:a)*wa],h=Rr(t(o)).rotate(l),c=On(l),u=h.center;return delete h.rotate,h.center=function(t){return arguments.length?u(c(t)):c.invert(u())},h.clipAngle(90)}function Fc(t){var e=ia(t);function n(t,n){var i=is(t,n);return i[0]*=e,i}return n.invert=function(t,n){return is.invert(t/e,n)},n}function Gc(t,e){return zc(Fc,t,e)}function qc(t){if(!(t*=2))return jr;var e=-t/2,n=-e,i=t*t,r=da(n),s=.5/fa(n);function o(r,s){var o=Sa(ia(s)*ia(r-e)),a=Sa(ia(s)*ia(r-n));return[((o*=o)-(a*=a))/(2*t),(s<0?-1:1)*Ia(4*i*a-(i-o+a)*(i-o+a))/(2*t)]}return o.invert=function(t,i){var o,a,l=i*i,h=ia(Ia(l+(o=t+e)*o)),c=ia(Ia(l+(o=t+n)*o));return[na(a=h-c,o=(h+c)*r),(i<0?-1:1)*Sa(Ia(o*o+a*a)*s)]},o}function jc(t,e){return zc(qc,t,e)}function Bc(t,e){if(ta(e)<pa)return[t,0];var n=ta(e/ya),i=Na(n);if(ta(t)<pa||ta(ta(e)-ya)<pa)return[0,ua(e)*_a*da(i/2)];var r=ia(i),s=ta(_a/t-t/_a)/2,o=s*s,a=r/(n+r-1),l=a*(2/n-1),h=l*l,c=h+o,u=a-h,f=o+a;return[ua(t)*_a*(s*u+Ia(o*u*u-c*(a*a-h)))/c,ua(e)*_a*(l*f-s*Ia((o+1)*c-f*f))/c]}function Uc(t,e){if(ta(e)<pa)return[t,0];var n=ta(e/ya),i=Na(n);if(ta(t)<pa||ta(ta(e)-ya)<pa)return[0,ua(e)*_a*da(i/2)];var r=ia(i),s=ta(_a/t-t/_a)/2,o=s*s,a=r*(Ia(1+o)-s*r)/(1+o*n*n);return[ua(t)*_a*a,ua(e)*_a*Ia(1-a*(2*s+a))]}function Yc(t,e){if(ta(e)<pa)return[t,0];var n=e/ya,i=Na(n);if(ta(t)<pa||ta(ta(e)-ya)<pa)return[0,_a*da(i/2)];var r=(_a/t-t/_a)/2,s=n/(1+ia(i));return[_a*(ua(t)*Ia(r*r+1-s*s)-r),_a*s]}function Wc(t,e){if(!e)return[t,0];var n=ta(e);if(!t||n===ya)return[0,e];var i=n/ya,r=i*i,s=(8*i-r*(r+2)-5)/(2*r*(i-1)),o=s*s,a=i*s,l=r+o+2*a,h=i+3*s,c=t/ya,u=c+1/c,f=ua(ta(t)-ya)*Ia(u*u-4),d=f*f,p=(f*(l+o-1)+2*Ia(l*(r+o*d-1)+(1-r)*(r*(h*h+4*o)+12*a*o+4*o*o)))/(4*l+d);return[ua(t)*ya*p,ua(e)*ya*Ia(1+f*ta(p)-p*p)]}function $c(t,e,n,i){var r=_a/3;t=aa(t,pa),e=aa(e,pa),t=la(t,ya),e=la(e,_a-pa),n=aa(n,0),n=la(n,99.999999);var s=(i=aa(i,pa))/100,o=Sa((n/100+1)*ia(r))/r,a=fa(t)/fa(o*ya),l=e/_a,h=Ia(s*fa(t/2)/fa(e/2));return function(t,e,n,i,r){function s(s,o){var a=n*fa(i*o),l=Ia(1-a*a),h=Ia(2/(1+l*ia(s*=r)));return[t*l*h*fa(s),e*a*h]}return s.invert=function(s,o){var a=s/t,l=o/e,h=Ia(a*a+l*l),c=2*Na(h/2);return[na(s*da(c),t*h)/r,h&&Na(o*fa(c)/(e*n*h))/i]},s}(h/Ia(l*a*o),1/(h*Ia(l*a*o)),a,o,l)}function Xc(){var t=65*Ea,e=60*Ea,n=20,i=200,r=Ar($c),s=r(t,e,n,i);return s.poleline=function(s){return arguments.length?r(t=+s*Ea,e,n,i):t*wa},s.parallels=function(s){return arguments.length?r(t,e=+s*Ea,n,i):e*wa},s.inflation=function(s){return arguments.length?r(t,e,n=+s,i):n},s.ratio=function(s){return arguments.length?r(t,e,n,i=+s):i},s.scale(163.775)}Dc.invert=function(t,e){var n=e/1.70711,i=fa(ma*n);return[t/(.74482-.34588*i*i),2*ea(n)]},Bc.invert=function(t,e){if(ta(e)<pa)return[t,0];if(ta(t)<pa)return[0,ya*fa(2*ea(e/_a))];var n=(t/=_a)*t,i=(e/=_a)*e,r=n+i,s=r*r,o=-ta(e)*(1+r),a=o-2*i+n,l=-2*o+1+2*i+s,h=i/l+(2*a*a*a/(l*l*l)-9*o*a/(l*l))/27,c=(o-a*a/(3*l))/l,u=2*Ia(-c/3),f=Sa(3*h/(c*u))/3;return[_a*(r-1+Ia(1+2*(n-i)+s))/(2*t),ua(e)*_a*(-u*ia(f+_a/3)-a/(3*l))]},Uc.invert=function(t,e){if(!t)return[0,ya*fa(2*ea(e/_a))];var n=ta(t/_a),i=(1-n*n-(e/=_a)*e)/(2*n),r=Ia(i*i+1);return[ua(t)*_a*(r-i),ua(e)*ya*fa(2*na(Ia((1-2*i*n)*(i+r)-n),Ia(r+i+n)))]},Yc.invert=function(t,e){if(!e)return[t,0];var n=e/_a,i=(_a*_a*(1-n*n)-t*t)/(2*_a*t);return[t?_a*(ua(t)*Ia(i*i+1)-i):0,ya*fa(2*ea(n))]},Wc.invert=function(t,e){var n;if(!t||!e)return[t,e];var i=ua(e);e=ta(e)/_a;var r=ua(t)*t/ya,s=(r*r-1+4*e*e)/ta(r),o=s*s,a=e*(2-(e>.5?la(e,ta(t)):0)),l=t*t+e*e,h=50;do{var c=a*a,u=(8*a-c*(c+2)-5)/(2*c*(a-1)),f=(3*a-c*a-10)/(2*c*a),d=u*u,p=a*u,g=a+u,_=g*g,y=a+3*u,m=-2*g*(4*p*d+(1-4*c+3*c*c)*(1+f)+d*(14*c-6-o+(8*c-8-2*o)*f)+p*(12*c-8+(10*c-10-o)*f)),x=Ia(_*(c+d*o-1)+(1-c)*(c*(y*y+4*d)+d*(12*p+4*d)));a-=n=(s*(_+d-1)+2*x-r*(4*_+o))/(s*(2*u*f+2*g*(1+f))+m/x-8*g*(s*(-1+d+_)+2*x)*(1+f)/(o+4*_))}while(n*l*l>pa&&--h>0);return[ua(t)*(Ia(s*s+4)+s)*_a/4,i*ya*a]};var Vc=4*_a+3*Ia(3),Hc=2*Ia(2*_a*Ia(3)/Vc),Zc=Ya(Hc*Ia(3)/_a,Hc,Vc/6);function Jc(t,e){return[t*Ia(1-3*e*e/(_a*_a)),e]}function Qc(t,e){var n=ia(e),i=ia(t)*n,r=1-i,s=ia(t=na(fa(t)*n,-fa(e))),o=fa(t);return[o*(n=Ia(1-i*i))-s*r,-s*n-o*r]}function Kc(t,e){var n=Ta(t,e);return[(n[0]+t/ya)/2,(n[1]+e)/2]}Jc.invert=function(t,e){return[t/Ia(1-3*e*e/(_a*_a)),e]},Qc.invert=function(t,e){var n=(t*t+e*e)/-2,i=Ia(-n*(2+n)),r=e*n+t*i,s=t*n-e*i,o=Ia(s*s+r*r);return[na(i*r,o*(1+n)),o?-Na(i*s/o):0]},Kc.invert=function(t,e){var n=t,i=e,r=25;do{var s,o=ia(i),a=fa(i),l=fa(2*i),h=a*a,c=o*o,u=fa(n),f=ia(n/2),d=fa(n/2),p=d*d,g=1-c*f*f,_=g?Sa(o*f)*Ia(s=1/g):s=0,y=.5*(2*_*o*d+n/ya)-t,m=.5*(_*a+i)-e,x=.5*s*(c*p+_*o*f*h)+.5/ya,v=s*(u*l/4-_*a*d),b=.125*s*(l*d-_*a*c*u),M=.5*s*(h*f+_*p*o)+.5,w=v*b-M*x,E=(m*v-y*M)/w,N=(y*b-m*x)/w;n-=E,i-=N}while((ta(E)>pa||ta(N)>pa)&&--r>0);return[n,i]};var tu=Object.freeze({__proto__:null,geoAiry:function(){var t=ya,e=Ar(Ca),n=e(t);return n.radius=function(n){return arguments.length?e(t=n*Ea):t*wa},n.scale(179.976).clipAngle(147)},geoAiryRaw:Ca,geoAitoff:function(){return Rr(Ta).scale(152.63)},geoAitoffRaw:Ta,geoArmadillo:function(){var t=20*Ea,e=t>=0?1:-1,n=da(e*t),i=Ar(Ra),r=i(t),s=r.stream;return r.parallel=function(r){return arguments.length?(n=da((e=(t=r*Ea)>=0?1:-1)*t),i(t)):t*wa},r.stream=function(i){var o=r.rotate(),a=s(i),l=(r.rotate([0,0]),s(i)),h=r.precision();return r.rotate(o),a.sphere=function(){l.polygonStart(),l.lineStart();for(var i=-180*e;e*i<180;i+=90*e)l.point(i,90*e);if(t)for(;e*(i-=3*e*h)>=-180;)l.point(i,e*-na(ia(i*Ea/2),n)*wa);l.lineEnd(),l.polygonEnd()},a},r.scale(218.695).center([0,28.0974])},geoArmadilloRaw:Ra,geoAugust:function(){return Rr(Aa).scale(66.1603)},geoAugustRaw:Aa,geoBaker:function(){return Rr(Da).scale(112.314)},geoBakerRaw:Da,geoBerghaus:function(){var t=5,e=Ar(za),n=e(t),i=n.stream,r=.01,s=-ia(r*Ea),o=fa(r*Ea);return n.lobes=function(n){return arguments.length?e(t=+n):t},n.stream=function(e){var a=n.rotate(),l=i(e),h=(n.rotate([0,0]),i(e));return n.rotate(a),l.sphere=function(){h.polygonStart(),h.lineStart();for(var e=0,n=360/t,i=2*_a/t,a=90-180/t,l=ya;e<t;++e,a-=n,l-=i)h.point(na(o*ia(l),s)*wa,Na(o*fa(l))*wa),a<-90?(h.point(-90,-180-a-r),h.point(-90,-180-a+r)):(h.point(90,a+r),h.point(90,a-r));h.lineEnd(),h.polygonEnd()},l},n.scale(87.8076).center([0,17.1875]).clipAngle(179.999)},geoBerghausRaw:za,geoBertin1953:function(){return Rr(Ba()).rotate([-16.5,-42]).scale(176.57).center([7.93,.09])},geoBertin1953Raw:Ba,geoBoggs:function(){return Rr(Va).scale(160.857)},geoBoggsRaw:Va,geoBonne:function(){return Ha(Ja).scale(123.082).center([0,26.1441]).parallel(45)},geoBonneRaw:Ja,geoBottomley:function(){var t=.5,e=Ar(Qa),n=e(t);return n.fraction=function(n){return arguments.length?e(t=+n):t},n.scale(158.837)},geoBottomleyRaw:Qa,geoBromley:function(){return Rr(Ka).scale(152.63)},geoBromleyRaw:Ka,geoChamberlin:sl,geoChamberlinRaw:il,geoChamberlinAfrica:function(){return sl([0,22],[45,22],[22.5,-22]).scale(380).center([22.5,2])},geoCollignon:function(){return Rr(ol).scale(95.6464).center([0,30])},geoCollignonRaw:ol,geoCraig:function(){return Ha(al).scale(249.828).clipAngle(90)},geoCraigRaw:al,geoCraster:function(){return Rr(hl).scale(156.19)},geoCrasterRaw:hl,geoCylindricalEqualArea:function(){return Ha(cl).parallel(38.58).scale(195.044)},geoCylindricalEqualAreaRaw:cl,geoCylindricalStereographic:function(){return Ha(ul).scale(124.75)},geoCylindricalStereographicRaw:ul,geoEckert1:function(){return Rr(fl).scale(165.664)},geoEckert1Raw:fl,geoEckert2:function(){return Rr(dl).scale(165.664)},geoEckert2Raw:dl,geoEckert3:function(){return Rr(pl).scale(180.739)},geoEckert3Raw:pl,geoEckert4:function(){return Rr(gl).scale(180.739)},geoEckert4Raw:gl,geoEckert5:function(){return Rr(_l).scale(173.044)},geoEckert5Raw:_l,geoEckert6:function(){return Rr(yl).scale(173.044)},geoEckert6Raw:yl,geoEisenlohr:function(){return Rr(xl).scale(62.5271)},geoEisenlohrRaw:xl,geoFahey:function(){return Rr(bl).scale(137.152)},geoFaheyRaw:bl,geoFoucaut:function(){return Rr(Ml).scale(135.264)},geoFoucautRaw:Ml,geoFoucautSinusoidal:function(){var t=.5,e=Ar(wl),n=e(t);return n.alpha=function(n){return arguments.length?e(t=+n):t},n.scale(168.725)},geoFoucautSinusoidalRaw:wl,geoGilbert:function(t){null==t&&(t=ls);var e=t(),n=Hr().scale(wa).precision(0).clipAngle(null).translate([0,0]);function i(t){return e(El(t))}function r(t){i[t]=function(){return arguments.length?(e[t].apply(e,arguments),i):e[t]()}}return e.invert&&(i.invert=function(t){return Nl(e.invert(t))}),i.stream=function(t){var i=e.stream(t),r=n.stream({point:function(t,e){i.point(t/2,Na(da(-e/2*Ea))*wa)},lineStart:function(){i.lineStart()},lineEnd:function(){i.lineEnd()},polygonStart:function(){i.polygonStart()},polygonEnd:function(){i.polygonEnd()}});return r.sphere=i.sphere,r},i.rotate=function(t){return arguments.length?(n.rotate(t),i):n.rotate()},i.center=function(t){return arguments.length?(e.center(El(t)),i):Nl(e.center())},r("angle"),r("clipAngle"),r("clipExtent"),r("fitExtent"),r("fitHeight"),r("fitSize"),r("fitWidth"),r("scale"),r("translate"),r("precision"),i.scale(249.5)},geoGingery:function(){var t=6,e=30*Ea,n=ia(e),i=fa(e),r=Ar(Sl),s=r(e,t),o=s.stream,a=-ia(.01*Ea),l=fa(.01*Ea);return s.radius=function(s){return arguments.length?(n=ia(e=s*Ea),i=fa(e),r(e,t)):e*wa},s.lobes=function(n){return arguments.length?r(e,t=+n):t},s.stream=function(e){var r=s.rotate(),h=o(e),c=(s.rotate([0,0]),o(e));return s.rotate(r),h.sphere=function(){c.polygonStart(),c.lineStart();for(var e=0,r=2*_a/t,s=0;e<t;++e,s-=r)c.point(na(l*ia(s),a)*wa,Na(l*fa(s))*wa),c.point(na(i*ia(s-r/2),n)*wa,Na(i*fa(s-r/2))*wa);c.lineEnd(),c.polygonEnd()},h},s.rotate([90,-40]).scale(91.7095).clipAngle(179.999)},geoGingeryRaw:Sl,geoGinzburg4:function(){return Rr(Cl).scale(149.995)},geoGinzburg4Raw:Cl,geoGinzburg5:function(){return Rr(Tl).scale(153.93)},geoGinzburg5Raw:Tl,geoGinzburg6:function(){return Rr(Rl).scale(130.945)},geoGinzburg6Raw:Rl,geoGinzburg8:function(){return Rr(Al).scale(131.747)},geoGinzburg8Raw:Al,geoGinzburg9:function(){return Rr(Ll).scale(131.087)},geoGinzburg9Raw:Ll,geoGringorten:function(){return Rr(Pl(Dl)).scale(239.75)},geoGringortenRaw:Dl,geoGuyou:function(){return Rr(Pl(Gl)).scale(151.496)},geoGuyouRaw:Gl,geoHammer:function(){var t=2,e=Ar(Fa),n=e(t);return n.coefficient=function(n){return arguments.length?e(t=+n):t},n.scale(169.529)},geoHammerRaw:Fa,geoHammerRetroazimuthal:function(){var t=0,e=Ar(ql),n=e(t),i=n.rotate,r=n.stream,s=Rn();return n.parallel=function(i){if(!arguments.length)return t*wa;var r=n.rotate();return e(t=i*Ea).rotate(r)},n.rotate=function(e){return arguments.length?(i.call(n,[e[0],e[1]-t*wa]),s.center([-e[0],-e[1]]),n):((e=i.call(n))[1]+=t*wa,e)},n.stream=function(t){return(t=r(t)).sphere=function(){t.polygonStart();var e,n=s.radius(89.99)().coordinates[0],i=n.length-1,r=-1;for(t.lineStart();++r<i;)t.point((e=n[r])[0],e[1]);for(t.lineEnd(),i=(n=s.radius(90.01)().coordinates[0]).length-1,t.lineStart();--r>=0;)t.point((e=n[r])[0],e[1]);t.lineEnd(),t.polygonEnd()},t},n.scale(79.4187).parallel(45).clipAngle(179.999)},geoHammerRetroazimuthalRaw:ql,geoHealpix:function(){var t=4,e=Ar(Yl),n=e(t),i=n.stream;return n.lobes=function(n){return arguments.length?e(t=+n):t},n.stream=function(e){var r=n.rotate(),s=i(e),o=(n.rotate([0,0]),i(e));return n.rotate(r),s.sphere=function(){ie(function(t){var e=[].concat(gt(-180,180+t/2,t).map(Wl),gt(180,-180-t/2,-t).map($l));return{type:"Polygon",coordinates:[180===t?e.map(Xl):e]}}(180/t),o)},s},n.scale(239.75)},geoHealpixRaw:Yl,geoHill:function(){var t=1,e=Ar(Vl),n=e(t);return n.ratio=function(n){return arguments.length?e(t=+n):t},n.scale(167.774).center([0,18.67])},geoHillRaw:Vl,geoHomolosine:function(){return Rr(Ql).scale(152.63)},geoHomolosineRaw:Ql,geoHufnagel:th,geoHufnagelRaw:Kl,geoHyperelliptical:function(){var t=0,e=2.5,n=1.183136,i=Ar(ih),r=i(t,e,n);return r.alpha=function(r){return arguments.length?i(t=+r,e,n):t},r.k=function(r){return arguments.length?i(t,e=+r,n):e},r.gamma=function(r){return arguments.length?i(t,e,n=+r):n},r.scale(152.63)},geoHyperellipticalRaw:ih,geoInterrupt:ah,geoInterruptedBoggs:function(){return ah(Va,lh).scale(160.857)},geoInterruptedHomolosine:function(){return ah(Ql,hh).scale(152.63)},geoInterruptedMollweide:function(){return ah(Wa,ch).scale(169.529)},geoInterruptedMollweideHemispheres:function(){return ah(Wa,uh).scale(169.529).rotate([20,0])},geoInterruptedSinuMollweide:function(){return ah(Jl,fh,ja).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},geoInterruptedSinusoidal:function(){return ah(Za,dh).scale(152.63).rotate([-20,0])},geoKavrayskiy7:function(){return Rr(ph).scale(158.837)},geoKavrayskiy7Raw:ph,geoLagrange:function(){var t=.5,e=Ar(gh),n=e(t);return n.spacing=function(n){return arguments.length?e(t=+n):t},n.scale(124.75)},geoLagrangeRaw:gh,geoLarrivee:function(){return Rr(yh).scale(97.2672)},geoLarriveeRaw:yh,geoLaskowski:function(){return Rr(mh).scale(139.98)},geoLaskowskiRaw:mh,geoLittrow:function(){return Rr(xh).scale(144.049).clipAngle(89.999)},geoLittrowRaw:xh,geoLoximuthal:function(){return Ha(vh).parallel(40).scale(158.837)},geoLoximuthalRaw:vh,geoMiller:function(){return Rr(bh).scale(108.318)},geoMillerRaw:bh,geoModifiedStereographic:kh,geoModifiedStereographicRaw:Mh,geoModifiedStereographicAlaska:function(){return kh(wh,[152,-64]).scale(1400).center([-160.908,62.4864]).clipAngle(30).angle(7.8)},geoModifiedStereographicGs48:function(){return kh(Eh,[95,-38]).scale(1e3).clipAngle(55).center([-96.5563,38.8675])},geoModifiedStereographicGs50:function(){return kh(Nh,[120,-45]).scale(359.513).clipAngle(55).center([-117.474,53.0628])},geoModifiedStereographicMiller:function(){return kh(Sh,[-20,-18]).scale(209.091).center([20,16.7214]).clipAngle(82)},geoModifiedStereographicLee:function(){return kh(Ih,[165,10]).scale(250).clipAngle(130).center([-165,-10])},geoMollweide:function(){return Rr(Wa).scale(169.529)},geoMollweideRaw:Wa,geoMtFlatPolarParabolic:function(){return Rr(Th).scale(164.859)},geoMtFlatPolarParabolicRaw:Th,geoMtFlatPolarQuartic:function(){return Rr(Rh).scale(188.209)},geoMtFlatPolarQuarticRaw:Rh,geoMtFlatPolarSinusoidal:function(){return Rr(Ah).scale(166.518)},geoMtFlatPolarSinusoidalRaw:Ah,geoNaturalEarth2:function(){return Rr(Lh).scale(175.295)},geoNaturalEarth2Raw:Lh,geoNellHammer:function(){return Rr(Ph).scale(152.63)},geoNellHammerRaw:Ph,geoInterruptedQuarticAuthalic:function(){return ah(Fa(1/0),Dh).rotate([20,0]).scale(152.63)},geoNicolosi:function(){return Rr(zh).scale(127.267)},geoNicolosiRaw:zh,geoPatterson:function(){return Rr(Uh).scale(139.319)},geoPattersonRaw:Uh,geoPolyconic:function(){return Rr(Yh).scale(103.74)},geoPolyconicRaw:Yh,geoPolyhedral:Hh,geoPolyhedralButterfly:function(t){t=t||function(t){var e=bn({type:"MultiPoint",coordinates:t});return rs().scale(1).translate([0,0]).rotate([-e[0],-e[1]])};var e=tc.map((function(e){return{face:e,project:t(e)}}));return[-1,0,0,1,0,1,4,5].forEach((function(t,n){var i=e[t];i&&(i.children||(i.children=[])).push(e[n])})),Hh(e[0],(function(t,n){return e[t<-_a/2?n<0?6:4:t<0?n<0?2:0:t<_a/2?n<0?3:1:n<0?7:5]})).angle(-30).scale(101.858).center([0,45])},geoPolyhedralCollignon:function(t){t=t||function(t){var e=bn({type:"MultiPoint",coordinates:t});return Rr(nc).translate([0,0]).scale(1).rotate(e[1]>0?[-e[0],0]:[180-e[0],180])};var e=tc.map((function(e){return{face:e,project:t(e)}}));return[-1,0,0,1,0,1,4,5].forEach((function(t,n){var i=e[t];i&&(i.children||(i.children=[])).push(e[n])})),Hh(e[0],(function(t,n){return e[t<-_a/2?n<0?6:4:t<0?n<0?2:0:t<_a/2?n<0?3:1:n<0?7:5]})).angle(-30).scale(121.906).center([0,48.5904])},geoPolyhedralWaterman:function(t){t=t||function(t){var e=6===t.length?bn({type:"MultiPoint",coordinates:t}):t[0];return rs().scale(1).translate([0,0]).rotate([-e[0],-e[1]])};var e=tc.map((function(t){for(var e,n=t.map(oc),i=n.length,r=n[i-1],s=[],o=0;o<i;++o)e=n[o],s.push(sc([.9486832980505138*r[0]+.31622776601683794*e[0],.9486832980505138*r[1]+.31622776601683794*e[1],.9486832980505138*r[2]+.31622776601683794*e[2]]),sc([.9486832980505138*e[0]+.31622776601683794*r[0],.9486832980505138*e[1]+.31622776601683794*r[1],.9486832980505138*e[2]+.31622776601683794*r[2]])),r=e;return s})),n=[],i=[-1,0,0,1,0,1,4,5];e.forEach((function(t,r){for(var s=tc[r],o=s.length,a=n[r]=[],l=0;l<o;++l)e.push([s[l],t[(2*l+2)%(2*o)],t[(2*l+1)%(2*o)]]),i.push(r),a.push(rc(oc(t[(2*l+2)%(2*o)]),oc(t[(2*l+1)%(2*o)])))}));var r=e.map((function(e){return{project:t(e),face:e}}));return i.forEach((function(t,e){var n=r[t];n&&(n.children||(n.children=[])).push(r[e])})),Hh(r[0],(function(t,e){var i=ia(e),s=[i*ia(t),i*fa(t),fa(e)],o=t<-_a/2?e<0?6:4:t<0?e<0?2:0:t<_a/2?e<0?3:1:e<0?7:5,a=n[o];return r[ic(a[0],s)<0?8+3*o:ic(a[1],s)<0?8+3*o+1:ic(a[2],s)<0?8+3*o+2:o]})).angle(-30).scale(110.625).center([0,45])},geoProject:lc,geoGringortenQuincuncial:function(){return yc(Dl).scale(176.423)},geoPeirceQuincuncial:function(){return yc(Gl).scale(111.48)},geoQuantize:function(t,e){if(!(0<=(e=+e)&&e<=20))throw new Error("invalid digits");function n(t){var n=t.length,i=2,r=new Array(n);for(r[0]=+t[0].toFixed(e),r[1]=+t[1].toFixed(e);i<n;)r[i]=t[i],++i;return r}function i(t){return t.map(n)}function r(t){for(var e=n(t[0]),i=[e],r=1;r<t.length;r++){var s=n(t[r]);(s.length>2||s[0]!=e[0]||s[1]!=e[1])&&(i.push(s),e=s)}return 1===i.length&&t.length>1&&i.push(n(t[t.length-1])),i}function s(t){return t.map(r)}function o(t){if(null==t)return t;var e;switch(t.type){case"GeometryCollection":e={type:"GeometryCollection",geometries:t.geometries.map(o)};break;case"Point":e={type:"Point",coordinates:n(t.coordinates)};break;case"MultiPoint":e={type:t.type,coordinates:i(t.coordinates)};break;case"LineString":e={type:t.type,coordinates:r(t.coordinates)};break;case"MultiLineString":case"Polygon":e={type:t.type,coordinates:s(t.coordinates)};break;case"MultiPolygon":e={type:"MultiPolygon",coordinates:t.coordinates.map(s)};break;default:return t}return null!=t.bbox&&(e.bbox=t.bbox),e}function a(t){var e={type:"Feature",properties:t.properties,geometry:o(t.geometry)};return null!=t.id&&(e.id=t.id),null!=t.bbox&&(e.bbox=t.bbox),e}if(null!=t)switch(t.type){case"Feature":return a(t);case"FeatureCollection":var l={type:"FeatureCollection",features:t.features.map(a)};return null!=t.bbox&&(l.bbox=t.bbox),l;default:return o(t)}return t},geoQuincuncial:yc,geoRectangularPolyconic:function(){return Ha(mc).scale(131.215)},geoRectangularPolyconicRaw:mc,geoRobinson:function(){return Rr(vc).scale(152.63)},geoRobinsonRaw:vc,geoSatellite:function(){var t=2,e=0,n=Ar(bc),i=n(t,e);return i.distance=function(i){return arguments.length?n(t=+i,e):t},i.tilt=function(i){return arguments.length?n(t,e=i*Ea):e*wa},i.scale(432.147).clipAngle(Sa(1/t)*wa-1e-6)},geoSatelliteRaw:bc,geoSinuMollweide:function(){return Rr(Jl).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},geoSinuMollweideRaw:Jl,geoSinusoidal:function(){return Rr(Za).scale(152.63)},geoSinusoidalRaw:Za,geoStitch:function(t){if(null==t)return t;switch(t.type){case"Feature":return Lc(t);case"FeatureCollection":var e={type:"FeatureCollection",features:t.features.map(Lc)};return null!=t.bbox&&(e.bbox=t.bbox),e;default:return Pc(t)}},geoTimes:function(){return Rr(Dc).scale(146.153)},geoTimesRaw:Dc,geoTwoPointAzimuthal:Gc,geoTwoPointAzimuthalRaw:Fc,geoTwoPointAzimuthalUsa:function(){return Gc([-158,21.5],[-77,39]).clipAngle(60).scale(400)},geoTwoPointEquidistant:jc,geoTwoPointEquidistantRaw:qc,geoTwoPointEquidistantUsa:function(){return jc([-158,21.5],[-77,39]).clipAngle(130).scale(122.571)},geoVanDerGrinten:function(){return Rr(Bc).scale(79.4183)},geoVanDerGrintenRaw:Bc,geoVanDerGrinten2:function(){return Rr(Uc).scale(79.4183)},geoVanDerGrinten2Raw:Uc,geoVanDerGrinten3:function(){return Rr(Yc).scale(79.4183)},geoVanDerGrinten3Raw:Yc,geoVanDerGrinten4:function(){return Rr(Wc).scale(127.16)},geoVanDerGrinten4Raw:Wc,geoWagner:Xc,geoWagner7:function(){return Xc().poleline(65).parallels(60).inflation(0).ratio(200).scale(172.633)},geoWagnerRaw:$c,geoWagner4:function(){return Rr(Zc).scale(176.84)},geoWagner4Raw:Zc,geoWagner6:function(){return Rr(Jc).scale(152.63)},geoWagner6Raw:Jc,geoWiechel:function(){return Rr(Qc).rotate([0,-90,45]).scale(124.75).clipAngle(179.999)},geoWiechelRaw:Qc,geoWinkel3:function(){return Rr(Kc).scale(158.837)},geoWinkel3Raw:Kc});const eu=Object.assign({},us,tu);const nu=Object.assign({},{geoAzimuthalEquidistant:Br});const iu=Object.assign({},{geoHufnagel:th});const ru=Object.assign({},{geoProjection:Rr});function su(t,e){const{abs:n,atan:i,ln:r,PI:s,sin:o,sqrt:a}=Math,l=1e-5,h=o(t);let c=a(1-e),u=h*h;if(u>=1||n(t)===s/2){if(c<=l)return h<0?-1/0:1/0;for(u=e=1,e+=c;n(u-c)>.001*e;)c=a(u*c),u=e/=2,e+=c;return h<0?-s/e:s/e}{if(c<=l)return r((1+h)/(1-h))/2;let t,o,f,d,p;for(o=0,t=e=1,f=e*c,e+=c,p=a((1-u)/u),n(p-=f/p)<=0&&(p=1e-9*a(f));n(t-c)>.001*t;)c=2*a(f),o+=o,p<0&&(o+=1),f=e*c,t=e,e+=c,n(p-=f/p)<=0&&(p=1e-9*a(f));return p<0&&(o+=1),d=(i(e/p)+s*o)/e,h<0?-d:d}}const{abs:ou,max:au,min:lu,sin:hu,cos:cu,asin:uu,acos:fu,tan:du}=Math;function pu(t,e){let n,i,r,s;const o=du(.5*e);return n=cu(uu(o))*hu(.5*t),r=o+n<0,s=o-n<0,i=fu(o),n=fu(n),function(t,e,n,i){let r=Math.asin(Math.sqrt(1+Math.min(0,Math.cos(t+e))));n&&(r=-r);let s=Math.asin(Math.sqrt(Math.abs(1-Math.max(0,Math.cos(t-e)))));return i&&(s=-s),[su(r,.5),su(s,.5)]}(n,i,r,s)}var gu=6378137,_u=.0066943799901413165,yu=484813681109536e-20,mu=Math.PI/2,xu=1e-10,vu=.017453292519943295,bu=57.29577951308232,Mu=Math.PI/4,wu=2*Math.PI,Eu=3.14159265359,Nu={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667},Su={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},Iu=/[\s_\-\/\(\)]/g;function ku(t,e){if(t[e])return t[e];for(var n,i=Object.keys(t),r=e.toLowerCase().replace(Iu,""),s=-1;++s<i.length;)if((n=i[s]).toLowerCase().replace(Iu,"")===r)return t[n]}function Ou(t){var e,n,i,r={},s=t.split("+").map((function(t){return t.trim()})).filter((function(t){return t})).reduce((function(t,e){var n=e.split("=");return n.push(!0),t[n[0].toLowerCase()]=n[1],t}),{}),o={proj:"projName",datum:"datumCode",rf:function(t){r.rf=parseFloat(t)},lat_0:function(t){r.lat0=t*vu},lat_1:function(t){r.lat1=t*vu},lat_2:function(t){r.lat2=t*vu},lat_ts:function(t){r.lat_ts=t*vu},lon_0:function(t){r.long0=t*vu},lon_1:function(t){r.long1=t*vu},lon_2:function(t){r.long2=t*vu},alpha:function(t){r.alpha=parseFloat(t)*vu},gamma:function(t){r.rectified_grid_angle=parseFloat(t)},lonc:function(t){r.longc=t*vu},x_0:function(t){r.x0=parseFloat(t)},y_0:function(t){r.y0=parseFloat(t)},k_0:function(t){r.k0=parseFloat(t)},k:function(t){r.k0=parseFloat(t)},a:function(t){r.a=parseFloat(t)},b:function(t){r.b=parseFloat(t)},r_a:function(){r.R_A=!0},zone:function(t){r.zone=parseInt(t,10)},south:function(){r.utmSouth=!0},towgs84:function(t){r.datum_params=t.split(",").map((function(t){return parseFloat(t)}))},to_meter:function(t){r.to_meter=parseFloat(t)},units:function(t){r.units=t;var e=ku(Su,t);e&&(r.to_meter=e.to_meter)},from_greenwich:function(t){r.from_greenwich=t*vu},pm:function(t){var e=ku(Nu,t);r.from_greenwich=(e||parseFloat(t))*vu},nadgrids:function(t){"@null"===t?r.datumCode="none":r.nadgrids=t},axis:function(t){var e="ewnsud";3===t.length&&-1!==e.indexOf(t.substr(0,1))&&-1!==e.indexOf(t.substr(1,1))&&-1!==e.indexOf(t.substr(2,1))&&(r.axis=t)},approx:function(){r.approx=!0}};for(e in s)n=s[e],e in o?"function"==typeof(i=o[e])?i(n):r[i]=n:r[e]=n;return"string"==typeof r.datumCode&&"WGS84"!==r.datumCode&&(r.datumCode=r.datumCode.toLowerCase()),r}var Cu=/\s/,Tu=/[A-Za-z]/,Ru=/[A-Za-z84_]/,Au=/[,\]]/,Lu=/[\d\.E\-\+]/;function Pu(t){if("string"!=typeof t)throw new Error("not a string");this.text=t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=1}function Du(t,e,n){Array.isArray(e)&&(n.unshift(e),e=null);var i=e?{}:t,r=n.reduce((function(t,e){return zu(e,t),t}),i);e&&(t[e]=r)}function zu(t,e){if(Array.isArray(t)){var n=t.shift();if("PARAMETER"===n&&(n=t.shift()),1===t.length)return Array.isArray(t[0])?(e[n]={},void zu(t[0],e[n])):void(e[n]=t[0]);if(t.length)if("TOWGS84"!==n){if("AXIS"===n)return n in e||(e[n]=[]),void e[n].push(t);var i;switch(Array.isArray(n)||(e[n]={}),n){case"UNIT":case"PRIMEM":case"VERT_DATUM":return e[n]={name:t[0].toLowerCase(),convert:t[1]},void(3===t.length&&zu(t[2],e[n]));case"SPHEROID":case"ELLIPSOID":return e[n]={name:t[0],a:t[1],rf:t[2]},void(4===t.length&&zu(t[3],e[n]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return t[0]=["name",t[0]],void Du(e,n,t);default:for(i=-1;++i<t.length;)if(!Array.isArray(t[i]))return zu(t,e[n]);return Du(e,n,t)}}else e[n]=t;else e[n]=!0}else e[t]=!0}Pu.prototype.readCharicter=function(){var t=this.text[this.place++];if(4!==this.state)for(;Cu.test(t);){if(this.place>=this.text.length)return;t=this.text[this.place++]}switch(this.state){case 1:return this.neutral(t);case 2:return this.keyword(t);case 4:return this.quoted(t);case 5:return this.afterquote(t);case 3:return this.number(t);case-1:return}},Pu.prototype.afterquote=function(t){if('"'===t)return this.word+='"',void(this.state=4);if(Au.test(t))return this.word=this.word.trim(),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in afterquote yet, index '+this.place)},Pu.prototype.afterItem=function(t){return","===t?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=1)):"]"===t?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=1,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},Pu.prototype.number=function(t){if(!Lu.test(t)){if(Au.test(t))return this.word=parseFloat(this.word),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in number yet, index '+this.place)}this.word+=t},Pu.prototype.quoted=function(t){'"'!==t?this.word+=t:this.state=5},Pu.prototype.keyword=function(t){if(Ru.test(t))this.word+=t;else{if("["===t){var e=[];return e.push(this.word),this.level++,null===this.root?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,void(this.state=1)}if(!Au.test(t))throw new Error("havn't handled \""+t+'" in keyword yet, index '+this.place);this.afterItem(t)}},Pu.prototype.neutral=function(t){if(Tu.test(t))return this.word=t,void(this.state=2);if('"'===t)return this.word="",void(this.state=4);if(Lu.test(t))return this.word=t,void(this.state=3);if(!Au.test(t))throw new Error("havn't handled \""+t+'" in neutral yet, index '+this.place);this.afterItem(t)},Pu.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function Fu(t){return.017453292519943295*t}function Gu(t){var e=new Pu(t).output(),n=e.shift(),i=e.shift();e.unshift(["name",i]),e.unshift(["type",n]);var r={};return zu(e,r),function(t){if("GEOGCS"===t.type?t.projName="longlat":"LOCAL_CS"===t.type?(t.projName="identity",t.local=!0):"object"==typeof t.PROJECTION?t.projName=Object.keys(t.PROJECTION)[0]:t.projName=t.PROJECTION,t.AXIS){for(var e="",n=0,i=t.AXIS.length;n<i;++n){var r=[t.AXIS[n][0].toLowerCase(),t.AXIS[n][1].toLowerCase()];-1!==r[0].indexOf("north")||("y"===r[0]||"lat"===r[0])&&"north"===r[1]?e+="n":-1!==r[0].indexOf("south")||("y"===r[0]||"lat"===r[0])&&"south"===r[1]?e+="s":-1!==r[0].indexOf("east")||("x"===r[0]||"lon"===r[0])&&"east"===r[1]?e+="e":-1===r[0].indexOf("west")&&("x"!==r[0]&&"lon"!==r[0]||"west"!==r[1])||(e+="w")}2===e.length&&(e+="u"),3===e.length&&(t.axis=e)}t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),"metre"===t.units&&(t.units="meter"),t.UNIT.convert&&("GEOGCS"===t.type?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a):t.to_meter=t.UNIT.convert));var s=t.GEOGCS;function o(e){return e*(t.to_meter||1)}"GEOGCS"===t.type&&(s=t),s&&(s.DATUM?t.datumCode=s.DATUM.name.toLowerCase():t.datumCode=s.name.toLowerCase(),"d_"===t.datumCode.slice(0,2)&&(t.datumCode=t.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==t.datumCode&&"new_zealand_1949"!==t.datumCode||(t.datumCode="nzgd49"),"wgs_1984"!==t.datumCode&&"world_geodetic_system_1984"!==t.datumCode||("Mercator_Auxiliary_Sphere"===t.PROJECTION&&(t.sphere=!0),t.datumCode="wgs84"),"_ferro"===t.datumCode.slice(-6)&&(t.datumCode=t.datumCode.slice(0,-6)),"_jakarta"===t.datumCode.slice(-8)&&(t.datumCode=t.datumCode.slice(0,-8)),~t.datumCode.indexOf("belge")&&(t.datumCode="rnb72"),s.DATUM&&s.DATUM.SPHEROID&&(t.ellps=s.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===t.ellps.toLowerCase().slice(0,13)&&(t.ellps="intl"),t.a=s.DATUM.SPHEROID.a,t.rf=parseFloat(s.DATUM.SPHEROID.rf,10)),s.DATUM&&s.DATUM.TOWGS84&&(t.datum_params=s.DATUM.TOWGS84),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36"),~t.datumCode.indexOf("osni_1952")&&(t.datumCode="osni52"),(~t.datumCode.indexOf("tm65")||~t.datumCode.indexOf("geodetic_datum_of_1965"))&&(t.datumCode="ire65"),"ch1903+"===t.datumCode&&(t.datumCode="ch1903"),~t.datumCode.indexOf("israel")&&(t.datumCode="isr93")),t.b&&!isFinite(t.b)&&(t.b=t.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Fu],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Fu],["x0","false_easting",o],["y0","false_northing",o],["long0","central_meridian",Fu],["lat0","latitude_of_origin",Fu],["lat0","standard_parallel_1",Fu],["lat1","standard_parallel_1",Fu],["lat2","standard_parallel_2",Fu],["azimuth","Azimuth"],["alpha","azimuth",Fu],["srsCode","name"]].forEach((function(e){return function(t,e){var n=e[0],i=e[1];!(n in t)&&i in t&&(t[n]=t[i],3===e.length&&(t[n]=e[2](t[n])))}(t,e)})),t.long0||!t.longc||"Albers_Conic_Equal_Area"!==t.projName&&"Lambert_Azimuthal_Equal_Area"!==t.projName||(t.long0=t.longc),t.lat_ts||!t.lat1||"Stereographic_South_Pole"!==t.projName&&"Polar Stereographic (variant B)"!==t.projName||(t.lat0=Fu(t.lat1>0?90:-90),t.lat_ts=t.lat1)}(r),r}function qu(t){var e=this;if(2===arguments.length){var n=arguments[1];"string"==typeof n?"+"===n.charAt(0)?qu[t]=Ou(arguments[1]):qu[t]=Gu(arguments[1]):qu[t]=n}else if(1===arguments.length){if(Array.isArray(t))return t.map((function(t){Array.isArray(t)?qu.apply(e,t):qu(t)}));if("string"==typeof t){if(t in qu)return qu[t]}else"EPSG"in t?qu["EPSG:"+t.EPSG]=t:"ESRI"in t?qu["ESRI:"+t.ESRI]=t:"IAU2000"in t?qu["IAU2000:"+t.IAU2000]=t:console.log(t);return}}!function(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}(qu);var ju=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];var Bu=["3857","900913","3785","102113"];function Uu(t){if(!function(t){return"string"==typeof t}(t))return t;if(function(t){return t in qu}(t))return qu[t];if(function(t){return ju.some((function(e){return t.indexOf(e)>-1}))}(t)){var e=Gu(t);if(function(t){var e=ku(t,"authority");if(e){var n=ku(e,"epsg");return n&&Bu.indexOf(n)>-1}}(e))return qu["EPSG:3857"];var n=function(t){var e=ku(t,"extension");if(e)return ku(e,"proj4")}(e);return n?Ou(n):e}return function(t){return"+"===t[0]}(t)?Ou(t):void 0}function Yu(t,e){var n,i;if(t=t||{},!e)return t;for(i in e)void 0!==(n=e[i])&&(t[i]=n);return t}function Wu(t,e,n){var i=t*e;return n/Math.sqrt(1-i*i)}function $u(t){return t<0?-1:1}function Xu(t){return Math.abs(t)<=Eu?t:t-$u(t)*wu}function Vu(t,e,n){var i=t*n,r=.5*t;return i=Math.pow((1-i)/(1+i),r),Math.tan(.5*(mu-e))/i}function Hu(t,e){for(var n,i,r=.5*t,s=mu-2*Math.atan(e),o=0;o<=15;o++)if(n=t*Math.sin(s),s+=i=mu-2*Math.atan(e*Math.pow((1-n)/(1+n),r))-s,Math.abs(i)<=1e-10)return s;return-9999}var Zu={init:function(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Wu(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},forward:function(t){var e,n,i=t.x,r=t.y;if(r*bu>90&&r*bu<-90&&i*bu>180&&i*bu<-180)return null;if(Math.abs(Math.abs(r)-mu)<=xu)return null;if(this.sphere)e=this.x0+this.a*this.k0*Xu(i-this.long0),n=this.y0+this.a*this.k0*Math.log(Math.tan(Mu+.5*r));else{var s=Math.sin(r),o=Vu(this.e,r,s);e=this.x0+this.a*this.k0*Xu(i-this.long0),n=this.y0-this.a*this.k0*Math.log(o)}return t.x=e,t.y=n,t},inverse:function(t){var e,n,i=t.x-this.x0,r=t.y-this.y0;if(this.sphere)n=mu-2*Math.atan(Math.exp(-r/(this.a*this.k0)));else{var s=Math.exp(-r/(this.a*this.k0));if(-9999===(n=Hu(this.e,s)))return null}return e=Xu(this.long0+i/(this.a*this.k0)),t.x=e,t.y=n,t},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]};function Ju(t){return t}var Qu=[Zu,{init:function(){},forward:Ju,inverse:Ju,names:["longlat","identity"]}],Ku={},tf=[];function ef(t,e){var n=tf.length;return t.names?(tf[n]=t,t.names.forEach((function(t){Ku[t.toLowerCase()]=n})),this):(console.log(e),!0)}var nf={start:function(){Qu.forEach(ef)},add:ef,get:function(t){if(!t)return!1;var e=t.toLowerCase();return void 0!==Ku[e]&&tf[Ku[e]]?tf[Ku[e]]:void 0}},rf={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},sf=rf.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};rf.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var of={};of.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},of.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},of.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},of.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},of.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},of.potsdam={towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},of.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},of.hermannskogel={towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},of.osni52={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},of.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},of.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},of.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},of.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},of.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},of.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},of.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},of.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"};var af={};function lf(t){if(0===t.length)return null;var e="@"===t[0];return e&&(t=t.slice(1)),"null"===t?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:t,mandatory:!e,grid:af[t]||null,isNull:!1}}function hf(t){return t/3600*Math.PI/180}function cf(t,e,n){return String.fromCharCode.apply(null,new Uint8Array(t.buffer.slice(e,n)))}function uf(t){return t.map((function(t){return[hf(t.longitudeShift),hf(t.latitudeShift)]}))}function ff(t,e,n){return{name:cf(t,e+8,e+16).trim(),parent:cf(t,e+24,e+24+8).trim(),lowerLatitude:t.getFloat64(e+72,n),upperLatitude:t.getFloat64(e+88,n),lowerLongitude:t.getFloat64(e+104,n),upperLongitude:t.getFloat64(e+120,n),latitudeInterval:t.getFloat64(e+136,n),longitudeInterval:t.getFloat64(e+152,n),gridNodeCount:t.getInt32(e+168,n)}}function df(t,e,n,i){for(var r=e+176,s=[],o=0;o<n.gridNodeCount;o++){var a={latitudeShift:t.getFloat32(r+16*o,i),longitudeShift:t.getFloat32(r+16*o+4,i),latitudeAccuracy:t.getFloat32(r+16*o+8,i),longitudeAccuracy:t.getFloat32(r+16*o+12,i)};s.push(a)}return s}function pf(t,e){if(!(this instanceof pf))return new pf(t);e=e||function(t){if(t)throw t};var n=Uu(t);if("object"==typeof n){var i=pf.projections.get(n.projName);if(i){if(n.datumCode&&"none"!==n.datumCode){var r=ku(of,n.datumCode);r&&(n.datum_params=n.datum_params||(r.towgs84?r.towgs84.split(","):null),n.ellps=r.ellipse,n.datumName=r.datumName?r.datumName:n.datumCode)}n.k0=n.k0||1,n.axis=n.axis||"enu",n.ellps=n.ellps||"wgs84",n.lat1=n.lat1||n.lat0;var s=function(t,e,n,i,r){if(!t){var s=ku(rf,i);s||(s=sf),t=s.a,e=s.b,n=s.rf}return n&&!e&&(e=(1-1/n)*t),(0===n||Math.abs(t-e)<xu)&&(r=!0,e=t),{a:t,b:e,rf:n,sphere:r}}(n.a,n.b,n.rf,n.ellps,n.sphere),o=function(t,e,n,i){var r=t*t,s=e*e,o=(r-s)/r,a=0;return i?(r=(t*=1-o*(.16666666666666666+o*(.04722222222222222+.022156084656084655*o)))*t,o=0):a=Math.sqrt(o),{es:o,e:a,ep2:(r-s)/s}}(s.a,s.b,s.rf,n.R_A),a=function(t){return void 0===t?null:t.split(",").map(lf)}(n.nadgrids),l=n.datum||function(t,e,n,i,r,s,o){var a={};return a.datum_type=void 0===t||"none"===t?5:4,e&&(a.datum_params=e.map(parseFloat),0===a.datum_params[0]&&0===a.datum_params[1]&&0===a.datum_params[2]||(a.datum_type=1),a.datum_params.length>3&&(0===a.datum_params[3]&&0===a.datum_params[4]&&0===a.datum_params[5]&&0===a.datum_params[6]||(a.datum_type=2,a.datum_params[3]*=yu,a.datum_params[4]*=yu,a.datum_params[5]*=yu,a.datum_params[6]=a.datum_params[6]/1e6+1))),o&&(a.datum_type=3,a.grids=o),a.a=n,a.b=i,a.es=r,a.ep2=s,a}(n.datumCode,n.datum_params,s.a,s.b,o.es,o.ep2,a);Yu(this,n),Yu(this,i),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=o.es,this.e=o.e,this.ep2=o.ep2,this.datum=l,this.init(),e(null,this)}else e(t)}else e(t)}function gf(t,e,n){var i,r,s,o,a=t.x,l=t.y,h=t.z?t.z:0;if(l<-mu&&l>-1.001*mu)l=-mu;else if(l>mu&&l<1.001*mu)l=mu;else{if(l<-mu)return{x:-1/0,y:-1/0,z:t.z};if(l>mu)return{x:1/0,y:1/0,z:t.z}}return a>Math.PI&&(a-=2*Math.PI),r=Math.sin(l),o=Math.cos(l),s=r*r,{x:((i=n/Math.sqrt(1-e*s))+h)*o*Math.cos(a),y:(i+h)*o*Math.sin(a),z:(i*(1-e)+h)*r}}function _f(t,e,n,i){var r,s,o,a,l,h,c,u,f,d,p,g,_,y,m,x=1e-12,v=t.x,b=t.y,M=t.z?t.z:0;if(r=Math.sqrt(v*v+b*b),s=Math.sqrt(v*v+b*b+M*M),r/n<x){if(y=0,s/n<x)return mu,m=-i,{x:t.x,y:t.y,z:t.z}}else y=Math.atan2(b,v);o=M/s,u=(a=r/s)*(1-e)*(l=1/Math.sqrt(1-e*(2-e)*a*a)),f=o*l,_=0;do{_++,h=e*(c=n/Math.sqrt(1-e*f*f))/(c+(m=r*u+M*f-c*(1-e*f*f))),g=(p=o*(l=1/Math.sqrt(1-h*(2-h)*a*a)))*u-(d=a*(1-h)*l)*f,u=d,f=p}while(g*g>1e-24&&_<30);return{x:y,y:Math.atan(p/Math.abs(d)),z:m}}function yf(t){return 1===t||2===t}function mf(t,e,n){if(function(t,e){return t.datum_type===e.datum_type&&!(t.a!==e.a||Math.abs(t.es-e.es)>5e-11)&&(1===t.datum_type?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]:2!==t.datum_type||t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]&&t.datum_params[3]===e.datum_params[3]&&t.datum_params[4]===e.datum_params[4]&&t.datum_params[5]===e.datum_params[5]&&t.datum_params[6]===e.datum_params[6])}(t,e))return n;if(5===t.datum_type||5===e.datum_type)return n;var i=t.a,r=t.es;if(3===t.datum_type){if(0!==xf(t,!1,n))return;i=gu,r=_u}var s=e.a,o=e.b,a=e.es;if(3===e.datum_type&&(s=gu,o=6356752.314,a=_u),r===a&&i===s&&!yf(t.datum_type)&&!yf(e.datum_type))return n;if((n=gf(n,r,i),yf(t.datum_type)&&(n=function(t,e,n){if(1===e)return{x:t.x+n[0],y:t.y+n[1],z:t.z+n[2]};if(2===e){var i=n[0],r=n[1],s=n[2],o=n[3],a=n[4],l=n[5],h=n[6];return{x:h*(t.x-l*t.y+a*t.z)+i,y:h*(l*t.x+t.y-o*t.z)+r,z:h*(-a*t.x+o*t.y+t.z)+s}}}(n,t.datum_type,t.datum_params)),yf(e.datum_type)&&(n=function(t,e,n){if(1===e)return{x:t.x-n[0],y:t.y-n[1],z:t.z-n[2]};if(2===e){var i=n[0],r=n[1],s=n[2],o=n[3],a=n[4],l=n[5],h=n[6],c=(t.x-i)/h,u=(t.y-r)/h,f=(t.z-s)/h;return{x:c+l*u-a*f,y:-l*c+u+o*f,z:a*c-o*u+f}}}(n,e.datum_type,e.datum_params)),n=_f(n,a,s,o),3===e.datum_type)&&0!==xf(e,!0,n))return;return n}function xf(t,e,n){if(null===t.grids||0===t.grids.length)return console.log("Grid shift grids not found"),-1;for(var i={x:-n.x,y:n.y},r={x:Number.NaN,y:Number.NaN},s=[],o=0;o<t.grids.length;o++){var a=t.grids[o];if(s.push(a.name),a.isNull){r=i;break}if(a.mandatory,null!==a.grid){var l=a.grid.subgrids[0],h=(Math.abs(l.del[1])+Math.abs(l.del[0]))/1e4,c=l.ll[0]-h,u=l.ll[1]-h,f=l.ll[0]+(l.lim[0]-1)*l.del[0]+h,d=l.ll[1]+(l.lim[1]-1)*l.del[1]+h;if(!(u>i.y||c>i.x||d<i.y||f<i.x||(r=vf(i,e,l),isNaN(r.x))))break}else if(a.mandatory)return console.log("Unable to find mandatory grid '"+a.name+"'"),-1}return isNaN(r.x)?(console.log("Failed to find a grid shift table for location '"+-i.x*bu+" "+i.y*bu+" tried: '"+s+"'"),-1):(n.x=-r.x,n.y=r.y,0)}function vf(t,e,n){var i={x:Number.NaN,y:Number.NaN};if(isNaN(t.x))return i;var r={x:t.x,y:t.y};r.x-=n.ll[0],r.y-=n.ll[1],r.x=Xu(r.x-Math.PI)+Math.PI;var s=bf(r,n);if(e){if(isNaN(s.x))return i;s.x=r.x-s.x,s.y=r.y-s.y;var o,a,l=9;do{if(a=bf(s,n),isNaN(a.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}o={x:r.x-(a.x+s.x),y:r.y-(a.y+s.y)},s.x+=o.x,s.y+=o.y}while(l--&&Math.abs(o.x)>1e-12&&Math.abs(o.y)>1e-12);if(l<0)return console.log("Inverse grid shift iterator failed to converge."),i;i.x=Xu(s.x+n.ll[0]),i.y=s.y+n.ll[1]}else isNaN(s.x)||(i.x=t.x+s.x,i.y=t.y+s.y);return i}function bf(t,e){var n,i={x:t.x/e.del[0],y:t.y/e.del[1]},r=Math.floor(i.x),s=Math.floor(i.y),o=i.x-1*r,a=i.y-1*s,l={x:Number.NaN,y:Number.NaN};if(r<0||r>=e.lim[0])return l;if(s<0||s>=e.lim[1])return l;n=s*e.lim[0]+r;var h=e.cvs[n][0],c=e.cvs[n][1];n++;var u=e.cvs[n][0],f=e.cvs[n][1];n+=e.lim[0];var d=e.cvs[n][0],p=e.cvs[n][1];n--;var g=e.cvs[n][0],_=e.cvs[n][1],y=o*a,m=o*(1-a),x=(1-o)*(1-a),v=(1-o)*a;return l.x=x*h+m*u+v*g+y*d,l.y=x*c+m*f+v*_+y*p,l}function Mf(t,e,n){var i,r,s,o=n.x,a=n.y,l=n.z||0,h={};for(s=0;s<3;s++)if(!e||2!==s||void 0!==n.z)switch(0===s?(i=o,r=-1!=="ew".indexOf(t.axis[s])?"x":"y"):1===s?(i=a,r=-1!=="ns".indexOf(t.axis[s])?"y":"x"):(i=l,r="z"),t.axis[s]){case"e":case"n":h[r]=i;break;case"w":case"s":h[r]=-i;break;case"u":void 0!==n[r]&&(h.z=i);break;case"d":void 0!==n[r]&&(h.z=-i);break;default:return null}return h}function wf(t){var e={x:t[0],y:t[1]};return t.length>2&&(e.z=t[2]),t.length>3&&(e.m=t[3]),e}function Ef(t){if("function"==typeof Number.isFinite){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof t||t!=t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}function Nf(t,e,n,i){var r;if(Array.isArray(n)&&(n=wf(n)),function(t){Ef(t.x),Ef(t.y)}(n),t.datum&&e.datum&&function(t,e){return(1===t.datum.datum_type||2===t.datum.datum_type)&&"WGS84"!==e.datumCode||(1===e.datum.datum_type||2===e.datum.datum_type)&&"WGS84"!==t.datumCode}(t,e)&&(n=Nf(t,r=new pf("WGS84"),n,i),t=r),i&&"enu"!==t.axis&&(n=Mf(t,!1,n)),"longlat"===t.projName)n={x:n.x*vu,y:n.y*vu,z:n.z||0};else if(t.to_meter&&(n={x:n.x*t.to_meter,y:n.y*t.to_meter,z:n.z||0}),!(n=t.inverse(n)))return;if(t.from_greenwich&&(n.x+=t.from_greenwich),n=mf(t.datum,e.datum,n))return e.from_greenwich&&(n={x:n.x-e.from_greenwich,y:n.y,z:n.z||0}),"longlat"===e.projName?n={x:n.x*bu,y:n.y*bu,z:n.z||0}:(n=e.forward(n),e.to_meter&&(n={x:n.x/e.to_meter,y:n.y/e.to_meter,z:n.z||0})),i&&"enu"!==e.axis?Mf(e,!0,n):n}pf.projections=nf,pf.projections.start();var Sf=pf("WGS84");function If(t,e,n,i){var r,s,o;return Array.isArray(n)?(r=Nf(t,e,n,i)||{x:NaN,y:NaN},n.length>2?void 0!==t.name&&"geocent"===t.name||void 0!==e.name&&"geocent"===e.name?"number"==typeof r.z?[r.x,r.y,r.z].concat(n.splice(3)):[r.x,r.y,n[2]].concat(n.splice(3)):[r.x,r.y].concat(n.splice(2)):[r.x,r.y]):(s=Nf(t,e,n,i),2===(o=Object.keys(n)).length||o.forEach((function(i){if(void 0!==t.name&&"geocent"===t.name||void 0!==e.name&&"geocent"===e.name){if("x"===i||"y"===i||"z"===i)return}else if("x"===i||"y"===i)return;s[i]=n[i]})),s)}function kf(t){return t instanceof pf?t:t.oProj?t.oProj:pf(t)}function Of(t,e,n){t=kf(t);var i,r=!1;return void 0===e?(e=t,t=Sf,r=!0):(void 0!==e.x||Array.isArray(e))&&(n=e,e=t,t=Sf,r=!0),e=kf(e),n?If(t,e,n):(i={forward:function(n,i){return If(t,e,n,i)},inverse:function(n,i){return If(e,t,n,i)}},r&&(i.oProj=e),i)}var Cf="AJSAJS",Tf="AFAFAF",Rf=65,Af=73,Lf=79,Pf=86,Df=90,zf={forward:Ff,inverse:function(t){var e=Bf(Wf(t.toUpperCase()));if(e.lat&&e.lon)return[e.lon,e.lat,e.lon,e.lat];return[e.left,e.bottom,e.right,e.top]},toPoint:Gf};function Ff(t,e){return e=e||5,function(t,e){var n="00000"+t.easting,i="00000"+t.northing;return t.zoneNumber+t.zoneLetter+(r=t.easting,s=t.northing,o=t.zoneNumber,a=Yf(o),l=Math.floor(r/1e5),h=Math.floor(s/1e5)%20,function(t,e,n){var i=n-1,r=Cf.charCodeAt(i),s=Tf.charCodeAt(i),o=r+t-1,a=s+e,l=!1;return o>Df&&(o=o-Df+Rf-1,l=!0),(o===Af||r<Af&&o>Af||(o>Af||r<Af)&&l)&&o++,(o===Lf||r<Lf&&o>Lf||(o>Lf||r<Lf)&&l)&&++o===Af&&o++,o>Df&&(o=o-Df+Rf-1),a>Pf?(a=a-Pf+Rf-1,l=!0):l=!1,(a===Af||s<Af&&a>Af||(a>Af||s<Af)&&l)&&a++,(a===Lf||s<Lf&&a>Lf||(a>Lf||s<Lf)&&l)&&++a===Af&&a++,a>Pf&&(a=a-Pf+Rf-1),String.fromCharCode(o)+String.fromCharCode(a)}(l,h,a))+n.substr(n.length-5,e)+i.substr(i.length-5,e);var r,s,o,a,l,h}(function(t){var e,n,i,r,s,o,a,l,h=t.lat,c=t.lon,u=6378137,f=.00669438,d=.9996,p=qf(h),g=qf(c);l=Math.floor((c+180)/6)+1,180===c&&(l=60);h>=56&&h<64&&c>=3&&c<12&&(l=32);h>=72&&h<84&&(c>=0&&c<9?l=31:c>=9&&c<21?l=33:c>=21&&c<33?l=35:c>=33&&c<42&&(l=37));a=qf(6*(l-1)-180+3),e=f/(1-f),n=u/Math.sqrt(1-f*Math.sin(p)*Math.sin(p)),i=Math.tan(p)*Math.tan(p),r=e*Math.cos(p)*Math.cos(p),s=Math.cos(p)*(g-a),o=u*((1-f/4-3*f*f/64-5*f*f*f/256)*p-(3*f/8+3*f*f/32+45*f*f*f/1024)*Math.sin(2*p)+(15*f*f/256+45*f*f*f/1024)*Math.sin(4*p)-35*f*f*f/3072*Math.sin(6*p));var _=d*n*(s+(1-i+r)*s*s*s/6+(5-18*i+i*i+72*r-58*e)*s*s*s*s*s/120)+5e5,y=d*(o+n*Math.tan(p)*(s*s/2+(5-i+9*r+4*r*r)*s*s*s*s/24+(61-58*i+i*i+600*r-330*e)*s*s*s*s*s*s/720));h<0&&(y+=1e7);return{northing:Math.round(y),easting:Math.round(_),zoneNumber:l,zoneLetter:Uf(h)}}({lat:t[1],lon:t[0]}),e)}function Gf(t){var e=Bf(Wf(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function qf(t){return t*(Math.PI/180)}function jf(t){return t/Math.PI*180}function Bf(t){var e=t.northing,n=t.easting,i=t.zoneLetter,r=t.zoneNumber;if(r<0||r>60)return null;var s,o,a,l,h,c,u,f,d,p=.9996,g=6378137,_=.00669438,y=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),m=n-5e5,x=e;i<"N"&&(x-=1e7),u=6*(r-1)-180+3,s=.006739496752268451,d=(f=x/p/6367449.145945056)+(3*y/2-27*y*y*y/32)*Math.sin(2*f)+(21*y*y/16-55*y*y*y*y/32)*Math.sin(4*f)+151*y*y*y/96*Math.sin(6*f),o=g/Math.sqrt(1-_*Math.sin(d)*Math.sin(d)),a=Math.tan(d)*Math.tan(d),l=s*Math.cos(d)*Math.cos(d),h=.99330562*g/Math.pow(1-_*Math.sin(d)*Math.sin(d),1.5),c=m/(o*p);var v=d-o*Math.tan(d)/h*(c*c/2-(5+3*a+10*l-4*l*l-9*s)*c*c*c*c/24+(61+90*a+298*l+45*a*a-1.6983531815716497-3*l*l)*c*c*c*c*c*c/720);v=jf(v);var b,M=(c-(1+2*a+l)*c*c*c/6+(5-2*l+28*a-3*l*l+8*s+24*a*a)*c*c*c*c*c/120)/Math.cos(d);if(M=u+jf(M),t.accuracy){var w=Bf({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});b={top:w.lat,right:w.lon,bottom:v,left:M}}else b={lat:v,lon:M};return b}function Uf(t){var e="Z";return 84>=t&&t>=72?e="X":72>t&&t>=64?e="W":64>t&&t>=56?e="V":56>t&&t>=48?e="U":48>t&&t>=40?e="T":40>t&&t>=32?e="S":32>t&&t>=24?e="R":24>t&&t>=16?e="Q":16>t&&t>=8?e="P":8>t&&t>=0?e="N":0>t&&t>=-8?e="M":-8>t&&t>=-16?e="L":-16>t&&t>=-24?e="K":-24>t&&t>=-32?e="J":-32>t&&t>=-40?e="H":-40>t&&t>=-48?e="G":-48>t&&t>=-56?e="F":-56>t&&t>=-64?e="E":-64>t&&t>=-72?e="D":-72>t&&t>=-80&&(e="C"),e}function Yf(t){var e=t%6;return 0===e&&(e=6),e}function Wf(t){if(t&&0===t.length)throw"MGRSPoint coverting from nothing";for(var e,n=t.length,i=null,r="",s=0;!/[A-Z]/.test(e=t.charAt(s));){if(s>=2)throw"MGRSPoint bad conversion from: "+t;r+=e,s++}var o=parseInt(r,10);if(0===s||s+3>n)throw"MGRSPoint bad conversion from: "+t;var a=t.charAt(s++);if(a<="A"||"B"===a||"Y"===a||a>="Z"||"I"===a||"O"===a)throw"MGRSPoint zone letter "+a+" not handled: "+t;i=t.substring(s,s+=2);for(var l=Yf(o),h=function(t,e){var n=Cf.charCodeAt(e-1),i=1e5,r=!1;for(;n!==t.charCodeAt(0);){if(++n===Af&&n++,n===Lf&&n++,n>Df){if(r)throw"Bad character: "+t;n=Rf,r=!0}i+=1e5}return i}(i.charAt(0),l),c=function(t,e){if(t>"V")throw"MGRSPoint given invalid Northing "+t;var n=Tf.charCodeAt(e-1),i=0,r=!1;for(;n!==t.charCodeAt(0);){if(++n===Af&&n++,n===Lf&&n++,n>Pf){if(r)throw"Bad character: "+t;n=Rf,r=!0}i+=1e5}return i}(i.charAt(1),l);c<$f(a);)c+=2e6;var u=n-s;if(u%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+t;var f,d,p,g=u/2,_=0,y=0;return g>0&&(f=1e5/Math.pow(10,g),d=t.substring(s,s+g),_=parseFloat(d)*f,p=t.substring(s+g),y=parseFloat(p)*f),{easting:_+h,northing:y+c,zoneLetter:a,zoneNumber:o,accuracy:f}}function $f(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+t}function Xf(t,e,n){if(!(this instanceof Xf))return new Xf(t,e,n);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if("object"==typeof t)this.x=t.x,this.y=t.y,this.z=t.z||0;else if("string"==typeof t&&void 0===e){var i=t.split(",");this.x=parseFloat(i[0],10),this.y=parseFloat(i[1],10),this.z=parseFloat(i[2],10)||0}else this.x=t,this.y=e,this.z=n||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}Xf.fromMGRS=function(t){return new Xf(Gf(t))},Xf.prototype.toMGRS=function(t){return Ff([this.x,this.y],t)};var Vf=.046875,Hf=.01953125,Zf=.01068115234375;function Jf(t){var e=[];e[0]=1-t*(.25+t*(Vf+t*(Hf+t*Zf))),e[1]=t*(.75-t*(Vf+t*(Hf+t*Zf)));var n=t*t;return e[2]=n*(.46875-t*(.013020833333333334+.007120768229166667*t)),n*=t,e[3]=n*(.3645833333333333-.005696614583333333*t),e[4]=n*t*.3076171875,e}function Qf(t,e,n,i){return n*=e,e*=e,i[0]*t-n*(i[1]+e*(i[2]+e*(i[3]+e*i[4])))}function Kf(t,e,n){for(var i=1/(1-e),r=t,s=20;s;--s){var o=Math.sin(r),a=1-e*o*o;if(r-=a=(Qf(r,o,Math.cos(r),n)-t)*(a*Math.sqrt(a))*i,Math.abs(a)<xu)return r}return r}var td={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=Jf(this.es),this.ml0=Qf(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(t){var e,n,i,r=t.x,s=t.y,o=Xu(r-this.long0),a=Math.sin(s),l=Math.cos(s);if(this.es){var h=l*o,c=Math.pow(h,2),u=this.ep2*Math.pow(l,2),f=Math.pow(u,2),d=Math.abs(l)>xu?Math.tan(s):0,p=Math.pow(d,2),g=Math.pow(p,2);e=1-this.es*Math.pow(a,2),h/=Math.sqrt(e);var _=Qf(s,a,l,this.en);n=this.a*(this.k0*h*(1+c/6*(1-p+u+c/20*(5-18*p+g+14*u-58*p*u+c/42*(61+179*g-g*p-479*p)))))+this.x0,i=this.a*(this.k0*(_-this.ml0+a*o*h/2*(1+c/12*(5-p+9*u+4*f+c/30*(61+g-58*p+270*u-330*p*u+c/56*(1385+543*g-g*p-3111*p))))))+this.y0}else{var y=l*Math.sin(o);if(Math.abs(Math.abs(y)-1)<xu)return 93;if(n=.5*this.a*this.k0*Math.log((1+y)/(1-y))+this.x0,i=l*Math.cos(o)/Math.sqrt(1-Math.pow(y,2)),(y=Math.abs(i))>=1){if(y-1>xu)return 93;i=0}else i=Math.acos(i);s<0&&(i=-i),i=this.a*this.k0*(i-this.lat0)+this.y0}return t.x=n,t.y=i,t},inverse:function(t){var e,n,i,r,s=(t.x-this.x0)*(1/this.a),o=(t.y-this.y0)*(1/this.a);if(this.es)if(n=Kf(e=this.ml0+o/this.k0,this.es,this.en),Math.abs(n)<mu){var a=Math.sin(n),l=Math.cos(n),h=Math.abs(l)>xu?Math.tan(n):0,c=this.ep2*Math.pow(l,2),u=Math.pow(c,2),f=Math.pow(h,2),d=Math.pow(f,2);e=1-this.es*Math.pow(a,2);var p=s*Math.sqrt(e)/this.k0,g=Math.pow(p,2);i=n-(e*=h)*g/(1-this.es)*.5*(1-g/12*(5+3*f-9*c*f+c-4*u-g/30*(61+90*f-252*c*f+45*d+46*c-g/56*(1385+3633*f+4095*d+1574*d*f)))),r=Xu(this.long0+p*(1-g/6*(1+2*f+c-g/20*(5+28*f+24*d+8*c*f+6*c-g/42*(61+662*f+1320*d+720*d*f))))/l)}else i=mu*$u(o),r=0;else{var _=Math.exp(s/this.k0),y=.5*(_-1/_),m=this.lat0+o/this.k0,x=Math.cos(m);e=Math.sqrt((1-Math.pow(x,2))/(1+Math.pow(y,2))),i=Math.asin(e),o<0&&(i=-i),r=0===y&&0===x?0:Xu(Math.atan2(y,x)+this.long0)}return t.x=r,t.y=i,t},names:["Fast_Transverse_Mercator","Fast Transverse Mercator"]};function ed(t){var e=Math.exp(t);return e=(e-1/e)/2}function nd(t,e){t=Math.abs(t),e=Math.abs(e);var n=Math.max(t,e),i=Math.min(t,e)/(n||1);return n*Math.sqrt(1+Math.pow(i,2))}function id(t){var e=Math.abs(t);return e=function(t){var e=1+t,n=e-1;return 0===n?t:t*Math.log(e)/n}(e*(1+e/(nd(1,e)+1))),t<0?-e:e}function rd(t,e){for(var n,i=2*Math.cos(2*e),r=t.length-1,s=t[r],o=0;--r>=0;)n=i*s-o+t[r],o=s,s=n;return e+n*Math.sin(2*e)}function sd(t,e,n){for(var i,r,s=Math.sin(e),o=Math.cos(e),a=ed(n),l=function(t){var e=Math.exp(t);return(e+1/e)/2}(n),h=2*o*l,c=-2*s*a,u=t.length-1,f=t[u],d=0,p=0,g=0;--u>=0;)i=p,r=d,f=h*(p=f)-i-c*(d=g)+t[u],g=c*p-r+h*d;return[(h=s*l)*f-(c=o*a)*g,h*g+c*f]}var od={init:function(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(td.init.apply(this),this.forward=td.forward,this.inverse=td.inverse),this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),e=t/(2-t),n=e;this.cgb[0]=e*(2+e*(-2/3+e*(e*(116/45+e*(26/45+e*(-2854/675)))-2))),this.cbg[0]=e*(e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))-2),n*=e,this.cgb[1]=n*(7/3+e*(e*(-227/45+e*(2704/315+e*(2323/945)))-1.6)),this.cbg[1]=n*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),n*=e,this.cgb[2]=n*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=n*(-26/15+e*(34/21+e*(1.6+e*(-12686/2835)))),n*=e,this.cgb[3]=n*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=n*(1237/630+e*(e*(-24832/14175)-2.4)),n*=e,this.cgb[4]=n*(4174/315+e*(-144838/6237)),this.cbg[4]=n*(-734/315+e*(109598/31185)),n*=e,this.cgb[5]=n*(601676/22275),this.cbg[5]=n*(444337/155925),n=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+n*(1/4+n*(1/64+n/256))),this.utg[0]=e*(e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))-.5),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=n*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=n*(13/48+e*(e*(557/1440+e*(281/630+e*(-1983433/1935360)))-.6)),n*=e,this.utg[2]=n*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=n*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),n*=e,this.utg[3]=n*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=n*(49561/161280+e*(-179/168+e*(6601661/7257600))),n*=e,this.utg[4]=n*(-4583/161280+e*(108847/3991680)),this.gtu[4]=n*(34729/80640+e*(-3418889/1995840)),n*=e,this.utg[5]=n*(-20648693/638668800),this.gtu[5]=.6650675310896665*n;var i=rd(this.cbg,this.lat0);this.Zb=-this.Qn*(i+function(t,e){for(var n,i=2*Math.cos(e),r=t.length-1,s=t[r],o=0;--r>=0;)n=i*s-o+t[r],o=s,s=n;return Math.sin(e)*n}(this.gtu,2*i))},forward:function(t){var e=Xu(t.x-this.long0),n=t.y;n=rd(this.cbg,n);var i=Math.sin(n),r=Math.cos(n),s=Math.sin(e),o=Math.cos(e);n=Math.atan2(i,o*r),e=Math.atan2(s*r,nd(i,r*o)),e=id(Math.tan(e));var a,l,h=sd(this.gtu,2*n,2*e);return n+=h[0],e+=h[1],Math.abs(e)<=2.623395162778?(a=this.a*(this.Qn*e)+this.x0,l=this.a*(this.Qn*n+this.Zb)+this.y0):(a=1/0,l=1/0),t.x=a,t.y=l,t},inverse:function(t){var e,n,i=(t.x-this.x0)*(1/this.a),r=(t.y-this.y0)*(1/this.a);if(r=(r-this.Zb)/this.Qn,i/=this.Qn,Math.abs(i)<=2.623395162778){var s=sd(this.utg,2*r,2*i);r+=s[0],i+=s[1],i=Math.atan(ed(i));var o=Math.sin(r),a=Math.cos(r),l=Math.sin(i),h=Math.cos(i);r=Math.atan2(o*h,nd(l,h*a)),e=Xu((i=Math.atan2(l,h*a))+this.long0),n=rd(this.cgb,r)}else e=1/0,n=1/0;return t.x=e,t.y=n,t},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","tmerc"]};var ad={init:function(){var t=function(t,e){if(void 0===t){if((t=Math.floor(30*(Xu(e)+Math.PI)/Math.PI)+1)<0)return 0;if(t>60)return 60}return t}(this.zone,this.long0);if(void 0===t)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*vu,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,od.init.apply(this),this.forward=od.forward,this.inverse=od.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"};function ld(t,e){return Math.pow((1-t)/(1+t),e)}var hd={init:function(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+Mu)/(Math.pow(Math.tan(.5*this.lat0+Mu),this.C)*ld(this.e*t,this.ratexp))},forward:function(t){var e=t.x,n=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*n+Mu),this.C)*ld(this.e*Math.sin(n),this.ratexp))-mu,t.x=this.C*e,t},inverse:function(t){for(var e=t.x/this.C,n=t.y,i=Math.pow(Math.tan(.5*n+Mu)/this.K,1/this.C),r=20;r>0&&(n=2*Math.atan(i*ld(this.e*Math.sin(t.y),-.5*this.e))-mu,!(Math.abs(n-t.y)<1e-14));--r)t.y=n;return r?(t.x=e,t.y=n,t):null},names:["gauss"]};var cd={init:function(){hd.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(t){var e,n,i,r;return t.x=Xu(t.x-this.long0),hd.forward.apply(this,[t]),e=Math.sin(t.y),n=Math.cos(t.y),i=Math.cos(t.x),r=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*n*i),t.x=r*n*Math.sin(t.x),t.y=r*(this.cosc0*e-this.sinc0*n*i),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},inverse:function(t){var e,n,i,r,s;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,s=Math.sqrt(t.x*t.x+t.y*t.y)){var o=2*Math.atan2(s,this.R2);e=Math.sin(o),n=Math.cos(o),r=Math.asin(n*this.sinc0+t.y*e*this.cosc0/s),i=Math.atan2(t.x*e,s*this.cosc0*n-t.y*this.sinc0*e)}else r=this.phic0,i=0;return t.x=i,t.y=r,hd.inverse.apply(this,[t]),t.x=Xu(t.x+this.long0),t},names:["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]};var ud={init:function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=xu&&(this.k0=.5*(1+$u(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=xu&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=xu&&(this.k0=.5*this.cons*Wu(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Vu(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Wu(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-mu,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(t){var e,n,i,r,s,o,a=t.x,l=t.y,h=Math.sin(l),c=Math.cos(l),u=Xu(a-this.long0);return Math.abs(Math.abs(a-this.long0)-Math.PI)<=xu&&Math.abs(l+this.lat0)<=xu?(t.x=NaN,t.y=NaN,t):this.sphere?(e=2*this.k0/(1+this.sinlat0*h+this.coslat0*c*Math.cos(u)),t.x=this.a*e*c*Math.sin(u)+this.x0,t.y=this.a*e*(this.coslat0*h-this.sinlat0*c*Math.cos(u))+this.y0,t):(n=2*Math.atan(this.ssfn_(l,h,this.e))-mu,r=Math.cos(n),i=Math.sin(n),Math.abs(this.coslat0)<=xu?(s=Vu(this.e,l*this.con,this.con*h),o=2*this.a*this.k0*s/this.cons,t.x=this.x0+o*Math.sin(a-this.long0),t.y=this.y0-this.con*o*Math.cos(a-this.long0),t):(Math.abs(this.sinlat0)<xu?(e=2*this.a*this.k0/(1+r*Math.cos(u)),t.y=e*i):(e=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*i+this.cosX0*r*Math.cos(u))),t.y=e*(this.cosX0*i-this.sinX0*r*Math.cos(u))+this.y0),t.x=e*r*Math.sin(u)+this.x0,t))},inverse:function(t){var e,n,i,r,s;t.x-=this.x0,t.y-=this.y0;var o=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var a=2*Math.atan(o/(2*this.a*this.k0));return e=this.long0,n=this.lat0,o<=xu?(t.x=e,t.y=n,t):(n=Math.asin(Math.cos(a)*this.sinlat0+t.y*Math.sin(a)*this.coslat0/o),e=Math.abs(this.coslat0)<xu?this.lat0>0?Xu(this.long0+Math.atan2(t.x,-1*t.y)):Xu(this.long0+Math.atan2(t.x,t.y)):Xu(this.long0+Math.atan2(t.x*Math.sin(a),o*this.coslat0*Math.cos(a)-t.y*this.sinlat0*Math.sin(a))),t.x=e,t.y=n,t)}if(Math.abs(this.coslat0)<=xu){if(o<=xu)return n=this.lat0,e=this.long0,t.x=e,t.y=n,t;t.x*=this.con,t.y*=this.con,i=o*this.cons/(2*this.a*this.k0),n=this.con*Hu(this.e,i),e=this.con*Xu(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else r=2*Math.atan(o*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,o<=xu?s=this.X0:(s=Math.asin(Math.cos(r)*this.sinX0+t.y*Math.sin(r)*this.cosX0/o),e=Xu(this.long0+Math.atan2(t.x*Math.sin(r),o*this.cosX0*Math.cos(r)-t.y*this.sinX0*Math.sin(r)))),n=-1*Hu(this.e,Math.tan(.5*(mu+s)));return t.x=e,t.y=n,t},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],ssfn_:function(t,e,n){return e*=n,Math.tan(.5*(mu+t))*Math.pow((1-e)/(1+e),.5*n)}};var fd={init:function(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),n=this.a,i=1/this.rf,r=2*i-Math.pow(i,2),s=this.e=Math.sqrt(r);this.R=this.k0*n*Math.sqrt(1-r)/(1-r*Math.pow(e,2)),this.alpha=Math.sqrt(1+r/(1-r)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var o=Math.log(Math.tan(Math.PI/4+this.b0/2)),a=Math.log(Math.tan(Math.PI/4+t/2)),l=Math.log((1+s*e)/(1-s*e));this.K=o-this.alpha*a+this.alpha*s/2*l},forward:function(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),n=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),i=-this.alpha*(e+n)+this.K,r=2*(Math.atan(Math.exp(i))-Math.PI/4),s=this.alpha*(t.x-this.lambda0),o=Math.atan(Math.sin(s)/(Math.sin(this.b0)*Math.tan(r)+Math.cos(this.b0)*Math.cos(s))),a=Math.asin(Math.cos(this.b0)*Math.sin(r)-Math.sin(this.b0)*Math.cos(r)*Math.cos(s));return t.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0,t.x=this.R*o+this.x0,t},inverse:function(t){for(var e=t.x-this.x0,n=t.y-this.y0,i=e/this.R,r=2*(Math.atan(Math.exp(n/this.R))-Math.PI/4),s=Math.asin(Math.cos(this.b0)*Math.sin(r)+Math.sin(this.b0)*Math.cos(r)*Math.cos(i)),o=Math.atan(Math.sin(i)/(Math.cos(this.b0)*Math.cos(i)-Math.sin(this.b0)*Math.tan(r))),a=this.lambda0+o/this.alpha,l=0,h=s,c=-1e3,u=0;Math.abs(h-c)>1e-7;){if(++u>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+s/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(h))/2)),c=h,h=2*Math.atan(Math.exp(l))-Math.PI/2}return t.x=a,t.y=h,t},names:["somerc"]},dd=1e-7;var pd={init:function(){var t,e,n,i,r,s,o,a,l,h,c,u,f,d=0,p=0,g=0,_=0,y=0,m=0,x=0;this.no_off=(f="object"==typeof(u=this).PROJECTION?Object.keys(u.PROJECTION)[0]:u.PROJECTION,"no_uoff"in u||"no_off"in u||-1!==["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"].indexOf(f)),this.no_rot="no_rot"in this;var v=!1;"alpha"in this&&(v=!0);var b=!1;if("rectified_grid_angle"in this&&(b=!0),v&&(x=this.alpha),b&&(d=this.rectified_grid_angle*vu),v||b)p=this.longc;else if(g=this.long1,y=this.lat1,_=this.long2,m=this.lat2,Math.abs(y-m)<=dd||(t=Math.abs(y))<=dd||Math.abs(t-mu)<=dd||Math.abs(Math.abs(this.lat0)-mu)<=dd||Math.abs(Math.abs(m)-mu)<=dd)throw new Error;var M=1-this.es;e=Math.sqrt(M),Math.abs(this.lat0)>xu?(a=Math.sin(this.lat0),n=Math.cos(this.lat0),t=1-this.es*a*a,this.B=n*n,this.B=Math.sqrt(1+this.es*this.B*this.B/M),this.A=this.B*this.k0*e/t,(r=(i=this.B*e/(n*Math.sqrt(t)))*i-1)<=0?r=0:(r=Math.sqrt(r),this.lat0<0&&(r=-r)),this.E=r+=i,this.E*=Math.pow(Vu(this.e,this.lat0,a),this.B)):(this.B=1/e,this.A=this.k0,this.E=i=r=1),v||b?(v?(c=Math.asin(Math.sin(x)/i),b||(d=x)):(c=d,x=Math.asin(i*Math.sin(c))),this.lam0=p-Math.asin(.5*(r-1/r)*Math.tan(c))/this.B):(s=Math.pow(Vu(this.e,y,Math.sin(y)),this.B),o=Math.pow(Vu(this.e,m,Math.sin(m)),this.B),r=this.E/s,l=(o-s)/(o+s),h=((h=this.E*this.E)-o*s)/(h+o*s),(t=g-_)<-Math.pi?_-=wu:t>Math.pi&&(_+=wu),this.lam0=Xu(.5*(g+_)-Math.atan(h*Math.tan(.5*this.B*(g-_))/l)/this.B),c=Math.atan(2*Math.sin(this.B*Xu(g-this.lam0))/(r-1/r)),d=x=Math.asin(i*Math.sin(c))),this.singam=Math.sin(c),this.cosgam=Math.cos(c),this.sinrot=Math.sin(d),this.cosrot=Math.cos(d),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.A,this.B,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(i*i-1)/Math.cos(x))),this.lat0<0&&(this.u_0=-this.u_0)),r=.5*c,this.v_pole_n=this.ArB*Math.log(Math.tan(Mu-r)),this.v_pole_s=this.ArB*Math.log(Math.tan(Mu+r))},forward:function(t){var e,n,i,r,s,o,a,l,h={};if(t.x=t.x-this.lam0,Math.abs(Math.abs(t.y)-mu)>xu){if(e=.5*((s=this.E/Math.pow(Vu(this.e,t.y,Math.sin(t.y)),this.B))-(o=1/s)),n=.5*(s+o),r=Math.sin(this.B*t.x),i=(e*this.singam-r*this.cosgam)/n,Math.abs(Math.abs(i)-1)<xu)throw new Error;l=.5*this.ArB*Math.log((1-i)/(1+i)),o=Math.cos(this.B*t.x),a=Math.abs(o)<dd?this.A*t.x:this.ArB*Math.atan2(e*this.cosgam+r*this.singam,o)}else l=t.y>0?this.v_pole_n:this.v_pole_s,a=this.ArB*t.y;return this.no_rot?(h.x=a,h.y=l):(a-=this.u_0,h.x=l*this.cosrot+a*this.sinrot,h.y=a*this.cosrot-l*this.sinrot),h.x=this.a*h.x+this.x0,h.y=this.a*h.y+this.y0,h},inverse:function(t){var e,n,i,r,s,o,a,l={};if(t.x=(t.x-this.x0)*(1/this.a),t.y=(t.y-this.y0)*(1/this.a),this.no_rot?(n=t.y,e=t.x):(n=t.x*this.cosrot-t.y*this.sinrot,e=t.y*this.cosrot+t.x*this.sinrot+this.u_0),r=.5*((i=Math.exp(-this.BrA*n))-1/i),s=.5*(i+1/i),a=((o=Math.sin(this.BrA*e))*this.cosgam+r*this.singam)/s,Math.abs(Math.abs(a)-1)<xu)l.x=0,l.y=a<0?-mu:mu;else{if(l.y=this.E/Math.sqrt((1+a)/(1-a)),l.y=Hu(this.e,Math.pow(l.y,1/this.B)),l.y===1/0)throw new Error;l.x=-this.rB*Math.atan2(r*this.cosgam-o*this.singam,Math.cos(this.BrA*e))}return l.x+=this.lam0,l},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"]};var gd={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<xu)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),n=Math.cos(this.lat1),i=Wu(this.e,e,n),r=Vu(this.e,this.lat1,e),s=Math.sin(this.lat2),o=Math.cos(this.lat2),a=Wu(this.e,s,o),l=Vu(this.e,this.lat2,s),h=Vu(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>xu?this.ns=Math.log(i/a)/Math.log(r/l):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=i/(this.ns*Math.pow(r,this.ns)),this.rh=this.a*this.f0*Math.pow(h,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(t){var e=t.x,n=t.y;Math.abs(2*Math.abs(n)-Math.PI)<=xu&&(n=$u(n)*(mu-2e-10));var i,r,s=Math.abs(Math.abs(n)-mu);if(s>xu)i=Vu(this.e,n,Math.sin(n)),r=this.a*this.f0*Math.pow(i,this.ns);else{if((s=n*this.ns)<=0)return null;r=0}var o=this.ns*Xu(e-this.long0);return t.x=this.k0*(r*Math.sin(o))+this.x0,t.y=this.k0*(this.rh-r*Math.cos(o))+this.y0,t},inverse:function(t){var e,n,i,r,s,o=(t.x-this.x0)/this.k0,a=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(o*o+a*a),n=1):(e=-Math.sqrt(o*o+a*a),n=-1);var l=0;if(0!==e&&(l=Math.atan2(n*o,n*a)),0!==e||this.ns>0){if(n=1/this.ns,i=Math.pow(e/(this.a*this.f0),n),-9999===(r=Hu(this.e,i)))return null}else r=-mu;return s=Xu(l/this.ns+this.long0),t.x=s,t.y=r,t},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"]};var _d={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(t){var e,n,i,r,s,o,a,l=t.x,h=t.y,c=Xu(l-this.long0);return e=Math.pow((1+this.e*Math.sin(h))/(1-this.e*Math.sin(h)),this.alfa*this.e/2),n=2*(Math.atan(this.k*Math.pow(Math.tan(h/2+this.s45),this.alfa)/e)-this.s45),i=-c*this.alfa,r=Math.asin(Math.cos(this.ad)*Math.sin(n)+Math.sin(this.ad)*Math.cos(n)*Math.cos(i)),s=Math.asin(Math.cos(n)*Math.sin(i)/Math.cos(r)),o=this.n*s,a=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(r/2+this.s45),this.n),t.y=a*Math.cos(o)/1,t.x=a*Math.sin(o)/1,this.czech||(t.y*=-1,t.x*=-1),t},inverse:function(t){var e,n,i,r,s,o,a,l=t.x;t.x=t.y,t.y=l,this.czech||(t.y*=-1,t.x*=-1),s=Math.sqrt(t.x*t.x+t.y*t.y),r=Math.atan2(t.y,t.x)/Math.sin(this.s0),i=2*(Math.atan(Math.pow(this.ro0/s,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(i)-Math.sin(this.ad)*Math.cos(i)*Math.cos(r)),n=Math.asin(Math.cos(i)*Math.sin(r)/Math.cos(e)),t.x=this.long0-n/this.alfa,o=e,a=0;var h=0;do{t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(o))/(1-this.e*Math.sin(o)),this.e/2))-this.s45),Math.abs(o-t.y)<1e-10&&(a=1),o=t.y,h+=1}while(0===a&&h<15);return h>=15?null:t},names:["Krovak","krovak"]};function yd(t,e,n,i,r){return t*r-e*Math.sin(2*r)+n*Math.sin(4*r)-i*Math.sin(6*r)}function md(t){return 1-.25*t*(1+t/16*(3+1.25*t))}function xd(t){return.375*t*(1+.25*t*(1+.46875*t))}function vd(t){return.05859375*t*t*(1+.75*t)}function bd(t){return t*t*t*(35/3072)}function Md(t,e,n){var i=e*n;return t/Math.sqrt(1-i*i)}function wd(t){return Math.abs(t)<mu?t:t-$u(t)*Math.PI}function Ed(t,e,n,i,r){var s,o;s=t/e;for(var a=0;a<15;a++)if(s+=o=(t-(e*s-n*Math.sin(2*s)+i*Math.sin(4*s)-r*Math.sin(6*s)))/(e-2*n*Math.cos(2*s)+4*i*Math.cos(4*s)-6*r*Math.cos(6*s)),Math.abs(o)<=1e-10)return s;return NaN}var Nd={init:function(){this.sphere||(this.e0=md(this.es),this.e1=xd(this.es),this.e2=vd(this.es),this.e3=bd(this.es),this.ml0=this.a*yd(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(t){var e,n,i=t.x,r=t.y;if(i=Xu(i-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(r)*Math.sin(i)),n=this.a*(Math.atan2(Math.tan(r),Math.cos(i))-this.lat0);else{var s=Math.sin(r),o=Math.cos(r),a=Md(this.a,this.e,s),l=Math.tan(r)*Math.tan(r),h=i*Math.cos(r),c=h*h,u=this.es*o*o/(1-this.es);e=a*h*(1-c*l*(1/6-(8-l+8*u)*c/120)),n=this.a*yd(this.e0,this.e1,this.e2,this.e3,r)-this.ml0+a*s/o*c*(.5+(5-l+6*u)*c/24)}return t.x=e+this.x0,t.y=n+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,n,i=t.x/this.a,r=t.y/this.a;if(this.sphere){var s=r+this.lat0;e=Math.asin(Math.sin(s)*Math.cos(i)),n=Math.atan2(Math.tan(i),Math.cos(s))}else{var o=Ed(this.ml0/this.a+r,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(o)-mu)<=xu)return t.x=this.long0,t.y=mu,r<0&&(t.y*=-1),t;var a=Md(this.a,this.e,Math.sin(o)),l=a*a*a/this.a/this.a*(1-this.es),h=Math.pow(Math.tan(o),2),c=i*this.a/a,u=c*c;e=o-a*Math.tan(o)/l*c*c*(.5-(1+3*h)*c*c/24),n=c*(1-u*(h/3+(1+3*h)*h*u/15))/Math.cos(o)}return t.x=Xu(n+this.long0),t.y=wd(e),t},names:["Cassini","Cassini_Soldner","cass"]};function Sd(t,e){var n;return t>1e-7?(1-t*t)*(e/(1-(n=t*e)*n)-.5/t*Math.log((1-n)/(1+n))):2*e}var Id=.3333333333333333,kd=.17222222222222222,Od=.10257936507936508,Cd=.06388888888888888,Td=.0664021164021164,Rd=.016415012942191543;var Ad={init:function(){var t,e=Math.abs(this.lat0);if(Math.abs(e-mu)<xu?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(e)<xu?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0)switch(this.qp=Sd(this.e,1),this.mmf=.5/(1-this.es),this.apa=function(t){var e,n=[];return n[0]=t*Id,e=t*t,n[0]+=e*kd,n[1]=e*Cd,e*=t,n[0]+=e*Od,n[1]+=e*Td,n[2]=e*Rd,n}(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=Sd(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(t){var e,n,i,r,s,o,a,l,h,c,u=t.x,f=t.y;if(u=Xu(u-this.long0),this.sphere){if(s=Math.sin(f),c=Math.cos(f),i=Math.cos(u),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((n=this.mode===this.EQUIT?1+c*i:1+this.sinph0*s+this.cosph0*c*i)<=xu)return null;e=(n=Math.sqrt(2/n))*c*Math.sin(u),n*=this.mode===this.EQUIT?s:this.cosph0*s-this.sinph0*c*i}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(i=-i),Math.abs(f+this.lat0)<xu)return null;n=Mu-.5*f,e=(n=2*(this.mode===this.S_POLE?Math.cos(n):Math.sin(n)))*Math.sin(u),n*=i}}else{switch(a=0,l=0,h=0,i=Math.cos(u),r=Math.sin(u),s=Math.sin(f),o=Sd(this.e,s),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(a=o/this.qp,l=Math.sqrt(1-a*a)),this.mode){case this.OBLIQ:h=1+this.sinb1*a+this.cosb1*l*i;break;case this.EQUIT:h=1+l*i;break;case this.N_POLE:h=mu+f,o=this.qp-o;break;case this.S_POLE:h=f-mu,o=this.qp+o}if(Math.abs(h)<xu)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:h=Math.sqrt(2/h),n=this.mode===this.OBLIQ?this.ymf*h*(this.cosb1*a-this.sinb1*l*i):(h=Math.sqrt(2/(1+l*i)))*a*this.ymf,e=this.xmf*h*l*r;break;case this.N_POLE:case this.S_POLE:o>=0?(e=(h=Math.sqrt(o))*r,n=i*(this.mode===this.S_POLE?h:-h)):e=n=0}}return t.x=this.a*e+this.x0,t.y=this.a*n+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,n,i,r,s,o,a,l,h,c,u=t.x/this.a,f=t.y/this.a;if(this.sphere){var d,p=0,g=0;if((n=.5*(d=Math.sqrt(u*u+f*f)))>1)return null;switch(n=2*Math.asin(n),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(g=Math.sin(n),p=Math.cos(n)),this.mode){case this.EQUIT:n=Math.abs(d)<=xu?0:Math.asin(f*g/d),u*=g,f=p*d;break;case this.OBLIQ:n=Math.abs(d)<=xu?this.lat0:Math.asin(p*this.sinph0+f*g*this.cosph0/d),u*=g*this.cosph0,f=(p-Math.sin(n)*this.sinph0)*d;break;case this.N_POLE:f=-f,n=mu-n;break;case this.S_POLE:n-=mu}e=0!==f||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(u,f):0}else{if(a=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(u/=this.dd,f*=this.dd,(o=Math.sqrt(u*u+f*f))<xu)return t.x=this.long0,t.y=this.lat0,t;r=2*Math.asin(.5*o/this.rq),i=Math.cos(r),u*=r=Math.sin(r),this.mode===this.OBLIQ?(a=i*this.sinb1+f*r*this.cosb1/o,s=this.qp*a,f=o*this.cosb1*i-f*this.sinb1*r):(a=f*r/o,s=this.qp*a,f=o*i)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(f=-f),!(s=u*u+f*f))return t.x=this.long0,t.y=this.lat0,t;a=1-s/this.qp,this.mode===this.S_POLE&&(a=-a)}e=Math.atan2(u,f),l=Math.asin(a),h=this.apa,c=l+l,n=l+h[0]*Math.sin(c)+h[1]*Math.sin(c+c)+h[2]*Math.sin(c+c+c)}return t.x=Xu(this.long0+e),t.y=n,t},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4};function Ld(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)}var Pd={init:function(){Math.abs(this.lat1+this.lat2)<xu||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Wu(this.e3,this.sin_po,this.cos_po),this.qs1=Sd(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Wu(this.e3,this.sin_po,this.cos_po),this.qs2=Sd(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Sd(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>xu?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(t){var e=t.x,n=t.y;this.sin_phi=Math.sin(n),this.cos_phi=Math.cos(n);var i=Sd(this.e3,this.sin_phi,this.cos_phi),r=this.a*Math.sqrt(this.c-this.ns0*i)/this.ns0,s=this.ns0*Xu(e-this.long0),o=r*Math.sin(s)+this.x0,a=this.rh-r*Math.cos(s)+this.y0;return t.x=o,t.y=a,t},inverse:function(t){var e,n,i,r,s,o;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),i=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),i=-1),r=0,0!==e&&(r=Math.atan2(i*t.x,i*t.y)),i=e*this.ns0/this.a,this.sphere?o=Math.asin((this.c-i*i)/(2*this.ns0)):(n=(this.c-i*i)/this.ns0,o=this.phi1z(this.e3,n)),s=Xu(r/this.ns0+this.long0),t.x=s,t.y=o,t},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(t,e){var n,i,r,s,o=Ld(.5*e);if(t<xu)return o;for(var a=t*t,l=1;l<=25;l++)if(o+=s=.5*(r=1-(i=t*(n=Math.sin(o)))*i)*r/Math.cos(o)*(e/(1-a)-n/r+.5/t*Math.log((1-i)/(1+i))),Math.abs(s)<=1e-7)return o;return null}};var Dd={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(t){var e,n,i,r,s,o,a,l=t.x,h=t.y;return i=Xu(l-this.long0),e=Math.sin(h),n=Math.cos(h),r=Math.cos(i),1,(s=this.sin_p14*e+this.cos_p14*n*r)>0||Math.abs(s)<=xu?(o=this.x0+1*this.a*n*Math.sin(i)/s,a=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*n*r)/s):(o=this.x0+this.infinity_dist*n*Math.sin(i),a=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*n*r)),t.x=o,t.y=a,t},inverse:function(t){var e,n,i,r,s,o;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(r=Math.atan2(e,this.rc),n=Math.sin(r),o=Ld((i=Math.cos(r))*this.sin_p14+t.y*n*this.cos_p14/e),s=Math.atan2(t.x*n,e*this.cos_p14*i-t.y*this.sin_p14*n),s=Xu(this.long0+s)):(o=this.phic0,s=0),t.x=s,t.y=o,t},names:["gnom"]};var zd={init:function(){this.sphere||(this.k0=Wu(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(t){var e,n,i=t.x,r=t.y,s=Xu(i-this.long0);if(this.sphere)e=this.x0+this.a*s*Math.cos(this.lat_ts),n=this.y0+this.a*Math.sin(r)/Math.cos(this.lat_ts);else{var o=Sd(this.e,Math.sin(r));e=this.x0+this.a*this.k0*s,n=this.y0+this.a*o*.5/this.k0}return t.x=e,t.y=n,t},inverse:function(t){var e,n;return t.x-=this.x0,t.y-=this.y0,this.sphere?(e=Xu(this.long0+t.x/this.a/Math.cos(this.lat_ts)),n=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(n=function(t,e){var n=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-n)<1e-6)return e<0?-1*mu:mu;for(var i,r,s,o,a=Math.asin(.5*e),l=0;l<30;l++)if(r=Math.sin(a),s=Math.cos(a),o=t*r,a+=i=Math.pow(1-o*o,2)/(2*s)*(e/(1-t*t)-r/(1-o*o)+.5/t*Math.log((1-o)/(1+o))),Math.abs(i)<=1e-10)return a;return NaN}(this.e,2*t.y*this.k0/this.a),e=Xu(this.long0+t.x/(this.a*this.k0))),t.x=e,t.y=n,t},names:["cea"]};var Fd={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(t){var e=t.x,n=t.y,i=Xu(e-this.long0),r=wd(n-this.lat0);return t.x=this.x0+this.a*i*this.rc,t.y=this.y0+this.a*r,t},inverse:function(t){var e=t.x,n=t.y;return t.x=Xu(this.long0+(e-this.x0)/(this.a*this.rc)),t.y=wd(this.lat0+(n-this.y0)/this.a),t},names:["Equirectangular","Equidistant_Cylindrical","eqc"]};var Gd={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=md(this.es),this.e1=xd(this.es),this.e2=vd(this.es),this.e3=bd(this.es),this.ml0=this.a*yd(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(t){var e,n,i,r=t.x,s=t.y,o=Xu(r-this.long0);if(i=o*Math.sin(s),this.sphere)Math.abs(s)<=xu?(e=this.a*o,n=-1*this.a*this.lat0):(e=this.a*Math.sin(i)/Math.tan(s),n=this.a*(wd(s-this.lat0)+(1-Math.cos(i))/Math.tan(s)));else if(Math.abs(s)<=xu)e=this.a*o,n=-1*this.ml0;else{var a=Md(this.a,this.e,Math.sin(s))/Math.tan(s);e=a*Math.sin(i),n=this.a*yd(this.e0,this.e1,this.e2,this.e3,s)-this.ml0+a*(1-Math.cos(i))}return t.x=e+this.x0,t.y=n+this.y0,t},inverse:function(t){var e,n,i,r,s,o,a,l,h;if(i=t.x-this.x0,r=t.y-this.y0,this.sphere)if(Math.abs(r+this.a*this.lat0)<=xu)e=Xu(i/this.a+this.long0),n=0;else{var c;for(o=this.lat0+r/this.a,a=i*i/this.a/this.a+o*o,l=o,s=20;s;--s)if(l+=h=-1*(o*(l*(c=Math.tan(l))+1)-l-.5*(l*l+a)*c)/((l-o)/c-1),Math.abs(h)<=xu){n=l;break}e=Xu(this.long0+Math.asin(i*Math.tan(l)/this.a)/Math.sin(n))}else if(Math.abs(r+this.ml0)<=xu)n=0,e=Xu(this.long0+i/this.a);else{var u,f,d,p,g;for(o=(this.ml0+r)/this.a,a=i*i/this.a/this.a+o*o,l=o,s=20;s;--s)if(g=this.e*Math.sin(l),u=Math.sqrt(1-g*g)*Math.tan(l),f=this.a*yd(this.e0,this.e1,this.e2,this.e3,l),d=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),l-=h=(o*(u*(p=f/this.a)+1)-p-.5*u*(p*p+a))/(this.es*Math.sin(2*l)*(p*p+a-2*o*p)/(4*u)+(o-p)*(u*d-2/Math.sin(2*l))-d),Math.abs(h)<=xu){n=l;break}u=Math.sqrt(1-this.es*Math.pow(Math.sin(n),2))*Math.tan(n),e=Xu(this.long0+Math.asin(i*u/this.a)/Math.sin(n))}return t.x=e,t.y=n,t},names:["Polyconic","poly"]};var qd={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(t){var e,n=t.x,i=t.y-this.lat0,r=n-this.long0,s=i/yu*1e-5,o=r,a=1,l=0;for(e=1;e<=10;e++)a*=s,l+=this.A[e]*a;var h,c=l,u=o,f=1,d=0,p=0,g=0;for(e=1;e<=6;e++)h=d*c+f*u,f=f*c-d*u,d=h,p=p+this.B_re[e]*f-this.B_im[e]*d,g=g+this.B_im[e]*f+this.B_re[e]*d;return t.x=g*this.a+this.x0,t.y=p*this.a+this.y0,t},inverse:function(t){var e,n,i=t.x,r=t.y,s=i-this.x0,o=(r-this.y0)/this.a,a=s/this.a,l=1,h=0,c=0,u=0;for(e=1;e<=6;e++)n=h*o+l*a,l=l*o-h*a,h=n,c=c+this.C_re[e]*l-this.C_im[e]*h,u=u+this.C_im[e]*l+this.C_re[e]*h;for(var f=0;f<this.iterations;f++){var d,p=c,g=u,_=o,y=a;for(e=2;e<=6;e++)d=g*c+p*u,p=p*c-g*u,g=d,_+=(e-1)*(this.B_re[e]*p-this.B_im[e]*g),y+=(e-1)*(this.B_im[e]*p+this.B_re[e]*g);p=1,g=0;var m=this.B_re[1],x=this.B_im[1];for(e=2;e<=6;e++)d=g*c+p*u,p=p*c-g*u,g=d,m+=e*(this.B_re[e]*p-this.B_im[e]*g),x+=e*(this.B_im[e]*p+this.B_re[e]*g);var v=m*m+x*x;c=(_*m+y*x)/v,u=(y*m-_*x)/v}var b=c,M=u,w=1,E=0;for(e=1;e<=9;e++)w*=b,E+=this.D[e]*w;var N=this.lat0+E*yu*1e5,S=this.long0+M;return t.x=S,t.y=N,t},names:["New_Zealand_Map_Grid","nzmg"]};var jd={init:function(){},forward:function(t){var e=t.x,n=t.y,i=Xu(e-this.long0),r=this.x0+this.a*i,s=this.y0+this.a*Math.log(Math.tan(Math.PI/4+n/2.5))*1.25;return t.x=r,t.y=s,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e=Xu(this.long0+t.x/this.a),n=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=n,t},names:["Miller_Cylindrical","mill"]};var Bd={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=Jf(this.es)},forward:function(t){var e,n,i=t.x,r=t.y;if(i=Xu(i-this.long0),this.sphere){if(this.m)for(var s=this.n*Math.sin(r),o=20;o;--o){var a=(this.m*r+Math.sin(r)-s)/(this.m+Math.cos(r));if(r-=a,Math.abs(a)<xu)break}else r=1!==this.n?Math.asin(this.n*Math.sin(r)):r;e=this.a*this.C_x*i*(this.m+Math.cos(r)),n=this.a*this.C_y*r}else{var l=Math.sin(r),h=Math.cos(r);n=this.a*Qf(r,l,h,this.en),e=this.a*i*h/Math.sqrt(1-this.es*l*l)}return t.x=e,t.y=n,t},inverse:function(t){var e,n,i;return t.x-=this.x0,n=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,n/=this.C_x*(this.m+Math.cos(e)),this.m?e=Ld((this.m*e+Math.sin(e))/this.n):1!==this.n&&(e=Ld(Math.sin(e)/this.n)),n=Xu(n+this.long0),e=wd(e)):(e=Kf(t.y/this.a,this.es,this.en),(i=Math.abs(e))<mu?(i=Math.sin(e),n=Xu(this.long0+t.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(e)))):i-xu<mu&&(n=this.long0)),t.x=n,t.y=e,t},names:["Sinusoidal","sinu"]};var Ud={init:function(){},forward:function(t){for(var e=t.x,n=t.y,i=Xu(e-this.long0),r=n,s=Math.PI*Math.sin(n);;){var o=-(r+Math.sin(r)-s)/(1+Math.cos(r));if(r+=o,Math.abs(o)<xu)break}r/=2,Math.PI/2-Math.abs(n)<xu&&(i=0);var a=.900316316158*this.a*i*Math.cos(r)+this.x0,l=1.4142135623731*this.a*Math.sin(r)+this.y0;return t.x=a,t.y=l,t},inverse:function(t){var e,n;t.x-=this.x0,t.y-=this.y0,n=t.y/(1.4142135623731*this.a),Math.abs(n)>.999999999999&&(n=.999999999999),e=Math.asin(n);var i=Xu(this.long0+t.x/(.900316316158*this.a*Math.cos(e)));i<-Math.PI&&(i=-Math.PI),i>Math.PI&&(i=Math.PI),n=(2*e+Math.sin(2*e))/Math.PI,Math.abs(n)>1&&(n=1);var r=Math.asin(n);return t.x=i,t.y=r,t},names:["Mollweide","moll"]};var Yd={init:function(){Math.abs(this.lat1+this.lat2)<xu||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=md(this.es),this.e1=xd(this.es),this.e2=vd(this.es),this.e3=bd(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=Wu(this.e,this.sinphi,this.cosphi),this.ml1=yd(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<xu?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=Wu(this.e,this.sinphi,this.cosphi),this.ml2=yd(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=yd(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(t){var e,n=t.x,i=t.y;if(this.sphere)e=this.a*(this.g-i);else{var r=yd(this.e0,this.e1,this.e2,this.e3,i);e=this.a*(this.g-r)}var s=this.ns*Xu(n-this.long0),o=this.x0+e*Math.sin(s),a=this.y0+this.rh-e*Math.cos(s);return t.x=o,t.y=a,t},inverse:function(t){var e,n,i,r;t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns>=0?(n=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(n=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var s=0;return 0!==n&&(s=Math.atan2(e*t.x,e*t.y)),this.sphere?(r=Xu(this.long0+s/this.ns),i=wd(this.g-n/this.a),t.x=r,t.y=i,t):(i=Ed(this.g-n/this.a,this.e0,this.e1,this.e2,this.e3),r=Xu(this.long0+s/this.ns),t.x=r,t.y=i,t)},names:["Equidistant_Conic","eqdc"]};var Wd={init:function(){this.R=this.a},forward:function(t){var e,n,i=t.x,r=t.y,s=Xu(i-this.long0);Math.abs(r)<=xu&&(e=this.x0+this.R*s,n=this.y0);var o=Ld(2*Math.abs(r/Math.PI));(Math.abs(s)<=xu||Math.abs(Math.abs(r)-mu)<=xu)&&(e=this.x0,n=r>=0?this.y0+Math.PI*this.R*Math.tan(.5*o):this.y0+Math.PI*this.R*-Math.tan(.5*o));var a=.5*Math.abs(Math.PI/s-s/Math.PI),l=a*a,h=Math.sin(o),c=Math.cos(o),u=c/(h+c-1),f=u*u,d=u*(2/h-1),p=d*d,g=Math.PI*this.R*(a*(u-p)+Math.sqrt(l*(u-p)*(u-p)-(p+l)*(f-p)))/(p+l);s<0&&(g=-g),e=this.x0+g;var _=l+u;return g=Math.PI*this.R*(d*_-a*Math.sqrt((p+l)*(l+1)-_*_))/(p+l),n=r>=0?this.y0+g:this.y0-g,t.x=e,t.y=n,t},inverse:function(t){var e,n,i,r,s,o,a,l,h,c,u,f;return t.x-=this.x0,t.y-=this.y0,u=Math.PI*this.R,s=(i=t.x/u)*i+(r=t.y/u)*r,u=3*(r*r/(l=-2*(o=-Math.abs(r)*(1+s))+1+2*r*r+s*s)+(2*(a=o-2*r*r+i*i)*a*a/l/l/l-9*o*a/l/l)/27)/(h=(o-a*a/3/l)/l)/(c=2*Math.sqrt(-h/3)),Math.abs(u)>1&&(u=u>=0?1:-1),f=Math.acos(u)/3,n=t.y>=0?(-c*Math.cos(f+Math.PI/3)-a/3/l)*Math.PI:-(-c*Math.cos(f+Math.PI/3)-a/3/l)*Math.PI,e=Math.abs(i)<xu?this.long0:Xu(this.long0+Math.PI*(s-1+Math.sqrt(1+2*(i*i-r*r)+s*s))/2/i),t.x=e,t.y=n,t},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]};var $d={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(t){var e,n,i,r,s,o,a,l,h,c,u,f,d,p,g,_,y,m,x,v,b,M,w=t.x,E=t.y,N=Math.sin(t.y),S=Math.cos(t.y),I=Xu(w-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=xu?(t.x=this.x0+this.a*(mu-E)*Math.sin(I),t.y=this.y0-this.a*(mu-E)*Math.cos(I),t):Math.abs(this.sin_p12+1)<=xu?(t.x=this.x0+this.a*(mu+E)*Math.sin(I),t.y=this.y0+this.a*(mu+E)*Math.cos(I),t):(m=this.sin_p12*N+this.cos_p12*S*Math.cos(I),y=(_=Math.acos(m))?_/Math.sin(_):1,t.x=this.x0+this.a*y*S*Math.sin(I),t.y=this.y0+this.a*y*(this.cos_p12*N-this.sin_p12*S*Math.cos(I)),t):(e=md(this.es),n=xd(this.es),i=vd(this.es),r=bd(this.es),Math.abs(this.sin_p12-1)<=xu?(s=this.a*yd(e,n,i,r,mu),o=this.a*yd(e,n,i,r,E),t.x=this.x0+(s-o)*Math.sin(I),t.y=this.y0-(s-o)*Math.cos(I),t):Math.abs(this.sin_p12+1)<=xu?(s=this.a*yd(e,n,i,r,mu),o=this.a*yd(e,n,i,r,E),t.x=this.x0+(s+o)*Math.sin(I),t.y=this.y0+(s+o)*Math.cos(I),t):(a=N/S,l=Md(this.a,this.e,this.sin_p12),h=Md(this.a,this.e,N),c=Math.atan((1-this.es)*a+this.es*l*this.sin_p12/(h*S)),x=0===(u=Math.atan2(Math.sin(I),this.cos_p12*Math.tan(c)-this.sin_p12*Math.cos(I)))?Math.asin(this.cos_p12*Math.sin(c)-this.sin_p12*Math.cos(c)):Math.abs(Math.abs(u)-Math.PI)<=xu?-Math.asin(this.cos_p12*Math.sin(c)-this.sin_p12*Math.cos(c)):Math.asin(Math.sin(I)*Math.cos(c)/Math.sin(u)),f=this.e*this.sin_p12/Math.sqrt(1-this.es),_=l*x*(1-(v=x*x)*(g=(d=this.e*this.cos_p12*Math.cos(u)/Math.sqrt(1-this.es))*d)*(1-g)/6+(b=v*x)/8*(p=f*d)*(1-2*g)+(M=b*x)/120*(g*(4-7*g)-3*f*f*(1-7*g))-M*x/48*p),t.x=this.x0+_*Math.sin(u),t.y=this.y0+_*Math.cos(u),t))},inverse:function(t){var e,n,i,r,s,o,a,l,h,c,u,f,d,p,g,_,y,m,x,v,b,M,w;if(t.x-=this.x0,t.y-=this.y0,this.sphere){if((e=Math.sqrt(t.x*t.x+t.y*t.y))>2*mu*this.a)return;return n=e/this.a,i=Math.sin(n),r=Math.cos(n),s=this.long0,Math.abs(e)<=xu?o=this.lat0:(o=Ld(r*this.sin_p12+t.y*i*this.cos_p12/e),a=Math.abs(this.lat0)-mu,s=Math.abs(a)<=xu?this.lat0>=0?Xu(this.long0+Math.atan2(t.x,-t.y)):Xu(this.long0-Math.atan2(-t.x,t.y)):Xu(this.long0+Math.atan2(t.x*i,e*this.cos_p12*r-t.y*this.sin_p12*i))),t.x=s,t.y=o,t}return l=md(this.es),h=xd(this.es),c=vd(this.es),u=bd(this.es),Math.abs(this.sin_p12-1)<=xu?(o=Ed(((f=this.a*yd(l,h,c,u,mu))-(e=Math.sqrt(t.x*t.x+t.y*t.y)))/this.a,l,h,c,u),s=Xu(this.long0+Math.atan2(t.x,-1*t.y)),t.x=s,t.y=o,t):Math.abs(this.sin_p12+1)<=xu?(f=this.a*yd(l,h,c,u,mu),o=Ed(((e=Math.sqrt(t.x*t.x+t.y*t.y))-f)/this.a,l,h,c,u),s=Xu(this.long0+Math.atan2(t.x,t.y)),t.x=s,t.y=o,t):(e=Math.sqrt(t.x*t.x+t.y*t.y),g=Math.atan2(t.x,t.y),d=Md(this.a,this.e,this.sin_p12),_=Math.cos(g),m=-(y=this.e*this.cos_p12*_)*y/(1-this.es),x=3*this.es*(1-m)*this.sin_p12*this.cos_p12*_/(1-this.es),M=1-m*(b=(v=e/d)-m*(1+m)*Math.pow(v,3)/6-x*(1+3*m)*Math.pow(v,4)/24)*b/2-v*b*b*b/6,p=Math.asin(this.sin_p12*Math.cos(b)+this.cos_p12*Math.sin(b)*_),s=Xu(this.long0+Math.asin(Math.sin(g)*Math.sin(b)/Math.cos(p))),w=Math.sin(p),o=Math.atan2((w-this.es*M*this.sin_p12)*Math.tan(p),w*(1-this.es)),t.x=s,t.y=o,t)},names:["Azimuthal_Equidistant","aeqd"]};var Xd={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(t){var e,n,i,r,s,o,a,l=t.x,h=t.y;return i=Xu(l-this.long0),e=Math.sin(h),n=Math.cos(h),r=Math.cos(i),1,((s=this.sin_p14*e+this.cos_p14*n*r)>0||Math.abs(s)<=xu)&&(o=1*this.a*n*Math.sin(i),a=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*n*r)),t.x=o,t.y=a,t},inverse:function(t){var e,n,i,r,s,o,a;return t.x-=this.x0,t.y-=this.y0,n=Ld((e=Math.sqrt(t.x*t.x+t.y*t.y))/this.a),i=Math.sin(n),r=Math.cos(n),o=this.long0,Math.abs(e)<=xu?(a=this.lat0,t.x=o,t.y=a,t):(a=Ld(r*this.sin_p14+t.y*i*this.cos_p14/e),s=Math.abs(this.lat0)-mu,Math.abs(s)<=xu?(o=this.lat0>=0?Xu(this.long0+Math.atan2(t.x,-t.y)):Xu(this.long0-Math.atan2(-t.x,t.y)),t.x=o,t.y=a,t):(o=Xu(this.long0+Math.atan2(t.x*i,e*this.cos_p14*r-t.y*this.sin_p14*i)),t.x=o,t.y=a,t))},names:["ortho"]},Vd=1,Hd=2,Zd=3,Jd=4,Qd=5,Kd=6,tp=1,ep=2,np=3,ip=4;function rp(t,e,n,i){var r;return t<xu?(i.value=tp,r=0):(r=Math.atan2(e,n),Math.abs(r)<=Mu?i.value=tp:r>Mu&&r<=mu+Mu?(i.value=ep,r-=mu):r>mu+Mu||r<=-(mu+Mu)?(i.value=np,r=r>=0?r-Eu:r+Eu):(i.value=ip,r+=mu)),r}function sp(t,e){var n=t+e;return n<-Eu?n+=wu:n>+Eu&&(n-=wu),n}var op={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=mu-Mu/2?this.face=Qd:this.lat0<=-(mu-Mu/2)?this.face=Kd:Math.abs(this.long0)<=Mu?this.face=Vd:Math.abs(this.long0)<=mu+Mu?this.face=this.long0>0?Hd:Jd:this.face=Zd,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(t){var e,n,i,r,s,o,a={x:0,y:0},l={value:0};if(t.x-=this.long0,e=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(t.y)):t.y,n=t.x,this.face===Qd)r=mu-e,n>=Mu&&n<=mu+Mu?(l.value=tp,i=n-mu):n>mu+Mu||n<=-(mu+Mu)?(l.value=ep,i=n>0?n-Eu:n+Eu):n>-(mu+Mu)&&n<=-Mu?(l.value=np,i=n+mu):(l.value=ip,i=n);else if(this.face===Kd)r=mu+e,n>=Mu&&n<=mu+Mu?(l.value=tp,i=-n+mu):n<Mu&&n>=-Mu?(l.value=ep,i=-n):n<-Mu&&n>=-(mu+Mu)?(l.value=np,i=-n-mu):(l.value=ip,i=n>0?-n+Eu:-n-Eu);else{var h,c,u,f,d,p;this.face===Hd?n=sp(n,+mu):this.face===Zd?n=sp(n,+Eu):this.face===Jd&&(n=sp(n,-mu)),f=Math.sin(e),d=Math.cos(e),p=Math.sin(n),h=d*Math.cos(n),c=d*p,u=f,this.face===Vd?i=rp(r=Math.acos(h),u,c,l):this.face===Hd?i=rp(r=Math.acos(c),u,-h,l):this.face===Zd?i=rp(r=Math.acos(-h),u,-c,l):this.face===Jd?i=rp(r=Math.acos(-c),u,h,l):(r=i=0,l.value=tp)}return o=Math.atan(12/Eu*(i+Math.acos(Math.sin(i)*Math.cos(Mu))-mu)),s=Math.sqrt((1-Math.cos(r))/(Math.cos(o)*Math.cos(o))/(1-Math.cos(Math.atan(1/Math.cos(i))))),l.value===ep?o+=mu:l.value===np?o+=Eu:l.value===ip&&(o+=1.5*Eu),a.x=s*Math.cos(o),a.y=s*Math.sin(o),a.x=a.x*this.a+this.x0,a.y=a.y*this.a+this.y0,t.x=a.x,t.y=a.y,t},inverse:function(t){var e,n,i,r,s,o,a,l,h,c,u,f,d={lam:0,phi:0},p={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,n=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),e=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?p.value=tp:t.y>=0&&t.y>=Math.abs(t.x)?(p.value=ep,e-=mu):t.x<0&&-t.x>=Math.abs(t.y)?(p.value=np,e=e<0?e+Eu:e-Eu):(p.value=ip,e+=mu),h=Eu/12*Math.tan(e),s=Math.sin(h)/(Math.cos(h)-1/Math.sqrt(2)),o=Math.atan(s),(a=1-(i=Math.cos(e))*i*(r=Math.tan(n))*r*(1-Math.cos(Math.atan(1/Math.cos(o)))))<-1?a=-1:a>1&&(a=1),this.face===Qd)l=Math.acos(a),d.phi=mu-l,p.value===tp?d.lam=o+mu:p.value===ep?d.lam=o<0?o+Eu:o-Eu:p.value===np?d.lam=o-mu:d.lam=o;else if(this.face===Kd)l=Math.acos(a),d.phi=l-mu,p.value===tp?d.lam=-o+mu:p.value===ep?d.lam=-o:p.value===np?d.lam=-o-mu:d.lam=o<0?-o-Eu:-o+Eu;else{var g,_,y;h=(g=a)*g,_=(h+=(y=h>=1?0:Math.sqrt(1-h)*Math.sin(o))*y)>=1?0:Math.sqrt(1-h),p.value===ep?(h=_,_=-y,y=h):p.value===np?(_=-_,y=-y):p.value===ip&&(h=_,_=y,y=-h),this.face===Hd?(h=g,g=-_,_=h):this.face===Zd?(g=-g,_=-_):this.face===Jd&&(h=g,g=_,_=-h),d.phi=Math.acos(-y)-mu,d.lam=Math.atan2(_,g),this.face===Hd?d.lam=sp(d.lam,-mu):this.face===Zd?d.lam=sp(d.lam,-Eu):this.face===Jd&&(d.lam=sp(d.lam,+mu))}return 0!==this.es&&(c=d.phi<0?1:0,u=Math.tan(d.phi),f=this.b/Math.sqrt(u*u+this.one_minus_f_squared),d.phi=Math.atan(Math.sqrt(this.a*this.a-f*f)/(this.one_minus_f*f)),c&&(d.phi=-d.phi)),d.lam+=this.long0,t.x=d.lam,t.y=d.phi,t},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]},ap=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],lp=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],hp=.8487,cp=1.3523,up=bu/5,fp=18,dp=function(t,e){return t[0]+e*(t[1]+e*(t[2]+e*t[3]))};var pp={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(t){var e=Xu(t.x-this.long0),n=Math.abs(t.y),i=Math.floor(n*up);i<0?i=0:i>=fp&&(i=17);var r={x:dp(ap[i],n=bu*(n-.08726646259971647*i))*e,y:dp(lp[i],n)};return t.y<0&&(r.y=-r.y),r.x=r.x*this.a*hp+this.x0,r.y=r.y*this.a*cp+this.y0,r},inverse:function(t){var e={x:(t.x-this.x0)/(this.a*hp),y:Math.abs(t.y-this.y0)/(this.a*cp)};if(e.y>=1)e.x/=ap[18][0],e.y=t.y<0?-mu:mu;else{var n=Math.floor(e.y*fp);for(n<0?n=0:n>=fp&&(n=17);;)if(lp[n][0]>e.y)--n;else{if(!(lp[n+1][0]<=e.y))break;++n}var i=lp[n],r=5*(e.y-i[0])/(lp[n+1][0]-i[0]);r=function(t,e,n,i){for(var r=e;i;--i){var s=t(r);if(r-=s,Math.abs(s)<n)break}return r}((function(t){return(dp(i,t)-e.y)/function(t,e){return t[1]+e*(2*t[2]+3*e*t[3])}(i,t)}),r,xu,100),e.x/=dp(ap[n],r),e.y=(5*n+r)*vu,t.y<0&&(e.y=-e.y)}return e.x=Xu(e.x+this.long0),e},names:["Robinson","robin"]};var gp={init:function(){this.name="geocent"},forward:function(t){return gf(t,this.es,this.a)},inverse:function(t){return _f(t,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]},_p=0,yp=1,mp=2,xp=3,vp={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};var bp={init:function(){if(Object.keys(vp).forEach(function(t){if(void 0===this[t])this[t]=vp[t].def;else{if(vp[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);vp[t].num&&(this[t]=parseFloat(this[t]))}vp[t].degrees&&(this[t]=this[t]*vu)}.bind(this)),Math.abs(Math.abs(this.lat0)-mu)<xu?this.mode=this.lat0<0?yp:_p:Math.abs(this.lat0)<xu?this.mode=mp:(this.mode=xp,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var t=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(t),this.sw=Math.sin(t)},forward:function(t){t.x-=this.long0;var e,n,i,r,s=Math.sin(t.y),o=Math.cos(t.y),a=Math.cos(t.x);switch(this.mode){case xp:n=this.sinph0*s+this.cosph0*o*a;break;case mp:n=o*a;break;case yp:n=-s;break;case _p:n=s}switch(e=(n=this.pn1/(this.p-n))*o*Math.sin(t.x),this.mode){case xp:n*=this.cosph0*s-this.sinph0*o*a;break;case mp:n*=s;break;case _p:n*=-o*a;break;case yp:n*=o*a}return r=1/((i=n*this.cg+e*this.sg)*this.sw*this.h1+this.cw),e=(e*this.cg-n*this.sg)*this.cw*r,n=i*r,t.x=e*this.a,t.y=n*this.a,t},inverse:function(t){t.x/=this.a,t.y/=this.a;var e,n,i,r={x:t.x,y:t.y};i=1/(this.pn1-t.y*this.sw),e=this.pn1*t.x*i,n=this.pn1*t.y*this.cw*i,t.x=e*this.cg+n*this.sg,t.y=n*this.cg-e*this.sg;var s=nd(t.x,t.y);if(Math.abs(s)<xu)r.x=0,r.y=t.y;else{var o,a;switch(a=1-s*s*this.pfact,a=(this.p-Math.sqrt(a))/(this.pn1/s+s/this.pn1),o=Math.sqrt(1-a*a),this.mode){case xp:r.y=Math.asin(o*this.sinph0+t.y*a*this.cosph0/s),t.y=(o-this.sinph0*Math.sin(r.y))*s,t.x*=a*this.cosph0;break;case mp:r.y=Math.asin(t.y*a/s),t.y=o*s,t.x*=a;break;case _p:r.y=Math.asin(o),t.y=-t.y;break;case yp:r.y=-Math.asin(o)}r.x=Math.atan2(t.x,t.y)}return t.x=r.x+this.long0,t.y=r.y,t},names:["Tilted_Perspective","tpers"]};var Mp={init:function(){if(this.flip_axis="x"===this.sweep?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,0!==this.es){var t=1-this.es,e=1/t;this.radius_p=Math.sqrt(t),this.radius_p2=t,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")},forward:function(t){var e,n,i,r,s=t.x,o=t.y;if(s-=this.long0,"ellipse"===this.shape){o=Math.atan(this.radius_p2*Math.tan(o));var a=this.radius_p/nd(this.radius_p*Math.cos(o),Math.sin(o));if(n=a*Math.cos(s)*Math.cos(o),i=a*Math.sin(s)*Math.cos(o),r=a*Math.sin(o),(this.radius_g-n)*n-i*i-r*r*this.radius_p_inv2<0)return t.x=Number.NaN,t.y=Number.NaN,t;e=this.radius_g-n,this.flip_axis?(t.x=this.radius_g_1*Math.atan(i/nd(r,e)),t.y=this.radius_g_1*Math.atan(r/e)):(t.x=this.radius_g_1*Math.atan(i/e),t.y=this.radius_g_1*Math.atan(r/nd(i,e)))}else"sphere"===this.shape&&(e=Math.cos(o),n=Math.cos(s)*e,i=Math.sin(s)*e,r=Math.sin(o),e=this.radius_g-n,this.flip_axis?(t.x=this.radius_g_1*Math.atan(i/nd(r,e)),t.y=this.radius_g_1*Math.atan(r/e)):(t.x=this.radius_g_1*Math.atan(i/e),t.y=this.radius_g_1*Math.atan(r/nd(i,e))));return t.x=t.x*this.a,t.y=t.y*this.a,t},inverse:function(t){var e,n,i,r,s=-1,o=0,a=0;if(t.x=t.x/this.a,t.y=t.y/this.a,"ellipse"===this.shape){this.flip_axis?(a=Math.tan(t.y/this.radius_g_1),o=Math.tan(t.x/this.radius_g_1)*nd(1,a)):(o=Math.tan(t.x/this.radius_g_1),a=Math.tan(t.y/this.radius_g_1)*nd(1,o));var l=a/this.radius_p;if(e=o*o+l*l+s*s,(i=(n=2*this.radius_g*s)*n-4*e*this.C)<0)return t.x=Number.NaN,t.y=Number.NaN,t;r=(-n-Math.sqrt(i))/(2*e),s=this.radius_g+r*s,o*=r,a*=r,t.x=Math.atan2(o,s),t.y=Math.atan(a*Math.cos(t.x)/s),t.y=Math.atan(this.radius_p_inv2*Math.tan(t.y))}else if("sphere"===this.shape){if(this.flip_axis?(a=Math.tan(t.y/this.radius_g_1),o=Math.tan(t.x/this.radius_g_1)*Math.sqrt(1+a*a)):(o=Math.tan(t.x/this.radius_g_1),a=Math.tan(t.y/this.radius_g_1)*Math.sqrt(1+o*o)),e=o*o+a*a+s*s,(i=(n=2*this.radius_g*s)*n-4*e*this.C)<0)return t.x=Number.NaN,t.y=Number.NaN,t;r=(-n-Math.sqrt(i))/(2*e),s=this.radius_g+r*s,o*=r,a*=r,t.x=Math.atan2(o,s),t.y=Math.atan(a*Math.cos(t.x)/s)}return t.x=t.x+this.long0,t},names:["Geostationary Satellite View","Geostationary_Satellite","geos"]};Of.defaultDatum="WGS84",Of.Proj=pf,Of.WGS84=new Of.Proj("WGS84"),Of.Point=Xf,Of.toPoint=wf,Of.defs=qu,Of.nadgrid=function(t,e){var n=new DataView(e),i=function(t){var e=t.getInt32(8,!1);if(11===e)return!1;11!==(e=t.getInt32(8,!0))&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian");return!0}(n),r=function(t,e){return{nFields:t.getInt32(8,e),nSubgridFields:t.getInt32(24,e),nSubgrids:t.getInt32(40,e),shiftType:cf(t,56,64).trim(),fromSemiMajorAxis:t.getFloat64(120,e),fromSemiMinorAxis:t.getFloat64(136,e),toSemiMajorAxis:t.getFloat64(152,e),toSemiMinorAxis:t.getFloat64(168,e)}}(n,i);r.nSubgrids>1&&console.log("Only single NTv2 subgrids are currently supported, subsequent sub grids are ignored");var s=function(t,e,n){for(var i=176,r=[],s=0;s<e.nSubgrids;s++){var o=ff(t,i,n),a=df(t,i,o,n),l=Math.round(1+(o.upperLongitude-o.lowerLongitude)/o.longitudeInterval),h=Math.round(1+(o.upperLatitude-o.lowerLatitude)/o.latitudeInterval);r.push({ll:[hf(o.lowerLongitude),hf(o.lowerLatitude)],del:[hf(o.longitudeInterval),hf(o.latitudeInterval)],lim:[l,h],count:o.gridNodeCount,cvs:uf(a)})}return r}(n,r,i),o={header:r,subgrids:s};return af[t]=o,o},Of.transform=Nf,Of.mgrs=zf,Of.version="__VERSION__",function(t){t.Proj.projections.add(td),t.Proj.projections.add(od),t.Proj.projections.add(ad),t.Proj.projections.add(cd),t.Proj.projections.add(ud),t.Proj.projections.add(fd),t.Proj.projections.add(pd),t.Proj.projections.add(gd),t.Proj.projections.add(_d),t.Proj.projections.add(Nd),t.Proj.projections.add(Ad),t.Proj.projections.add(Pd),t.Proj.projections.add(Dd),t.Proj.projections.add(zd),t.Proj.projections.add(Fd),t.Proj.projections.add(Gd),t.Proj.projections.add(qd),t.Proj.projections.add(jd),t.Proj.projections.add(Bd),t.Proj.projections.add(Ud),t.Proj.projections.add(Yd),t.Proj.projections.add(Wd),t.Proj.projections.add($d),t.Proj.projections.add(Xd),t.Proj.projections.add(op),t.Proj.projections.add(pp),t.Proj.projections.add(gp),t.Proj.projections.add(bp),t.Proj.projections.add(Mp)}(Of);const wp=Object.assign({},{geoProjection:Rr});Of.defs([["epsg:2154","+title=France Lambert93 +proj=lcc +lat_1=49 +lat_2=44 +lat_0=46.5 +lon_0=3 +x_0=700000 +y_0=6600000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"]]),Of.defs([["epsg:3035","+title=Europa (ETRS89/LAEA) +proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs"]]),Of.defs([["epsg:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs"]]),Of.defs([["epsg:27700","+title=British National Grid -- United Kingdom +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy +towgs84=446.448,-125.157,542.06,0.15,0.247,0.842,-20.489 +units=m +no_defs"]]),Of.defs([["epsg:42304","+title=NAD83 / NRCan LCC Canada +proj=lcc +lat_1=49 +lat_2=77 +lat_0=49 +lon_0=-95 +x_0=0 +y_0=0 +datum=NAD83 +units=m +no_defs "]]);const Ep=Object.assign({},{geoEquirectangular:Hr,geoIdentity:ss});function Np(t){if(null==t||""===t)return Ep.geoEquirectangular();if("function"==typeof t)return t;if("string"==typeof t){if("Polar"==(t=t.replace(/\s/g,"")))return nu.geoAzimuthalEquidistant().scale(190).rotate([0,-90]).clipAngle(150);if("HoaXiaoguang"==t)return iu.geoHufnagel().a(.8).b(.35).psiMax(50).ratio(1.6).angle(90).rotate([110,-200,90]);if("Spilhaus"==t)return ru.geoProjection(pu).rotate([-66.94970198,49.56371678,40.17823482]);if("user"===t)return Ep.geoIdentity().reflectY(!0);if("+proj"===t.substring(0,5)||"epsg:"===t.substring(0,5))return function(t){let e;+t==t&&(e=Of("epsg:"+t)),e||(e=Of(t));const n=180/Math.PI,i=1/n,r=function(t,i){return e.forward([t*n,i*n])};r.invert=function(t,n){return e.inverse([t,n]).map((function(t){return t*i}))};const s=wp.geoProjection(r).scale(1);return s.raw=e,s}(t);if("user"!==t&&"+proj"!==t.substring(0,5)&&"epsg:"!==t.substring(0,5))return function(t){let e=t;return e=e.replace(/\s/g,""),"d3.geo"!==e.substring(0,6)&&(-1===e.indexOf(".")?e+="()":e=e.replace(".","()."),e="d3.geo"+e),new Function("d3",`return (${e})`)(eu)}(t)}}const Sp=Object.assign({},{geoPath:vr,geoGraticule:_i});function Ip(t){let e=[],n=-180;for(;n<=180;)e.push([n,t]),n+=2.5;return{type:"MultiLineString",coordinates:[e]}}const kp=Object.assign({},{geoPath:vr});function Op(t,e,n,i={},r){if(0!=i.display&&!n){let n=null!=i.stroke?i.stroke:"#020e21";Array.isArray(n)||(n=Array(3).fill(n));let s=null!=i.strokeWidth?i.strokeWidth:[1.5,1.2,.7];Array.isArray(s)||(s=Array(3).fill(s));let o=null!=i.strokeOpacity?i.strokeOpacity:1;Array.isArray(o)||(o=Array(3).fill(o));let a=null!=i.strokeDasharray?i.strokeDasharray:["none",5,3];Array.isArray(a)||(a=Array(3).fill(a));let l=null!=i.strokeLinecap?i.strokeLinecap:"butt";Array.isArray(l)||(l=Array(3).fill(l));let h=function(){let t=[];return[["Equator",0],["Tropic of Cancer",23.43656],["Tropic of Capricorn",-23.43636],["Arctic Circle",66.56345],["Antarctic Circle",-66.56364]].forEach((e=>{t.push({type:"Feature",properties:{name:e[0],latitude:e[1]},geometry:Ip(e[1])})})),{type:"FeatureCollection",features:t}}().features,c=h.filter((t=>"Equator"==t.properties.name)),u=h.filter((t=>t.properties.name.includes("Tropic"))),f=h.filter((t=>t.properties.name.includes("Circle")));t.append("g").attr("clip-path",null==r?"none":`url(#clip_${r})`).selectAll("path").data(c).join("path").attr("d",kp.geoPath(e)).attr("fill","none").attr("stroke",n[0]).attr("stroke-width",s[0]).attr("stroke-opacity",o[0]).attr("stroke-dasharray",a[0]).attr("stroke-linecap",l[0]),t.append("g").attr("clip-path",null==r?"none":`url(#clip_${r})`).selectAll("path").data(u).join("path").attr("d",kp.geoPath(e)).attr("fill","none").attr("stroke",n[1]).attr("stroke-width",s[1]).attr("stroke-opacity",o[1]).attr("stroke-dasharray",a[1]).attr("stroke-linecap",l[1]),t.append("g").attr("clip-path",null==r?"none":`url(#clip_${r})`).selectAll("path").data(f).join("path").attr("d",kp.geoPath(e)).attr("fill","none").attr("stroke",n[2]).attr("stroke-width",s[2]).attr("stroke-opacity",o[2]).attr("stroke-dasharray",a[2]).attr("stroke-linecap",l[2])}}const Cp=Object.assign({},{geoPath:vr});function Tp(t,e,n,i={}){if(0!=i.display&&!n){let n=i.fill?i.fill:"#add8f7",r=null!=i.fillOpacity?i.fillOpacity:1,s=i.stroke?i.stroke:"none",o=null!=i.strokeWidth?i.strokeWidth:1;t.append("g").append("path").attr("d",Cp.geoPath(e)({type:"Sphere"})).attr("fill",n).attr("fill-opacity",r).attr("stroke",s).attr("stroke-width",o)}}const Rp=Math.PI,Ap=2*Rp,Lp=1e-6,Pp=Ap-Lp;function Dp(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function zp(){return new Dp}function Fp(t){return function(){return t}}Dp.prototype=zp.prototype={constructor:Dp,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,i){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(t,e,n,i,r,s){this._+="C"+ +t+","+ +e+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+s)},arcTo:function(t,e,n,i,r){t=+t,e=+e,n=+n,i=+i,r=+r;var s=this._x1,o=this._y1,a=n-t,l=i-e,h=s-t,c=o-e,u=h*h+c*c;if(r<0)throw new Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(u>Lp)if(Math.abs(c*a-l*h)>Lp&&r){var f=n-s,d=i-o,p=a*a+l*l,g=f*f+d*d,_=Math.sqrt(p),y=Math.sqrt(u),m=r*Math.tan((Rp-Math.acos((p+u-g)/(2*_*y)))/2),x=m/y,v=m/_;Math.abs(x-1)>Lp&&(this._+="L"+(t+x*h)+","+(e+x*c)),this._+="A"+r+","+r+",0,0,"+ +(c*f>h*d)+","+(this._x1=t+v*a)+","+(this._y1=e+v*l)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,i,r,s){t=+t,e=+e,s=!!s;var o=(n=+n)*Math.cos(i),a=n*Math.sin(i),l=t+o,h=e+a,c=1^s,u=s?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+l+","+h:(Math.abs(this._x1-l)>Lp||Math.abs(this._y1-h)>Lp)&&(this._+="L"+l+","+h),n&&(u<0&&(u=u%Ap+Ap),u>Pp?this._+="A"+n+","+n+",0,1,"+c+","+(t-o)+","+(e-a)+"A"+n+","+n+",0,1,"+c+","+(this._x1=l)+","+(this._y1=h):u>Lp&&(this._+="A"+n+","+n+",0,"+ +(u>=Rp)+","+c+","+(this._x1=t+n*Math.cos(r))+","+(this._y1=e+n*Math.sin(r))))},rect:function(t,e,n,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};const Gp=Math.abs,qp=Math.atan2,jp=Math.cos,Bp=Math.max,Up=Math.min,Yp=Math.sin,Wp=Math.sqrt,$p=1e-12,Xp=Math.PI,Vp=Xp/2,Hp=2*Xp;function Zp(t){return t>1?0:t<-1?Xp:Math.acos(t)}function Jp(t){return t>=1?Vp:t<=-1?-Vp:Math.asin(t)}function Qp(t){return t.innerRadius}function Kp(t){return t.outerRadius}function tg(t){return t.startAngle}function eg(t){return t.endAngle}function ng(t){return t&&t.padAngle}function ig(t,e,n,i,r,s,o,a){var l=n-t,h=i-e,c=o-r,u=a-s,f=u*l-c*h;if(!(f*f<$p))return[t+(f=(c*(e-s)-u*(t-r))/f)*l,e+f*h]}function rg(t,e,n,i,r,s,o){var a=t-n,l=e-i,h=(o?s:-s)/Wp(a*a+l*l),c=h*l,u=-h*a,f=t+c,d=e+u,p=n+c,g=i+u,_=(f+p)/2,y=(d+g)/2,m=p-f,x=g-d,v=m*m+x*x,b=r-s,M=f*g-p*d,w=(x<0?-1:1)*Wp(Bp(0,b*b*v-M*M)),E=(M*x-m*w)/v,N=(-M*m-x*w)/v,S=(M*x+m*w)/v,I=(-M*m+x*w)/v,k=E-_,O=N-y,C=S-_,T=I-y;return k*k+O*O>C*C+T*T&&(E=S,N=I),{cx:E,cy:N,x01:-c,y01:-u,x11:E*(r/b-1),y11:N*(r/b-1)}}var sg=Array.prototype.slice;function og(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function ag(t){this._context=t}function lg(t){return new ag(t)}function hg(t){return t[0]}function cg(t){return t[1]}function ug(t,e){var n=Fp(!0),i=null,r=lg,s=null;function o(o){var a,l,h,c=(o=og(o)).length,u=!1;for(null==i&&(s=r(h=zp())),a=0;a<=c;++a)!(a<c&&n(l=o[a],a,o))===u&&((u=!u)?s.lineStart():s.lineEnd()),u&&s.point(+t(l,a,o),+e(l,a,o));if(h)return s=null,h+""||null}return t="function"==typeof t?t:void 0===t?hg:Fp(t),e="function"==typeof e?e:void 0===e?cg:Fp(e),o.x=function(e){return arguments.length?(t="function"==typeof e?e:Fp(+e),o):t},o.y=function(t){return arguments.length?(e="function"==typeof t?t:Fp(+t),o):e},o.defined=function(t){return arguments.length?(n="function"==typeof t?t:Fp(!!t),o):n},o.curve=function(t){return arguments.length?(r=t,null!=i&&(s=r(i)),o):r},o.context=function(t){return arguments.length?(null==t?i=s=null:s=r(i=t),o):i},o}function fg(t,e,n){var i=null,r=Fp(!0),s=null,o=lg,a=null;function l(l){var h,c,u,f,d,p=(l=og(l)).length,g=!1,_=new Array(p),y=new Array(p);for(null==s&&(a=o(d=zp())),h=0;h<=p;++h){if(!(h<p&&r(f=l[h],h,l))===g)if(g=!g)c=h,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),u=h-1;u>=c;--u)a.point(_[u],y[u]);a.lineEnd(),a.areaEnd()}g&&(_[h]=+t(f,h,l),y[h]=+e(f,h,l),a.point(i?+i(f,h,l):_[h],n?+n(f,h,l):y[h]))}if(d)return a=null,d+""||null}function h(){return ug().defined(r).curve(o).context(s)}return t="function"==typeof t?t:void 0===t?hg:Fp(+t),e="function"==typeof e?e:Fp(void 0===e?0:+e),n="function"==typeof n?n:void 0===n?cg:Fp(+n),l.x=function(e){return arguments.length?(t="function"==typeof e?e:Fp(+e),i=null,l):t},l.x0=function(e){return arguments.length?(t="function"==typeof e?e:Fp(+e),l):t},l.x1=function(t){return arguments.length?(i=null==t?null:"function"==typeof t?t:Fp(+t),l):i},l.y=function(t){return arguments.length?(e="function"==typeof t?t:Fp(+t),n=null,l):e},l.y0=function(t){return arguments.length?(e="function"==typeof t?t:Fp(+t),l):e},l.y1=function(t){return arguments.length?(n=null==t?null:"function"==typeof t?t:Fp(+t),l):n},l.lineX0=l.lineY0=function(){return h().x(t).y(e)},l.lineY1=function(){return h().x(t).y(n)},l.lineX1=function(){return h().x(i).y(e)},l.defined=function(t){return arguments.length?(r="function"==typeof t?t:Fp(!!t),l):r},l.curve=function(t){return arguments.length?(o=t,null!=s&&(a=o(s)),l):o},l.context=function(t){return arguments.length?(null==t?s=a=null:a=o(s=t),l):s},l}function dg(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function pg(t){return t}ag.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var gg=yg(lg);function _g(t){this._curve=t}function yg(t){function e(e){return new _g(t(e))}return e._curve=t,e}function mg(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?e(yg(t)):e()._curve},t}function xg(){return mg(ug().curve(gg))}function vg(){var t=fg().curve(gg),e=t.curve,n=t.lineX0,i=t.lineX1,r=t.lineY0,s=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return mg(n())},delete t.lineX0,t.lineEndAngle=function(){return mg(i())},delete t.lineX1,t.lineInnerRadius=function(){return mg(r())},delete t.lineY0,t.lineOuterRadius=function(){return mg(s())},delete t.lineY1,t.curve=function(t){return arguments.length?e(yg(t)):e()._curve},t}function bg(t,e){return[(e=+e)*Math.cos(t-=Math.PI/2),e*Math.sin(t)]}_g.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};class Mg{constructor(t,e){this._context=t,this._x=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line}point(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,e,t,e):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+e)/2,t,this._y0,t,e)}this._x0=t,this._y0=e}}class wg{constructor(t){this._context=t}lineStart(){this._point=0}lineEnd(){}point(t,e){if(t=+t,e=+e,0==this._point++)this._x0=t,this._y0=e;else{const n=bg(this._x0,this._y0),i=bg(this._x0,this._y0=(this._y0+e)/2),r=bg(t,this._y0),s=bg(t,e);this._context.moveTo(...n),this._context.bezierCurveTo(...i,...r,...s)}}}function Eg(t){return new Mg(t,!0)}function Ng(t){return new Mg(t,!1)}function Sg(t){return new wg(t)}function Ig(t){return t.source}function kg(t){return t.target}function Og(t){let e=Ig,n=kg,i=hg,r=cg,s=null,o=null;function a(){let a;const l=sg.call(arguments),h=e.apply(this,l),c=n.apply(this,l);if(null==s&&(o=t(a=zp())),o.lineStart(),l[0]=h,o.point(+i.apply(this,l),+r.apply(this,l)),l[0]=c,o.point(+i.apply(this,l),+r.apply(this,l)),o.lineEnd(),a)return o=null,a+""||null}return a.source=function(t){return arguments.length?(e=t,a):e},a.target=function(t){return arguments.length?(n=t,a):n},a.x=function(t){return arguments.length?(i="function"==typeof t?t:Fp(+t),a):i},a.y=function(t){return arguments.length?(r="function"==typeof t?t:Fp(+t),a):r},a.context=function(e){return arguments.length?(null==e?s=o=null:o=t(s=e),a):s},a}const Cg=Wp(3);var Tg={draw(t,e){const n=.59436*Wp(e+Up(e/28,.75)),i=n/2,r=i*Cg;t.moveTo(0,n),t.lineTo(0,-n),t.moveTo(-r,-i),t.lineTo(r,i),t.moveTo(-r,i),t.lineTo(r,-i)}},Rg={draw(t,e){const n=Wp(e/Xp);t.moveTo(n,0),t.arc(0,0,n,0,Hp)}},Ag={draw(t,e){const n=Wp(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}};const Lg=Wp(1/3),Pg=2*Lg;var Dg={draw(t,e){const n=Wp(e/Pg),i=n*Lg;t.moveTo(0,-n),t.lineTo(i,0),t.lineTo(0,n),t.lineTo(-i,0),t.closePath()}},zg={draw(t,e){const n=.62625*Wp(e);t.moveTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.lineTo(-n,0),t.closePath()}},Fg={draw(t,e){const n=.87559*Wp(e-Up(e/7,2));t.moveTo(-n,0),t.lineTo(n,0),t.moveTo(0,n),t.lineTo(0,-n)}},Gg={draw(t,e){const n=Wp(e),i=-n/2;t.rect(i,i,n,n)}},qg={draw(t,e){const n=.4431*Wp(e);t.moveTo(n,n),t.lineTo(n,-n),t.lineTo(-n,-n),t.lineTo(-n,n),t.closePath()}};const jg=Yp(Xp/10)/Yp(7*Xp/10),Bg=Yp(Hp/10)*jg,Ug=-jp(Hp/10)*jg;var Yg={draw(t,e){const n=Wp(.8908130915292852*e),i=Bg*n,r=Ug*n;t.moveTo(0,-n),t.lineTo(i,r);for(let e=1;e<5;++e){const s=Hp*e/5,o=jp(s),a=Yp(s);t.lineTo(a*n,-o*n),t.lineTo(o*i-a*r,a*i+o*r)}t.closePath()}};const Wg=Wp(3);var $g={draw(t,e){const n=-Wp(e/(3*Wg));t.moveTo(0,2*n),t.lineTo(-Wg*n,-n),t.lineTo(Wg*n,-n),t.closePath()}};const Xg=Wp(3);var Vg={draw(t,e){const n=.6824*Wp(e),i=n/2,r=n*Xg/2;t.moveTo(0,-n),t.lineTo(r,i),t.lineTo(-r,i),t.closePath()}};const Hg=-.5,Zg=Wp(3)/2,Jg=1/Wp(12),Qg=3*(Jg/2+1);var Kg={draw(t,e){const n=Wp(e/Qg),i=n/2,r=n*Jg,s=i,o=n*Jg+n,a=-s,l=o;t.moveTo(i,r),t.lineTo(s,o),t.lineTo(a,l),t.lineTo(Hg*i-Zg*r,Zg*i+Hg*r),t.lineTo(Hg*s-Zg*o,Zg*s+Hg*o),t.lineTo(Hg*a-Zg*l,Zg*a+Hg*l),t.lineTo(Hg*i+Zg*r,Hg*r-Zg*i),t.lineTo(Hg*s+Zg*o,Hg*o-Zg*s),t.lineTo(Hg*a+Zg*l,Hg*l-Zg*a),t.closePath()}},t_={draw(t,e){const n=.6189*Wp(e-Up(e/6,1.7));t.moveTo(-n,-n),t.lineTo(n,n),t.moveTo(-n,n),t.lineTo(n,-n)}};const e_=[Rg,Ag,Dg,Gg,Yg,$g,Kg],n_=[Rg,Fg,t_,Vg,Tg,qg,zg];function i_(t,e){let n=null;function i(){let i;if(n||(n=i=zp()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),i)return n=null,i+""||null}return t="function"==typeof t?t:Fp(t||Rg),e="function"==typeof e?e:Fp(void 0===e?64:+e),i.type=function(e){return arguments.length?(t="function"==typeof e?e:Fp(e),i):t},i.size=function(t){return arguments.length?(e="function"==typeof t?t:Fp(+t),i):e},i.context=function(t){return arguments.length?(n=null==t?null:t,i):n},i}function r_(){}function s_(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function o_(t){this._context=t}function a_(t){this._context=t}function l_(t){this._context=t}function h_(t,e){this._basis=new o_(t),this._beta=e}o_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:s_(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:s_(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},a_.prototype={areaStart:r_,areaEnd:r_,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:s_(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},l_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,i=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:s_(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},h_.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var i,r=t[0],s=e[0],o=t[n]-r,a=e[n]-s,l=-1;++l<=n;)i=l/n,this._basis.point(this._beta*t[l]+(1-this._beta)*(r+i*o),this._beta*e[l]+(1-this._beta)*(s+i*a));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var c_=function t(e){function n(t){return 1===e?new o_(t):new h_(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function u_(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function f_(t,e){this._context=t,this._k=(1-e)/6}f_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:u_(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:u_(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var d_=function t(e){function n(t){return new f_(t,e)}return n.tension=function(e){return t(+e)},n}(0);function p_(t,e){this._context=t,this._k=(1-e)/6}p_.prototype={areaStart:r_,areaEnd:r_,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:u_(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var g_=function t(e){function n(t){return new p_(t,e)}return n.tension=function(e){return t(+e)},n}(0);function __(t,e){this._context=t,this._k=(1-e)/6}__.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:u_(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var y_=function t(e){function n(t){return new __(t,e)}return n.tension=function(e){return t(+e)},n}(0);function m_(t,e,n){var i=t._x1,r=t._y1,s=t._x2,o=t._y2;if(t._l01_a>$p){var a=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,l=3*t._l01_a*(t._l01_a+t._l12_a);i=(i*a-t._x0*t._l12_2a+t._x2*t._l01_2a)/l,r=(r*a-t._y0*t._l12_2a+t._y2*t._l01_2a)/l}if(t._l23_a>$p){var h=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,c=3*t._l23_a*(t._l23_a+t._l12_a);s=(s*h+t._x1*t._l23_2a-e*t._l12_2a)/c,o=(o*h+t._y1*t._l23_2a-n*t._l12_2a)/c}t._context.bezierCurveTo(i,r,s,o,t._x2,t._y2)}function x_(t,e){this._context=t,this._alpha=e}x_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:m_(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var v_=function t(e){function n(t){return e?new x_(t,e):new f_(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function b_(t,e){this._context=t,this._alpha=e}b_.prototype={areaStart:r_,areaEnd:r_,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:m_(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var M_=function t(e){function n(t){return e?new b_(t,e):new p_(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function w_(t,e){this._context=t,this._alpha=e}w_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:m_(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var E_=function t(e){function n(t){return e?new w_(t,e):new __(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function N_(t){this._context=t}function S_(t){return t<0?-1:1}function I_(t,e,n){var i=t._x1-t._x0,r=e-t._x1,s=(t._y1-t._y0)/(i||r<0&&-0),o=(n-t._y1)/(r||i<0&&-0),a=(s*r+o*i)/(i+r);return(S_(s)+S_(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(a))||0}function k_(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function O_(t,e,n){var i=t._x0,r=t._y0,s=t._x1,o=t._y1,a=(s-i)/3;t._context.bezierCurveTo(i+a,r+a*e,s-a,o-a*n,s,o)}function C_(t){this._context=t}function T_(t){this._context=new R_(t)}function R_(t){this._context=t}function A_(t){this._context=t}function L_(t){var e,n,i=t.length-1,r=new Array(i),s=new Array(i),o=new Array(i);for(r[0]=0,s[0]=2,o[0]=t[0]+2*t[1],e=1;e<i-1;++e)r[e]=1,s[e]=4,o[e]=4*t[e]+2*t[e+1];for(r[i-1]=2,s[i-1]=7,o[i-1]=8*t[i-1]+t[i],e=1;e<i;++e)n=r[e]/s[e-1],s[e]-=n,o[e]-=n*o[e-1];for(r[i-1]=o[i-1]/s[i-1],e=i-2;e>=0;--e)r[e]=(o[e]-r[e+1])/s[e];for(s[i-1]=(t[i]+r[i-1])/2,e=0;e<i-1;++e)s[e]=2*t[e+1]-r[e+1];return[r,s]}function P_(t,e){this._context=t,this._t=e}function D_(t,e){if((r=t.length)>1)for(var n,i,r,s=1,o=t[e[0]],a=o.length;s<r;++s)for(i=o,o=t[e[s]],n=0;n<a;++n)o[n][1]+=o[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function z_(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function F_(t,e){return t[e]}function G_(t){const e=[];return e.key=t,e}function q_(t){var e=t.map(j_);return z_(t).sort((function(t,n){return e[t]-e[n]}))}function j_(t){for(var e,n=-1,i=0,r=t.length,s=-1/0;++n<r;)(e=+t[n][1])>s&&(s=e,i=n);return i}function B_(t){var e=t.map(U_);return z_(t).sort((function(t,n){return e[t]-e[n]}))}function U_(t){for(var e,n=0,i=-1,r=t.length;++i<r;)(e=+t[i][1])&&(n+=e);return n}N_.prototype={areaStart:r_,areaEnd:r_,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}},C_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:O_(this,this._t0,k_(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,O_(this,k_(this,n=I_(this,t,e)),n);break;default:O_(this,this._t0,n=I_(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(T_.prototype=Object.create(C_.prototype)).point=function(t,e){C_.prototype.point.call(this,e,t)},R_.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,i,r,s){this._context.bezierCurveTo(e,t,i,n,s,r)}},A_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var i=L_(t),r=L_(e),s=0,o=1;o<n;++s,++o)this._context.bezierCurveTo(i[0][s],r[0][s],i[1][s],r[1][s],t[o],e[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},P_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};var Y_=Object.freeze({__proto__:null,arc:function(){var t=Qp,e=Kp,n=Fp(0),i=null,r=tg,s=eg,o=ng,a=null;function l(){var l,h,c=+t.apply(this,arguments),u=+e.apply(this,arguments),f=r.apply(this,arguments)-Vp,d=s.apply(this,arguments)-Vp,p=Gp(d-f),g=d>f;if(a||(a=l=zp()),u<c&&(h=u,u=c,c=h),u>$p)if(p>Hp-$p)a.moveTo(u*jp(f),u*Yp(f)),a.arc(0,0,u,f,d,!g),c>$p&&(a.moveTo(c*jp(d),c*Yp(d)),a.arc(0,0,c,d,f,g));else{var _,y,m=f,x=d,v=f,b=d,M=p,w=p,E=o.apply(this,arguments)/2,N=E>$p&&(i?+i.apply(this,arguments):Wp(c*c+u*u)),S=Up(Gp(u-c)/2,+n.apply(this,arguments)),I=S,k=S;if(N>$p){var O=Jp(N/c*Yp(E)),C=Jp(N/u*Yp(E));(M-=2*O)>$p?(v+=O*=g?1:-1,b-=O):(M=0,v=b=(f+d)/2),(w-=2*C)>$p?(m+=C*=g?1:-1,x-=C):(w=0,m=x=(f+d)/2)}var T=u*jp(m),R=u*Yp(m),A=c*jp(b),L=c*Yp(b);if(S>$p){var P,D=u*jp(x),z=u*Yp(x),F=c*jp(v),G=c*Yp(v);if(p<Xp&&(P=ig(T,R,F,G,D,z,A,L))){var q=T-P[0],j=R-P[1],B=D-P[0],U=z-P[1],Y=1/Yp(Zp((q*B+j*U)/(Wp(q*q+j*j)*Wp(B*B+U*U)))/2),W=Wp(P[0]*P[0]+P[1]*P[1]);I=Up(S,(c-W)/(Y-1)),k=Up(S,(u-W)/(Y+1))}}w>$p?k>$p?(_=rg(F,G,T,R,u,k,g),y=rg(D,z,A,L,u,k,g),a.moveTo(_.cx+_.x01,_.cy+_.y01),k<S?a.arc(_.cx,_.cy,k,qp(_.y01,_.x01),qp(y.y01,y.x01),!g):(a.arc(_.cx,_.cy,k,qp(_.y01,_.x01),qp(_.y11,_.x11),!g),a.arc(0,0,u,qp(_.cy+_.y11,_.cx+_.x11),qp(y.cy+y.y11,y.cx+y.x11),!g),a.arc(y.cx,y.cy,k,qp(y.y11,y.x11),qp(y.y01,y.x01),!g))):(a.moveTo(T,R),a.arc(0,0,u,m,x,!g)):a.moveTo(T,R),c>$p&&M>$p?I>$p?(_=rg(A,L,D,z,c,-I,g),y=rg(T,R,F,G,c,-I,g),a.lineTo(_.cx+_.x01,_.cy+_.y01),I<S?a.arc(_.cx,_.cy,I,qp(_.y01,_.x01),qp(y.y01,y.x01),!g):(a.arc(_.cx,_.cy,I,qp(_.y01,_.x01),qp(_.y11,_.x11),!g),a.arc(0,0,c,qp(_.cy+_.y11,_.cx+_.x11),qp(y.cy+y.y11,y.cx+y.x11),g),a.arc(y.cx,y.cy,I,qp(y.y11,y.x11),qp(y.y01,y.x01),!g))):a.arc(0,0,c,b,v,g):a.lineTo(A,L)}else a.moveTo(0,0);if(a.closePath(),l)return a=null,l+""||null}return l.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,i=(+r.apply(this,arguments)+ +s.apply(this,arguments))/2-Xp/2;return[jp(i)*n,Yp(i)*n]},l.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:Fp(+e),l):t},l.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:Fp(+t),l):e},l.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:Fp(+t),l):n},l.padRadius=function(t){return arguments.length?(i=null==t?null:"function"==typeof t?t:Fp(+t),l):i},l.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:Fp(+t),l):r},l.endAngle=function(t){return arguments.length?(s="function"==typeof t?t:Fp(+t),l):s},l.padAngle=function(t){return arguments.length?(o="function"==typeof t?t:Fp(+t),l):o},l.context=function(t){return arguments.length?(a=null==t?null:t,l):a},l},area:fg,line:ug,pie:function(){var t=pg,e=dg,n=null,i=Fp(0),r=Fp(Hp),s=Fp(0);function o(o){var a,l,h,c,u,f=(o=og(o)).length,d=0,p=new Array(f),g=new Array(f),_=+i.apply(this,arguments),y=Math.min(Hp,Math.max(-Hp,r.apply(this,arguments)-_)),m=Math.min(Math.abs(y)/f,s.apply(this,arguments)),x=m*(y<0?-1:1);for(a=0;a<f;++a)(u=g[p[a]=a]=+t(o[a],a,o))>0&&(d+=u);for(null!=e?p.sort((function(t,n){return e(g[t],g[n])})):null!=n&&p.sort((function(t,e){return n(o[t],o[e])})),a=0,h=d?(y-f*x)/d:0;a<f;++a,_=c)l=p[a],c=_+((u=g[l])>0?u*h:0)+x,g[l]={data:o[l],index:a,value:u,startAngle:_,endAngle:c,padAngle:m};return g}return o.value=function(e){return arguments.length?(t="function"==typeof e?e:Fp(+e),o):t},o.sortValues=function(t){return arguments.length?(e=t,n=null,o):e},o.sort=function(t){return arguments.length?(n=t,e=null,o):n},o.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:Fp(+t),o):i},o.endAngle=function(t){return arguments.length?(r="function"==typeof t?t:Fp(+t),o):r},o.padAngle=function(t){return arguments.length?(s="function"==typeof t?t:Fp(+t),o):s},o},areaRadial:vg,radialArea:vg,lineRadial:xg,radialLine:xg,pointRadial:bg,link:Og,linkHorizontal:function(){return Og(Eg)},linkVertical:function(){return Og(Ng)},linkRadial:function(){const t=Og(Sg);return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t},symbol:i_,symbolsStroke:n_,symbolsFill:e_,symbols:e_,symbolAsterisk:Tg,symbolCircle:Rg,symbolCross:Ag,symbolDiamond:Dg,symbolDiamond2:zg,symbolPlus:Fg,symbolSquare:Gg,symbolSquare2:qg,symbolStar:Yg,symbolTriangle:$g,symbolTriangle2:Vg,symbolWye:Kg,symbolX:t_,curveBasisClosed:function(t){return new a_(t)},curveBasisOpen:function(t){return new l_(t)},curveBasis:function(t){return new o_(t)},curveBumpX:Eg,curveBumpY:Ng,curveBundle:c_,curveCardinalClosed:g_,curveCardinalOpen:y_,curveCardinal:d_,curveCatmullRomClosed:M_,curveCatmullRomOpen:E_,curveCatmullRom:v_,curveLinearClosed:function(t){return new N_(t)},curveLinear:lg,curveMonotoneX:function(t){return new C_(t)},curveMonotoneY:function(t){return new T_(t)},curveNatural:function(t){return new A_(t)},curveStep:function(t){return new P_(t,.5)},curveStepAfter:function(t){return new P_(t,1)},curveStepBefore:function(t){return new P_(t,0)},stack:function(){var t=Fp([]),e=z_,n=D_,i=F_;function r(r){var s,o,a=Array.from(t.apply(this,arguments),G_),l=a.length,h=-1;for(const t of r)for(s=0,++h;s<l;++s)(a[s][h]=[0,+i(t,a[s].key,h,r)]).data=t;for(s=0,o=og(e(a));s<l;++s)a[o[s]].index=s;return n(a,o),a}return r.keys=function(e){return arguments.length?(t="function"==typeof e?e:Fp(Array.from(e)),r):t},r.value=function(t){return arguments.length?(i="function"==typeof t?t:Fp(+t),r):i},r.order=function(t){return arguments.length?(e=null==t?z_:"function"==typeof t?t:Fp(Array.from(t)),r):e},r.offset=function(t){return arguments.length?(n=null==t?D_:t,r):n},r},stackOffsetExpand:function(t,e){if((i=t.length)>0){for(var n,i,r,s=0,o=t[0].length;s<o;++s){for(r=n=0;n<i;++n)r+=t[n][s][1]||0;if(r)for(n=0;n<i;++n)t[n][s][1]/=r}D_(t,e)}},stackOffsetDiverging:function(t,e){if((a=t.length)>0)for(var n,i,r,s,o,a,l=0,h=t[e[0]].length;l<h;++l)for(s=o=0,n=0;n<a;++n)(r=(i=t[e[n]][l])[1]-i[0])>0?(i[0]=s,i[1]=s+=r):r<0?(i[1]=o,i[0]=o+=r):(i[0]=0,i[1]=r)},stackOffsetNone:D_,stackOffsetSilhouette:function(t,e){if((n=t.length)>0){for(var n,i=0,r=t[e[0]],s=r.length;i<s;++i){for(var o=0,a=0;o<n;++o)a+=t[o][i][1]||0;r[i][1]+=r[i][0]=-a/2}D_(t,e)}},stackOffsetWiggle:function(t,e){if((r=t.length)>0&&(i=(n=t[e[0]]).length)>0){for(var n,i,r,s=0,o=1;o<i;++o){for(var a=0,l=0,h=0;a<r;++a){for(var c=t[e[a]],u=c[o][1]||0,f=(u-(c[o-1][1]||0))/2,d=0;d<a;++d){var p=t[e[d]];f+=(p[o][1]||0)-(p[o-1][1]||0)}l+=u,h+=f*u}n[o-1][1]+=n[o-1][0]=s,l&&(s-=h/l)}n[o-1][1]+=n[o-1][0]=s,D_(t,e)}},stackOrderAppearance:q_,stackOrderAscending:B_,stackOrderDescending:function(t){return B_(t).reverse()},stackOrderInsideOut:function(t){var e,n,i=t.length,r=t.map(U_),s=q_(t),o=0,a=0,l=[],h=[];for(e=0;e<i;++e)n=s[e],o<a?(o+=r[n],l.push(n)):(a+=r[n],h.push(n));return h.reverse().concat(l)},stackOrderNone:z_,stackOrderReverse:function(t){return z_(t).reverse()}});function W_(t,e,n,i){if(isNaN(e)||isNaN(n))return t;var r,s,o,a,l,h,c,u,f,d=t._root,p={data:i},g=t._x0,_=t._y0,y=t._x1,m=t._y1;if(!d)return t._root=p,t;for(;d.length;)if((h=e>=(s=(g+y)/2))?g=s:y=s,(c=n>=(o=(_+m)/2))?_=o:m=o,r=d,!(d=d[u=c<<1|h]))return r[u]=p,t;if(a=+t._x.call(null,d.data),l=+t._y.call(null,d.data),e===a&&n===l)return p.next=d,r?r[u]=p:t._root=p,t;do{r=r?r[u]=new Array(4):t._root=new Array(4),(h=e>=(s=(g+y)/2))?g=s:y=s,(c=n>=(o=(_+m)/2))?_=o:m=o}while((u=c<<1|h)==(f=(l>=o)<<1|a>=s));return r[f]=d,r[u]=p,t}function $_(t,e,n,i,r){this.node=t,this.x0=e,this.y0=n,this.x1=i,this.y1=r}function X_(t){return t[0]}function V_(t){return t[1]}function H_(t,e,n){var i=new Z_(null==e?X_:e,null==n?V_:n,NaN,NaN,NaN,NaN);return null==t?i:i.addAll(t)}function Z_(t,e,n,i,r,s){this._x=t,this._y=e,this._x0=n,this._y0=i,this._x1=r,this._y1=s,this._root=void 0}function J_(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var Q_=H_.prototype=Z_.prototype;function K_(t){return function(){return t}}function ty(t){return 1e-6*(t()-.5)}function ey(t){return t.x+t.vx}function ny(t){return t.y+t.vy}function iy(t){var e,n,i,r=1,s=1;function o(){for(var t,o,l,h,c,u,f,d=e.length,p=0;p<s;++p)for(o=H_(e,ey,ny).visitAfter(a),t=0;t<d;++t)l=e[t],u=n[l.index],f=u*u,h=l.x+l.vx,c=l.y+l.vy,o.visit(g);function g(t,e,n,s,o){var a=t.data,d=t.r,p=u+d;if(!a)return e>h+p||s<h-p||n>c+p||o<c-p;if(a.index>l.index){var g=h-a.x-a.vx,_=c-a.y-a.vy,y=g*g+_*_;y<p*p&&(0===g&&(y+=(g=ty(i))*g),0===_&&(y+=(_=ty(i))*_),y=(p-(y=Math.sqrt(y)))/y*r,l.vx+=(g*=y)*(p=(d*=d)/(f+d)),l.vy+=(_*=y)*p,a.vx-=g*(p=1-p),a.vy-=_*p)}}}function a(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function l(){if(e){var i,r,s=e.length;for(n=new Array(s),i=0;i<s;++i)r=e[i],n[r.index]=+t(r,i,e)}}return"function"!=typeof t&&(t=K_(null==t?1:+t)),o.initialize=function(t,n){e=t,i=n,l()},o.iterations=function(t){return arguments.length?(s=+t,o):s},o.strength=function(t){return arguments.length?(r=+t,o):r},o.radius=function(e){return arguments.length?(t="function"==typeof e?e:K_(+e),l(),o):t},o}Q_.copy=function(){var t,e,n=new Z_(this._x,this._y,this._x0,this._y0,this._x1,this._y1),i=this._root;if(!i)return n;if(!i.length)return n._root=J_(i),n;for(t=[{source:i,target:n._root=new Array(4)}];i=t.pop();)for(var r=0;r<4;++r)(e=i.source[r])&&(e.length?t.push({source:e,target:i.target[r]=new Array(4)}):i.target[r]=J_(e));return n},Q_.add=function(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return W_(this.cover(e,n),e,n,t)},Q_.addAll=function(t){var e,n,i,r,s=t.length,o=new Array(s),a=new Array(s),l=1/0,h=1/0,c=-1/0,u=-1/0;for(n=0;n<s;++n)isNaN(i=+this._x.call(null,e=t[n]))||isNaN(r=+this._y.call(null,e))||(o[n]=i,a[n]=r,i<l&&(l=i),i>c&&(c=i),r<h&&(h=r),r>u&&(u=r));if(l>c||h>u)return this;for(this.cover(l,h).cover(c,u),n=0;n<s;++n)W_(this,o[n],a[n],t[n]);return this},Q_.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,r=this._x1,s=this._y1;if(isNaN(n))r=(n=Math.floor(t))+1,s=(i=Math.floor(e))+1;else{for(var o,a,l=r-n||1,h=this._root;n>t||t>=r||i>e||e>=s;)switch(a=(e<i)<<1|t<n,(o=new Array(4))[a]=h,h=o,l*=2,a){case 0:r=n+l,s=i+l;break;case 1:n=r-l,s=i+l;break;case 2:r=n+l,i=s-l;break;case 3:n=r-l,i=s-l}this._root&&this._root.length&&(this._root=h)}return this._x0=n,this._y0=i,this._x1=r,this._y1=s,this},Q_.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},Q_.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Q_.find=function(t,e,n){var i,r,s,o,a,l,h,c=this._x0,u=this._y0,f=this._x1,d=this._y1,p=[],g=this._root;for(g&&p.push(new $_(g,c,u,f,d)),null==n?n=1/0:(c=t-n,u=e-n,f=t+n,d=e+n,n*=n);l=p.pop();)if(!(!(g=l.node)||(r=l.x0)>f||(s=l.y0)>d||(o=l.x1)<c||(a=l.y1)<u))if(g.length){var _=(r+o)/2,y=(s+a)/2;p.push(new $_(g[3],_,y,o,a),new $_(g[2],r,y,_,a),new $_(g[1],_,s,o,y),new $_(g[0],r,s,_,y)),(h=(e>=y)<<1|t>=_)&&(l=p[p.length-1],p[p.length-1]=p[p.length-1-h],p[p.length-1-h]=l)}else{var m=t-+this._x.call(null,g.data),x=e-+this._y.call(null,g.data),v=m*m+x*x;if(v<n){var b=Math.sqrt(n=v);c=t-b,u=e-b,f=t+b,d=e+b,i=g.data}}return i},Q_.remove=function(t){if(isNaN(s=+this._x.call(null,t))||isNaN(o=+this._y.call(null,t)))return this;var e,n,i,r,s,o,a,l,h,c,u,f,d=this._root,p=this._x0,g=this._y0,_=this._x1,y=this._y1;if(!d)return this;if(d.length)for(;;){if((h=s>=(a=(p+_)/2))?p=a:_=a,(c=o>=(l=(g+y)/2))?g=l:y=l,e=d,!(d=d[u=c<<1|h]))return this;if(!d.length)break;(e[u+1&3]||e[u+2&3]||e[u+3&3])&&(n=e,f=u)}for(;d.data!==t;)if(i=d,!(d=d.next))return this;return(r=d.next)&&delete d.next,i?(r?i.next=r:delete i.next,this):e?(r?e[u]=r:delete e[u],(d=e[0]||e[1]||e[2]||e[3])&&d===(e[3]||e[2]||e[1]||e[0])&&!d.length&&(n?n[f]=d:this._root=d),this):(this._root=r,this)},Q_.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},Q_.root=function(){return this._root},Q_.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},Q_.visit=function(t){var e,n,i,r,s,o,a=[],l=this._root;for(l&&a.push(new $_(l,this._x0,this._y0,this._x1,this._y1));e=a.pop();)if(!t(l=e.node,i=e.x0,r=e.y0,s=e.x1,o=e.y1)&&l.length){var h=(i+s)/2,c=(r+o)/2;(n=l[3])&&a.push(new $_(n,h,c,s,o)),(n=l[2])&&a.push(new $_(n,i,c,h,o)),(n=l[1])&&a.push(new $_(n,h,r,s,c)),(n=l[0])&&a.push(new $_(n,i,r,h,c))}return this},Q_.visitAfter=function(t){var e,n=[],i=[];for(this._root&&n.push(new $_(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var r=e.node;if(r.length){var s,o=e.x0,a=e.y0,l=e.x1,h=e.y1,c=(o+l)/2,u=(a+h)/2;(s=r[0])&&n.push(new $_(s,o,a,c,u)),(s=r[1])&&n.push(new $_(s,c,a,l,u)),(s=r[2])&&n.push(new $_(s,o,u,c,h)),(s=r[3])&&n.push(new $_(s,c,u,l,h))}i.push(e)}for(;e=i.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},Q_.x=function(t){return arguments.length?(this._x=t,this):this._x},Q_.y=function(t){return arguments.length?(this._y=t,this):this._y};var ry={value:()=>{}};function sy(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new oy(i)}function oy(t){this._=t}function ay(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function ly(t,e){for(var n,i=0,r=t.length;i<r;++i)if((n=t[i]).name===e)return n.value}function hy(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=ry,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}oy.prototype=sy.prototype={constructor:oy,on:function(t,e){var n,i=this._,r=ay(t+"",i),s=-1,o=r.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++s<o;)if(n=(t=r[s]).type)i[n]=hy(i[n],t.name,e);else if(null==e)for(n in i)i[n]=hy(i[n],t.name,null);return this}for(;++s<o;)if((n=(t=r[s]).type)&&(n=ly(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new oy(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,r=new Array(n),s=0;s<n;++s)r[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=0,n=(i=this._[t]).length;s<n;++s)i[s].value.apply(e,r)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,s=i.length;r<s;++r)i[r].value.apply(e,n)}};var cy,uy,fy=0,dy=0,py=0,gy=0,_y=0,yy=0,my="object"==typeof performance&&performance.now?performance:Date,xy="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function vy(){return _y||(xy(by),_y=my.now()+yy)}function by(){_y=0}function My(){this._call=this._time=this._next=null}function wy(t,e,n){var i=new My;return i.restart(t,e,n),i}function Ey(){_y=(gy=my.now())+yy,fy=dy=0;try{!function(){vy(),++fy;for(var t,e=cy;e;)(t=_y-e._time)>=0&&e._call.call(void 0,t),e=e._next;--fy}()}finally{fy=0,function(){var t,e,n=cy,i=1/0;for(;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:cy=e);uy=t,Sy(i)}(),_y=0}}function Ny(){var t=my.now(),e=t-gy;e>1e3&&(yy-=e,gy=t)}function Sy(t){fy||(dy&&(dy=clearTimeout(dy)),t-_y>24?(t<1/0&&(dy=setTimeout(Ey,t-my.now()-yy)),py&&(py=clearInterval(py))):(py||(gy=my.now(),py=setInterval(Ny,1e3)),fy=1,xy(Ey)))}My.prototype=wy.prototype={constructor:My,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?vy():+n)+(null==e?0:+e),this._next||uy===this||(uy?uy._next=this:cy=this,uy=this),this._call=t,this._time=n,Sy()},stop:function(){this._call&&(this._call=null,this._time=1/0,Sy())}};const Iy=4294967296;var ky=Math.PI*(3-Math.sqrt(5));function Oy(t){var e,n=1,i=.001,r=1-Math.pow(i,1/300),s=0,o=.6,a=new Map,l=wy(u),h=sy("tick","end"),c=function(){let t=1;return()=>(t=(1664525*t+1013904223)%Iy)/Iy}();function u(){f(),h.call("tick",e),n<i&&(l.stop(),h.call("end",e))}function f(i){var l,h,c=t.length;void 0===i&&(i=1);for(var u=0;u<i;++u)for(n+=(s-n)*r,a.forEach((function(t){t(n)})),l=0;l<c;++l)null==(h=t[l]).fx?h.x+=h.vx*=o:(h.x=h.fx,h.vx=0),null==h.fy?h.y+=h.vy*=o:(h.y=h.fy,h.vy=0);return e}function d(){for(var e,n=0,i=t.length;n<i;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var r=10*Math.sqrt(.5+n),s=n*ky;e.x=r*Math.cos(s),e.y=r*Math.sin(s)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function p(e){return e.initialize&&e.initialize(t,c),e}return null==t&&(t=[]),d(),e={tick:f,restart:function(){return l.restart(u),e},stop:function(){return l.stop(),e},nodes:function(n){return arguments.length?(t=n,d(),a.forEach(p),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(i=+t,e):i},alphaDecay:function(t){return arguments.length?(r=+t,e):+r},alphaTarget:function(t){return arguments.length?(s=+t,e):s},velocityDecay:function(t){return arguments.length?(o=1-t,e):1-o},randomSource:function(t){return arguments.length?(c=t,a.forEach(p),e):c},force:function(t,n){return arguments.length>1?(null==n?a.delete(t):a.set(t,p(n)),e):a.get(t)},find:function(e,n,i){var r,s,o,a,l,h=0,c=t.length;for(null==i?i=1/0:i*=i,h=0;h<c;++h)(o=(r=e-(a=t[h]).x)*r+(s=n-a.y)*s)<i&&(l=a,i=o);return l},on:function(t,n){return arguments.length>1?(h.on(t,n),e):h.on(t)}}}function Cy(t){var e,n,i,r=K_(.1);function s(t){for(var r,s=0,o=e.length;s<o;++s)(r=e[s]).vx+=(i[s]-r.x)*n[s]*t}function o(){if(e){var s,o=e.length;for(n=new Array(o),i=new Array(o),s=0;s<o;++s)n[s]=isNaN(i[s]=+t(e[s],s,e))?0:+r(e[s],s,e)}}return"function"!=typeof t&&(t=K_(null==t?0:+t)),s.initialize=function(t){e=t,o()},s.strength=function(t){return arguments.length?(r="function"==typeof t?t:K_(+t),o(),s):r},s.x=function(e){return arguments.length?(t="function"==typeof e?e:K_(+e),o(),s):t},s}function Ty(t){var e,n,i,r=K_(.1);function s(t){for(var r,s=0,o=e.length;s<o;++s)(r=e[s]).vy+=(i[s]-r.y)*n[s]*t}function o(){if(e){var s,o=e.length;for(n=new Array(o),i=new Array(o),s=0;s<o;++s)n[s]=isNaN(i[s]=+t(e[s],s,e))?0:+r(e[s],s,e)}}return"function"!=typeof t&&(t=K_(null==t?0:+t)),s.initialize=function(t){e=t,o()},s.strength=function(t){return arguments.length?(r="function"==typeof t?t:K_(+t),o(),s):r},s.y=function(e){return arguments.length?(t="function"==typeof e?e:K_(+e),o(),s):t},s}const Ry=Object.assign({},{symbol:i_,symbolCircle:Rg,symbolDiamond:Dg,symbolCross:Ag,symbolSquare:Gg,symbolStar:Yg,symbolTriangle:$g,symbolWye:Kg});function Ay(t,e={}){let n=e.type?e.type:"box",i=e.x?e.x:null,r=e.y?e.y:null,s=null!=e.w?e.w:30,o=null!=e.h?e.h:20,a=e.title?e.title:null,l=e.text?e.text:"leg_text",h=null!=e.fontSize?e.fontSize:14,c=null!=e.fontSize2?e.fontSize2:10,u=e.stroke?e.stroke:"black",f=e.fill?e.fill:"#CCCCCC",d=null!=e.fillOpacity?e.fillOpacity:1,p=null!=e.strokeWidth?e.strokeWidth:.5,g=e.txtcol?e.txtcol:"#363636";if(null!=i&&null!=r){let _=t.append("g").attr("class","bertinlegend"),y=0;null!=a&&(y=(a.split("\n").length+1)*h,_.append("g").selectAll("text").data(a.split("\n")).join("text").attr("x",i).attr("y",r).attr("font-size",`${h}px`).attr("dy",((t,e)=>e*h)).attr("text-anchor","start").attr("dominant-baseline","hanging").attr("fill",g).text((t=>t))),"box"==n&&(_.append("rect").attr("x",i).attr("y",r+y).attr("height",o).attr("width",s).attr("fill",f).attr("stroke",u).attr("stroke-width",p).attr("fill-opacity",d),_.append("g").selectAll("text").data(l.split("\n")).join("text").attr("x",i+s+c/2).attr("y",r+o/2-c*l.split("\n").length/2+y).attr("font-size",`${c}px`).attr("dy",((t,e)=>e*c)).attr("fill",g).attr("text-anchor","start").attr("dominant-baseline","hanging").text((t=>t)));const m=new Map([["circle",Ry.symbolCircle],["cross",Ry.symbolCross],["diamond",Ry.symbolDiamond],["square",Ry.symbolSquare],["star",Ry.symbolStar],["triangle",Ry.symbolTriangle],["wye",Ry.symbolWye]]);if(m.has(n)){const t=e.symbol_size;_.append("path").attr("x",i).attr("y",r+y).attr("d",Ry.symbol().size(t).type(m.get(n))).attr("transform",`translate(${i+Math.sqrt(t)},${r+y})`).attr("fill",f).attr("stroke",u).attr("stroke-width",p).attr("fill-opacity",d),_.append("g").selectAll("text").data(l.split("\n")).join("text").attr("x",i+2*Math.sqrt(t)+c/2).attr("y",r+y).attr("font-size",`${c}px`).attr("dy",((t,e)=>e*c)).attr("fill",g).attr("text-anchor","start").attr("dominant-baseline","middle").text((t=>t))}}}const Ly=Object.assign({},{reverse:Mt});function Py(t,e={}){let n=e.x?e.x:null,i=e.y?e.y:null,r=e.w?e.w:30,s=e.h?e.h:20,o=e.title?e.title:null,a=e.fontSize?e.fontSize:14,l=e.fontSize2?e.fontSize2:10,h=e.stroke?e.stroke:"black",c=e.fillOpacity?e.fillOpacity:1,u=e.strokeWidth?e.strokeWidth:.5,f=e.txtcol?e.txtcol:"#363636",d=e.breaks,p=e.colors,g=e.missing;const _=null!=g?p.length:-1,y=null==g?Ly.reverse(d):[Ly.reverse(d),g[0]].flat(),m=null==g?Ly.reverse(p):[Ly.reverse(p),g[1]].flat();if(null!=n&&null!=i){let e=t.append("g").attr("class","bertinlegend"),d=0;null!=o&&(d=(o.split("\n").length+1)*a,e.append("g").selectAll("text").data(o.split("\n")).join("text").attr("x",n).attr("y",i).attr("font-size",`${a}px`).attr("dy",((t,e)=>e*a)).attr("text-anchor","start").attr("dominant-baseline","hanging").attr("fill",f).text((t=>t))),e.selectAll("rect").data(m).join("rect").attr("x",n).attr("y",((t,e)=>i+d+(s+0)*e+(e===_?s/2:0))).attr("height",s).attr("width",r).attr("fill",(t=>t)).attr("stroke",h).attr("stroke-width",u).attr("fill-opacity",c),e.append("g").selectAll("text").data(y).join("text").attr("x",n+r+l/2).attr("y",i+d).attr("font-size",`${l}px`).attr("fill",f).attr("dy",((t,e)=>(s+0)*e)).attr("text-anchor","start").attr("dominant-baseline","central").text((t=>t))}}function Dy(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function zy(t,e){switch(arguments.length){case 0:break;case 1:"function"==typeof t?this.interpolator(t):this.range(t);break;default:this.domain(t),"function"==typeof e?this.interpolator(e):this.range(e)}return this}const Fy=Symbol("implicit");function Gy(){var t=new S,e=[],n=[],i=Fy;function r(r){let s=t.get(r);if(void 0===s){if(i!==Fy)return i;t.set(r,s=e.push(r)-1)}return n[s%n.length]}return r.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new S;for(const i of n)t.has(i)||t.set(i,e.push(i)-1);return r},r.range=function(t){return arguments.length?(n=Array.from(t),r):n.slice()},r.unknown=function(t){return arguments.length?(i=t,r):i},r.copy=function(){return Gy(e,n).unknown(i)},Dy.apply(r,arguments),r}function qy(){var t,e,n=Gy().unknown(void 0),i=n.domain,r=n.range,s=0,o=1,a=!1,l=0,h=0,c=.5;function u(){var n=i().length,u=o<s,f=u?o:s,d=u?s:o;t=(d-f)/Math.max(1,n-l+2*h),a&&(t=Math.floor(t)),f+=(d-f-t*(n-l))*c,e=t*(1-l),a&&(f=Math.round(f),e=Math.round(e));var p=gt(n).map((function(e){return f+t*e}));return r(u?p.reverse():p)}return delete n.unknown,n.domain=function(t){return arguments.length?(i(t),u()):i()},n.range=function(t){return arguments.length?([s,o]=t,s=+s,o=+o,u()):[s,o]},n.rangeRound=function(t){return[s,o]=t,s=+s,o=+o,a=!0,u()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(a=!!t,u()):a},n.padding=function(t){return arguments.length?(l=Math.min(1,h=+t),u()):l},n.paddingInner=function(t){return arguments.length?(l=Math.min(1,t),u()):l},n.paddingOuter=function(t){return arguments.length?(h=+t,u()):h},n.align=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),u()):c},n.copy=function(){return qy(i(),[s,o]).round(a).paddingInner(l).paddingOuter(h).align(c)},Dy.apply(u(),arguments)}function jy(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return jy(e())},t}function By(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Uy(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function Yy(){}var Wy=.7,$y=1/Wy,Xy="\\s*([+-]?\\d+)\\s*",Vy="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Hy="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Zy=/^#([0-9a-f]{3,8})$/,Jy=new RegExp(`^rgb\\(${Xy},${Xy},${Xy}\\)$`),Qy=new RegExp(`^rgb\\(${Hy},${Hy},${Hy}\\)$`),Ky=new RegExp(`^rgba\\(${Xy},${Xy},${Xy},${Vy}\\)$`),tm=new RegExp(`^rgba\\(${Hy},${Hy},${Hy},${Vy}\\)$`),em=new RegExp(`^hsl\\(${Vy},${Hy},${Hy}\\)$`),nm=new RegExp(`^hsla\\(${Vy},${Hy},${Hy},${Vy}\\)$`),im={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function rm(){return this.rgb().formatHex()}function sm(){return this.rgb().formatRgb()}function om(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Zy.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?am(e):3===n?new um(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?lm(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?lm(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Jy.exec(t))?new um(e[1],e[2],e[3],1):(e=Qy.exec(t))?new um(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Ky.exec(t))?lm(e[1],e[2],e[3],e[4]):(e=tm.exec(t))?lm(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=em.exec(t))?ym(e[1],e[2]/100,e[3]/100,1):(e=nm.exec(t))?ym(e[1],e[2]/100,e[3]/100,e[4]):im.hasOwnProperty(t)?am(im[t]):"transparent"===t?new um(NaN,NaN,NaN,0):null}function am(t){return new um(t>>16&255,t>>8&255,255&t,1)}function lm(t,e,n,i){return i<=0&&(t=e=n=NaN),new um(t,e,n,i)}function hm(t){return t instanceof Yy||(t=om(t)),t?new um((t=t.rgb()).r,t.g,t.b,t.opacity):new um}function cm(t,e,n,i){return 1===arguments.length?hm(t):new um(t,e,n,null==i?1:i)}function um(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function fm(){return`#${_m(this.r)}${_m(this.g)}${_m(this.b)}`}function dm(){const t=pm(this.opacity);return`${1===t?"rgb(":"rgba("}${gm(this.r)}, ${gm(this.g)}, ${gm(this.b)}${1===t?")":`, ${t})`}`}function pm(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function gm(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function _m(t){return((t=gm(t))<16?"0":"")+t.toString(16)}function ym(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new xm(t,e,n,i)}function mm(t){if(t instanceof xm)return new xm(t.h,t.s,t.l,t.opacity);if(t instanceof Yy||(t=om(t)),!t)return new xm;if(t instanceof xm)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),s=Math.max(e,n,i),o=NaN,a=s-r,l=(s+r)/2;return a?(o=e===s?(n-i)/a+6*(n<i):n===s?(i-e)/a+2:(e-n)/a+4,a/=l<.5?s+r:2-s-r,o*=60):a=l>0&&l<1?0:o,new xm(o,a,l,t.opacity)}function xm(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function vm(t){return(t=(t||0)%360)<0?t+360:t}function bm(t){return Math.max(0,Math.min(1,t||0))}function Mm(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}By(Yy,om,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:rm,formatHex:rm,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return mm(this).formatHsl()},formatRgb:sm,toString:sm}),By(um,cm,Uy(Yy,{brighter(t){return t=null==t?$y:Math.pow($y,t),new um(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?Wy:Math.pow(Wy,t),new um(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new um(gm(this.r),gm(this.g),gm(this.b),pm(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:fm,formatHex:fm,formatHex8:function(){return`#${_m(this.r)}${_m(this.g)}${_m(this.b)}${_m(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:dm,toString:dm})),By(xm,(function(t,e,n,i){return 1===arguments.length?mm(t):new xm(t,e,n,null==i?1:i)}),Uy(Yy,{brighter(t){return t=null==t?$y:Math.pow($y,t),new xm(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?Wy:Math.pow(Wy,t),new xm(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new um(Mm(t>=240?t-240:t+120,r,i),Mm(t,r,i),Mm(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new xm(vm(this.h),bm(this.s),bm(this.l),pm(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=pm(this.opacity);return`${1===t?"hsl(":"hsla("}${vm(this.h)}, ${100*bm(this.s)}%, ${100*bm(this.l)}%${1===t?")":`, ${t})`}`}}));const wm=Math.PI/180,Em=180/Math.PI;var Nm=-.14861,Sm=1.78277,Im=-.29227,km=-.90649,Om=1.97294,Cm=Om*km,Tm=Om*Sm,Rm=Sm*Im-km*Nm;function Am(t){if(t instanceof Pm)return new Pm(t.h,t.s,t.l,t.opacity);t instanceof um||(t=hm(t));var e=t.r/255,n=t.g/255,i=t.b/255,r=(Rm*i+Cm*e-Tm*n)/(Rm+Cm-Tm),s=i-r,o=(Om*(n-r)-Im*s)/km,a=Math.sqrt(o*o+s*s)/(Om*r*(1-r)),l=a?Math.atan2(o,s)*Em-120:NaN;return new Pm(l<0?l+360:l,a,r,t.opacity)}function Lm(t,e,n,i){return 1===arguments.length?Am(t):new Pm(t,e,n,null==i?1:i)}function Pm(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}By(Pm,Lm,Uy(Yy,{brighter(t){return t=null==t?$y:Math.pow($y,t),new Pm(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?Wy:Math.pow(Wy,t),new Pm(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=isNaN(this.h)?0:(this.h+120)*wm,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),i=Math.cos(t),r=Math.sin(t);return new um(255*(e+n*(Nm*i+Sm*r)),255*(e+n*(Im*i+km*r)),255*(e+n*(Om*i)),this.opacity)}}));var Dm=t=>()=>t;function zm(t,e){return function(n){return t+n*e}}function Fm(t){return 1==(t=+t)?Gm:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}(e,n,t):Dm(isNaN(e)?n:e)}}function Gm(t,e){var n=e-t;return n?zm(t,n):Dm(isNaN(t)?e:t)}var qm=function t(e){var n=Fm(e);function i(t,e){var i=n((t=cm(t)).r,(e=cm(e)).r),r=n(t.g,e.g),s=n(t.b,e.b),o=Gm(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=r(e),t.b=s(e),t.opacity=o(e),t+""}}return i.gamma=t,i}(1);var jm,Bm=(jm=function(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],s=t[i+1],o=i>0?t[i-1]:2*r-s,a=i<e-1?t[i+2]:2*s-r;return function(t,e,n,i,r){var s=t*t,o=s*t;return((1-3*t+3*s-o)*e+(4-6*s+3*o)*n+(1+3*t+3*s-3*o)*i+o*r)/6}((n-i/e)*e,o,r,s,a)}},function(t){var e,n,i=t.length,r=new Array(i),s=new Array(i),o=new Array(i);for(e=0;e<i;++e)n=cm(t[e]),r[e]=n.r||0,s[e]=n.g||0,o[e]=n.b||0;return r=jm(r),s=jm(s),o=jm(o),n.opacity=1,function(t){return n.r=r(t),n.g=s(t),n.b=o(t),n+""}});function Um(t,e){e||(e=[]);var n,i=t?Math.min(e.length,t.length):0,r=e.slice();return function(s){for(n=0;n<i;++n)r[n]=t[n]*(1-s)+e[n]*s;return r}}function Ym(t,e){var n,i=e?e.length:0,r=t?Math.min(i,t.length):0,s=new Array(r),o=new Array(i);for(n=0;n<r;++n)s[n]=Jm(t[n],e[n]);for(;n<i;++n)o[n]=e[n];return function(t){for(n=0;n<r;++n)o[n]=s[n](t);return o}}function Wm(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function $m(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Xm(t,e){var n,i={},r={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?i[n]=Jm(t[n],e[n]):r[n]=e[n];return function(t){for(n in i)r[n]=i[n](t);return r}}var Vm=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Hm=new RegExp(Vm.source,"g");function Zm(t,e){var n,i,r,s=Vm.lastIndex=Hm.lastIndex=0,o=-1,a=[],l=[];for(t+="",e+="";(n=Vm.exec(t))&&(i=Hm.exec(e));)(r=i.index)>s&&(r=e.slice(s,r),a[o]?a[o]+=r:a[++o]=r),(n=n[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,l.push({i:o,x:$m(n,i)})),s=Hm.lastIndex;return s<e.length&&(r=e.slice(s),a[o]?a[o]+=r:a[++o]=r),a.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,i=0;i<e;++i)a[(n=l[i]).i]=n.x(t);return a.join("")})}function Jm(t,e){var n,i=typeof e;return null==e||"boolean"===i?Dm(e):("number"===i?$m:"string"===i?(n=om(e))?(e=n,qm):Zm:e instanceof om?qm:e instanceof Date?Wm:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}(e)?Um:Array.isArray(e)?Ym:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Xm:$m)(t,e)}function Qm(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function Km(t){return function e(n){function i(e,i){var r=t((e=Lm(e)).h,(i=Lm(i)).h),s=Gm(e.s,i.s),o=Gm(e.l,i.l),a=Gm(e.opacity,i.opacity);return function(t){return e.h=r(t),e.s=s(t),e.l=o(Math.pow(t,n)),e.opacity=a(t),e+""}}return n=+n,i.gamma=e,i}(1)}Km((function(t,e){var n=e-t;return n?zm(t,n>180||n<-180?n-360*Math.round(n/360):n):Dm(isNaN(t)?e:t)}));var tx=Km(Gm);function ex(t,e){void 0===e&&(e=t,t=Jm);for(var n=0,i=e.length-1,r=e[0],s=new Array(i<0?0:i);n<i;)s[n]=t(r,r=e[++n]);return function(t){var e=Math.max(0,Math.min(i-1,Math.floor(t*=i)));return s[e](t-e)}}function nx(t){return+t}var ix=[0,1];function rx(t){return t}function sx(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:function(t){return function(){return t}}(isNaN(e)?NaN:.5)}function ox(t,e,n){var i=t[0],r=t[1],s=e[0],o=e[1];return r<i?(i=sx(r,i),s=n(o,s)):(i=sx(i,r),s=n(s,o)),function(t){return s(i(t))}}function ax(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),s=new Array(i),o=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<i;)r[o]=sx(t[o],t[o+1]),s[o]=n(e[o],e[o+1]);return function(e){var n=u(t,e,1,i)-1;return s[n](r[n](e))}}function lx(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function hx(){var t,e,n,i,r,s,o=ix,a=ix,l=Jm,h=rx;function c(){var t=Math.min(o.length,a.length);return h!==rx&&(h=function(t,e){var n;return t>e&&(n=t,t=e,e=n),function(n){return Math.max(t,Math.min(e,n))}}(o[0],o[t-1])),i=t>2?ax:ox,r=s=null,u}function u(e){return null==e||isNaN(e=+e)?n:(r||(r=i(o.map(t),a,l)))(t(h(e)))}return u.invert=function(n){return h(e((s||(s=i(a,o.map(t),$m)))(n)))},u.domain=function(t){return arguments.length?(o=Array.from(t,nx),c()):o.slice()},u.range=function(t){return arguments.length?(a=Array.from(t),c()):a.slice()},u.rangeRound=function(t){return a=Array.from(t),l=Qm,c()},u.clamp=function(t){return arguments.length?(h=!!t||rx,c()):h!==rx},u.interpolate=function(t){return arguments.length?(l=t,c()):l},u.unknown=function(t){return arguments.length?(n=t,u):n},function(n,i){return t=n,e=i,c()}}function cx(){return hx()(rx,rx)}function ux(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function fx(t){return(t=ux(Math.abs(t)))?t[1]:NaN}var dx,px=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function gx(t){if(!(e=px.exec(t)))throw new Error("invalid format: "+t);var e;return new _x({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function _x(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function yx(t,e){var n=ux(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}gx.prototype=_x.prototype,_x.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var mx={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>yx(100*t,e),r:yx,s:function(t,e){var n=ux(t,e);if(!n)return t+"";var i=n[0],r=n[1],s=r-(dx=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,o=i.length;return s===o?i:s>o?i+new Array(s-o+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+ux(t,Math.max(0,e+s-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function xx(t){return t}var vx,bx,Mx,wx=Array.prototype.map,Ex=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Nx(t){var e,n,i=void 0===t.grouping||void 0===t.thousands?xx:(e=wx.call(t.grouping,Number),n=t.thousands+"",function(t,i){for(var r=t.length,s=[],o=0,a=e[0],l=0;r>0&&a>0&&(l+a+1>i&&(a=Math.max(1,i-l)),s.push(t.substring(r-=a,r+a)),!((l+=a+1)>i));)a=e[o=(o+1)%e.length];return s.reverse().join(n)}),r=void 0===t.currency?"":t.currency[0]+"",s=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",a=void 0===t.numerals?xx:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(wx.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",h=void 0===t.minus?"":t.minus+"",c=void 0===t.nan?"NaN":t.nan+"";function u(t){var e=(t=gx(t)).fill,n=t.align,u=t.sign,f=t.symbol,d=t.zero,p=t.width,g=t.comma,_=t.precision,y=t.trim,m=t.type;"n"===m?(g=!0,m="g"):mx[m]||(void 0===_&&(_=12),y=!0,m="g"),(d||"0"===e&&"="===n)&&(d=!0,e="0",n="=");var x="$"===f?r:"#"===f&&/[boxX]/.test(m)?"0"+m.toLowerCase():"",v="$"===f?s:/[%p]/.test(m)?l:"",b=mx[m],M=/[defgprs%]/.test(m);function w(t){var r,s,l,f=x,w=v;if("c"===m)w=b(t)+w,t="";else{var E=(t=+t)<0||1/t<0;if(t=isNaN(t)?c:b(Math.abs(t),_),y&&(t=function(t){t:for(var e,n=t.length,i=1,r=-1;i<n;++i)switch(t[i]){case".":r=e=i;break;case"0":0===r&&(r=i),e=i;break;default:if(!+t[i])break t;r>0&&(r=0)}return r>0?t.slice(0,r)+t.slice(e+1):t}(t)),E&&0==+t&&"+"!==u&&(E=!1),f=(E?"("===u?u:h:"-"===u||"("===u?"":u)+f,w=("s"===m?Ex[8+dx/3]:"")+w+(E&&"("===u?")":""),M)for(r=-1,s=t.length;++r<s;)if(48>(l=t.charCodeAt(r))||l>57){w=(46===l?o+t.slice(r+1):t.slice(r))+w,t=t.slice(0,r);break}}g&&!d&&(t=i(t,1/0));var N=f.length+t.length+w.length,S=N<p?new Array(p-N+1).join(e):"";switch(g&&d&&(t=i(S+t,S.length?p-w.length:1/0),S=""),n){case"<":t=f+t+w+S;break;case"=":t=f+S+t+w;break;case"^":t=S.slice(0,N=S.length>>1)+f+t+w+S.slice(N);break;default:t=S+f+t+w}return a(t)}return _=void 0===_?6:/[gprs]/.test(m)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_)),w.toString=function(){return t+""},w}return{format:u,formatPrefix:function(t,e){var n=u(((t=gx(t)).type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(fx(e)/3))),r=Math.pow(10,-i),s=Ex[8+i/3];return function(t){return n(r*t)+s}}}}function Sx(t,e,n,i){var r,s=K(t,e,n);switch((i=gx(null==i?",f":i)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=i.precision||isNaN(r=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(fx(e)/3)))-fx(Math.abs(t)))}(s,o))||(i.precision=r),Mx(i,o);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(r=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,fx(e)-fx(t))+1}(s,Math.max(Math.abs(t),Math.abs(e))))||(i.precision=r-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(r=function(t){return Math.max(0,-fx(Math.abs(t)))}(s))||(i.precision=r-2*("%"===i.type))}return bx(i)}function Ix(t){var e=t.domain;return t.ticks=function(t){var n=e();return J(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var i=e();return Sx(i[0],i[i.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var i,r,s=e(),o=0,a=s.length-1,l=s[o],h=s[a],c=10;for(h<l&&(r=l,l=h,h=r,r=o,o=a,a=r);c-- >0;){if((r=Q(l,h,n))===i)return s[o]=l,s[a]=h,e(s);if(r>0)l=Math.floor(l/r)*r,h=Math.ceil(h/r)*r;else{if(!(r<0))break;l=Math.ceil(l*r)/r,h=Math.floor(h*r)/r}i=r}return t},t}function kx(){var t=cx();return t.copy=function(){return lx(t,kx())},Dy.apply(t,arguments),Ix(t)}function Ox(t,e){var n,i=0,r=(t=t.slice()).length-1,s=t[i],o=t[r];return o<s&&(n=i,i=r,r=n,n=s,s=o,o=n),t[i]=e.floor(s),t[r]=e.ceil(o),t}function Cx(t){return Math.log(t)}function Tx(t){return Math.exp(t)}function Rx(t){return-Math.log(-t)}function Ax(t){return-Math.exp(-t)}function Lx(t){return isFinite(t)?+("1e"+t):t<0?0:t}function Px(t){return(e,n)=>-t(-e,n)}function Dx(t){const e=t(Cx,Tx),n=e.domain;let i,r,s=10;function o(){return i=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}(s),r=function(t){return 10===t?Lx:t===Math.E?Math.exp:e=>Math.pow(t,e)}(s),n()[0]<0?(i=Px(i),r=Px(r),t(Rx,Ax)):t(Cx,Tx),e}return e.base=function(t){return arguments.length?(s=+t,o()):s},e.domain=function(t){return arguments.length?(n(t),o()):n()},e.ticks=t=>{const e=n();let o=e[0],a=e[e.length-1];const l=a<o;l&&([o,a]=[a,o]);let h,c,u=i(o),f=i(a);const d=null==t?10:+t;let p=[];if(!(s%1)&&f-u<d){if(u=Math.floor(u),f=Math.ceil(f),o>0){for(;u<=f;++u)for(h=1;h<s;++h)if(c=u<0?h/r(-u):h*r(u),!(c<o)){if(c>a)break;p.push(c)}}else for(;u<=f;++u)for(h=s-1;h>=1;--h)if(c=u>0?h/r(-u):h*r(u),!(c<o)){if(c>a)break;p.push(c)}2*p.length<d&&(p=J(o,a,d))}else p=J(u,f,Math.min(f-u,d)).map(r);return l?p.reverse():p},e.tickFormat=(t,n)=>{if(null==t&&(t=10),null==n&&(n=10===s?"s":","),"function"!=typeof n&&(s%1||null!=(n=gx(n)).precision||(n.trim=!0),n=bx(n)),t===1/0)return n;const o=Math.max(1,s*t/e.ticks().length);return t=>{let e=t/r(Math.round(i(t)));return e*s<s-.5&&(e*=s),e<=o?n(t):""}},e.nice=()=>n(Ox(n(),{floor:t=>r(Math.floor(i(t))),ceil:t=>r(Math.ceil(i(t)))})),e}function zx(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function Fx(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function Gx(t){var e=1,n=t(zx(e),Fx(e));return n.constant=function(n){return arguments.length?t(zx(e=+n),Fx(e)):e},Ix(n)}function qx(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function jx(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Bx(t){return t<0?-t*t:t*t}function Ux(t){var e=t(rx,rx),n=1;function i(){return 1===n?t(rx,rx):.5===n?t(jx,Bx):t(qx(n),qx(1/n))}return e.exponent=function(t){return arguments.length?(n=+t,i()):n},Ix(e)}function Yx(){var t=Ux(hx());return t.copy=function(){return lx(t,Yx()).exponent(t.exponent())},Dy.apply(t,arguments),t}function Wx(){return Yx.apply(null,arguments).exponent(.5)}function $x(t){return Math.sign(t)*t*t}function Xx(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function Vx(){var t,e=[.5],n=[0,1],i=1;function r(r){return null!=r&&r<=r?n[u(e,r,0,i)]:t}return r.domain=function(t){return arguments.length?(e=Array.from(t),i=Math.min(e.length,n.length-1),r):e.slice()},r.range=function(t){return arguments.length?(n=Array.from(t),i=Math.min(e.length,n.length-1),r):n.slice()},r.invertExtent=function(t){var i=n.indexOf(t);return[e[i-1],e[i]]},r.unknown=function(e){return arguments.length?(t=e,r):t},r.copy=function(){return Vx().domain(e).range(n).unknown(t)},Dy.apply(r,arguments)}vx=Nx({thousands:",",grouping:[3],currency:["$",""]}),bx=vx.format,Mx=vx.formatPrefix;var Hx=new Date,Zx=new Date;function Jx(t,e,n,i){function r(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return r.floor=function(e){return t(e=new Date(+e)),e},r.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},r.round=function(t){var e=r(t),n=r.ceil(t);return t-e<n-t?e:n},r.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},r.range=function(n,i,s){var o,a=[];if(n=r.ceil(n),s=null==s?1:Math.floor(s),!(n<i&&s>0))return a;do{a.push(o=new Date(+n)),e(n,s),t(n)}while(o<n&&n<i);return a},r.filter=function(n){return Jx((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,i){if(t>=t)if(i<0)for(;++i<=0;)for(;e(t,-1),!n(t););else for(;--i>=0;)for(;e(t,1),!n(t););}))},n&&(r.count=function(e,i){return Hx.setTime(+e),Zx.setTime(+i),t(Hx),t(Zx),Math.floor(n(Hx,Zx))},r.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?r.filter(i?function(e){return i(e)%t==0}:function(e){return r.count(0,e)%t==0}):r:null}),r}var Qx=Jx((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t}));Qx.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?Jx((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t})):Qx:null};var Kx=Qx;Qx.range;const tv=1e3,ev=6e4,nv=36e5,iv=864e5,rv=6048e5,sv=2592e6,ov=31536e6;var av=Jx((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,e){t.setTime(+t+e*tv)}),(function(t,e){return(e-t)/tv}),(function(t){return t.getUTCSeconds()})),lv=av;av.range;var hv=Jx((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*tv)}),(function(t,e){t.setTime(+t+e*ev)}),(function(t,e){return(e-t)/ev}),(function(t){return t.getMinutes()})),cv=hv;hv.range;var uv=Jx((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*tv-t.getMinutes()*ev)}),(function(t,e){t.setTime(+t+e*nv)}),(function(t,e){return(e-t)/nv}),(function(t){return t.getHours()})),fv=uv;uv.range;var dv=Jx((t=>t.setHours(0,0,0,0)),((t,e)=>t.setDate(t.getDate()+e)),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*ev)/iv),(t=>t.getDate()-1)),pv=dv;function gv(t){return Jx((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*ev)/rv}))}dv.range;var _v=gv(0),yv=gv(1),mv=gv(2),xv=gv(3),vv=gv(4),bv=gv(5),Mv=gv(6);_v.range,yv.range,mv.range,xv.range,vv.range,bv.range,Mv.range;var wv=Jx((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()})),Ev=wv;wv.range;var Nv=Jx((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));Nv.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Jx((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};var Sv=Nv;Nv.range;var Iv=Jx((function(t){t.setUTCSeconds(0,0)}),(function(t,e){t.setTime(+t+e*ev)}),(function(t,e){return(e-t)/ev}),(function(t){return t.getUTCMinutes()})),kv=Iv;Iv.range;var Ov=Jx((function(t){t.setUTCMinutes(0,0,0)}),(function(t,e){t.setTime(+t+e*nv)}),(function(t,e){return(e-t)/nv}),(function(t){return t.getUTCHours()})),Cv=Ov;Ov.range;var Tv=Jx((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/iv}),(function(t){return t.getUTCDate()-1})),Rv=Tv;function Av(t){return Jx((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/rv}))}Tv.range;var Lv=Av(0),Pv=Av(1),Dv=Av(2),zv=Av(3),Fv=Av(4),Gv=Av(5),qv=Av(6);Lv.range,Pv.range,Dv.range,zv.range,Fv.range,Gv.range,qv.range;var jv=Jx((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCMonth(t.getUTCMonth()+e)}),(function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()})),Bv=jv;jv.range;var Uv=Jx((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()}));Uv.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Jx((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};var Yv=Uv;function Wv(t,e,n,r,s,o){const a=[[lv,1,tv],[lv,5,5e3],[lv,15,15e3],[lv,30,3e4],[o,1,ev],[o,5,3e5],[o,15,9e5],[o,30,18e5],[s,1,nv],[s,3,108e5],[s,6,216e5],[s,12,432e5],[r,1,iv],[r,2,1728e5],[n,1,rv],[e,1,sv],[e,3,7776e6],[t,1,ov]];function l(e,n,r){const s=Math.abs(n-e)/r,o=i((([,,t])=>t)).right(a,s);if(o===a.length)return t.every(K(e/ov,n/ov,r));if(0===o)return Kx.every(Math.max(K(e,n,r),1));const[l,h]=a[s/a[o-1][2]<a[o][2]/s?o-1:o];return l.every(h)}return[function(t,e,n){const i=e<t;i&&([t,e]=[e,t]);const r=n&&"function"==typeof n.range?n:l(t,e,n),s=r?r.range(t,+e+1):[];return i?s.reverse():s},l]}Uv.range;const[$v,Xv]=Wv(Yv,Bv,Lv,Rv,Cv,kv),[Vv,Hv]=Wv(Sv,Ev,_v,pv,fv,cv);function Zv(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Jv(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Qv(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}var Kv,tb,eb,nb={"-":"",_:" ",0:"0"},ib=/^\s*\d+/,rb=/^%/,sb=/[\\^$*+?|[\]().{}]/g;function ob(t,e,n){var i=t<0?"-":"",r=(i?-t:t)+"",s=r.length;return i+(s<n?new Array(n-s+1).join(e)+r:r)}function ab(t){return t.replace(sb,"\\$&")}function lb(t){return new RegExp("^(?:"+t.map(ab).join("|")+")","i")}function hb(t){return new Map(t.map(((t,e)=>[t.toLowerCase(),e])))}function cb(t,e,n){var i=ib.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function ub(t,e,n){var i=ib.exec(e.slice(n,n+1));return i?(t.u=+i[0],n+i[0].length):-1}function fb(t,e,n){var i=ib.exec(e.slice(n,n+2));return i?(t.U=+i[0],n+i[0].length):-1}function db(t,e,n){var i=ib.exec(e.slice(n,n+2));return i?(t.V=+i[0],n+i[0].length):-1}function pb(t,e,n){var i=ib.exec(e.slice(n,n+2));return i?(t.W=+i[0],n+i[0].length):-1}function gb(t,e,n){var i=ib.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function _b(t,e,n){var i=ib.exec(e.slice(n,n+2));return i?(t.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function yb(t,e,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return i?(t.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function mb(t,e,n){var i=ib.exec(e.slice(n,n+1));return i?(t.q=3*i[0]-3,n+i[0].length):-1}function xb(t,e,n){var i=ib.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function vb(t,e,n){var i=ib.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function bb(t,e,n){var i=ib.exec(e.slice(n,n+3));return i?(t.m=0,t.d=+i[0],n+i[0].length):-1}function Mb(t,e,n){var i=ib.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function wb(t,e,n){var i=ib.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function Eb(t,e,n){var i=ib.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function Nb(t,e,n){var i=ib.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function Sb(t,e,n){var i=ib.exec(e.slice(n,n+6));return i?(t.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function Ib(t,e,n){var i=rb.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function kb(t,e,n){var i=ib.exec(e.slice(n));return i?(t.Q=+i[0],n+i[0].length):-1}function Ob(t,e,n){var i=ib.exec(e.slice(n));return i?(t.s=+i[0],n+i[0].length):-1}function Cb(t,e){return ob(t.getDate(),e,2)}function Tb(t,e){return ob(t.getHours(),e,2)}function Rb(t,e){return ob(t.getHours()%12||12,e,2)}function Ab(t,e){return ob(1+pv.count(Sv(t),t),e,3)}function Lb(t,e){return ob(t.getMilliseconds(),e,3)}function Pb(t,e){return Lb(t,e)+"000"}function Db(t,e){return ob(t.getMonth()+1,e,2)}function zb(t,e){return ob(t.getMinutes(),e,2)}function Fb(t,e){return ob(t.getSeconds(),e,2)}function Gb(t){var e=t.getDay();return 0===e?7:e}function qb(t,e){return ob(_v.count(Sv(t)-1,t),e,2)}function jb(t){var e=t.getDay();return e>=4||0===e?vv(t):vv.ceil(t)}function Bb(t,e){return t=jb(t),ob(vv.count(Sv(t),t)+(4===Sv(t).getDay()),e,2)}function Ub(t){return t.getDay()}function Yb(t,e){return ob(yv.count(Sv(t)-1,t),e,2)}function Wb(t,e){return ob(t.getFullYear()%100,e,2)}function $b(t,e){return ob((t=jb(t)).getFullYear()%100,e,2)}function Xb(t,e){return ob(t.getFullYear()%1e4,e,4)}function Vb(t,e){var n=t.getDay();return ob((t=n>=4||0===n?vv(t):vv.ceil(t)).getFullYear()%1e4,e,4)}function Hb(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+ob(e/60|0,"0",2)+ob(e%60,"0",2)}function Zb(t,e){return ob(t.getUTCDate(),e,2)}function Jb(t,e){return ob(t.getUTCHours(),e,2)}function Qb(t,e){return ob(t.getUTCHours()%12||12,e,2)}function Kb(t,e){return ob(1+Rv.count(Yv(t),t),e,3)}function tM(t,e){return ob(t.getUTCMilliseconds(),e,3)}function eM(t,e){return tM(t,e)+"000"}function nM(t,e){return ob(t.getUTCMonth()+1,e,2)}function iM(t,e){return ob(t.getUTCMinutes(),e,2)}function rM(t,e){return ob(t.getUTCSeconds(),e,2)}function sM(t){var e=t.getUTCDay();return 0===e?7:e}function oM(t,e){return ob(Lv.count(Yv(t)-1,t),e,2)}function aM(t){var e=t.getUTCDay();return e>=4||0===e?Fv(t):Fv.ceil(t)}function lM(t,e){return t=aM(t),ob(Fv.count(Yv(t),t)+(4===Yv(t).getUTCDay()),e,2)}function hM(t){return t.getUTCDay()}function cM(t,e){return ob(Pv.count(Yv(t)-1,t),e,2)}function uM(t,e){return ob(t.getUTCFullYear()%100,e,2)}function fM(t,e){return ob((t=aM(t)).getUTCFullYear()%100,e,2)}function dM(t,e){return ob(t.getUTCFullYear()%1e4,e,4)}function pM(t,e){var n=t.getUTCDay();return ob((t=n>=4||0===n?Fv(t):Fv.ceil(t)).getUTCFullYear()%1e4,e,4)}function gM(){return"+0000"}function _M(){return"%"}function yM(t){return+t}function mM(t){return Math.floor(+t/1e3)}function xM(t){return new Date(t)}function vM(t){return t instanceof Date?+t:+new Date(+t)}function bM(t,e,n,i,r,s,o,a,l,h){var c=cx(),u=c.invert,f=c.domain,d=h(".%L"),p=h(":%S"),g=h("%I:%M"),_=h("%I %p"),y=h("%a %d"),m=h("%b %d"),x=h("%B"),v=h("%Y");function b(t){return(l(t)<t?d:a(t)<t?p:o(t)<t?g:s(t)<t?_:i(t)<t?r(t)<t?y:m:n(t)<t?x:v)(t)}return c.invert=function(t){return new Date(u(t))},c.domain=function(t){return arguments.length?f(Array.from(t,vM)):f().map(xM)},c.ticks=function(e){var n=f();return t(n[0],n[n.length-1],null==e?10:e)},c.tickFormat=function(t,e){return null==e?b:h(e)},c.nice=function(t){var n=f();return t&&"function"==typeof t.range||(t=e(n[0],n[n.length-1],null==t?10:t)),t?f(Ox(n,t)):c},c.copy=function(){return lx(c,bM(t,e,n,i,r,s,o,a,l,h))},c}function MM(){var t,e,n,i,r,s=0,o=1,a=rx,l=!1;function h(e){return null==e||isNaN(e=+e)?r:a(0===n?.5:(e=(i(e)-t)*n,l?Math.max(0,Math.min(1,e)):e))}function c(t){return function(e){var n,i;return arguments.length?([n,i]=e,a=t(n,i),h):[a(0),a(1)]}}return h.domain=function(r){return arguments.length?([s,o]=r,t=i(s=+s),e=i(o=+o),n=t===e?0:1/(e-t),h):[s,o]},h.clamp=function(t){return arguments.length?(l=!!t,h):l},h.interpolator=function(t){return arguments.length?(a=t,h):a},h.range=c(Jm),h.rangeRound=c(Qm),h.unknown=function(t){return arguments.length?(r=t,h):r},function(r){return i=r,t=r(s),e=r(o),n=t===e?0:1/(e-t),h}}function wM(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function EM(){var t=Ux(MM());return t.copy=function(){return wM(t,EM()).exponent(t.exponent())},zy.apply(t,arguments)}function NM(){var t=[],n=rx;function i(e){if(null!=e&&!isNaN(e=+e))return n((u(t,e,1)-1)/(t.length-1))}return i.domain=function(n){if(!arguments.length)return t.slice();t=[];for(let e of n)null==e||isNaN(e=+e)||t.push(e);return t.sort(e),i},i.interpolator=function(t){return arguments.length?(n=t,i):n},i.range=function(){return t.map(((e,i)=>n(i/(t.length-1))))},i.quantiles=function(e){return Array.from({length:e+1},((n,i)=>ct(t,i/e)))},i.copy=function(){return NM(n).domain(t)},zy.apply(i,arguments)}function SM(){var t,e,n,i,r,s,o,a=0,l=.5,h=1,c=1,u=rx,f=!1;function d(t){return isNaN(t=+t)?o:(t=.5+((t=+s(t))-e)*(c*t<c*e?i:r),u(f?Math.max(0,Math.min(1,t)):t))}function p(t){return function(e){var n,i,r;return arguments.length?([n,i,r]=e,u=ex(t,[n,i,r]),d):[u(0),u(.5),u(1)]}}return d.domain=function(o){return arguments.length?([a,l,h]=o,t=s(a=+a),e=s(l=+l),n=s(h=+h),i=t===e?0:.5/(e-t),r=e===n?0:.5/(n-e),c=e<t?-1:1,d):[a,l,h]},d.clamp=function(t){return arguments.length?(f=!!t,d):f},d.interpolator=function(t){return arguments.length?(u=t,d):u},d.range=p(Jm),d.rangeRound=p(Qm),d.unknown=function(t){return arguments.length?(o=t,d):o},function(o){return s=o,t=o(a),e=o(l),n=o(h),i=t===e?0:.5/(e-t),r=e===n?0:.5/(n-e),c=e<t?-1:1,d}}function IM(){var t=Ux(SM());return t.copy=function(){return wM(t,IM()).exponent(t.exponent())},zy.apply(t,arguments)}!function(t){Kv=function(t){var e=t.dateTime,n=t.date,i=t.time,r=t.periods,s=t.days,o=t.shortDays,a=t.months,l=t.shortMonths,h=lb(r),c=hb(r),u=lb(s),f=hb(s),d=lb(o),p=hb(o),g=lb(a),_=hb(a),y=lb(l),m=hb(l),x={a:function(t){return o[t.getDay()]},A:function(t){return s[t.getDay()]},b:function(t){return l[t.getMonth()]},B:function(t){return a[t.getMonth()]},c:null,d:Cb,e:Cb,f:Pb,g:$b,G:Vb,H:Tb,I:Rb,j:Ab,L:Lb,m:Db,M:zb,p:function(t){return r[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:yM,s:mM,S:Fb,u:Gb,U:qb,V:Bb,w:Ub,W:Yb,x:null,X:null,y:Wb,Y:Xb,Z:Hb,"%":_M},v={a:function(t){return o[t.getUTCDay()]},A:function(t){return s[t.getUTCDay()]},b:function(t){return l[t.getUTCMonth()]},B:function(t){return a[t.getUTCMonth()]},c:null,d:Zb,e:Zb,f:eM,g:fM,G:pM,H:Jb,I:Qb,j:Kb,L:tM,m:nM,M:iM,p:function(t){return r[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:yM,s:mM,S:rM,u:sM,U:oM,V:lM,w:hM,W:cM,x:null,X:null,y:uM,Y:dM,Z:gM,"%":_M},b={a:function(t,e,n){var i=d.exec(e.slice(n));return i?(t.w=p.get(i[0].toLowerCase()),n+i[0].length):-1},A:function(t,e,n){var i=u.exec(e.slice(n));return i?(t.w=f.get(i[0].toLowerCase()),n+i[0].length):-1},b:function(t,e,n){var i=y.exec(e.slice(n));return i?(t.m=m.get(i[0].toLowerCase()),n+i[0].length):-1},B:function(t,e,n){var i=g.exec(e.slice(n));return i?(t.m=_.get(i[0].toLowerCase()),n+i[0].length):-1},c:function(t,n,i){return E(t,e,n,i)},d:vb,e:vb,f:Sb,g:_b,G:gb,H:Mb,I:Mb,j:bb,L:Nb,m:xb,M:wb,p:function(t,e,n){var i=h.exec(e.slice(n));return i?(t.p=c.get(i[0].toLowerCase()),n+i[0].length):-1},q:mb,Q:kb,s:Ob,S:Eb,u:ub,U:fb,V:db,w:cb,W:pb,x:function(t,e,i){return E(t,n,e,i)},X:function(t,e,n){return E(t,i,e,n)},y:_b,Y:gb,Z:yb,"%":Ib};function M(t,e){return function(n){var i,r,s,o=[],a=-1,l=0,h=t.length;for(n instanceof Date||(n=new Date(+n));++a<h;)37===t.charCodeAt(a)&&(o.push(t.slice(l,a)),null!=(r=nb[i=t.charAt(++a)])?i=t.charAt(++a):r="e"===i?" ":"0",(s=e[i])&&(i=s(n,r)),o.push(i),l=a+1);return o.push(t.slice(l,a)),o.join("")}}function w(t,e){return function(n){var i,r,s=Qv(1900,void 0,1);if(E(s,t,n+="",0)!=n.length)return null;if("Q"in s)return new Date(s.Q);if("s"in s)return new Date(1e3*s.s+("L"in s?s.L:0));if(e&&!("Z"in s)&&(s.Z=0),"p"in s&&(s.H=s.H%12+12*s.p),void 0===s.m&&(s.m="q"in s?s.q:0),"V"in s){if(s.V<1||s.V>53)return null;"w"in s||(s.w=1),"Z"in s?(r=(i=Jv(Qv(s.y,0,1))).getUTCDay(),i=r>4||0===r?Pv.ceil(i):Pv(i),i=Rv.offset(i,7*(s.V-1)),s.y=i.getUTCFullYear(),s.m=i.getUTCMonth(),s.d=i.getUTCDate()+(s.w+6)%7):(r=(i=Zv(Qv(s.y,0,1))).getDay(),i=r>4||0===r?yv.ceil(i):yv(i),i=pv.offset(i,7*(s.V-1)),s.y=i.getFullYear(),s.m=i.getMonth(),s.d=i.getDate()+(s.w+6)%7)}else("W"in s||"U"in s)&&("w"in s||(s.w="u"in s?s.u%7:"W"in s?1:0),r="Z"in s?Jv(Qv(s.y,0,1)).getUTCDay():Zv(Qv(s.y,0,1)).getDay(),s.m=0,s.d="W"in s?(s.w+6)%7+7*s.W-(r+5)%7:s.w+7*s.U-(r+6)%7);return"Z"in s?(s.H+=s.Z/100|0,s.M+=s.Z%100,Jv(s)):Zv(s)}}function E(t,e,n,i){for(var r,s,o=0,a=e.length,l=n.length;o<a;){if(i>=l)return-1;if(37===(r=e.charCodeAt(o++))){if(r=e.charAt(o++),!(s=b[r in nb?e.charAt(o++):r])||(i=s(t,n,i))<0)return-1}else if(r!=n.charCodeAt(i++))return-1}return i}return x.x=M(n,x),x.X=M(i,x),x.c=M(e,x),v.x=M(n,v),v.X=M(i,v),v.c=M(e,v),{format:function(t){var e=M(t+="",x);return e.toString=function(){return t},e},parse:function(t){var e=w(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=M(t+="",v);return e.toString=function(){return t},e},utcParse:function(t){var e=w(t+="",!0);return e.toString=function(){return t},e}}}(t),tb=Kv.format,Kv.parse,eb=Kv.utcFormat,Kv.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var kM=Object.freeze({__proto__:null,scaleBand:qy,scalePoint:function(){return jy(qy.apply(null,arguments).paddingInner(1))},scaleIdentity:function t(e){var n;function i(t){return null==t||isNaN(t=+t)?n:t}return i.invert=i,i.domain=i.range=function(t){return arguments.length?(e=Array.from(t,nx),i):e.slice()},i.unknown=function(t){return arguments.length?(n=t,i):n},i.copy=function(){return t(e).unknown(n)},e=arguments.length?Array.from(e,nx):[0,1],Ix(i)},scaleLinear:kx,scaleLog:function t(){const e=Dx(hx()).domain([1,10]);return e.copy=()=>lx(e,t()).base(e.base()),Dy.apply(e,arguments),e},scaleSymlog:function t(){var e=Gx(hx());return e.copy=function(){return lx(e,t()).constant(e.constant())},Dy.apply(e,arguments)},scaleOrdinal:Gy,scaleImplicit:Fy,scalePow:Yx,scaleSqrt:Wx,scaleRadial:function t(){var e,n=cx(),i=[0,1],r=!1;function s(t){var i=Xx(n(t));return isNaN(i)?e:r?Math.round(i):i}return s.invert=function(t){return n.invert($x(t))},s.domain=function(t){return arguments.length?(n.domain(t),s):n.domain()},s.range=function(t){return arguments.length?(n.range((i=Array.from(t,nx)).map($x)),s):i.slice()},s.rangeRound=function(t){return s.range(t).round(!0)},s.round=function(t){return arguments.length?(r=!!t,s):r},s.clamp=function(t){return arguments.length?(n.clamp(t),s):n.clamp()},s.unknown=function(t){return arguments.length?(e=t,s):e},s.copy=function(){return t(n.domain(),i).round(r).clamp(n.clamp()).unknown(e)},Dy.apply(s,arguments),Ix(s)},scaleQuantile:function t(){var n,i=[],r=[],s=[];function o(){var t=0,e=Math.max(1,r.length);for(s=new Array(e-1);++t<e;)s[t-1]=ut(i,t/e);return a}function a(t){return null==t||isNaN(t=+t)?n:r[u(s,t)]}return a.invertExtent=function(t){var e=r.indexOf(t);return e<0?[NaN,NaN]:[e>0?s[e-1]:i[0],e<s.length?s[e]:i[i.length-1]]},a.domain=function(t){if(!arguments.length)return i.slice();i=[];for(let e of t)null==e||isNaN(e=+e)||i.push(e);return i.sort(e),o()},a.range=function(t){return arguments.length?(r=Array.from(t),o()):r.slice()},a.unknown=function(t){return arguments.length?(n=t,a):n},a.quantiles=function(){return s.slice()},a.copy=function(){return t().domain(i).range(r).unknown(n)},Dy.apply(a,arguments)},scaleQuantize:function t(){var e,n=0,i=1,r=1,s=[.5],o=[0,1];function a(t){return null!=t&&t<=t?o[u(s,t,0,r)]:e}function l(){var t=-1;for(s=new Array(r);++t<r;)s[t]=((t+1)*i-(t-r)*n)/(r+1);return a}return a.domain=function(t){return arguments.length?([n,i]=t,n=+n,i=+i,l()):[n,i]},a.range=function(t){return arguments.length?(r=(o=Array.from(t)).length-1,l()):o.slice()},a.invertExtent=function(t){var e=o.indexOf(t);return e<0?[NaN,NaN]:e<1?[n,s[0]]:e>=r?[s[r-1],i]:[s[e-1],s[e]]},a.unknown=function(t){return arguments.length?(e=t,a):a},a.thresholds=function(){return s.slice()},a.copy=function(){return t().domain([n,i]).range(o).unknown(e)},Dy.apply(Ix(a),arguments)},scaleThreshold:Vx,scaleTime:function(){return Dy.apply(bM(Vv,Hv,Sv,Ev,_v,pv,fv,cv,lv,tb).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},scaleUtc:function(){return Dy.apply(bM($v,Xv,Yv,Bv,Lv,Rv,Cv,kv,lv,eb).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)},scaleSequential:function t(){var e=Ix(MM()(rx));return e.copy=function(){return wM(e,t())},zy.apply(e,arguments)},scaleSequentialLog:function t(){var e=Dx(MM()).domain([1,10]);return e.copy=function(){return wM(e,t()).base(e.base())},zy.apply(e,arguments)},scaleSequentialPow:EM,scaleSequentialSqrt:function(){return EM.apply(null,arguments).exponent(.5)},scaleSequentialSymlog:function t(){var e=Gx(MM());return e.copy=function(){return wM(e,t()).constant(e.constant())},zy.apply(e,arguments)},scaleSequentialQuantile:NM,scaleDiverging:function t(){var e=Ix(SM()(rx));return e.copy=function(){return wM(e,t())},zy.apply(e,arguments)},scaleDivergingLog:function t(){var e=Dx(SM()).domain([.1,1,10]);return e.copy=function(){return wM(e,t()).base(e.base())},zy.apply(e,arguments)},scaleDivergingPow:IM,scaleDivergingSqrt:function(){return IM.apply(null,arguments).exponent(.5)},scaleDivergingSymlog:function t(){var e=Gx(SM());return e.copy=function(){return wM(e,t()).constant(e.constant())},zy.apply(e,arguments)},tickFormat:Sx});const OM=Object.assign({},{scaleOrdinal:Gy});function CM(t,e={}){let n=e.x?e.x:null,i=e.y?e.y:null,r=e.w?e.w:30,s=e.h?e.h:20,o=e.title?e.title:null,a=e.fontSize?e.fontSize:14,l=e.fontSize2?e.fontSize2:10,h=e.stroke?e.stroke:"black",c=e.fillOpacity?e.fillOpacity:1,u=e.strokeWidth?e.strokeWidth:.5,f=e.txtcol?e.txtcol:"#363636",d=e.types,p=e.colors,g=OM.scaleOrdinal().domain(d).range(p);if(null!=n&&null!=i){let e=t.append("g").attr("class","bertinlegend"),p=0;null!=o&&(p=(o.split("\n").length+1)*a,e.append("g").selectAll("text").data(o.split("\n")).join("text").attr("x",n).attr("y",i).attr("font-size",`${a}px`).attr("dy",((t,e)=>e*a)).attr("text-anchor","start").attr("dominant-baseline","hanging").attr("fill",f).text((t=>t))),e.selectAll("rect").data(d).join("rect").attr("x",n).attr("y",((t,e)=>i+p+(s+3)*e)).attr("height",s).attr("width",r).attr("fill",(t=>g(t))).attr("stroke",h).attr("stroke-width",u).attr("fill-opacity",c),e.append("g").selectAll("text").data(d).join("text").attr("x",n+r+l/2).attr("y",i+p+s/2).attr("font-size",`${l}px`).attr("fill",f).attr("dy",((t,e)=>(s+3)*e)).attr("text-anchor","start").attr("dominant-baseline","central").text((t=>t))}}function TM(t,e){let n;return e>=0&&(n=+t.toFixed(e)),e<0&&(n=Math.round(t/+(1+"0".repeat(Math.abs(e))))*+(1+"0".repeat(Math.abs(e)))),null==e&&(n=t),n}const RM=Object.assign({},{reverse:Mt});const AM=Object.assign({},{reverse:Mt});function LM(t){for(var e=t.length/6|0,n=new Array(e),i=0;i<e;)n[i]="#"+t.slice(6*i,6*++i);return n}var PM=LM("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),DM=LM("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),zM=LM("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),FM=LM("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),GM=LM("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),qM=LM("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),jM=LM("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),BM=LM("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),UM=LM("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),YM=LM("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),WM=t=>Bm(t[t.length-1]),$M=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(LM),XM=WM($M),VM=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(LM),HM=WM(VM),ZM=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(LM),JM=WM(ZM),QM=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(LM),KM=WM(QM),tw=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(LM),ew=WM(tw),nw=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(LM),iw=WM(nw),rw=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(LM),sw=WM(rw),ow=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(LM),aw=WM(ow),lw=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(LM),hw=WM(lw),cw=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(LM),uw=WM(cw),fw=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(LM),dw=WM(fw),pw=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(LM),gw=WM(pw),_w=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(LM),yw=WM(_w),mw=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(LM),xw=WM(mw),vw=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(LM),bw=WM(vw),Mw=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(LM),ww=WM(Mw),Ew=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(LM),Nw=WM(Ew),Sw=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(LM),Iw=WM(Sw),kw=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(LM),Ow=WM(kw),Cw=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(LM),Tw=WM(Cw),Rw=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(LM),Aw=WM(Rw),Lw=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(LM),Pw=WM(Lw),Dw=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(LM),zw=WM(Dw),Fw=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(LM),Gw=WM(Fw),qw=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(LM),jw=WM(qw),Bw=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(LM),Uw=WM(Bw),Yw=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(LM),Ww=WM(Yw);var $w=tx(Lm(300,.5,0),Lm(-240,.5,1)),Xw=tx(Lm(-100,.75,.35),Lm(80,1.5,.8)),Vw=tx(Lm(260,.75,.35),Lm(80,1.5,.8)),Hw=Lm();var Zw=cm(),Jw=Math.PI/3,Qw=2*Math.PI/3;function Kw(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}var tE=Kw(LM("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),eE=Kw(LM("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),nE=Kw(LM("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),iE=Kw(LM("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),rE=Object.freeze({__proto__:null,schemeCategory10:PM,schemeAccent:DM,schemeDark2:zM,schemePaired:FM,schemePastel1:GM,schemePastel2:qM,schemeSet1:jM,schemeSet2:BM,schemeSet3:UM,schemeTableau10:YM,interpolateBrBG:XM,schemeBrBG:$M,interpolatePRGn:HM,schemePRGn:VM,interpolatePiYG:JM,schemePiYG:ZM,interpolatePuOr:KM,schemePuOr:QM,interpolateRdBu:ew,schemeRdBu:tw,interpolateRdGy:iw,schemeRdGy:nw,interpolateRdYlBu:sw,schemeRdYlBu:rw,interpolateRdYlGn:aw,schemeRdYlGn:ow,interpolateSpectral:hw,schemeSpectral:lw,interpolateBuGn:uw,schemeBuGn:cw,interpolateBuPu:dw,schemeBuPu:fw,interpolateGnBu:gw,schemeGnBu:pw,interpolateOrRd:yw,schemeOrRd:_w,interpolatePuBuGn:xw,schemePuBuGn:mw,interpolatePuBu:bw,schemePuBu:vw,interpolatePuRd:ww,schemePuRd:Mw,interpolateRdPu:Nw,schemeRdPu:Ew,interpolateYlGnBu:Iw,schemeYlGnBu:Sw,interpolateYlGn:Ow,schemeYlGn:kw,interpolateYlOrBr:Tw,schemeYlOrBr:Cw,interpolateYlOrRd:Aw,schemeYlOrRd:Rw,interpolateBlues:Pw,schemeBlues:Lw,interpolateGreens:zw,schemeGreens:Dw,interpolateGreys:Gw,schemeGreys:Fw,interpolatePurples:jw,schemePurples:qw,interpolateReds:Uw,schemeReds:Bw,interpolateOranges:Ww,schemeOranges:Yw,interpolateCividis:function(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-t*(35.34-t*(2381.73-t*(6402.7-t*(7024.72-2710.57*t)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+t*(170.73+t*(52.82-t*(131.46-t*(176.58-67.37*t)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+t*(442.36-t*(2482.43-t*(6167.24-t*(6614.94-2475.67*t)))))))+")"},interpolateCubehelixDefault:$w,interpolateRainbow:function(t){(t<0||t>1)&&(t-=Math.floor(t));var e=Math.abs(t-.5);return Hw.h=360*t-100,Hw.s=1.5-1.5*e,Hw.l=.8-.9*e,Hw+""},interpolateWarm:Xw,interpolateCool:Vw,interpolateSinebow:function(t){var e;return t=(.5-t)*Math.PI,Zw.r=255*(e=Math.sin(t))*e,Zw.g=255*(e=Math.sin(t+Jw))*e,Zw.b=255*(e=Math.sin(t+Qw))*e,Zw+""},interpolateTurbo:function(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+t*(1172.33-t*(10793.56-t*(33300.12-t*(38394.49-14825.05*t)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+t*(557.33+t*(1225.33-t*(3574.96-t*(1073.77+707.56*t)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+t*(3211.1-t*(15327.97-t*(27814-t*(22569.18-6838.66*t)))))))+")"},interpolateViridis:tE,interpolateMagma:eE,interpolateInferno:nE,interpolatePlasma:iE});function sE(t){return null!==t&&""!==t&&isFinite(t)}const oE=Object.assign({},St);const aE=Object.assign({},St);const lE=Object.assign({},St);const hE=Object.assign({},St);function cE({values:t,method:e,nb:n,precision:i,k:r,middle:s}){let o;switch(e){case"q6":a=(a=t).filter((t=>sE(t))).map((t=>+t)),o=6>a.length?null:[oE.quantile(a,0),oE.quantile(a,.05),oE.quantile(a,.25),oE.quantile(a,.5),oE.quantile(a,.75),oE.quantile(a,.95),oE.quantile(a,1)];break;case"quantile":o=function(t,e){if(t=t.filter((t=>sE(t))).map((t=>+t)),e>t.length)return null;const n=[],i=1/e;for(let r=0;r<=e;r++)n.push(aE.quantile(t,i*r));return n}(t,n);break;case"equal":o=function(t,e){if(t=t.filter((t=>sE(t))).map((t=>+t)),e>t.length)return null;const n=[lE.min(t),lE.max(t)],i=(n[1]-n[0])/e;let r=n[0];for(let t=0;t<e-1;t++)n.push(r+i),r+=i;return n.sort(lE.ascending)}(t,n);break;case"jenks":o=function(t,e){if(t=t.filter((t=>sE(t))).map((t=>+t)).sort((function(t,e){return t-e})),e>t.length)return null;if(e>[...new Set(t)].length)return null;let n=function(t,e){const n=[],i=[],r=t.length;let s,o,a,l,h,c,u,f,d,p,g,_;for(s=0;s<r;s++){const t=[],r=[],a=0===s?1:0;for(o=0;o<e;o++)t.push(a),r.push(1/0);n.push(t),i.push(r)}for(h=0,l=0;l<r;l++){for(u=f=d=0,a=0;a<=l;a++)if(_=l-a,c=t[_],d++,u+=c,f+=c*c,h=f-u*u/d,g=_-1,g>-1)for(o=1;o<e;o++)p=h+i[g][o-1],i[l][o]>=p&&(n[l][o]=_+1,i[l][o]=p);n[l][0]=1,i[l][0]=h}return{lower_class_limits:n,variance_combinations:i}}(t,e);return function(t,e,n){const i=[];let r,s,o=t.length;for(i[n]=t[t.length-1],i[0]=t[0],r=1;r<n;r++)s=n-r+1,i[s-1]=t[e[o-1][s-1]-2],o=e[o-1][s-1]-1;return i}(t,n.lower_class_limits,e)}(t,n);break;case"msd":o=function(t,e=1,n=!1){t=t.filter((t=>sE(t))).map((t=>+t));const i=hE.min(t),r=hE.max(t),s=hE.mean(t),o=hE.deviation(t),a=[i,r];if(1==n){let t=s+e/2*o;for(;t<r;)a.push(t),t+=o*e;for(t=s-e/2*o;t>i;)a.push(t),t-=o*e}else{a.push(s);let t=s+o*e;for(;t<r;)a.push(t),t+=o*e;for(t=s-o*e;t>i;)a.push(t),t-=o*e}return a.sort(hE.ascending)}(t,r,s)}var a;return Number.isInteger(+i)?o.map((t=>function(t,e){let n;return e>=0&&(n=+t.toFixed(e)),e<0&&(n=Math.round(t/+(1+"0".repeat(Math.abs(e))))*+(1+"0".repeat(Math.abs(e)))),n}(t,i))):o}Object.assign({},St,Lo,kM,Y_),Object.assign({},St,Lo,kM,Y_);const uE=Object.assign({},rE,{sort:U,scaleThreshold:Vx,scaleOrdinal:Gy});function fE(t,e){if("string"==typeof e)return{getcol:t=>e};if(t=null==t[0].properties?t:t.map((t=>t.properties)),"object"==typeof e&&"choro"==e.type){let n=e.values,i=e.colors?e.colors:"Blues",r=null!=e.nbreaks?e.nbreaks:5,s=e.breaks?e.breaks:null,o=null!=e.k?e.k:1,a=1==e.middle,l=e.method?e.method:"quantile",h=e.col_missing?e.col_missing:"#f5f5f5",c=e.txt_missing?e.txt_missing:"No data",u=void 0!==e.leg_round?e.leg_round:void 0;"q6"==l&&(r=6);const f=t.map((t=>t[n])),d=f.filter((t=>void 0!==+t)).filter((t=>null!==+t)).filter((t=>!isNaN(+t))).filter((t=>""!==t)),p=f.length===d.length?null:[c,h];s=null==s?cE({values:d,method:l,nb:r,k:o,middle:a,precision:u}):uE.sort(s),Array.isArray(i)||(i=uE[`scheme${i}`][s.length-1]);let g=[...s];function _(t){return""===t||isNaN(+t)?h:uE.scaleThreshold(g,i).unknown(h)(t)}return g.pop(),g.shift(),{getcol:_,breaks:s,colors:i,missing:p}}if("object"==typeof e&&"typo"==e.type){let y=e.values,m=e.colors?e.colors:"Tableau10",x=e.col_missing?e.col_missing:"#f5f5f5",v=e.txt_missing?e.txt_missing:"No data";const b=null!=e.order?e.order:Array.from(new Set(t.map((t=>t[y]))));let M=null!=e.types?e.types:b.filter((t=>""!==t&&null!=t&&null!=t));return Array.isArray(m)?m.slice(0,M.length):m=uE[`scheme${m}`].slice(0,M.length),{getcol:uE.scaleOrdinal().domain(M).range(m).unknown(x),types:M.length==b.length?M:[M,v].flat(),colors:M.length==b.length?m:[m,x].flat()}}if("object"==typeof e&&"split"==e.type){let w=e.values,E=null!=e.split?e.split:0,N=e.colors?e.colors:["#F25842","#4a7cd9"],S=e.col_missing?e.col_missing:"#f5f5f5",I=e.txt_missing?e.txt_missing:"No data";const k=t.map((t=>t[w])),O=k.filter((t=>""!==t&&null!=t&&null!=t));return{getcol:t=>t>=E?N[0]:t<E?N[1]:null==t||""===t?S:void 0,types:k.length==O.length?[`>= ${E}`,`< ${E}`]:[[`>= ${E}`,`< ${E}`],I].flat(),colors:k.length==O.length?N:[N,S].flat()}}}const dE=Object.assign({},{min:st,max:it,scaleLinear:kx,scaleOrdinal:Gy,scaleThreshold:Vx,quantize:function(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t(i/(e-1));return n},interpolate:Jm});function pE(t,e){const n=e.type?e.type:"linear";if("number"==typeof e||"string"==typeof e)return{getthickness:()=>+e};if(0==t.length)return{getthickness:()=>0,valmax:0,sizemax:0};if("number"!=typeof e&&"string"!=typeof e&&"linear"==n){let i=null!=e.k?e.k:10,r=e.values,s=null!=e.fixmax?e.fixmax:void 0,o=null!=e.fixmin?e.fixmin:0;if("geometry"in t[0]&&"properties"in t[0]&&(t=t.map((t=>t.properties))),"string"==typeof e||"number"==typeof e)return{getcol:t=>e};1==o&&(o=dE.min(t.map((t=>Math.abs(+t[r])))));const a=null==s?dE.max(t.map((t=>Math.abs(+t[r])))):s,l=dE.max(t.map((t=>Math.abs(+t[r]))));return{type:n,getthickness:dE.scaleLinear().domain([o,a]).range([0,i]),valmax:l,valmin:o,sizemax:dE.scaleLinear().domain([o,a]).range([0,i])(l)}}if("number"!=typeof e&&"string"!=typeof e&&"quali"==n){const t=e.categories,i=null!=e.k?e.k:10,r=e.sizes?e.sizes:dE.quantize(dE.interpolate(1,i),t.length);return{type:n,categories:t,sizes:r,getthickness:dE.scaleOrdinal().domain(t).range(r).unknown(0)}}if("number"!=typeof e&&"string"!=typeof e&&"discr"==n){const i=e.values;let r=e.sizes,s=null!=e.nbreaks?e.nbreaks:5,o=e.breaks?e.breaks:null,a=null!=e.k?e.k:10,l=null!=e.nbsd?e.nbsd:1,h=1==e.middle,c=e.method?e.method:"quantile";"q6"==c&&(s=6);const u=t.map((t=>+t.properties[i])).filter((t=>null!=t&&null!=t&&""!=t));o=null==o?cE({values:u,method:c,nb:s,k:l,middle:h}):dE.sort(o),null==r&&(r=dE.quantize(dE.interpolate(1,a),o.length-1));let f=[...o];return f.pop(),f.shift(),{type:n,breaks:o,sizes:r,getthickness:dE.scaleThreshold(f,r).unknown(0)}}}function gE(t,e,n,i,r){"object"==typeof n&&"choro"==n.type&&Py(e,{x:n.leg_x,y:n.leg_y,w:n.leg_w,h:n.leg_h,stroke:n.leg_stroke,fillOpacity:n.leg_fillOpacity,strokeWidth:n.leg_strokeWidth,txtcol:n.leg_txtcol,title:n.leg_title?n.leg_title:n.values,fontSize:n.leg_fontSize,fontSize2:n.leg_fontSize2,breaks:fE(t.features,n).breaks,colors:fE(t.features,n).colors,missing:fE(t.features,n).missing}),"object"==typeof i&&"choro"==i.type&&Py(e,{x:i.leg_x,y:i.leg_y,w:i.leg_w,h:i.leg_h,stroke:i.leg_stroke,fillOpacity:i.leg_fillOpacity,strokeWidth:i.leg_strokeWidth,txtcol:i.leg_txtcol,title:i.leg_title?i.leg_title:i.values,fontSize:i.leg_fontSize,fontSize2:i.leg_fontSize2,breaks:fE(t.features,i).breaks,colors:fE(t.features,i).colors,missing:fE(t.features,i).missing}),"object"!=typeof n||"typo"!=n.type&&"split"!=n.type||CM(e,{x:n.leg_x,y:n.leg_y,w:n.leg_w,h:n.leg_h,stroke:n.leg_stroke,fillOpacity:n.leg_fillOpacity,strokeWidth:n.leg_strokeWidth,txtcol:n.leg_txtcol,title:n.leg_title?n.leg_title:n.values,fontSize:n.leg_fontSize,fontSize2:n.leg_fontSize2,types:fE(t.features,n).types,colors:fE(t.features,n).colors}),"object"!=typeof i||"typo"!=i.type&&"split"!=i.type||CM(e,{x:i.leg_x,y:i.leg_y,w:i.leg_w,h:i.leg_h,stroke:i.leg_stroke,fillOpacity:i.leg_fillOpacity,strokeWidth:i.leg_strokeWidth,txtcol:i.leg_txtcol,title:i.leg_title?i.leg_title:i.values,fontSize:i.leg_fontSize,fontSize2:i.leg_fontSize2,types:fE(t.features,i).types,colors:fE(t.features,i).colors}),"object"!=typeof r||null==r.values||"linear"!=r.type&&null!=r.type||function(t,e={}){let n=null!=e.x?e.x:null,i=null!=e.y?e.y:null,r=e.valmax,s=e.valmin,o=e.sizemax,a=e.title?e.title:null,l=null!=e.fontSize?e.fontSize:14,h=null!=e.fontSize2?e.fontSize2:10,c=e.fill?e.fill:"none",u=e.stroke?e.stroke:"black",f=null!=e.strokeWidth?e.strokeWidth:.4,d=null!=e.fillOpacity?e.fillOpacity:1,p=e.txtcol?e.txtcol:"#363636",g=null!=e.w?e.w:75,_=null!=e.round?e.round:void 0;if(null!=n&&null!=i){let e=t.append("g").attr("class","bertinlegend"),y=0;null!=a&&(y=(a.split("\n").length+1)*l,e.append("g").selectAll("text").data(a.split("\n")).join("text").attr("x",n).attr("y",i).attr("font-size",`${l}px`).attr("dy",((t,e)=>e*l)).attr("text-anchor","start").attr("dominant-baseline","hanging").attr("fill",p).text((t=>t))),e.append("path").attr("d",`M ${n},${i+y+o/2} ${n+g},${i+y} ${n+g},${i+y+o} Z `).attr("stroke",u).attr("fill",c).attr("stroke-width",f).attr("fill-opacity",d),e.append("text").attr("font-size",`${h}px`).attr("fill",p).attr("text-anchor","start").attr("dominant-baseline","hanging").attr("x",n).attr("y",i+y+o/2+h/2).text(TM(s,_)),e.append("text").attr("font-size",`${h}px`).attr("fill",p).attr("text-anchor","end").attr("dominant-baseline","hanging").attr("x",n+g).attr("y",i+y+o+h/2).text(TM(r,_))}}(e,{x:r.leg_x,y:r.leg_y,valmax:pE(t.features,r).valmax,valmin:pE(t.features,r).valmin,sizemax:pE(t.features,r).sizemax,title:r.leg_title?r.leg_title:r.values,fontSize:r.leg_fontSize,fontSize2:r.leg_fontSize2,fill:r.stroke,fillOpacity:r.fillOpacity,txtcol:r.leg_txtcol,w:r.leg_w,round:r.leg_round}),"object"==typeof r&&null!=r.values&&"discr"==r.type&&function(t,e={}){let n=e.x?e.x:null,i=e.y?e.y:null,r=e.w?e.w:30,s=e.title?e.title:null,o=null!=e.fontSize?e.fontSize:14,a=null!=e.fontSize2?e.fontSize2:10,l=e.stroke?e.stroke:"black",h=null!=e.strokeOpacity?e.strokeOpacity:1,c=e.txtcol?e.txtcol:"#363636",u=e.breaks,f=e.sizes,d=void 0!==e.round?e.round:void 0;if(f=RM.reverse(f),u=RM.reverse(u),null!=n&&null!=i){let e=t.append("g").attr("class","bertinlegend"),p=0;null!=s&&(p=(s.split("\n").length+1)*o,e.append("g").selectAll("text").data(s.split("\n")).join("text").attr("x",n).attr("y",i).attr("font-size",`${o}px`).attr("dy",((t,e)=>e*o)).attr("text-anchor","start").attr("dominant-baseline","hanging").attr("fill",c).text((t=>t)));const g=10;let _=[],y=0;for(let t=0;t<f.length;t++)_.push(i+p+y+f[t]/2+t*g),y+=f[t];let m=[];y=0;for(let t=0;t<u.length;t++)m.push(i+p+y-g/2),y+=f[t]+g;e.selectAll("line").data(f).join("line").attr("x1",n).attr("y1",((t,e)=>_[e])).attr("x2",n+r).attr("y2",((t,e)=>_[e])).attr("stroke",l).attr("stroke-opacity",h).attr("stroke-width",(t=>t)),e.append("g").selectAll("text").data(u).join("text").attr("x",n+r+a/2).attr("y",((t,e)=>m[e])).attr("font-size",`${a}px`).attr("fill",c).attr("text-anchor","start").attr("dominant-baseline","central").text((t=>TM(t,d)))}}(e,{x:r.leg_x,y:r.leg_y,breaks:pE(t.features,r).breaks,sizes:pE(t.features,r).sizes,w:r.leg_w,title:r.leg_title?r.leg_title:r.values,fontSize:r.leg_fontSize,fontSize2:r.leg_fontSize2,stroke:r.stroke,strokeOpacity:r.strokeOpacity,txtcol:r.leg_txtcol,round:r.leg_round}),"object"==typeof r&&null!=r.values&&"quali"==r.type&&function(t,e={}){let n=e.x?e.x:null,i=e.y?e.y:null,r=e.w?e.w:30,s=e.title?e.title:null,o=e.fontSize?e.fontSize:14,a=e.fontSize2?e.fontSize2:10,l=e.stroke?e.stroke:"black",h=e.strokeOpacity?e.strokeOpacity:1,c=e.txtcol?e.txtcol:"#363636",u=e.categories,f=e.sizes;if(f=AM.reverse(f),u=AM.reverse(u),null!=n&&null!=i){let e=t.append("g").attr("class","bertinlegend"),d=0;null!=s&&(d=(s.split("\n").length+1)*o,e.append("g").selectAll("text").data(s.split("\n")).join("text").attr("x",n).attr("y",i).attr("font-size",`${o}px`).attr("dy",((t,e)=>e*o)).attr("text-anchor","start").attr("dominant-baseline","hanging").attr("fill",c).text((t=>t)));const p=10;let g=[],_=0;for(let t=0;t<f.length;t++)g.push(i+d+_+f[t]/2+t*p),_+=f[t];e.selectAll("line").data(f).join("line").attr("x1",n).attr("y1",((t,e)=>g[e])).attr("x2",n+r).attr("y2",((t,e)=>g[e])).attr("stroke",l).attr("stroke-opacity",h).attr("stroke-width",(t=>t)),e.append("g").selectAll("text").data(u).join("text").attr("x",n+r+a/2).attr("y",((t,e)=>g[e])).attr("font-size",`${a}px`).attr("fill",c).attr("text-anchor","start").attr("dominant-baseline","central").text((t=>t))}}(e,{x:r.leg_x,y:r.leg_y,categories:pE(t.features,r).categories,sizes:pE(t.features,r).sizes,w:r.leg_w,title:r.leg_title?r.leg_title:"Catgories",fontSize:r.leg_fontSize,fontSize2:r.leg_fontSize2,stroke:r.stroke,strokeOpacity:r.strokeOpacity,txtcol:r.leg_txtcol})}function _E(t,e,n){const i=.33*e,r=.25*n;return t[0]<i&&t[1]<r?"bottomright":t[0]>e-i&&t[1]<r?"bottomleft":t[0]<i&&t[1]>n-r?"topright":t[0]>e-i&&t[1]>n-r?"topleft":t[1]>n-r?"top":t[0]<i?"right":t[0]>e-i?"left":"bottom"}function yE(t,e){if(!e)return t.style("display","none");const n=1==Array.isArray(e.fields)?e.fields:[e.fields],i=e.fill?e.fill:"#fcf7e6",r=null!=e.strokeWidth?e.strokeWidth:1,s=null!=e.fillOpacity?e.fillOpacity:1,o=null!=e.strokeOpacity?e.strokeOpacity:1,a=e.stroke?e.stroke:"#4a4d4b",l=e.type?e.type:"bottom",h=n.length;let c=e.col?e.col:"#4d4545";Array.isArray(c)||(c=Array(h).fill(c));let u=e.fontWeight;null==u&&1==h&&(u=["bold"]),null==u&&h>1&&(u=["bold"].concat(Array(h-1).fill("normal"))),"string"==typeof u&&(u=Array(h).fill(u));let f=e.fontSize;null==f&&1==h&&(f=[18]),null==f&&h>1&&(f=[18].concat(Array(h-1).fill(12))),"number"==typeof f&&(f=Array(h).fill(f));let d=e.fontStyle;null==d&&(d=Array(h).fill("normal")),"string"==typeof d&&(d=Array(h).fill(d)),t.style("display",null).style("pointer-events","none").style("font","8px sans-serif");const p=t.selectAll("path").data([null]).join("path").attr("fill",i).attr("stroke",a).attr("stroke-width",r).attr("fill-opacity",s).attr("stroke-opacity",o),g=t.selectAll("text").data([null]).join("text").call((t=>t.selectAll("tspan").data(n).join("tspan").attr("x",0).attr("y",((t,e)=>`${f.slice(0,e+1).reduce(((t,e)=>t+e),0)+3*e}px`)).style("font-weight",((t,e)=>u[e])).style("font-size",((t,e)=>`${f[e]}px`)).style("font-style",((t,e)=>d[e])).style("fill",((t,e)=>c[e])).text((t=>t)))),{x:_,y:y,width:m,height:x}=g.node().getBBox();switch(l){case"bottom":g.attr("transform",`translate(${-m/2},${15-y})`),p.attr("d",`M${-m/2-10},5H-5l5,-5l5,5H${m/2+10}v${x+20}h-${m+20}z`);break;case"top":g.attr("transform",`translate(${-m/2},${-15-y-x})`),p.attr("d",`M${-m/2-10},-5H-5l5,5l5,-5H${m/2+10}v${-x-20}h-${m+20}z`);break;case"left":g.attr("transform",`translate(${-m-15},${-y-x/2})`),p.attr("d",`M0,0l-5,5v${x/2+5}h${-m-20}v${-x-20}h${m+20}v${x/2+5}z`);break;case"right":g.attr("transform",`translate(15,${-y-x/2})`),p.attr("d",`M0,0l5,5v${x/2+5}h${m+20}v${-x-20}h${-m-20}v${x/2+5}z`);break;case"topleft":g.attr("transform",`translate(${-m-10},${-15-y-x})`),p.attr("d",`M0,0v${-x-5-20}h${-m-20}v${x+20}h${m+15}z`);break;case"topright":g.attr("transform",`translate(10,${-15-y-x})`),p.attr("d",`M0,0v${-x-5-20}h${m+20}v${x+20}h${-m-15}z`);break;case"bottomleft":g.attr("transform",`translate(${-m-10},${15-y})`),p.attr("d",`M0,0v${+x+5+20}h${-m-20}v${-x-20}h${+m+15}z`);break;case"bottomright":g.attr("transform",`translate(10,${15-y})`),p.attr("d",`M0,0v${+x+5+20}h${m+20}v${-x-20}h${-m-15}z`)}}function mE(t){let e=["z","l","p"],n=t.features.map((t=>t.geometry.type));n=Array.from(new Set(n));let i=(-1!==n.indexOf("Polygon")||-1!==n.indexOf("MultiPolygon")?e[0]:"")+(-1!==n.indexOf("LineString")||-1!==n.indexOf("MultiLineString")?e[1]:"")+(-1!==n.indexOf("Point")||-1!==n.indexOf("MultiPoint")?e[2]:"");return 1==i.length?i:"composite"}const xE=Object.assign({},{select:Io,pointer:Ao,forceX:Cy,forceY:Ty,forceCollide:iy,forceSimulation:Oy,geoPath:vr,symbol:i_,symbolCircle:Rg,symbolDiamond:Dg,symbolCross:Ag,symbolSquare:Gg,symbolStar:Yg,symbolTriangle:$g,symbolWye:Kg});function vE(t,e,n={},i,r,s){if(0!=n.display){let o=["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],a=Uo(n.geojson),l=n.fill?n.fill:o[Math.floor(Math.random()*o.length)],h=n.strokeLinecap?n.strokeLinecap:"round",c=n.strokeLinejoin?n.strokeLinejoin:"round",u=null!=n.strokeDasharray?n.strokeDasharray:"none",f=n.stroke?n.stroke:"white",d=null!=n.strokeWidth?n.strokeWidth:.5,p=null!=n.fillOpacity?n.fillOpacity:1,g=null!=n.strokeOpacity?n.strokeOpacity:1,_=!!n.tooltip&&n.tooltip;Array.isArray(_)&&(_={fields:_}),"string"==typeof _&&(_={fields:[_]});let y=n.symbol?n.symbol:"circle",m=null!=n.symbol_size?n.symbol_size:40,x=null!=n.symbol_iteration?n.symbol_iteration:200,v=null!=n.symbol_shift?n.symbol_shift:0,b=!!n.viewof,M={};if("l"==mE(a)&&(f=n.stroke?n.stroke:o[Math.floor(Math.random()*o.length)],l=n.fill?n.fill:"none",d=n.strokeWidth?n.strokeWidth:1),"l"!=mE(a)&&"z"!=mE(a)||t.append("g").attr("clip-path",null==i?"none":`url(#clip_${i})`).selectAll("path").data(a.features).join("path").attr("d",xE.geoPath(e)).attr("fill",(t=>fE(a.features,l).getcol(t.properties[l.values]))).attr("stroke",(t=>fE(a.features,f).getcol(t.properties[f.values]))).attr("stroke-width",(t=>pE(a.features,d).getthickness(t.properties[d.values]||void 0))).attr("fill-opacity",p).attr("stroke-opacity",g).attr("stroke-linecap",h).attr("stroke-linejoin",c).attr("stroke-dasharray",u).on("touchmove mousemove",(function(e,n){b&&(xE.select(this).attr("stroke-opacity",g-.3).attr("fill-opacity",p-.3),M=n.properties,t.dispatch("input"),Object.defineProperty(t.node(),"value",{get:()=>M,configurable:!0})),_&&t.select("#info").call(yE,{fields:function(){const t=Array.isArray(_.fields)?_.fields:[_.fields];let e=[];return t.forEach((t=>{e.push("$"==t[0]?`${n.properties[t.substr(1,t.length)]}`:t)})),e}(),fontWeight:_.fontWeight,fontSize:_.fontSize,fontStyle:_.fontStyle,fill:_.fill,stroke:_.stroke,strokeWidth:_.strokeWidth,fillOpacity:_.fillOpacity,strokeOpacity:_.strokeOpacity,col:_.col,type:_E(xE.pointer(e,this),r,s)}),_&&(t.select("#info").attr("transform",`translate(${xE.pointer(e,this)})`),xE.select(this).attr("stroke-opacity",g-.3).attr("fill-opacity",p-.3).raise())})).on("touchend mouseleave",(function(){b&&(M={},t.dispatch("input")),t.select("#info").call(yE,null),xE.select(this).attr("stroke-opacity",g).attr("fill-opacity",p).lower()})),"p"==mE(a)){if(n.leg_type=n.symbol?n.symbol:"circle",v>0){const t=xE.forceSimulation(a.features).force("x",xE.forceX((t=>e(t.geometry.coordinates)[0]))).force("y",xE.forceY((t=>e(t.geometry.coordinates)[1]))).force("collide",xE.forceCollide(Math.sqrt(m)/2+v/2));for(let e=0;e<x;e++)t.tick()}const i=new Map([["circle",xE.symbolCircle],["cross",xE.symbolCross],["diamond",xE.symbolDiamond],["square",xE.symbolSquare],["star",xE.symbolStar],["triangle",xE.symbolTriangle],["wye",xE.symbolWye]]);t.append("g").selectAll("path").data(a.features).join("path").attr("d",xE.symbol().size(m).type(i.get(y))).attr("transform",(t=>`translate(\n       ${v?t.x:e(t.geometry.coordinates)[0]},\n       ${v?t.y:e(t.geometry.coordinates)[1]})`)).attr("fill",(t=>fE(a.features,l).getcol(t.properties[l.values]||void 0))).attr("stroke",(t=>fE(a.features,f).getcol(t.properties[f.values]))).attr("stroke-width",(t=>pE(a.features,d).getthickness(t.properties[d.values]))).attr("fill-opacity",p).attr("stroke-opacity",g).attr("stroke-linecap",h).attr("stroke-linejoin",c).attr("stroke-dasharray",u).on("touchmove mousemove",(function(n,i){b&&(M=i.properties,t.dispatch("input"),Object.defineProperty(t.node(),"value",{get:()=>M,configurable:!0})),_&&t.select("#info").call(yE,{fields:function(){const t=Array.isArray(_.fields)?_.fields:[_.fields];let e=[];return t.forEach((t=>{e.push("$"==t[0]?`${i.properties[t.substr(1,t.length)]}`:t)})),e}(),fontWeight:_.fontWeight,fontSize:_.fontSize,fontStyle:_.fontStyle,fill:_.fill,stroke:_.stroke,strokeWidth:_.strokeWidth,fillOpacity:_.fillOpacity,strokeOpacity:_.strokeOpacity,col:_.col,type:_E(v?[i.x,i.y]:e(i.geometry.coordinates),r,s)}),_&&(t.select("#info").attr("transform",`translate(\n         ${v?i.x:e(i.geometry.coordinates)[0]},\n         ${v?i.y:e(i.geometry.coordinates)[1]})`),xE.select(this).attr("stroke-opacity",g-.3).attr("fill-opacity",p-.3))})).on("touchend mouseleave",(function(){b&&(M={},t.dispatch("input")),t.select("#info").call(yE,null),xE.select(this).attr("stroke-opacity",g).attr("fill-opacity",p)}))}b&&Object.defineProperty(t.node(),"value",{get:()=>M,configurable:!0}),gE(a,t,l,f,d),Ay(t,{x:n.leg_x,y:n.leg_y,w:n.leg_w,h:n.leg_h,symbol_size:m,type:n.leg_type,title:n.leg_title,text:n.leg_text,fontSize:n.leg_fontSize,fontSize2:n.leg_fontSize2,stroke:n.leg_stroke,fillOpacity:n.leg_fillOpacity?n.leg_fillOpacity:p,fill:n.leg_fill?n.leg_fill:l,strokeWidth:n.leg_strokeWidth,txtcol:n.leg_txtcol})}}const bE=Object.assign({},{scaleSqrt:Wx,max:it,descending:n});const ME=Object.assign({},{geoArea:Ie,geoCentroid:bn,geoIdentity:ss,geoPath:vr});function wE(t,e={}){if("p"===mE(t))return t;{let n=!1!==e.largest,i=!0===e.planar,r=ME.geoPath(ME.geoIdentity());t=Wo(t);const s=function(t){var e={},n=0;return t.geometry.coordinates.forEach((function(t){var s={type:"Polygon",coordinates:t},o=i?r.area(s):ME.geoArea(s);o>n&&(n=o,e=s)})),e};let o=t.features.map((t=>(t.geometry.coordinates=i?r.centroid(1==n?"Polygon"==t.geometry.type?t:s(t):t):ME.geoCentroid(1==n?"Polygon"==t.geometry.type?t:s(t):t),t.geometry.type="Point",t)));return t.features=o,t}}const EE=Object.assign({},{min:st,max:it,descending:n,scaleSqrt:Wx,select:Io,pointer:Ao,forceX:Cy,forceY:Ty,forceCollide:iy,forceSimulation:Oy});function NE(t,e,n,i={},r,s,o){if(0!=i.display){let r,a=["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],l=Uo(i.geojson),h=i.values,c=null!=i.fixmax?i.fixmax:void 0,u=i.k?i.k:50,f=i.fill?i.fill:a[Math.floor(Math.random()*a.length)],d=i.stroke?i.stroke:"white",p=null!=i.strokeWidth?i.strokeWidth:.5,g=i.strokeDasharray?i.strokeDasharray:"none",_=null!=i.strokeOpacity?i.strokeOpacity:1,y=null!=i.fillOpacity?i.fillOpacity:1,m=!!i.dorling&&i.dorling,x=null!=i.iteration?i.iteration:200,v=!!i.tooltip&&i.tooltip,b=!!i.viewof;Array.isArray(v)&&(v={fields:v}),"string"==typeof v&&(v={fields:[v]}),r="p"==mE(l)?l.features:wE(l,{planar:n}).features;const M=null!=c?c:EE.max(r,(t=>Math.abs(+t.properties[h])));let w=EE.scaleSqrt([0,M],[0,u]);if(1==m){const t=EE.forceSimulation(r).force("x",EE.forceX((t=>e(t.geometry.coordinates)[0]))).force("y",EE.forceY((t=>e(t.geometry.coordinates)[1]))).force("collide",EE.forceCollide((t=>w(Math.abs(t.properties[h]))+pE(r,p).getthickness(t.properties[p.values]||0)/2)));for(let e=0;e<x;e++)t.tick()}let E={};t.append("g").selectAll("circle").data(r.filter((t=>null!=t.geometry.coordinates)).filter((t=>null!=t.properties[h])).sort(((t,e)=>EE.descending(Math.abs(+t.properties[h]),Math.abs(+e.properties[h]))))).join("circle").attr("fill",(t=>fE(r,f).getcol(t.properties[f.values]))).attr("stroke",(t=>fE(r,d).getcol(t.properties[d.values]))).attr("stroke-width",(t=>pE(r,p).getthickness(t.properties[p.values]||void 0))).attr("fill-opacity",y).attr("stroke-dasharray",g).attr("stroke-opacity",_).attr("cx",(t=>m?t.x:e(t.geometry.coordinates)[0])).attr("cy",(t=>m?t.y:e(t.geometry.coordinates)[1])).attr("r",(t=>w(Math.abs(t.properties[h])))).on("touchmove mousemove",(function(e,n){b&&(EE.select(this).attr("stroke-opacity",_-.3).attr("fill-opacity",y-.3),E=n.properties,t.dispatch("input"),Object.defineProperty(t.node(),"value",{get:()=>E,configurable:!0})),v&&t.select("#info").call(yE,{fields:function(){const t=Array.isArray(v.fields)?v.fields:[v.fields];let e=[];return t.forEach((t=>{e.push("$"==t[0]?`${n.properties[t.substr(1,t.length)]}`:t)})),e}(),fontWeight:v.fontWeight,fontSize:v.fontSize,fontStyle:v.fontStyle,fill:v.fill,stroke:v.stroke,strokeWidth:v.strokeWidth,fillOpacity:v.fillOpacity,strokeOpacity:v.strokeOpacity,col:v.col,type:_E(EE.pointer(e,this),s,o)}),v&&(t.select("#info").attr("transform",`translate(${EE.pointer(e,this)})`),EE.select(this).attr("stroke-opacity",_-.3).attr("fill-opacity",y-.3))})).on("touchend mouseleave",(function(){b&&(E={},t.dispatch("input")),t.select("#info").call(yE,null),EE.select(this).attr("stroke-opacity",_).attr("fill-opacity",y)})),b&&Object.defineProperty(t.node(),"value",{get:()=>E,configurable:!0}),gE(l,t,f,d,p);let N=r.map((t=>Math.abs(+t.properties[h]))),S=[EE.min(N),w.invert(w(EE.max(N))/3),w.invert(w(EE.max(N))/1.5),EE.max(N)];!function(t,e={}){let n=e.values,i=e.k?e.k:50,r=e.stroke?e.stroke:"black",s=e.fill?e.fill:"none",o=e.strokeWidth?e.strokeWidth:.8,a=e.txtcol?e.txtcol:"#363636",l=e.x?e.x:null,h=e.y?e.y:null,c=e.title?e.title:"Title, year\n(units)",u=e.fontSize?e.fontSize:14,f=e.fontSize2?e.fontSize2:10,d=null!=e.round?e.round:void 0,p=e.fixmax;const g=null!=p?p:bE.max(n);let _=bE.scaleSqrt([0,g],[0,i]),y=_(bE.max(n));if(null!=l&&null!=h){let e=t.append("g").attr("class","bertinlegend");e.selectAll("circle").data(n.sort(bE.descending)).join("circle").attr("r",(t=>_(t))).attr("fill",s).attr("stroke",r).attr("stroke-width",o).attr("transform",(t=>`translate(${l+y},${h-_(t)+2*y+(c.split("\n").length+1)*u})`)),e.selectAll("line").data(n).join("line").attr("x1",l+y).attr("y1",(t=>h+2*y-2*_(t)+(c.split("\n").length+1)*u)).attr("x2",l+2*y+u).attr("y2",(t=>h+2*y-2*_(t)+(c.split("\n").length+1)*u)).attr("stroke",r).attr("stroke-width",o).attr("stroke-dasharray",2),e.append("g").selectAll("text").data(c.split("\n")).join("text").attr("x",l).attr("y",h).attr("font-size",`${u}px`).attr("dy",((t,e)=>e*u)).attr("text-anchor","start").attr("dominant-baseline","hanging").attr("fill",a).text((t=>t)),e.append("g").selectAll("text").data(n).join("text").attr("x",l+2*y+u+f/2).attr("y",(t=>h+2*y-2*_(t)+(c.split("\n").length+1)*u)).attr("font-size",f).attr("dominant-baseline","central").attr("fill",a).text((t=>TM(t,d)))}}(t,{x:i.leg_x,y:i.leg_y,round:void 0!==i.leg_round?i.leg_round:void 0,k:u,fixmax:c,stroke:i.leg_stroke,fill:i.leg_fill,strokeWidth:i.leg_strokeWidth,txtcol:i.leg_txtcol,title:i.leg_title,fontSize:i.leg_fontSize,fontSize2:i.leg_fontSize2,title:i.leg_title?i.leg_title:h,values:S})}}const SE=Object.assign({},{scaleSqrt:Wx,max:it,descending:n});const IE=Object.assign({},{min:st,max:it,descending:n,scaleSqrt:Wx,select:Io,pointer:Ao,forceX:Cy,forceY:Ty,forceCollide:iy,forceSimulation:Oy,quadtree:H_});function kE(t,e,n,i={},r,s,o){if(0!=i.display){let a,l=["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],h=Uo(i.geojson),c=i.values,u=null!=i.fixmax?i.fixmax:void 0,f=i.k?i.k:50,d=i.fill?i.fill:l[Math.floor(Math.random()*l.length)],p=i.stroke?i.stroke:"white",g=null!=i.strokeWidth?i.strokeWidth:.5,_=i.strokeDasharray?i.strokeDasharray:"none",y=null!=i.strokeOpacity?i.strokeOpacity:1,m=null!=i.fillOpacity?i.fillOpacity:1,x=!!i.dorling&&i.dorling,v=!!i.demers&&i.demers,b=null!=i.iteration?i.iteration:200,M=!!i.tooltip&&i.tooltip,w=!!i.viewof;Array.isArray(M)&&(M={fields:M}),"string"==typeof M&&(M={fields:[M]}),a="p"==mE(h)?h.features:wE(h,{planar:n}).features;const E=null!=u?u:IE.max(a,(t=>Math.abs(+t.properties[c])));let N=IE.scaleSqrt([0,E],[0,1.77*f]),S=[...a].map((t=>Object.assign(t.properties,{_x:e(t.geometry.coordinates)[0],_y:e(t.geometry.coordinates)[1],_size:N(Math.abs(t.properties[c])),_padding:pE(a,g).getthickness(t.properties[g.values]||0)/2+0}))).filter((t=>!isNaN(t._x))).filter((t=>!isNaN(t._y))).filter((t=>null!=t[c]));if(1==x||1==v){function C(){let t;function e(e){const n=IE.quadtree(t,(t=>t._x),(t=>t._y));for(const e of t)n.visit(((t,n,i,r,s)=>{let o=!1;if(t.data&&t.data!==e){let n,i,r,s=e._x-t.data._x,a=e._y-t.data._y,l=e._padding+(t.data._size+e._size)/2,h=e._padding+(t.data._size+e._size)/2,c=Math.abs(s),u=Math.abs(a);c<l&&u<h&&(n=Math.sqrt(s*s+a*a),i=(c-l)/n,r=(u-h)/n,Math.abs(i)>Math.abs(r)?i=0:r=0,e._x-=s*=i,e._y-=a*=r,t.data.x+=s,t.data.y+=a,o=!0)}return o}))}return e.initialize=e=>t=e,e}const T=IE.forceSimulation(S).force("_x",IE.forceX((t=>t._x))).force("_y",IE.forceY((t=>t._y))).force("collide",C());for(let R=0;R<b;R++)T.tick()}let I={};t.append("g").selectAll("squares").data(S.sort(((t,e)=>IE.descending(Math.abs(+t[c]),Math.abs(+e[c]))))).join("rect").attr("fill",(t=>fE(S,d).getcol(t[d.values]))).attr("stroke",(t=>fE(S,p).getcol(t[p.values]))).attr("stroke-width",(t=>pE(S,g).getthickness(t[g.values]||void 0))).attr("fill-opacity",m).attr("stroke-dasharray",_).attr("stroke-opacity",y).attr("x",(t=>t._x-t._size/2)).attr("y",(t=>t._y-t._size/2)).attr("width",(t=>t._size)).attr("height",(t=>t._size)).on("touchmove mousemove",(function(e,n){w&&(IE.select(this).attr("stroke-opacity",y-.3).attr("fill-opacity",m-.3),I=n,t.dispatch("input"),Object.defineProperty(t.node(),"value",{get:()=>I,configurable:!0})),M&&t.select("#info").call(yE,{fields:function(){const t=Array.isArray(M.fields)?M.fields:[M.fields];let e=[];return t.forEach((t=>{e.push("$"==t[0]?`${n[t.substr(1,t.length)]}`:t)})),e}(),fontWeight:M.fontWeight,fontSize:M.fontSize,fontStyle:M.fontStyle,fill:M.fill,stroke:M.stroke,strokeWidth:M.strokeWidth,fillOpacity:M.fillOpacity,strokeOpacity:M.strokeOpacity,col:M.col,type:_E(IE.pointer(e,this),s,o)}),M&&(t.select("#info").attr("transform",`translate(${IE.pointer(e,this)})`),IE.select(this).attr("stroke-opacity",y-.3).attr("fill-opacity",m-.3))})).on("touchend mouseleave",(function(){w&&(I={},t.dispatch("input")),t.select("#info").call(yE,null),IE.select(this).attr("stroke-opacity",y).attr("fill-opacity",m)})),w&&Object.defineProperty(t.node(),"value",{get:()=>I,configurable:!0}),gE(h,t,d,p,g);let k=S.map((t=>Math.abs(+t[c]))),O=[IE.min(k),N.invert(N(IE.max(k))/3),N.invert(N(IE.max(k))/1.5),IE.max(k)];!function(t,e={}){let n=e.values,i=e.k?e.k:50,r=e.stroke?e.stroke:"black",s=e.fill?e.fill:"none",o=e.strokeWidth?e.strokeWidth:.8,a=e.txtcol?e.txtcol:"#363636",l=e.x?e.x:null,h=e.y?e.y:null,c=e.title?e.title:"Title, year\n  (units)",u=e.fontSize?e.fontSize:14,f=e.fontSize2?e.fontSize2:10,d=null!=e.round?e.round:void 0,p=e.fixmax;const g=null!=p?p:SE.max(n);let _=SE.scaleSqrt([0,g],[0,1.77*i]),y=_(SE.max(n));if(null!=l&&null!=h){let e=t.append("g").attr("class","bertinlegend");e.selectAll("rect").data(n.sort(SE.descending)).join("rect").attr("width",(t=>_(t))).attr("height",(t=>_(t))).attr("fill",s).attr("stroke",r).attr("stroke-width",o).attr("transform",(t=>`translate(${l+y-_(t)},${h-_(t)+y+(c.split("\n").length+1)*u})`)),e.selectAll("line").data(n).join("line").attr("x1",l+y).attr("y1",(t=>h+y-_(t)+(c.split("\n").length+1)*u)).attr("x2",l+y+u).attr("y2",(t=>h+y-_(t)+(c.split("\n").length+1)*u)).attr("stroke",r).attr("stroke-width",o).attr("stroke-dasharray",2),e.append("g").selectAll("text").data(c.split("\n")).join("text").attr("x",l).attr("y",h).attr("font-size",`${u}px`).attr("dy",((t,e)=>e*u)).attr("text-anchor","start").attr("dominant-baseline","hanging").attr("fill",a).text((t=>t)),e.append("g").selectAll("text").data(n).join("text").attr("x",l+y+u+f/2).attr("y",(t=>h+y-_(t)+(c.split("\n").length+1)*u)).attr("font-size",f).attr("dominant-baseline","central").attr("fill",a).text((t=>TM(t,d)))}}(t,{x:i.leg_x,y:i.leg_y,round:void 0!==i.leg_round?i.leg_round:void 0,k:f,fixmax:u,stroke:i.leg_stroke,fill:i.leg_fill,strokeWidth:i.leg_strokeWidth,txtcol:i.leg_txtcol,title:i.leg_title,fontSize:i.leg_fontSize,fontSize2:i.leg_fontSize2,title:i.leg_title?i.leg_title:c,values:O})}}function OE(t,e,n){void 0===n&&(n={});var i={type:"Feature"};return(0===n.id||n.id)&&(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.properties=e||{},i.geometry=t,i}function CE(t){return"Feature"===t.type?t.geometry:t}function TE(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var i=function(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}(t),r=CE(e),s=r.type,o=e.bbox,a=r.coordinates;if(o&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}
/**
   * splaytree v3.1.1
   * Fast Splay tree for Node and browser
   *
   * @author Alexander Milevski <info@w8r.name>
   * @license MIT
   * @preserve
   */
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */(i,o))return!1;"Polygon"===s&&(a=[a]);for(var l=!1,h=0;h<a.length&&!l;h++)if(RE(i,a[h][0],n.ignoreBoundary)){for(var c=!1,u=1;u<a[h].length&&!c;)RE(i,a[h][u],!n.ignoreBoundary)&&(c=!0),u++;c||(l=!0)}return l}function RE(t,e,n){var i=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var r=0,s=e.length-1;r<e.length;s=r++){var o=e[r][0],a=e[r][1],l=e[s][0],h=e[s][1];if(t[1]*(o-l)+a*(l-t[0])+h*(t[0]-o)==0&&(o-t[0])*(l-t[0])<=0&&(a-t[1])*(h-t[1])<=0)return!n;a>t[1]!=h>t[1]&&t[0]<(l-o)*(t[1]-a)/(h-a)+o&&(i=!i)}return i}function AE(t,e){var n,i,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}var LE=function(t,e){this.next=null,this.key=t,this.data=e,this.left=null,this.right=null};function PE(t,e){return t>e?1:t<e?-1:0}function DE(t,e,n){for(var i=new LE(null,null),r=i,s=i;;){var o=n(t,e.key);if(o<0){if(null===e.left)break;if(n(t,e.left.key)<0){var a=e.left;if(e.left=a.right,a.right=e,null===(e=a).left)break}s.left=e,s=e,e=e.left}else{if(!(o>0))break;if(null===e.right)break;if(n(t,e.right.key)>0){a=e.right;if(e.right=a.left,a.left=e,null===(e=a).right)break}r.right=e,r=e,e=e.right}}return r.right=e.left,s.left=e.right,e.left=i.right,e.right=i.left,e}function zE(t,e,n,i){var r=new LE(t,e);if(null===n)return r.left=r.right=null,r;var s=i(t,(n=DE(t,n,i)).key);return s<0?(r.left=n.left,r.right=n,n.left=null):s>=0&&(r.right=n.right,r.left=n,n.right=null),r}function FE(t,e,n){var i=null,r=null;if(e){var s=n((e=DE(t,e,n)).key,t);0===s?(i=e.left,r=e.right):s<0?(r=e.right,e.right=null,i=e):(i=e.left,e.left=null,r=e)}return{left:i,right:r}}function GE(t,e,n,i,r){if(t){i(e+(n?" ":" ")+r(t)+"\n");var s=e+(n?"    ":"   ");t.left&&GE(t.left,s,!1,i,r),t.right&&GE(t.right,s,!0,i,r)}}var qE=function(){function t(t){void 0===t&&(t=PE),this._root=null,this._size=0,this._comparator=t}return t.prototype.insert=function(t,e){return this._size++,this._root=zE(t,e,this._root,this._comparator)},t.prototype.add=function(t,e){var n=new LE(t,e);null===this._root&&(n.left=n.right=null,this._size++,this._root=n);var i=this._comparator,r=DE(t,this._root,i),s=i(t,r.key);return 0===s?this._root=r:(s<0?(n.left=r.left,n.right=r,r.left=null):s>0&&(n.right=r.right,n.left=r,r.right=null),this._size++,this._root=n),this._root},t.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},t.prototype._remove=function(t,e,n){var i;return null===e?null:0===n(t,(e=DE(t,e,n)).key)?(null===e.left?i=e.right:(i=DE(t,e.left,n)).right=e.right,this._size--,i):e},t.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=DE(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},t.prototype.findStatic=function(t){for(var e=this._root,n=this._comparator;e;){var i=n(t,e.key);if(0===i)return e;e=i<0?e.left:e.right}return null},t.prototype.find=function(t){return this._root&&(this._root=DE(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root},t.prototype.contains=function(t){for(var e=this._root,n=this._comparator;e;){var i=n(t,e.key);if(0===i)return!0;e=i<0?e.left:e.right}return!1},t.prototype.forEach=function(t,e){for(var n=this._root,i=[],r=!1;!r;)null!==n?(i.push(n),n=n.left):0!==i.length?(n=i.pop(),t.call(e,n),n=n.right):r=!0;return this},t.prototype.range=function(t,e,n,i){for(var r=[],s=this._comparator,o=this._root;0!==r.length||o;)if(o)r.push(o),o=o.left;else{if(s((o=r.pop()).key,e)>0)break;if(s(o.key,t)>=0&&n.call(i,o))return this;o=o.right}return this},t.prototype.keys=function(){var t=[];return this.forEach((function(e){var n=e.key;return t.push(n)})),t},t.prototype.values=function(){var t=[];return this.forEach((function(e){var n=e.data;return t.push(n)})),t},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},t.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},t.prototype.at=function(t){for(var e=this._root,n=!1,i=0,r=[];!n;)if(e)r.push(e),e=e.left;else if(r.length>0){if(e=r.pop(),i===t)return e;i++,e=e.right}else n=!0;return null},t.prototype.next=function(t){var e=this._root,n=null;if(t.right){for(n=t.right;n.left;)n=n.left;return n}for(var i=this._comparator;e;){var r=i(t.key,e.key);if(0===r)break;r<0?(n=e,e=e.left):e=e.right}return n},t.prototype.prev=function(t){var e=this._root,n=null;if(null!==t.left){for(n=t.left;n.right;)n=n.right;return n}for(var i=this._comparator;e;){var r=i(t.key,e.key);if(0===r)break;r<0?e=e.left:(n=e,e=e.right)}return n},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return function(t){var e=t,n=[],i=!1,r=new LE(null,null),s=r;for(;!i;)e?(n.push(e),e=e.left):n.length>0?e=(e=s=s.next=n.pop()).right:i=!0;return s.next=null,r.next}(this._root)},t.prototype.load=function(t,e,n){void 0===e&&(e=[]),void 0===n&&(n=!1);var i=t.length,r=this._comparator;if(n&&UE(t,e,0,i-1,r),null===this._root)this._root=jE(t,e,0,i),this._size=i;else{var s=function(t,e,n){var i=new LE(null,null),r=i,s=t,o=e;for(;null!==s&&null!==o;)n(s.key,o.key)<0?(r.next=s,s=s.next):(r.next=o,o=o.next),r=r.next;null!==s?r.next=s:null!==o&&(r.next=o);return i.next}(this.toList(),function(t,e){for(var n=new LE(null,null),i=n,r=0;r<t.length;r++)i=i.next=new LE(t[r],e[r]);return i.next=null,n.next}(t,e),r);i=this._size+i,this._root=BE({head:s},0,i)}return this},t.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(t){void 0===t&&(t=function(t){return String(t.key)});var e=[];return GE(this._root,"",!0,(function(t){return e.push(t)}),t),e.join("")},t.prototype.update=function(t,e,n){var i=this._comparator,r=FE(t,this._root,i),s=r.left,o=r.right;i(t,e)<0?o=zE(e,n,o,i):s=zE(e,n,s,i),this._root=function(t,e,n){return null===e?t:(null===t||((e=DE(t.key,e,n)).left=t),e)}(s,o,i)},t.prototype.split=function(t){return FE(t,this._root,this._comparator)},t.prototype[Symbol.iterator]=function(){var t;return AE(this,(function(e){switch(e.label){case 0:t=this.minNode(),e.label=1;case 1:return t?[4,t]:[3,3];case 2:return e.sent(),t=this.next(t),[3,1];case 3:return[2]}}))},t}();function jE(t,e,n,i){var r=i-n;if(r>0){var s=n+Math.floor(r/2),o=t[s],a=e[s],l=new LE(o,a);return l.left=jE(t,e,n,s),l.right=jE(t,e,s+1,i),l}return null}function BE(t,e,n){var i=n-e;if(i>0){var r=e+Math.floor(i/2),s=BE(t,e,r),o=t.head;return o.left=s,t.head=t.head.next,o.right=BE(t,r+1,n),o}return null}function UE(t,e,n,i,r){if(!(n>=i)){for(var s=t[n+i>>1],o=n-1,a=i+1;;){do{o++}while(r(t[o],s)<0);do{a--}while(r(t[a],s)>0);if(o>=a)break;var l=t[o];t[o]=t[a],t[a]=l,l=e[o],e[o]=e[a],e[a]=l}UE(t,e,n,a,r),UE(t,e,a+1,i,r)}}function YE(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function WE(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function $E(t,e,n){return e&&WE(t.prototype,e),n&&WE(t,n),t}var XE=function(t,e){return t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y},VE=function(t,e){if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;var n=t.ll.x<e.ll.x?e.ll.x:t.ll.x,i=t.ur.x<e.ur.x?t.ur.x:e.ur.x;return{ll:{x:n,y:t.ll.y<e.ll.y?e.ll.y:t.ll.y},ur:{x:i,y:t.ur.y<e.ur.y?t.ur.y:e.ur.y}}},HE=Number.EPSILON;void 0===HE&&(HE=Math.pow(2,-52));var ZE=HE*HE,JE=function(t,e){if(-HE<t&&t<HE&&-HE<e&&e<HE)return 0;var n=t-e;return n*n<ZE*t*e?0:t<e?-1:1},QE=function(){function t(){YE(this,t),this.reset()}return $E(t,[{key:"reset",value:function(){this.xRounder=new KE,this.yRounder=new KE}},{key:"round",value:function(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}}]),t}(),KE=function(){function t(){YE(this,t),this.tree=new qE,this.round(0)}return $E(t,[{key:"round",value:function(t){var e=this.tree.add(t),n=this.tree.prev(e);if(null!==n&&0===JE(e.key,n.key))return this.tree.remove(t),n.key;var i=this.tree.next(e);return null!==i&&0===JE(e.key,i.key)?(this.tree.remove(t),i.key):t}}]),t}(),tN=new QE,eN=function(t,e){return t.x*e.y-t.y*e.x},nN=function(t,e){return t.x*e.x+t.y*e.y},iN=function(t,e,n){var i={x:e.x-t.x,y:e.y-t.y},r={x:n.x-t.x,y:n.y-t.y},s=eN(i,r);return JE(s,0)},rN=function(t){return Math.sqrt(nN(t,t))},sN=function(t,e,n){var i={x:e.x-t.x,y:e.y-t.y},r={x:n.x-t.x,y:n.y-t.y};return nN(r,i)/rN(r)/rN(i)},oN=function(t,e,n){return 0===e.y?null:{x:t.x+e.x/e.y*(n-t.y),y:n}},aN=function(t,e,n){return 0===e.x?null:{x:n,y:t.y+e.y/e.x*(n-t.x)}},lN=function(){function t(e,n){YE(this,t),void 0===e.events?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=n}return $E(t,null,[{key:"compare",value:function(e,n){var i=t.comparePoints(e.point,n.point);return 0!==i?i:(e.point!==n.point&&e.link(n),e.isLeft!==n.isLeft?e.isLeft?1:-1:cN.compare(e.segment,n.segment))}},{key:"comparePoints",value:function(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}}]),$E(t,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var e=t.point.events,n=0,i=e.length;n<i;n++){var r=e[n];this.point.events.push(r),r.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,e=0;e<t;e++){var n=this.point.events[e];if(void 0===n.segment.consumedBy)for(var i=e+1;i<t;i++){var r=this.point.events[i];void 0===r.consumedBy&&(n.otherSE.point.events===r.otherSE.point.events&&n.segment.consume(r.segment))}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],e=0,n=this.point.events.length;e<n;e++){var i=this.point.events[e];i!==this&&!i.segment.ringOut&&i.segment.isInResult()&&t.push(i)}return t}},{key:"getLeftmostComparator",value:function(t){var e=this,n=new Map,i=function(i){var r,s,o,a,l,h=i.otherSE;n.set(i,{sine:(r=e.point,s=t.point,o=h.point,a={x:s.x-r.x,y:s.y-r.y},l={x:o.x-r.x,y:o.y-r.y},eN(l,a)/rN(l)/rN(a)),cosine:sN(e.point,t.point,h.point)})};return function(t,e){n.has(t)||i(t),n.has(e)||i(e);var r=n.get(t),s=r.sine,o=r.cosine,a=n.get(e),l=a.sine,h=a.cosine;return s>=0&&l>=0?o<h?1:o>h?-1:0:s<0&&l<0?o<h?-1:o>h?1:0:l<s?-1:l>s?1:0}}}]),t}(),hN=0,cN=function(){function t(e,n,i,r){YE(this,t),this.id=++hN,this.leftSE=e,e.segment=this,e.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=e,this.rings=i,this.windings=r}return $E(t,null,[{key:"compare",value:function(t,e){var n=t.leftSE.point.x,i=e.leftSE.point.x,r=t.rightSE.point.x,s=e.rightSE.point.x;if(s<n)return 1;if(r<i)return-1;var o=t.leftSE.point.y,a=e.leftSE.point.y,l=t.rightSE.point.y,h=e.rightSE.point.y;if(n<i){if(a<o&&a<l)return 1;if(a>o&&a>l)return-1;var c=t.comparePoint(e.leftSE.point);if(c<0)return 1;if(c>0)return-1;var u=e.comparePoint(t.rightSE.point);return 0!==u?u:-1}if(n>i){if(o<a&&o<h)return-1;if(o>a&&o>h)return 1;var f=e.comparePoint(t.leftSE.point);if(0!==f)return f;var d=t.comparePoint(e.rightSE.point);return d<0?1:d>0?-1:1}if(o<a)return-1;if(o>a)return 1;if(r<s){var p=e.comparePoint(t.rightSE.point);if(0!==p)return p}if(r>s){var g=t.comparePoint(e.rightSE.point);if(g<0)return 1;if(g>0)return-1}if(r!==s){var _=l-o,y=r-n,m=h-a,x=s-i;if(_>y&&m<x)return 1;if(_<y&&m>x)return-1}return r>s?1:r<s||l<h?-1:l>h?1:t.id<e.id?-1:t.id>e.id?1:0}}]),$E(t,[{key:"replaceRightSE",value:function(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:t>e?t:e}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var e=this.leftSE.point,n=this.rightSE.point,i=this.vector();if(e.x===n.x)return t.x===e.x?0:t.x<e.x?1:-1;var r=(t.y-e.y)/i.y,s=e.x+r*i.x;if(t.x===s)return 0;var o=(t.x-e.x)/i.x,a=e.y+o*i.y;return t.y===a?0:t.y<a?-1:1}},{key:"getIntersection",value:function(t){var e=this.bbox(),n=t.bbox(),i=VE(e,n);if(null===i)return null;var r=this.leftSE.point,s=this.rightSE.point,o=t.leftSE.point,a=t.rightSE.point,l=XE(e,o)&&0===this.comparePoint(o),h=XE(n,r)&&0===t.comparePoint(r),c=XE(e,a)&&0===this.comparePoint(a),u=XE(n,s)&&0===t.comparePoint(s);if(h&&l)return u&&!c?s:!u&&c?a:null;if(h)return c&&r.x===a.x&&r.y===a.y?null:r;if(l)return u&&s.x===o.x&&s.y===o.y?null:o;if(u&&c)return null;if(u)return s;if(c)return a;var f=function(t,e,n,i){if(0===e.x)return aN(n,i,t.x);if(0===i.x)return aN(t,e,n.x);if(0===e.y)return oN(n,i,t.y);if(0===i.y)return oN(t,e,n.y);var r=eN(e,i);if(0==r)return null;var s={x:n.x-t.x,y:n.y-t.y},o=eN(s,e)/r,a=eN(s,i)/r;return{x:(t.x+a*e.x+(n.x+o*i.x))/2,y:(t.y+a*e.y+(n.y+o*i.y))/2}}(r,this.vector(),o,t.vector());return null===f?null:XE(i,f)?tN.round(f.x,f.y):null}},{key:"split",value:function(e){var n=[],i=void 0!==e.events,r=new lN(e,!0),s=new lN(e,!1),o=this.rightSE;this.replaceRightSE(s),n.push(s),n.push(r);var a=new t(r,o,this.rings.slice(),this.windings.slice());return lN.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),lN.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),i&&(r.checkForConsuming(),s.checkForConsuming()),n}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var e=0,n=this.windings.length;e<n;e++)this.windings[e]*=-1}},{key:"consume",value:function(e){for(var n=this,i=e;n.consumedBy;)n=n.consumedBy;for(;i.consumedBy;)i=i.consumedBy;var r=t.compare(n,i);if(0!==r){if(r>0){var s=n;n=i,i=s}if(n.prev===i){var o=n;n=i,i=o}for(var a=0,l=i.rings.length;a<l;a++){var h=i.rings[a],c=i.windings[a],u=n.rings.indexOf(h);-1===u?(n.rings.push(h),n.windings.push(c)):n.windings[u]+=c}i.rings=null,i.windings=null,i.consumedBy=n,i.leftSE.consumedBy=n.leftSE,i.rightSE.consumedBy=n.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){var t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};for(var e=this._afterState.rings,n=this._afterState.windings,i=this._afterState.multiPolys,r=0,s=this.rings.length;r<s;r++){var o=this.rings[r],a=this.windings[r],l=e.indexOf(o);-1===l?(e.push(o),n.push(a)):n[l]+=a}for(var h=[],c=[],u=0,f=e.length;u<f;u++)if(0!==n[u]){var d=e[u],p=d.poly;if(-1===c.indexOf(p))if(d.isExterior)h.push(p);else{-1===c.indexOf(p)&&c.push(p);var g=h.indexOf(d.poly);-1!==g&&h.splice(g,1)}}for(var _=0,y=h.length;_<y;_++){var m=h[_].multiPoly;-1===i.indexOf(m)&&i.push(m)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(vN.type){case"union":var n=0===t.length,i=0===e.length;this._isInResult=n!==i;break;case"intersection":var r,s;t.length<e.length?(r=t.length,s=e.length):(r=e.length,s=t.length),this._isInResult=s===vN.numMultiPolys&&r<s;break;case"xor":var o=Math.abs(t.length-e.length);this._isInResult=o%2==1;break;case"difference":var a=function(t){return 1===t.length&&t[0].isSubject};this._isInResult=a(t)!==a(e);break;default:throw new Error("Unrecognized operation type found ".concat(vN.type))}return this._isInResult}}],[{key:"fromRing",value:function(e,n,i){var r,s,o,a=lN.comparePoints(e,n);if(a<0)r=e,s=n,o=1;else{if(!(a>0))throw new Error("Tried to create degenerate segment at [".concat(e.x,", ").concat(e.y,"]"));r=n,s=e,o=-1}return new t(new lN(r,!0),new lN(s,!1),[i],[o])}}]),t}(),uN=function(){function t(e,n,i){if(YE(this,t),!Array.isArray(e)||0===e.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=i,this.segments=[],"number"!=typeof e[0][0]||"number"!=typeof e[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var r=tN.round(e[0][0],e[0][1]);this.bbox={ll:{x:r.x,y:r.y},ur:{x:r.x,y:r.y}};for(var s=r,o=1,a=e.length;o<a;o++){if("number"!=typeof e[o][0]||"number"!=typeof e[o][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var l=tN.round(e[o][0],e[o][1]);l.x===s.x&&l.y===s.y||(this.segments.push(cN.fromRing(s,l,this)),l.x<this.bbox.ll.x&&(this.bbox.ll.x=l.x),l.y<this.bbox.ll.y&&(this.bbox.ll.y=l.y),l.x>this.bbox.ur.x&&(this.bbox.ur.x=l.x),l.y>this.bbox.ur.y&&(this.bbox.ur.y=l.y),s=l)}r.x===s.x&&r.y===s.y||this.segments.push(cN.fromRing(s,r,this))}return $E(t,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,n=this.segments.length;e<n;e++){var i=this.segments[e];t.push(i.leftSE),t.push(i.rightSE)}return t}}]),t}(),fN=function(){function t(e,n){if(YE(this,t),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new uN(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var i=1,r=e.length;i<r;i++){var s=new uN(e[i],this,!1);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.interiorRings.push(s)}this.multiPoly=n}return $E(t,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),e=0,n=this.interiorRings.length;e<n;e++)for(var i=this.interiorRings[e].getSweepEvents(),r=0,s=i.length;r<s;r++)t.push(i[r]);return t}}]),t}(),dN=function(){function t(e,n){if(YE(this,t),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof e[0][0][0]&&(e=[e])}catch(t){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var i=0,r=e.length;i<r;i++){var s=new fN(e[i],this);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.polys.push(s)}this.isSubject=n}return $E(t,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,n=this.polys.length;e<n;e++)for(var i=this.polys[e].getSweepEvents(),r=0,s=i.length;r<s;r++)t.push(i[r]);return t}}]),t}(),pN=function(){function t(e){YE(this,t),this.events=e;for(var n=0,i=e.length;n<i;n++)e[n].segment.ringOut=this;this.poly=null}return $E(t,null,[{key:"factory",value:function(e){for(var n=[],i=0,r=e.length;i<r;i++){var s=e[i];if(s.isInResult()&&!s.ringOut){for(var o=null,a=s.leftSE,l=s.rightSE,h=[a],c=a.point,u=[];o=a,a=l,h.push(a),a.point!==c;)for(;;){var f=a.getAvailableLinkedEvents();if(0===f.length){var d=h[0].point,p=h[h.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(d.x,",")+" ".concat(d.y,"]. Last matching segment found ends at")+" [".concat(p.x,", ").concat(p.y,"]."))}if(1===f.length){l=f[0].otherSE;break}for(var g=null,_=0,y=u.length;_<y;_++)if(u[_].point===a.point){g=_;break}if(null===g){u.push({index:h.length,point:a.point});var m=a.getLeftmostComparator(o);l=f.sort(m)[0].otherSE;break}var x=u.splice(g)[0],v=h.splice(x.index);v.unshift(v[0].otherSE),n.push(new t(v.reverse()))}n.push(new t(h))}}return n}}]),$E(t,[{key:"getGeom",value:function(){for(var t=this.events[0].point,e=[t],n=1,i=this.events.length-1;n<i;n++){var r=this.events[n].point,s=this.events[n+1].point;0!==iN(r,t,s)&&(e.push(r),t=r)}if(1===e.length)return null;var o=e[0],a=e[1];0===iN(o,t,a)&&e.shift(),e.push(e[0]);for(var l=this.isExteriorRing()?1:-1,h=this.isExteriorRing()?0:e.length-1,c=this.isExteriorRing()?e.length:-1,u=[],f=h;f!=c;f+=l)u.push([e[f].x,e[f].y]);return u}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],e=1,n=this.events.length;e<n;e++){var i=this.events[e];lN.compare(t,i)>0&&(t=i)}for(var r=t.segment.prevInResult(),s=r?r.prevInResult():null;;){if(!r)return null;if(!s)return r.ringOut;if(s.ringOut!==r.ringOut)return s.ringOut.enclosingRing()!==r.ringOut?r.ringOut:r.ringOut.enclosingRing();r=s.prevInResult(),s=r?r.prevInResult():null}}}]),t}(),gN=function(){function t(e){YE(this,t),this.exteriorRing=e,e.poly=this,this.interiorRings=[]}return $E(t,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(var e=0,n=this.interiorRings.length;e<n;e++){var i=this.interiorRings[e].getGeom();null!==i&&t.push(i)}return t}}]),t}(),_N=function(){function t(e){YE(this,t),this.rings=e,this.polys=this._composePolys(e)}return $E(t,[{key:"getGeom",value:function(){for(var t=[],e=0,n=this.polys.length;e<n;e++){var i=this.polys[e].getGeom();null!==i&&t.push(i)}return t}},{key:"_composePolys",value:function(t){for(var e=[],n=0,i=t.length;n<i;n++){var r=t[n];if(!r.poly)if(r.isExteriorRing())e.push(new gN(r));else{var s=r.enclosingRing();s.poly||e.push(new gN(s)),s.poly.addInterior(r)}}return e}}]),t}(),yN=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:cN.compare;YE(this,t),this.queue=e,this.tree=new qE(n),this.segments=[]}return $E(t,[{key:"process",value:function(t){var e=t.segment,n=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(e),n;var i=t.isLeft?this.tree.insert(e):this.tree.find(e);if(!i)throw new Error("Unable to find segment #".concat(e.id," ")+"[".concat(e.leftSE.point.x,", ").concat(e.leftSE.point.y,"] -> ")+"[".concat(e.rightSE.point.x,", ").concat(e.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var r=i,s=i,o=void 0,a=void 0;void 0===o;)null===(r=this.tree.prev(r))?o=null:void 0===r.key.consumedBy&&(o=r.key);for(;void 0===a;)null===(s=this.tree.next(s))?a=null:void 0===s.key.consumedBy&&(a=s.key);if(t.isLeft){var l=null;if(o){var h=o.getIntersection(e);if(null!==h&&(e.isAnEndpoint(h)||(l=h),!o.isAnEndpoint(h)))for(var c=this._splitSafely(o,h),u=0,f=c.length;u<f;u++)n.push(c[u])}var d=null;if(a){var p=a.getIntersection(e);if(null!==p&&(e.isAnEndpoint(p)||(d=p),!a.isAnEndpoint(p)))for(var g=this._splitSafely(a,p),_=0,y=g.length;_<y;_++)n.push(g[_])}if(null!==l||null!==d){var m=null;if(null===l)m=d;else if(null===d)m=l;else{m=lN.comparePoints(l,d)<=0?l:d}this.queue.remove(e.rightSE),n.push(e.rightSE);for(var x=e.split(m),v=0,b=x.length;v<b;v++)n.push(x[v])}n.length>0?(this.tree.remove(e),n.push(t)):(this.segments.push(e),e.prev=o)}else{if(o&&a){var M=o.getIntersection(a);if(null!==M){if(!o.isAnEndpoint(M))for(var w=this._splitSafely(o,M),E=0,N=w.length;E<N;E++)n.push(w[E]);if(!a.isAnEndpoint(M))for(var S=this._splitSafely(a,M),I=0,k=S.length;I<k;I++)n.push(S[I])}}this.tree.remove(e)}return n}},{key:"_splitSafely",value:function(t,e){this.tree.remove(t);var n=t.rightSE;this.queue.remove(n);var i=t.split(e);return i.push(n),void 0===t.consumedBy&&this.tree.insert(t),i}}]),t}(),mN="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,xN="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,vN=new(function(){function t(){YE(this,t)}return $E(t,[{key:"run",value:function(t,e,n){vN.type=t,tN.reset();for(var i=[new dN(e,!0)],r=0,s=n.length;r<s;r++)i.push(new dN(n[r],!1));if(vN.numMultiPolys=i.length,"difference"===vN.type)for(var o=i[0],a=1;a<i.length;)null!==VE(i[a].bbox,o.bbox)?a++:i.splice(a,1);if("intersection"===vN.type)for(var l=0,h=i.length;l<h;l++)for(var c=i[l],u=l+1,f=i.length;u<f;u++)if(null===VE(c.bbox,i[u].bbox))return[];for(var d=new qE(lN.compare),p=0,g=i.length;p<g;p++)for(var _=i[p].getSweepEvents(),y=0,m=_.length;y<m;y++)if(d.insert(_[y]),d.size>mN)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var x=new yN(d),v=d.size,b=d.pop();b;){var M=b.key;if(d.size===v){var w=M.segment;throw new Error("Unable to pop() ".concat(M.isLeft?"left":"right"," SweepEvent ")+"[".concat(M.point.x,", ").concat(M.point.y,"] from segment #").concat(w.id," ")+"[".concat(w.leftSE.point.x,", ").concat(w.leftSE.point.y,"] -> ")+"[".concat(w.rightSE.point.x,", ").concat(w.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(d.size>mN)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(x.segments.length>xN)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var E=x.process(M),N=0,S=E.length;N<S;N++){var I=E[N];void 0===I.consumedBy&&d.insert(I)}v=d.size,b=d.pop()}tN.reset();var k=pN.factory(x.segments);return new _N(k).getGeom()}}]),t}()),bN={union:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return vN.run("union",t,n)},intersection:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return vN.run("intersection",t,n)},xor:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return vN.run("xor",t,n)},difference:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return vN.run("difference",t,n)}},MN=bN;const wN=Object.assign({},{booleanPointInPolygon:TE,intersect:function(t,e,n){void 0===n&&(n={});var i=CE(t),r=CE(e),s=MN.intersection(i.coordinates,r.coordinates);return 0===s.length?null:1===s.length?function(t,e,n){void 0===n&&(n={});for(var i=0,r=t;i<r.length;i++){var s=r[i];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var o=0;o<s[s.length-1].length;o++)if(s[s.length-1][o]!==s[0][o])throw new Error("First and last Position are not equivalent.")}return OE({type:"Polygon",coordinates:t},e,n)}(s[0],n.properties):function(t,e,n){return void 0===n&&(n={}),OE({type:"MultiPolygon",coordinates:t},e,n)}(s,n.properties)}}),EN=Object.assign({},{geoProject:lc,range:gt,rollup:z,ascending:e,blur2:f,sum:xt,flatGroup:D,geoPath:vr});function NN({geojson:t,values:e=null,projection:n,width:i,height:r,step:s=20,output:o="dots",blur:a=0}={}){let l=EN.range(0+s/2,i,s),h=EN.range(0+s/2,r,s).reverse();const c=l.length,u=h.length;let f,d=l.map(((t,e)=>h.map((e=>[t,e])))).flat(),p=l.map(((t,e)=>h.map((e=>[[t-s/2,e-s/2],[t+s/2,e-s/2],[t+s/2,e+s/2],[t-s/2,e+s/2],[t-s/2,e-s/2]])))).flat(),g=!1;if(null===e||Array.isArray(e)?null!==e&&Array.isArray(e)&&1==e.length?f=new Map(t.features.map(((t,n)=>[n,+t.properties[e[0]]]))):null!==e&&Array.isArray(e)&&2==e.length?(g=!0,f=[new Map(t.features.map(((t,n)=>[n,+t.properties[e[0]]]))),new Map(t.features.map(((t,n)=>[n,+t.properties[e[1]]])))]):f=new Map(t.features.map(((t,e)=>[e,1]))):f=new Map(t.features.map(((t,n)=>[n,+t.properties[e]]))),"p"==mE(t)){let e=EN.geoProject(t,n);e=e.features.map(((t,e)=>[e,t.geometry.coordinates]));let i=[];p.forEach((t=>{let n=[],r=[],s=[];e.forEach((e=>{wN.booleanPointInPolygon({type:"Point",coordinates:e[1]},{type:"Polygon",coordinates:[t]})&&(g?(r.push(f[0].get(e[0])),s.push(f[1].get(e[0]))):n.push(f.get(e[0])))})),g?i.push(EN.sum(r)/EN.sum(s)):i.push(EN.sum(n))}));const r=EN.blur2({data:i.map((t=>void 0===t?0:t)),width:u,height:c},a).data;let s=[];"dots"!=o&&"dot"!=o||d.forEach(((t,e)=>{s.push({type:"Feature",properties:{id:e,value:r[e]},geometry:{type:"Point",coordinates:t}})})),"squares"!=o&&"square"!=o||p.forEach(((t,e)=>{s.push({type:"Feature",properties:{id:e,value:r[e]},geometry:{type:"Polygon",coordinates:[t]}})}));let l={type:"FeatureCollection",features:s.filter((t=>t.properties.value>0)).sort(((t,e)=>EN.ascending(t.properties.value,e.properties.value)))};return l}if("z"==mE(t)){const e=EN.geoProject(t,n),i=e.features.map((t=>EN.geoPath().area(t)));let r=[];p.forEach(((t,n)=>{e.features.forEach(((e,s)=>{let o=wN.intersect(e,{type:"Polygon",coordinates:[t]});if(null!==o){let t=EN.geoPath().area(o),e=i[s];r.push({id_square:n,id_poly:s,area_piece:t,area_poly:e,share:t/e,feature:o})}}))}));let s=EN.flatGroup(r,(t=>t.id_square)),l=[];g?s.forEach((t=>{l.push([t[0],EN.sum(t[1].map((t=>t.share*f[0].get(t.id_poly))))/EN.sum(t[1].map((t=>t.share*f[1].get(t.id_poly))))])})):s.forEach((t=>{l.push([t[0],EN.sum(t[1].map((t=>t.share*f.get(t.id_poly))))])}));let h=new Map(l),_=d.map(((t,e)=>h.get(e))).map((t=>void 0===t?0:t));const y=EN.blur2({data:_,width:u,height:c},a).data;let m=[];"dots"!=o&&"dot"!=o||d.forEach(((t,e)=>{m.push({type:"Feature",properties:{id:e,value:y[e]},geometry:{type:"Point",coordinates:t}})})),"squares"!=o&&"square"!=o||p.forEach(((t,e)=>{m.push({type:"Feature",properties:{id:e,value:y[e]},geometry:{type:"Polygon",coordinates:[t]}})}));let x={type:"FeatureCollection",features:m.filter((t=>t.properties.value>0)).sort(((t,e)=>EN.ascending(t.properties.value,e.properties.value)))};return x}}var SN=Array.prototype.slice;function IN(t,e){return t-e}var kN=t=>()=>t;function ON(t,e){for(var n,i=-1,r=e.length;++i<r;)if(n=CN(t,e[i]))return n;return 0}function CN(t,e){for(var n=e[0],i=e[1],r=-1,s=0,o=t.length,a=o-1;s<o;a=s++){var l=t[s],h=l[0],c=l[1],u=t[a],f=u[0],d=u[1];if(TN(l,u,e))return 0;c>i!=d>i&&n<(f-h)*(i-c)/(d-c)+h&&(r=-r)}return r}function TN(t,e,n){var i,r,s,o;return function(t,e,n){return(e[0]-t[0])*(n[1]-t[1])==(n[0]-t[0])*(e[1]-t[1])}(t,e,n)&&(r=t[i=+(t[0]===e[0])],s=n[i],o=e[i],r<=s&&s<=o||o<=s&&s<=r)}function RN(){}var AN=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function LN(){var t=1,e=1,n=et,i=a;function r(t){var e=n(t);if(Array.isArray(e))e=e.slice().sort(IN);else{const n=E(t),i=K(n[0],n[1],e);e=J(Math.floor(n[0]/i)*i,Math.floor(n[1]/i-1)*i,e)}return e.map((e=>s(t,e)))}function s(n,r){var s=[],a=[];return function(n,i,r){var s,a,l,h,c,u,f=new Array,d=new Array;s=a=-1,h=n[0]>=i,AN[h<<1].forEach(p);for(;++s<t-1;)l=h,h=n[s+1]>=i,AN[l|h<<1].forEach(p);AN[h<<0].forEach(p);for(;++a<e-1;){for(s=-1,h=n[a*t+t]>=i,c=n[a*t]>=i,AN[h<<1|c<<2].forEach(p);++s<t-1;)l=h,h=n[a*t+t+s+1]>=i,u=c,c=n[a*t+s+1]>=i,AN[l|h<<1|c<<2|u<<3].forEach(p);AN[h|c<<3].forEach(p)}s=-1,c=n[a*t]>=i,AN[c<<2].forEach(p);for(;++s<t-1;)u=c,c=n[a*t+s+1]>=i,AN[c<<2|u<<3].forEach(p);function p(t){var e,n,i=[t[0][0]+s,t[0][1]+a],l=[t[1][0]+s,t[1][1]+a],h=o(i),c=o(l);(e=d[h])?(n=f[c])?(delete d[e.end],delete f[n.start],e===n?(e.ring.push(l),r(e.ring)):f[e.start]=d[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete d[e.end],e.ring.push(l),d[e.end=c]=e):(e=f[c])?(n=d[h])?(delete f[e.start],delete d[n.end],e===n?(e.ring.push(l),r(e.ring)):f[n.start]=d[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete f[e.start],e.ring.unshift(i),f[e.start=h]=e):f[h]=d[c]={start:h,end:c,ring:[i,l]}}AN[c<<3].forEach(p)}(n,r,(function(t){i(t,n,r),function(t){for(var e=0,n=t.length,i=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];++e<n;)i+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return i}(t)>0?s.push([t]):a.push(t)})),a.forEach((function(t){for(var e,n=0,i=s.length;n<i;++n)if(-1!==ON((e=s[n])[0],t))return void e.push(t)})),{type:"MultiPolygon",value:r,coordinates:s}}function o(e){return 2*e[0]+e[1]*(t+1)*4}function a(n,i,r){n.forEach((function(n){var s,o=n[0],a=n[1],l=0|o,h=0|a,c=i[h*t+l];o>0&&o<t&&l===o&&(s=i[h*t+l-1],n[0]=o+(r-s)/(c-s)-.5),a>0&&a<e&&h===a&&(s=i[(h-1)*t+l],n[1]=a+(r-s)/(c-s)-.5)}))}return r.contour=s,r.size=function(n){if(!arguments.length)return[t,e];var i=Math.floor(n[0]),s=Math.floor(n[1]);if(!(i>=0&&s>=0))throw new Error("invalid size");return t=i,e=s,r},r.thresholds=function(t){return arguments.length?(n="function"==typeof t?t:Array.isArray(t)?kN(SN.call(t)):kN(t),r):n},r.smooth=function(t){return arguments.length?(i=t?a:RN,r):i===a},r}function PN(t){return t[0]}function DN(t){return t[1]}function zN(){return 1}const FN=Object.assign({},rE,{sum:xt,contourDensity:function(){var t=PN,e=DN,n=zN,i=960,r=500,s=20,o=2,a=3*s,l=i+2*a>>o,h=r+2*a>>o,c=kN(20);function u(i){var r=new Float32Array(l*h),c=Math.pow(2,-o),u=-1;for(const s of i){var d=(t(s,++u,i)+a)*c,p=(e(s,u,i)+a)*c,g=+n(s,u,i);if(d>=0&&d<l&&p>=0&&p<h){var _=Math.floor(d),y=Math.floor(p),m=d-_-.5,x=p-y-.5;r[_+y*l]+=(1-m)*(1-x)*g,r[_+1+y*l]+=m*(1-x)*g,r[_+1+(y+1)*l]+=m*x*g,r[_+(y+1)*l]+=(1-m)*x*g}}return f({data:r,width:l,height:h},s*c),r}function d(t){var e=u(t),n=c(e),i=Math.pow(2,2*o);return Array.isArray(n)||(n=J(Number.MIN_VALUE,it(e)/i,n)),LN().size([l,h]).thresholds(n.map((t=>t*i)))(e).map(((t,e)=>(t.value=+n[e],p(t))))}function p(t){return t.coordinates.forEach(g),t}function g(t){t.forEach(_)}function _(t){t.forEach(y)}function y(t){t[0]=t[0]*Math.pow(2,o)-a,t[1]=t[1]*Math.pow(2,o)-a}function m(){return l=i+2*(a=3*s)>>o,h=r+2*a>>o,d}return d.contours=function(t){var e=u(t),n=LN().size([l,h]),i=Math.pow(2,2*o),r=t=>{t=+t;var r=p(n.contour(e,t*i));return r.value=t,r};return Object.defineProperty(r,"max",{get:()=>it(e)/i}),r},d.x=function(e){return arguments.length?(t="function"==typeof e?e:kN(+e),d):t},d.y=function(t){return arguments.length?(e="function"==typeof t?t:kN(+t),d):e},d.weight=function(t){return arguments.length?(n="function"==typeof t?t:kN(+t),d):n},d.size=function(t){if(!arguments.length)return[i,r];var e=+t[0],n=+t[1];if(!(e>=0&&n>=0))throw new Error("invalid size");return i=e,r=n,m()},d.cellSize=function(t){if(!arguments.length)return 1<<o;if(!((t=+t)>=1))throw new Error("invalid cell size");return o=Math.floor(Math.log(t)/Math.LN2),m()},d.thresholds=function(t){return arguments.length?(c="function"==typeof t?t:Array.isArray(t)?kN(SN.call(t)):kN(t),d):c},d.bandwidth=function(t){if(!arguments.length)return Math.sqrt(s*(s+1));if(!((t=+t)>=0))throw new Error("invalid bandwidth");return s=(Math.sqrt(4*t*t+1)-1)/2,m()},d},geoIdentity:ss,geoPath:vr,scaleSequentialQuantile:NM});function GN(t={}){let e=t.geojson,n=t.values,i=t.nb?t.nb:1e3,r=t.projection,s=[];if(null==n)e.features.forEach((t=>{s.push(r(t.geometry.coordinates))}));else{let t,o=1;t=FN.sum(e.features.map((t=>t.properties[n]))),t>i&&(o=t/i),console.log(n),e.features.forEach((t=>{let e=r(t.geometry.coordinates),i=Math.round(t.properties[n]/o);for(let t=0;t<=i;t++)s.push(e)}))}return s}const qN=Object.assign({},{descending:n,max:it,scaleSqrt:Wx,select:Io,pointer:Ao});const jN=Object.assign({},{geoPath:vr});function BN(t,e){return t.interfaces_&&t.interfaces_.indexOf(e)>-1}class UN{constructor(t,e){this.low=e||0,this.high=t||0}static toBinaryString(t){let e,n="";for(e=2147483648;e>0;e>>>=1)n+=(t.high&e)===e?"1":"0";for(e=2147483648;e>0;e>>>=1)n+=(t.low&e)===e?"1":"0";return n}}function YN(){}function WN(){}YN.NaN=NaN,YN.isNaN=t=>Number.isNaN(t),YN.isInfinite=t=>!Number.isFinite(t),YN.MAX_VALUE=Number.MAX_VALUE,YN.POSITIVE_INFINITY=Number.POSITIVE_INFINITY,YN.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,"function"==typeof Float64Array&&"function"==typeof Int32Array?function(){const t=2146435072,e=new Float64Array(1),n=new Int32Array(e.buffer);YN.doubleToLongBits=function(i){e[0]=i;let r=0|n[0],s=0|n[1];return(s&t)===t&&0!=(1048575&s)&&0!==r&&(r=0,s=2146959360),new UN(s,r)},YN.longBitsToDouble=function(t){return n[0]=t.low,n[1]=t.high,e[0]}}():function(){const t=1023,e=Math.log2,n=Math.floor,i=Math.pow,r=function(){for(let t=53;t>0;t--){const r=i(2,t)-1;if(n(e(r))+1===t)return r}return 0}();YN.doubleToLongBits=function(s){let o,a,l,h,c,u,f,d,p;if(s<0||1/s===Number.NEGATIVE_INFINITY?(u=1<<31,s=-s):u=0,0===s)return p=0,d=u,new UN(d,p);if(s===1/0)return p=0,d=2146435072|u,new UN(d,p);if(s!=s)return p=0,d=2146959360,new UN(d,p);if(h=0,p=0,o=n(s),o>1)if(o<=r)h=n(e(o)),h<=20?(p=0,d=o<<20-h&1048575):(l=h-20,a=i(2,l),p=o%a<<32-l,d=o/a&1048575);else for(l=o,p=0;a=l/2,l=n(a),0!==l;)h++,p>>>=1,p|=(1&d)<<31,d>>>=1,a!==l&&(d|=524288);if(f=h+t,c=0===o,o=s-o,h<52&&0!==o)for(l=0;;){if(a=2*o,a>=1?(o=a-1,c?(f--,c=!1):(l<<=1,l|=1,h++)):(o=a,c?0==--f&&(h++,c=!1):(l<<=1,h++)),20===h)d|=l,l=0;else if(52===h){p|=l;break}if(1===a){h<20?d|=l<<20-h:h<52&&(p|=l<<52-h);break}}return d|=f<<20,d|=u,new UN(d,p)},YN.longBitsToDouble=function(e){let n,r,s,o;const a=e.high,l=e.low,h=a&1<<31?-1:1;for(s=((2146435072&a)>>20)-t,o=0,r=1<<19,n=1;n<=20;n++)a&r&&(o+=i(2,-n)),r>>>=1;for(r=1<<31,n=21;n<=52;n++)l&r&&(o+=i(2,-n)),r>>>=1;if(-1023===s){if(0===o)return 0*h;s=-1022}else{if(1024===s)return 0===o?h/0:NaN;o+=1}return h*o*i(2,s)}}();class $N{getM(t){if(this.hasM()){const e=this.getDimension()-this.getMeasures();return this.getOrdinate(t,e)}return YN.NaN}setOrdinate(t,e,n){}getZ(t){return this.hasZ()?this.getOrdinate(t,2):YN.NaN}size(){}getOrdinate(t,e){}getCoordinate(){}getCoordinateCopy(t){}createCoordinate(){}getDimension(){}hasM(){return this.getMeasures()>0}getX(t){}hasZ(){return this.getDimension()-this.getMeasures()>2}getMeasures(){return 0}expandEnvelope(t){}copy(){}getY(t){}toCoordinateArray(){}get interfaces_(){return[WN]}}$N.X=0,$N.Y=1,$N.Z=2,$N.M=3;class XN{create(){if(1===arguments.length)arguments[0]instanceof Array||BN(arguments[0],$N);else if(2===arguments.length);else if(3===arguments.length){const t=arguments[0],e=arguments[1];return this.create(t,e)}}}class VN extends Error{constructor(t){super(t),this.name=Object.keys({Exception:VN})[0]}toString(){return this.message}}class HN extends VN{constructor(t){super(t),this.name=Object.keys({IllegalArgumentException:HN})[0]}}class ZN{filter(t){}}function JN(){}function QN(){}class KN{static equalsWithTolerance(t,e,n){return Math.abs(t-e)<=n}}function tS(){}class eS extends VN{constructor(t){super(t),this.name=Object.keys({RuntimeException:eS})[0]}}class nS extends eS{constructor(){super(),nS.constructor_.apply(this,arguments)}static constructor_(){if(0===arguments.length)eS.constructor_.call(this);else if(1===arguments.length){const t=arguments[0];eS.constructor_.call(this,t)}}}class iS{static shouldNeverReachHere(){if(0===arguments.length)iS.shouldNeverReachHere(null);else if(1===arguments.length){const t=arguments[0];throw new nS("Should never reach here"+(null!==t?": "+t:""))}}static isTrue(){if(1===arguments.length){const t=arguments[0];iS.isTrue(t,null)}else if(2===arguments.length){const t=arguments[1];if(!arguments[0])throw null===t?new nS:new nS(t)}}static equals(){if(2===arguments.length){const t=arguments[0],e=arguments[1];iS.equals(t,e,null)}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];if(!e.equals(t))throw new nS("Expected "+t+" but encountered "+e+(null!==n?": "+n:""))}}}const rS=new ArrayBuffer(8),sS=new Float64Array(rS),oS=new Int32Array(rS);class aS{constructor(){aS.constructor_.apply(this,arguments)}static constructor_(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)aS.constructor_.call(this,0,0);else if(1===arguments.length){const t=arguments[0];aS.constructor_.call(this,t.x,t.y,t.getZ())}else if(2===arguments.length){const t=arguments[0],e=arguments[1];aS.constructor_.call(this,t,e,aS.NULL_ORDINATE)}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this.x=t,this.y=e,this.z=n}}static hashCode(t){return sS[0]=t,oS[0]^oS[1]}getM(){return YN.NaN}setOrdinate(t,e){switch(t){case aS.X:this.x=e;break;case aS.Y:this.y=e;break;case aS.Z:this.setZ(e);break;default:throw new HN("Invalid ordinate index: "+t)}}equals2D(){if(1===arguments.length){const t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){const t=arguments[0],e=arguments[1];return!!KN.equalsWithTolerance(this.x,t.x,e)&&!!KN.equalsWithTolerance(this.y,t.y,e)}}setM(t){throw new HN("Invalid ordinate index: "+aS.M)}getZ(){return this.z}getOrdinate(t){switch(t){case aS.X:return this.x;case aS.Y:return this.y;case aS.Z:return this.getZ()}throw new HN("Invalid ordinate index: "+t)}equals3D(t){return this.x===t.x&&this.y===t.y&&(this.getZ()===t.getZ()||YN.isNaN(this.getZ())&&YN.isNaN(t.getZ()))}equals(t){return t instanceof aS&&this.equals2D(t)}equalInZ(t,e){return KN.equalsWithTolerance(this.getZ(),t.getZ(),e)}setX(t){this.x=t}compareTo(t){const e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0}getX(){return this.x}setZ(t){this.z=t}clone(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return iS.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw t}}copy(){return new aS(this)}toString(){return"("+this.x+", "+this.y+", "+this.getZ()+")"}distance3D(t){const e=this.x-t.x,n=this.y-t.y,i=this.getZ()-t.getZ();return Math.sqrt(e*e+n*n+i*i)}getY(){return this.y}setY(t){this.y=t}distance(t){const e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)}hashCode(){let t=17;return t=37*t+aS.hashCode(this.x),t=37*t+aS.hashCode(this.y),t}setCoordinate(t){this.x=t.x,this.y=t.y,this.z=t.getZ()}get interfaces_(){return[JN,WN,QN]}}class lS{constructor(){lS.constructor_.apply(this,arguments)}static constructor_(){if(this._dimensionsToTest=2,0===arguments.length)lS.constructor_.call(this,2);else if(1===arguments.length){const t=arguments[0];if(2!==t&&3!==t)throw new HN("only 2 or 3 dimensions may be specified");this._dimensionsToTest=t}}static compare(t,e){return t<e?-1:t>e?1:YN.isNaN(t)?YN.isNaN(e)?0:-1:YN.isNaN(e)?1:0}compare(t,e){const n=lS.compare(t.x,e.x);if(0!==n)return n;const i=lS.compare(t.y,e.y);if(0!==i)return i;if(this._dimensionsToTest<=2)return 0;return lS.compare(t.getZ(),e.getZ())}get interfaces_(){return[tS]}}aS.DimensionalComparator=lS,aS.NULL_ORDINATE=YN.NaN,aS.X=0,aS.Y=1,aS.Z=2,aS.M=3;class hS{constructor(){hS.constructor_.apply(this,arguments)}static constructor_(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof aS){const t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof hS){const t=arguments[0];this.init(t)}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.init(t.x,e.x,t.y,e.y)}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.init(t,e,n,i)}}static intersects(){if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];return n.x>=(t.x<e.x?t.x:e.x)&&n.x<=(t.x>e.x?t.x:e.x)&&n.y>=(t.y<e.y?t.y:e.y)&&n.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];let r=Math.min(n.x,i.x),s=Math.max(n.x,i.x),o=Math.min(t.x,e.x),a=Math.max(t.x,e.x);return!(o>s)&&(!(a<r)&&(r=Math.min(n.y,i.y),s=Math.max(n.y,i.y),o=Math.min(t.y,e.y),a=Math.max(t.y,e.y),!(o>s)&&!(a<r)))}}getArea(){return this.getWidth()*this.getHeight()}equals(t){if(!(t instanceof hS))return!1;const e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()}intersection(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new hS;const e=this._minx>t._minx?this._minx:t._minx,n=this._miny>t._miny?this._miny:t._miny,i=this._maxx<t._maxx?this._maxx:t._maxx,r=this._maxy<t._maxy?this._maxy:t._maxy;return new hS(e,i,n,r)}isNull(){return this._maxx<this._minx}getMaxX(){return this._maxx}covers(){if(1===arguments.length){if(arguments[0]instanceof aS){const t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof hS){const t=arguments[0];return!this.isNull()&&!t.isNull()&&(t.getMinX()>=this._minx&&t.getMaxX()<=this._maxx&&t.getMinY()>=this._miny&&t.getMaxY()<=this._maxy)}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];return!this.isNull()&&(t>=this._minx&&t<=this._maxx&&e>=this._miny&&e<=this._maxy)}}intersects(){if(1===arguments.length){if(arguments[0]instanceof hS){const t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof aS){const t=arguments[0];return this.intersects(t.x,t.y)}}else if(2===arguments.length){if(arguments[0]instanceof aS&&arguments[1]instanceof aS){const t=arguments[0],e=arguments[1];if(this.isNull())return!1;if((t.x<e.x?t.x:e.x)>this._maxx)return!1;if((t.x>e.x?t.x:e.x)<this._minx)return!1;if((t.y<e.y?t.y:e.y)>this._maxy)return!1;return!((t.y>e.y?t.y:e.y)<this._miny)}if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1];return!this.isNull()&&!(t>this._maxx||t<this._minx||e>this._maxy||e<this._miny)}}}getMinY(){return this._miny}getDiameter(){if(this.isNull())return 0;const t=this.getWidth(),e=this.getHeight();return Math.sqrt(t*t+e*e)}getMinX(){return this._minx}expandToInclude(){if(1===arguments.length){if(arguments[0]instanceof aS){const t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof hS){const t=arguments[0];if(t.isNull())return null;this.isNull()?(this._minx=t.getMinX(),this._maxx=t.getMaxX(),this._miny=t.getMinY(),this._maxy=t.getMaxY()):(t._minx<this._minx&&(this._minx=t._minx),t._maxx>this._maxx&&(this._maxx=t._maxx),t._miny<this._miny&&(this._miny=t._miny),t._maxy>this._maxy&&(this._maxy=t._maxy))}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.isNull()?(this._minx=t,this._maxx=t,this._miny=e,this._maxy=e):(t<this._minx&&(this._minx=t),t>this._maxx&&(this._maxx=t),e<this._miny&&(this._miny=e),e>this._maxy&&(this._maxy=e))}}minExtent(){if(this.isNull())return 0;const t=this.getWidth(),e=this.getHeight();return t<e?t:e}getWidth(){return this.isNull()?0:this._maxx-this._minx}compareTo(t){const e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0}translate(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)}copy(){return new hS(this)}toString(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}setToNull(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}disjoint(t){return!(!this.isNull()&&!t.isNull())||(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}getHeight(){return this.isNull()?0:this._maxy-this._miny}maxExtent(){if(this.isNull())return 0;const t=this.getWidth(),e=this.getHeight();return t>e?t:e}expandBy(){if(1===arguments.length){const t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];if(this.isNull())return null;this._minx-=t,this._maxx+=t,this._miny-=e,this._maxy+=e,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}contains(){if(1===arguments.length){if(arguments[0]instanceof hS){const t=arguments[0];return this.covers(t)}if(arguments[0]instanceof aS){const t=arguments[0];return this.covers(t)}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];return this.covers(t,e)}}centre(){return this.isNull()?null:new aS((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}init(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof aS){const t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof hS){const t=arguments[0];this._minx=t._minx,this._maxx=t._maxx,this._miny=t._miny,this._maxy=t._maxy}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.init(t.x,e.x,t.y,e.y)}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];t<e?(this._minx=t,this._maxx=e):(this._minx=e,this._maxx=t),n<i?(this._miny=n,this._maxy=i):(this._miny=i,this._maxy=n)}}getMaxY(){return this._maxy}distance(t){if(this.intersects(t))return 0;let e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);let n=0;return this._maxy<t._miny?n=t._miny-this._maxy:this._miny>t._maxy&&(n=this._miny-t._maxy),0===e?n:0===n?e:Math.sqrt(e*e+n*n)}hashCode(){let t=17;return t=37*t+aS.hashCode(this._minx),t=37*t+aS.hashCode(this._maxx),t=37*t+aS.hashCode(this._miny),t=37*t+aS.hashCode(this._maxy),t}get interfaces_(){return[JN,QN]}}class cS{constructor(){cS.constructor_.apply(this,arguments)}isGeometryCollection(){return this.getTypeCode()===cS.TYPECODE_GEOMETRYCOLLECTION}getFactory(){return this._factory}getGeometryN(t){return this}getArea(){return 0}isRectangle(){return!1}equalsExact(t){return this===t||this.equalsExact(t,0)}geometryChanged(){this.apply(cS.geometryChangedFilter)}geometryChangedAction(){this._envelope=null}equalsNorm(t){return null!==t&&this.norm().equalsExact(t.norm())}getLength(){return 0}getNumGeometries(){return 1}compareTo(){let t;if(1===arguments.length){const e=arguments[0];return t=e,this.getTypeCode()!==t.getTypeCode()?this.getTypeCode()-t.getTypeCode():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(e)}if(2===arguments.length){const e=arguments[0],n=arguments[1];return t=e,this.getTypeCode()!==t.getTypeCode()?this.getTypeCode()-t.getTypeCode():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(e,n)}}getUserData(){return this._userData}getSRID(){return this._SRID}getEnvelope(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}checkNotGeometryCollection(t){if(t.getTypeCode()===cS.TYPECODE_GEOMETRYCOLLECTION)throw new HN("This method does not support GeometryCollection arguments")}equal(t,e,n){return 0===n?t.equals(e):t.distance(e)<=n}norm(){const t=this.copy();return t.normalize(),t}reverse(){const t=this.reverseInternal();return null!=this.envelope&&(t.envelope=this.envelope.copy()),t.setSRID(this.getSRID()),t}copy(){const t=this.copyInternal();return t.envelope=null==this._envelope?null:this._envelope.copy(),t._SRID=this._SRID,t._userData=this._userData,t}getPrecisionModel(){return this._factory.getPrecisionModel()}getEnvelopeInternal(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new hS(this._envelope)}setSRID(t){this._SRID=t}setUserData(t){this._userData=t}compare(t,e){const n=t.iterator(),i=e.iterator();for(;n.hasNext()&&i.hasNext();){const t=n.next(),e=i.next(),r=t.compareTo(e);if(0!==r)return r}return n.hasNext()?1:i.hasNext()?-1:0}hashCode(){return this.getEnvelopeInternal().hashCode()}isEquivalentClass(t){return this.getClass()===t.getClass()}isGeometryCollectionOrDerived(){return this.getTypeCode()===cS.TYPECODE_GEOMETRYCOLLECTION||this.getTypeCode()===cS.TYPECODE_MULTIPOINT||this.getTypeCode()===cS.TYPECODE_MULTILINESTRING||this.getTypeCode()===cS.TYPECODE_MULTIPOLYGON}get interfaces_(){return[WN,JN,QN]}getClass(){return cS}static hasNonEmptyElements(t){for(let e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1}static hasNullElements(t){for(let e=0;e<t.length;e++)if(null===t[e])return!0;return!1}}cS.constructor_=function(t){t&&(this._envelope=null,this._userData=null,this._factory=t,this._SRID=t.getSRID())},cS.TYPECODE_POINT=0,cS.TYPECODE_MULTIPOINT=1,cS.TYPECODE_LINESTRING=2,cS.TYPECODE_LINEARRING=3,cS.TYPECODE_MULTILINESTRING=4,cS.TYPECODE_POLYGON=5,cS.TYPECODE_MULTIPOLYGON=6,cS.TYPECODE_GEOMETRYCOLLECTION=7,cS.TYPENAME_POINT="Point",cS.TYPENAME_MULTIPOINT="MultiPoint",cS.TYPENAME_LINESTRING="LineString",cS.TYPENAME_LINEARRING="LinearRing",cS.TYPENAME_MULTILINESTRING="MultiLineString",cS.TYPENAME_POLYGON="Polygon",cS.TYPENAME_MULTIPOLYGON="MultiPolygon",cS.TYPENAME_GEOMETRYCOLLECTION="GeometryCollection",cS.geometryChangedFilter={get interfaces_(){return[ZN]},filter(t){t.geometryChangedAction()}};class uS{filter(t){}}class fS{static ofLine(t){const e=t.size();if(e<=1)return 0;let n=0;const i=new aS;t.getCoordinate(0,i);let r=i.x,s=i.y;for(let o=1;o<e;o++){t.getCoordinate(o,i);const e=i.x,a=i.y,l=e-r,h=a-s;n+=Math.sqrt(l*l+h*h),r=e,s=a}return n}}class dS{}class pS{static copyCoord(t,e,n,i){const r=Math.min(t.getDimension(),n.getDimension());for(let s=0;s<r;s++)n.setOrdinate(i,s,t.getOrdinate(e,s))}static isRing(t){const e=t.size();return 0===e||!(e<=3)&&(t.getOrdinate(0,$N.X)===t.getOrdinate(e-1,$N.X)&&t.getOrdinate(0,$N.Y)===t.getOrdinate(e-1,$N.Y))}static scroll(){if(2===arguments.length){if(BN(arguments[0],$N)&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1];pS.scroll(t,e,pS.isRing(t))}else if(BN(arguments[0],$N)&&arguments[1]instanceof aS){const t=arguments[0],e=arguments[1],n=pS.indexOf(e,t);if(n<=0)return null;pS.scroll(t,n)}}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];if(e<=0)return null;const i=t.copy(),r=n?t.size()-1:t.size();for(let n=0;n<r;n++)for(let s=0;s<t.getDimension();s++)t.setOrdinate(n,s,i.getOrdinate((e+n)%r,s));if(n)for(let e=0;e<t.getDimension();e++)t.setOrdinate(r,e,t.getOrdinate(0,e))}}static isEqual(t,e){const n=t.size();if(n!==e.size())return!1;const i=Math.min(t.getDimension(),e.getDimension());for(let r=0;r<n;r++)for(let n=0;n<i;n++){const i=t.getOrdinate(r,n),s=e.getOrdinate(r,n);if(t.getOrdinate(r,n)!==e.getOrdinate(r,n)&&(!YN.isNaN(i)||!YN.isNaN(s)))return!1}return!0}static minCoordinateIndex(){if(1===arguments.length){const t=arguments[0];return pS.minCoordinateIndex(t,0,t.size()-1)}if(3===arguments.length){const t=arguments[0],e=arguments[2];let n=-1,i=null;for(let r=arguments[1];r<=e;r++){const e=t.getCoordinate(r);(null===i||i.compareTo(e)>0)&&(i=e,n=r)}return n}}static extend(t,e,n){const i=t.create(n,e.getDimension()),r=e.size();if(pS.copy(e,0,i,0,r),r>0)for(let t=r;t<n;t++)pS.copy(e,r-1,i,t,1);return i}static reverse(t){const e=t.size()-1,n=Math.trunc(e/2);for(let i=0;i<=n;i++)pS.swap(t,i,e-i)}static swap(t,e,n){if(e===n)return null;for(let i=0;i<t.getDimension();i++){const r=t.getOrdinate(e,i);t.setOrdinate(e,i,t.getOrdinate(n,i)),t.setOrdinate(n,i,r)}}static copy(t,e,n,i,r){for(let s=0;s<r;s++)pS.copyCoord(t,e+s,n,i+s)}static ensureValidRing(t,e){const n=e.size();if(0===n)return e;if(n<=3)return pS.createClosedRing(t,e,4);return e.getOrdinate(0,$N.X)===e.getOrdinate(n-1,$N.X)&&e.getOrdinate(0,$N.Y)===e.getOrdinate(n-1,$N.Y)?e:pS.createClosedRing(t,e,n+1)}static indexOf(t,e){for(let n=0;n<e.size();n++)if(t.x===e.getOrdinate(n,$N.X)&&t.y===e.getOrdinate(n,$N.Y))return n;return-1}static createClosedRing(t,e,n){const i=t.create(n,e.getDimension()),r=e.size();pS.copy(e,0,i,0,r);for(let t=r;t<n;t++)pS.copy(e,0,i,t,1);return i}static minCoordinate(t){let e=null;for(let n=0;n<t.size();n++){const i=t.getCoordinate(n);(null===e||e.compareTo(i)>0)&&(e=i)}return e}}class gS extends VN{constructor(t){super(t),this.name=Object.keys({UnsupportedOperationException:gS})[0]}}class _S{static isWhitespace(t){return t<=32&&t>=0||127===t}static toUpperCase(t){return t.toUpperCase()}}class yS{static toDimensionSymbol(t){switch(t){case yS.FALSE:return yS.SYM_FALSE;case yS.TRUE:return yS.SYM_TRUE;case yS.DONTCARE:return yS.SYM_DONTCARE;case yS.P:return yS.SYM_P;case yS.L:return yS.SYM_L;case yS.A:return yS.SYM_A}throw new HN("Unknown dimension value: "+t)}static toDimensionValue(t){switch(_S.toUpperCase(t)){case yS.SYM_FALSE:return yS.FALSE;case yS.SYM_TRUE:return yS.TRUE;case yS.SYM_DONTCARE:return yS.DONTCARE;case yS.SYM_P:return yS.P;case yS.SYM_L:return yS.L;case yS.SYM_A:return yS.A}throw new HN("Unknown dimension symbol: "+t)}}yS.P=0,yS.L=1,yS.A=2,yS.FALSE=-1,yS.TRUE=-2,yS.DONTCARE=-3,yS.SYM_FALSE="F",yS.SYM_TRUE="T",yS.SYM_DONTCARE="*",yS.SYM_P="0",yS.SYM_L="1",yS.SYM_A="2";class mS{filter(t){}}class xS{filter(t,e){}isDone(){}isGeometryChanged(){}}class vS extends cS{constructor(){super(),vS.constructor_.apply(this,arguments)}static constructor_(){if(this._points=null,0===arguments.length);else if(2===arguments.length){const t=arguments[0],e=arguments[1];cS.constructor_.call(this,e),this.init(t)}}computeEnvelopeInternal(){return this.isEmpty()?new hS:this._points.expandEnvelope(new hS)}isRing(){return this.isClosed()&&this.isSimple()}getCoordinates(){return this._points.toCoordinateArray()}copyInternal(){return new vS(this._points.copy(),this._factory)}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof cS){const t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;const n=t;if(this._points.size()!==n._points.size())return!1;for(let t=0;t<this._points.size();t++)if(!this.equal(this._points.getCoordinate(t),n._points.getCoordinate(t),e))return!1;return!0}return super.equalsExact.apply(this,arguments)}normalize(){for(let t=0;t<Math.trunc(this._points.size()/2);t++){const e=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(e))){if(this._points.getCoordinate(t).compareTo(this._points.getCoordinate(e))>0){const t=this._points.copy();pS.reverse(t),this._points=t}return null}}}getCoordinate(){return this.isEmpty()?null:this._points.getCoordinate(0)}getBoundaryDimension(){return this.isClosed()?yS.FALSE:0}isClosed(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}reverseInternal(){const t=this._points.copy();return pS.reverse(t),this.getFactory().createLineString(t)}getEndPoint(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}getTypeCode(){return cS.TYPECODE_LINESTRING}getDimension(){return 1}getLength(){return fS.ofLine(this._points)}getNumPoints(){return this._points.size()}compareToSameClass(){if(1===arguments.length){const t=arguments[0];let e=0,n=0;for(;e<this._points.size()&&n<t._points.size();){const i=this._points.getCoordinate(e).compareTo(t._points.getCoordinate(n));if(0!==i)return i;e++,n++}return e<this._points.size()?1:n<t._points.size()?-1:0}if(2===arguments.length){const t=arguments[0];return arguments[1].compare(this._points,t._points)}}apply(){if(BN(arguments[0],uS)){const t=arguments[0];for(let e=0;e<this._points.size();e++)t.filter(this._points.getCoordinate(e))}else if(BN(arguments[0],xS)){const t=arguments[0];if(0===this._points.size())return null;for(let e=0;e<this._points.size()&&(t.filter(this._points,e),!t.isDone());e++);t.isGeometryChanged()&&this.geometryChanged()}else if(BN(arguments[0],mS)){arguments[0].filter(this)}else if(BN(arguments[0],ZN)){arguments[0].filter(this)}}getBoundary(){throw new gS}isEquivalentClass(t){return t instanceof vS}getCoordinateN(t){return this._points.getCoordinate(t)}getGeometryType(){return cS.TYPENAME_LINESTRING}getCoordinateSequence(){return this._points}isEmpty(){return 0===this._points.size()}init(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new HN("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t}isCoordinate(t){for(let e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1}getStartPoint(){return this.isEmpty()?null:this.getPointN(0)}getPointN(t){return this.getFactory().createPoint(this._points.getCoordinate(t))}get interfaces_(){return[dS]}}class bS{}class MS extends cS{constructor(){super(),MS.constructor_.apply(this,arguments)}static constructor_(){this._coordinates=null;const t=arguments[0],e=arguments[1];cS.constructor_.call(this,e),this.init(t)}computeEnvelopeInternal(){if(this.isEmpty())return new hS;const t=new hS;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t}getCoordinates(){return this.isEmpty()?[]:[this.getCoordinate()]}copyInternal(){return new MS(this._coordinates.copy(),this._factory)}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof cS){const t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&(!(!this.isEmpty()||!t.isEmpty())||this.isEmpty()===t.isEmpty()&&this.equal(t.getCoordinate(),this.getCoordinate(),e))}return super.equalsExact.apply(this,arguments)}normalize(){}getCoordinate(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null}getBoundaryDimension(){return yS.FALSE}reverseInternal(){return this.getFactory().createPoint(this._coordinates.copy())}getTypeCode(){return cS.TYPECODE_POINT}getDimension(){return 0}getNumPoints(){return this.isEmpty()?0:1}getX(){if(null===this.getCoordinate())throw new IllegalStateException("getX called on empty Point");return this.getCoordinate().x}compareToSameClass(){if(1===arguments.length){const t=arguments[0];return this.getCoordinate().compareTo(t.getCoordinate())}if(2===arguments.length){const t=arguments[0];return arguments[1].compare(this._coordinates,t._coordinates)}}apply(){if(BN(arguments[0],uS)){const t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(BN(arguments[0],xS)){const t=arguments[0];if(this.isEmpty())return null;t.filter(this._coordinates,0),t.isGeometryChanged()&&this.geometryChanged()}else if(BN(arguments[0],mS)){arguments[0].filter(this)}else if(BN(arguments[0],ZN)){arguments[0].filter(this)}}getBoundary(){return this.getFactory().createGeometryCollection()}getGeometryType(){return cS.TYPENAME_POINT}getCoordinateSequence(){return this._coordinates}getY(){if(null===this.getCoordinate())throw new IllegalStateException("getY called on empty Point");return this.getCoordinate().y}isEmpty(){return 0===this._coordinates.size()}init(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),iS.isTrue(t.size()<=1),this._coordinates=t}isSimple(){return!0}get interfaces_(){return[bS]}}class wS{static ofRing(){if(arguments[0]instanceof Array){const t=arguments[0];return Math.abs(wS.ofRingSigned(t))}if(BN(arguments[0],$N)){const t=arguments[0];return Math.abs(wS.ofRingSigned(t))}}static ofRingSigned(){if(arguments[0]instanceof Array){const t=arguments[0];if(t.length<3)return 0;let e=0;const n=t[0].x;for(let i=1;i<t.length-1;i++){const r=t[i].x-n,s=t[i+1].y;e+=r*(t[i-1].y-s)}return e/2}if(BN(arguments[0],$N)){const t=arguments[0],e=t.size();if(e<3)return 0;const n=new aS,i=new aS,r=new aS;t.getCoordinate(0,i),t.getCoordinate(1,r);const s=i.x;r.x-=s;let o=0;for(let a=1;a<e-1;a++)n.y=i.y,i.x=r.x,i.y=r.y,t.getCoordinate(a+1,r),r.x-=s,o+=i.x*(n.y-r.y);return o/2}}}class ES{add(){}addAll(){}isEmpty(){}iterator(){}size(){}toArray(){}remove(){}}class NS extends VN{constructor(t){super(t),this.name=Object.keys({IndexOutOfBoundsException:NS})[0]}}class SS extends ES{get(){}set(){}isEmpty(){}}class IS extends VN{constructor(t){super(t),this.name=Object.keys({NoSuchElementException:IS})[0]}}class kS extends SS{constructor(t){super(),this.array=[],t instanceof ES&&this.addAll(t)}get interfaces_(){return[SS,ES]}ensureCapacity(){}add(t){return 1===arguments.length?this.array.push(t):this.array.splice(arguments[0],0,arguments[1]),!0}clear(){this.array=[]}addAll(t){for(const e of t)this.array.push(e)}set(t,e){const n=this.array[t];return this.array[t]=e,n}iterator(){return new OS(this)}get(t){if(t<0||t>=this.size())throw new NS;return this.array[t]}isEmpty(){return 0===this.array.length}sort(t){t?this.array.sort(((e,n)=>t.compare(e,n))):this.array.sort()}size(){return this.array.length}toArray(){return this.array.slice()}remove(t){for(let e=0,n=this.array.length;e<n;e++)if(this.array[e]===t)return!!this.array.splice(e,1);return!1}[Symbol.iterator](){return this.array.values()}}class OS{constructor(t){this.arrayList=t,this.position=0}next(){if(this.position===this.arrayList.size())throw new IS;return this.arrayList.get(this.position++)}hasNext(){return this.position<this.arrayList.size()}set(t){return this.arrayList.set(this.position-1,t)}remove(){this.arrayList.remove(this.arrayList.get(this.position))}}class CS{static sort(){const t=arguments[0];if(1===arguments.length)t.sort(((t,e)=>t.compareTo(e)));else if(2===arguments.length)t.sort(((t,e)=>arguments[1].compare(t,e)));else if(3===arguments.length){const e=t.slice(arguments[1],arguments[2]);e.sort();const n=t.slice(0,arguments[1]).concat(e,t.slice(arguments[2],t.length));t.splice(0,t.length);for(const e of n)t.push(e)}else if(4===arguments.length){const e=t.slice(arguments[1],arguments[2]);e.sort(((t,e)=>arguments[3].compare(t,e)));const n=t.slice(0,arguments[1]).concat(e,t.slice(arguments[2],t.length));t.splice(0,t.length);for(const e of n)t.push(e)}}static asList(t){const e=new kS;for(const n of t)e.add(n);return e}static copyOf(t,e){return t.slice(0,e)}}class TS{constructor(t){this.str=t}append(t){this.str+=t}setCharAt(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)}toString(){return this.str}}class RS{constructor(t){this.value=t}intValue(){return this.value}compareTo(t){return this.value<t?-1:this.value>t?1:0}static compare(t,e){return t<e?-1:t>e?1:0}static isNan(t){return Number.isNaN(t)}static valueOf(t){return new RS(t)}}class AS{constructor(){AS.constructor_.apply(this,arguments)}static constructor_(){if(this._hi=0,this._lo=0,0===arguments.length)this.init(0);else if(1===arguments.length){if("number"==typeof arguments[0]){const t=arguments[0];this.init(t)}else if(arguments[0]instanceof AS){const t=arguments[0];this.init(t)}else if("string"==typeof arguments[0]){const t=arguments[0];AS.constructor_.call(this,AS.parse(t))}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.init(t,e)}}static determinant(){if("number"==typeof arguments[3]&&"number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];return AS.determinant(AS.valueOf(t),AS.valueOf(e),AS.valueOf(n),AS.valueOf(i))}if(arguments[3]instanceof AS&&arguments[2]instanceof AS&&arguments[0]instanceof AS&&arguments[1]instanceof AS){const t=arguments[1],e=arguments[2],n=arguments[3];return arguments[0].multiply(n).selfSubtract(t.multiply(e))}}static sqr(t){return AS.valueOf(t).selfMultiply(t)}static valueOf(){if("string"==typeof arguments[0]){const t=arguments[0];return AS.parse(t)}if("number"==typeof arguments[0]){return new AS(arguments[0])}}static sqrt(t){return AS.valueOf(t).sqrt()}static parse(t){let e=0;const n=t.length;for(;_S.isWhitespace(t.charAt(e));)e++;let i=!1;if(e<n){const n=t.charAt(e);"-"!==n&&"+"!==n||(e++,"-"===n&&(i=!0))}const r=new AS;let s=0,o=0,a=0,l=!1;for(;!(e>=n);){const n=t.charAt(e);if(e++,_S.isDigit(n)){const t=n-"0";r.selfMultiply(AS.TEN),r.selfAdd(t),s++}else{if("."!==n){if("e"===n||"E"===n){const n=t.substring(e);try{a=RS.parseInt(n)}catch(e){throw e instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+n+" in string "+t):e}break}throw new NumberFormatException("Unexpected character '"+n+"' at position "+e+" in string "+t)}o=s,l=!0}}let h=r;l||(o=s);const c=s-o-a;if(0===c)h=r;else if(c>0){const t=AS.TEN.pow(c);h=r.divide(t)}else if(c<0){const t=AS.TEN.pow(-c);h=r.multiply(t)}return i?h.negate():h}static createNaN(){return new AS(YN.NaN,YN.NaN)}static copy(t){return new AS(t)}static magnitude(t){const e=Math.abs(t),n=Math.log(e)/Math.log(10);let i=Math.trunc(Math.floor(n));return 10*Math.pow(10,i)<=e&&(i+=1),i}static stringOfChar(t,e){const n=new TS;for(let i=0;i<e;i++)n.append(t);return n.toString()}le(t){return this._hi<t._hi||this._hi===t._hi&&this._lo<=t._lo}extractSignificantDigits(t,e){let n=this.abs(),i=AS.magnitude(n._hi);const r=AS.TEN.pow(i);n=n.divide(r),n.gt(AS.TEN)?(n=n.divide(AS.TEN),i+=1):n.lt(AS.ONE)&&(n=n.multiply(AS.TEN),i-=1);const s=i+1,o=new TS,a=AS.MAX_PRINT_DIGITS-1;for(let e=0;e<=a;e++){t&&e===s&&o.append(".");const i=Math.trunc(n._hi);if(i<0)break;let r=!1,l=0;i>9?(r=!0,l="9"):l="0"+i,o.append(l),n=n.subtract(AS.valueOf(i)).multiply(AS.TEN),r&&n.selfAdd(AS.TEN);let h=!0;const c=AS.magnitude(n._hi);if(c<0&&Math.abs(c)>=a-e&&(h=!1),!h)break}return e[0]=i,o.toString()}sqr(){return this.multiply(this)}doubleValue(){return this._hi+this._lo}subtract(){if(arguments[0]instanceof AS){const t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){const t=arguments[0];return this.add(-t)}}equals(){if(1===arguments.length&&arguments[0]instanceof AS){const t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}}isZero(){return 0===this._hi&&0===this._lo}selfSubtract(){if(arguments[0]instanceof AS){const t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if("number"==typeof arguments[0]){const t=arguments[0];return this.isNaN()?this:this.selfAdd(-t,0)}}getSpecialNumberString(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}min(t){return this.le(t)?this:t}selfDivide(){if(1===arguments.length){if(arguments[0]instanceof AS){const t=arguments[0];return this.selfDivide(t._hi,t._lo)}if("number"==typeof arguments[0]){const t=arguments[0];return this.selfDivide(t,0)}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];let n=null,i=null,r=null,s=null,o=null,a=null,l=null,h=null;return o=this._hi/t,a=AS.SPLIT*o,n=a-o,h=AS.SPLIT*t,n=a-n,i=o-n,r=h-t,l=o*t,r=h-r,s=t-r,h=n*r-l+n*s+i*r+i*s,a=(this._hi-l-h+this._lo-o*e)/t,h=o+a,this._hi=h,this._lo=o-h+a,this}}dump(){return"DD<"+this._hi+", "+this._lo+">"}divide(){if(arguments[0]instanceof AS){const t=arguments[0];let e=null,n=null,i=null,r=null,s=null,o=null,a=null,l=null;s=this._hi/t._hi,o=AS.SPLIT*s,e=o-s,l=AS.SPLIT*t._hi,e=o-e,n=s-e,i=l-t._hi,a=s*t._hi,i=l-i,r=t._hi-i,l=e*i-a+e*r+n*i+n*r,o=(this._hi-a-l+this._lo-s*t._lo)/t._hi,l=s+o;return new AS(l,s-l+o)}if("number"==typeof arguments[0]){const t=arguments[0];return YN.isNaN(t)?AS.createNaN():AS.copy(this).selfDivide(t,0)}}ge(t){return this._hi>t._hi||this._hi===t._hi&&this._lo>=t._lo}pow(t){if(0===t)return AS.valueOf(1);let e=new AS(this),n=AS.valueOf(1),i=Math.abs(t);if(i>1)for(;i>0;)i%2==1&&n.selfMultiply(e),i/=2,i>0&&(e=e.sqr());else n=e;return t<0?n.reciprocal():n}ceil(){if(this.isNaN())return AS.NaN;const t=Math.ceil(this._hi);let e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new AS(t,e)}compareTo(t){const e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0}rint(){if(this.isNaN())return this;return this.add(.5).floor()}setValue(){if(arguments[0]instanceof AS){const t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){const t=arguments[0];return this.init(t),this}}max(t){return this.ge(t)?this:t}sqrt(){if(this.isZero())return AS.valueOf(0);if(this.isNegative())return AS.NaN;const t=1/Math.sqrt(this._hi),e=this._hi*t,n=AS.valueOf(e),i=this.subtract(n.sqr())._hi*(.5*t);return n.add(i)}selfAdd(){if(1===arguments.length){if(arguments[0]instanceof AS){const t=arguments[0];return this.selfAdd(t._hi,t._lo)}if("number"==typeof arguments[0]){const t=arguments[0];let e=null,n=null,i=null,r=null,s=null,o=null;return i=this._hi+t,s=i-this._hi,r=i-s,r=t-s+(this._hi-r),o=r+this._lo,e=i+o,n=o+(i-e),this._hi=e+n,this._lo=n+(e-this._hi),this}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];let n=null,i=null,r=null,s=null,o=null,a=null,l=null,h=null;o=this._hi+t,r=this._lo+e,l=o-this._hi,h=r-this._lo,a=o-l,s=r-h,a=t-l+(this._hi-a),s=e-h+(this._lo-s),l=a+r,n=o+l,i=l+(o-n),l=s+i;const c=n+l,u=l+(n-c);return this._hi=c,this._lo=u,this}}selfMultiply(){if(1===arguments.length){if(arguments[0]instanceof AS){const t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if("number"==typeof arguments[0]){const t=arguments[0];return this.selfMultiply(t,0)}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];let n=null,i=null,r=null,s=null,o=null,a=null;o=AS.SPLIT*this._hi,n=o-this._hi,a=AS.SPLIT*t,n=o-n,i=this._hi-n,r=a-t,o=this._hi*t,r=a-r,s=t-r,a=n*r-o+n*s+i*r+i*s+(this._hi*e+this._lo*t);const l=o+a;n=o-l;const h=a+n;return this._hi=l,this._lo=h,this}}selfSqr(){return this.selfMultiply(this)}floor(){if(this.isNaN())return AS.NaN;const t=Math.floor(this._hi);let e=0;return t===this._hi&&(e=Math.floor(this._lo)),new AS(t,e)}negate(){return this.isNaN()?this:new AS(-this._hi,-this._lo)}clone(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return null;throw t}}multiply(){if(arguments[0]instanceof AS){const t=arguments[0];return t.isNaN()?AS.createNaN():AS.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){const t=arguments[0];return YN.isNaN(t)?AS.createNaN():AS.copy(this).selfMultiply(t,0)}}isNaN(){return YN.isNaN(this._hi)}intValue(){return Math.trunc(this._hi)}toString(){const t=AS.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()}toStandardNotation(){const t=this.getSpecialNumberString();if(null!==t)return t;const e=new Array(1).fill(null),n=this.extractSignificantDigits(!0,e),i=e[0]+1;let r=n;if("."===n.charAt(0))r="0"+n;else if(i<0)r="0."+AS.stringOfChar("0",-i)+n;else if(-1===n.indexOf(".")){const t=i-n.length;r=n+AS.stringOfChar("0",t)+".0"}return this.isNegative()?"-"+r:r}reciprocal(){let t=null,e=null,n=null,i=null,r=null,s=null,o=null,a=null;r=1/this._hi,s=AS.SPLIT*r,t=s-r,a=AS.SPLIT*this._hi,t=s-t,e=r-t,n=a-this._hi,o=r*this._hi,n=a-n,i=this._hi-n,a=t*n-o+t*i+e*n+e*i,s=(1-o-a-r*this._lo)/this._hi;const l=r+s;return new AS(l,r-l+s)}toSciNotation(){if(this.isZero())return AS.SCI_NOT_ZERO;const t=this.getSpecialNumberString();if(null!==t)return t;const e=new Array(1).fill(null),n=this.extractSignificantDigits(!1,e),i=AS.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===n.charAt(0))throw new IllegalStateException("Found leading zero: "+n);let r="";n.length>1&&(r=n.substring(1));const s=n.charAt(0)+"."+r;return this.isNegative()?"-"+s+i:s+i}abs(){return this.isNaN()?AS.NaN:this.isNegative()?this.negate():new AS(this)}isPositive(){return this._hi>0||0===this._hi&&this._lo>0}lt(t){return this._hi<t._hi||this._hi===t._hi&&this._lo<t._lo}add(){if(arguments[0]instanceof AS){const t=arguments[0];return AS.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){const t=arguments[0];return AS.copy(this).selfAdd(t)}}init(){if(1===arguments.length){if("number"==typeof arguments[0]){const t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof AS){const t=arguments[0];this._hi=t._hi,this._lo=t._lo}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this._hi=t,this._lo=e}}gt(t){return this._hi>t._hi||this._hi===t._hi&&this._lo>t._lo}isNegative(){return this._hi<0||0===this._hi&&this._lo<0}trunc(){return this.isNaN()?AS.NaN:this.isPositive()?this.floor():this.ceil()}signum(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}get interfaces_(){return[QN,JN,WN]}}AS.PI=new AS(3.141592653589793,12246467991473532e-32),AS.TWO_PI=new AS(6.283185307179586,24492935982947064e-32),AS.PI_2=new AS(1.5707963267948966,6123233995736766e-32),AS.E=new AS(2.718281828459045,14456468917292502e-32),AS.NaN=new AS(YN.NaN,YN.NaN),AS.EPS=123259516440783e-46,AS.SPLIT=134217729,AS.MAX_PRINT_DIGITS=32,AS.TEN=AS.valueOf(10),AS.ONE=AS.valueOf(1),AS.SCI_NOT_EXPONENT_CHAR="E",AS.SCI_NOT_ZERO="0.0E0";class LS{static orientationIndex(t,e,n){const i=LS.orientationIndexFilter(t,e,n);if(i<=1)return i;const r=AS.valueOf(e.x).selfAdd(-t.x),s=AS.valueOf(e.y).selfAdd(-t.y),o=AS.valueOf(n.x).selfAdd(-e.x),a=AS.valueOf(n.y).selfAdd(-e.y);return r.selfMultiply(a).selfSubtract(s.selfMultiply(o)).signum()}static signOfDet2x2(){if(arguments[3]instanceof AS&&arguments[2]instanceof AS&&arguments[0]instanceof AS&&arguments[1]instanceof AS){const t=arguments[1],e=arguments[2],n=arguments[3];return arguments[0].multiply(n).selfSubtract(t.multiply(e)).signum()}if("number"==typeof arguments[3]&&"number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=AS.valueOf(t),s=AS.valueOf(e),o=AS.valueOf(n),a=AS.valueOf(i);return r.multiply(a).selfSubtract(s.multiply(o)).signum()}}static intersection(t,e,n,i){const r=new AS(t.y).selfSubtract(e.y),s=new AS(e.x).selfSubtract(t.x),o=new AS(t.x).selfMultiply(e.y).selfSubtract(new AS(e.x).selfMultiply(t.y)),a=new AS(n.y).selfSubtract(i.y),l=new AS(i.x).selfSubtract(n.x),h=new AS(n.x).selfMultiply(i.y).selfSubtract(new AS(i.x).selfMultiply(n.y)),c=s.multiply(h).selfSubtract(l.multiply(o)),u=a.multiply(o).selfSubtract(r.multiply(h)),f=r.multiply(l).selfSubtract(a.multiply(s)),d=c.selfDivide(f).doubleValue(),p=u.selfDivide(f).doubleValue();return YN.isNaN(d)||YN.isInfinite(d)||YN.isNaN(p)||YN.isInfinite(p)?null:new aS(d,p)}static orientationIndexFilter(t,e,n){let i=null;const r=(t.x-n.x)*(e.y-n.y),s=(t.y-n.y)*(e.x-n.x),o=r-s;if(r>0){if(s<=0)return LS.signum(o);i=r+s}else{if(!(r<0))return LS.signum(o);if(s>=0)return LS.signum(o);i=-r-s}const a=LS.DP_SAFE_EPSILON*i;return o>=a||-o>=a?LS.signum(o):2}static signum(t){return t>0?1:t<0?-1:0}}LS.DP_SAFE_EPSILON=1e-15;class PS{static index(t,e,n){return LS.orientationIndex(t,e,n)}static isCCW(){if(arguments[0]instanceof Array){const t=arguments[0],e=t.length-1;if(e<3)throw new HN("Ring has fewer than 4 points, so orientation cannot be determined");let n=t[0],i=0;for(let r=1;r<=e;r++){const e=t[r];e.y>n.y&&(n=e,i=r)}let r=i;do{r-=1,r<0&&(r=e)}while(t[r].equals2D(n)&&r!==i);let s=i;do{s=(s+1)%e}while(t[s].equals2D(n)&&s!==i);const o=t[r],a=t[s];if(o.equals2D(n)||a.equals2D(n)||o.equals2D(a))return!1;const l=PS.index(o,n,a);let h=null;return h=0===l?o.x>a.x:l>0,h}if(BN(arguments[0],$N)){const t=arguments[0],e=t.size()-1;if(e<3)throw new HN("Ring has fewer than 4 points, so orientation cannot be determined");let n=t.getCoordinate(0),i=0;for(let r=1;r<=e;r++){const e=t.getCoordinate(r);e.y>n.y&&(n=e,i=r)}let r=null,s=i;do{s-=1,s<0&&(s=e),r=t.getCoordinate(s)}while(r.equals2D(n)&&s!==i);let o=null,a=i;do{a=(a+1)%e,o=t.getCoordinate(a)}while(o.equals2D(n)&&a!==i);if(r.equals2D(n)||o.equals2D(n)||r.equals2D(o))return!1;const l=PS.index(r,n,o);let h=null;return h=0===l?r.x>o.x:l>0,h}}}PS.CLOCKWISE=-1,PS.RIGHT=PS.CLOCKWISE,PS.COUNTERCLOCKWISE=1,PS.LEFT=PS.COUNTERCLOCKWISE,PS.COLLINEAR=0,PS.STRAIGHT=PS.COLLINEAR;class DS{}class zS extends cS{constructor(){super(),zS.constructor_.apply(this,arguments)}static constructor_(){this._shell=null,this._holes=null;let t=arguments[0],e=arguments[1],n=arguments[2];if(cS.constructor_.call(this,n),null===t&&(t=this.getFactory().createLinearRing()),null===e&&(e=[]),cS.hasNullElements(e))throw new HN("holes must not contain null elements");if(t.isEmpty()&&cS.hasNonEmptyElements(e))throw new HN("shell is empty but holes are not");this._shell=t,this._holes=e}computeEnvelopeInternal(){return this._shell.getEnvelopeInternal()}getCoordinates(){if(this.isEmpty())return[];const t=new Array(this.getNumPoints()).fill(null);let e=-1;const n=this._shell.getCoordinates();for(let i=0;i<n.length;i++)e++,t[e]=n[i];for(let n=0;n<this._holes.length;n++){const i=this._holes[n].getCoordinates();for(let n=0;n<i.length;n++)e++,t[e]=i[n]}return t}getArea(){let t=0;t+=wS.ofRing(this._shell.getCoordinateSequence());for(let e=0;e<this._holes.length;e++)t-=wS.ofRing(this._holes[e].getCoordinateSequence());return t}copyInternal(){const t=this._shell.copy(),e=new Array(this._holes.length).fill(null);for(let t=0;t<this._holes.length;t++)e[t]=this._holes[t].copy();return new zS(t,e,this._factory)}isRectangle(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;const t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal();for(let n=0;n<5;n++){const i=t.getX(n);if(i!==e.getMinX()&&i!==e.getMaxX())return!1;const r=t.getY(n);if(r!==e.getMinY()&&r!==e.getMaxY())return!1}let n=t.getX(0),i=t.getY(0);for(let e=1;e<=4;e++){const r=t.getX(e),s=t.getY(e);if(r!==n===(s!==i))return!1;n=r,i=s}return!0}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof cS){const t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;const n=t,i=this._shell,r=n._shell;if(!i.equalsExact(r,e))return!1;if(this._holes.length!==n._holes.length)return!1;for(let t=0;t<this._holes.length;t++)if(!this._holes[t].equalsExact(n._holes[t],e))return!1;return!0}return super.equalsExact.apply(this,arguments)}normalize(){if(0===arguments.length){this._shell=this.normalized(this._shell,!0);for(let t=0;t<this._holes.length;t++)this._holes[t]=this.normalized(this._holes[t],!1);CS.sort(this._holes)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];if(t.isEmpty())return null;const n=t.getCoordinateSequence(),i=pS.minCoordinateIndex(n,0,n.size()-2);pS.scroll(n,i,!0),PS.isCCW(n)===e&&pS.reverse(n)}}getCoordinate(){return this._shell.getCoordinate()}getNumInteriorRing(){return this._holes.length}getBoundaryDimension(){return 1}reverseInternal(){const t=this.getExteriorRing().reverse(),e=new Array(this.getNumInteriorRing()).fill(null);for(let t=0;t<e.length;t++)e[t]=this.getInteriorRingN(t).reverse();return this.getFactory().createPolygon(t,e)}getTypeCode(){return cS.TYPECODE_POLYGON}getDimension(){return 2}getLength(){let t=0;t+=this._shell.getLength();for(let e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t}getNumPoints(){let t=this._shell.getNumPoints();for(let e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t}convexHull(){return this.getExteriorRing().convexHull()}normalized(t,e){const n=t.copy();return this.normalize(n,e),n}compareToSameClass(){if(1===arguments.length){const t=arguments[0],e=this._shell,n=t._shell;return e.compareToSameClass(n)}if(2===arguments.length){const t=arguments[1],e=arguments[0],n=this._shell,i=e._shell,r=n.compareToSameClass(i,t);if(0!==r)return r;const s=this.getNumInteriorRing(),o=e.getNumInteriorRing();let a=0;for(;a<s&&a<o;){const n=this.getInteriorRingN(a),i=e.getInteriorRingN(a),r=n.compareToSameClass(i,t);if(0!==r)return r;a++}return a<s?1:a<o?-1:0}}apply(){if(BN(arguments[0],uS)){const t=arguments[0];this._shell.apply(t);for(let e=0;e<this._holes.length;e++)this._holes[e].apply(t)}else if(BN(arguments[0],xS)){const t=arguments[0];if(this._shell.apply(t),!t.isDone())for(let e=0;e<this._holes.length&&(this._holes[e].apply(t),!t.isDone());e++);t.isGeometryChanged()&&this.geometryChanged()}else if(BN(arguments[0],mS)){arguments[0].filter(this)}else if(BN(arguments[0],ZN)){const t=arguments[0];t.filter(this),this._shell.apply(t);for(let e=0;e<this._holes.length;e++)this._holes[e].apply(t)}}getBoundary(){if(this.isEmpty())return this.getFactory().createMultiLineString();const t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(let e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)}getGeometryType(){return cS.TYPENAME_POLYGON}getExteriorRing(){return this._shell}isEmpty(){return this._shell.isEmpty()}getInteriorRingN(t){return this._holes[t]}get interfaces_(){return[DS]}}class FS extends ES{contains(){}}class GS extends FS{}class qS extends GS{constructor(t){super(),this.array=[],t instanceof ES&&this.addAll(t)}contains(t){for(const e of this.array)if(0===e.compareTo(t))return!0;return!1}add(t){if(this.contains(t))return!1;for(let e=0,n=this.array.length;e<n;e++){if(1===this.array[e].compareTo(t))return!!this.array.splice(e,0,t)}return this.array.push(t),!0}addAll(t){for(const e of t)this.add(e);return!0}remove(){throw new gS}size(){return this.array.length}isEmpty(){return 0===this.array.length}toArray(){return this.array.slice()}iterator(){return new jS(this.array)}}class jS{constructor(t){this.array=t,this.position=0}next(){if(this.position===this.array.length)throw new IS;return this.array[this.position++]}hasNext(){return this.position<this.array.length}remove(){throw new gS}}class BS extends cS{constructor(){super(),BS.constructor_.apply(this,arguments)}static constructor_(){if(this._geometries=null,0===arguments.length);else if(2===arguments.length){let t=arguments[0],e=arguments[1];if(cS.constructor_.call(this,e),null===t&&(t=[]),cS.hasNullElements(t))throw new HN("geometries must not contain null elements");this._geometries=t}}computeEnvelopeInternal(){const t=new hS;for(let e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t}getGeometryN(t){return this._geometries[t]}getCoordinates(){const t=new Array(this.getNumPoints()).fill(null);let e=-1;for(let n=0;n<this._geometries.length;n++){const i=this._geometries[n].getCoordinates();for(let n=0;n<i.length;n++)e++,t[e]=i[n]}return t}getArea(){let t=0;for(let e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t}copyInternal(){const t=new Array(this._geometries.length).fill(null);for(let e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new BS(t,this._factory)}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof cS){const t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;const n=t;if(this._geometries.length!==n._geometries.length)return!1;for(let t=0;t<this._geometries.length;t++)if(!this._geometries[t].equalsExact(n._geometries[t],e))return!1;return!0}return super.equalsExact.apply(this,arguments)}normalize(){for(let t=0;t<this._geometries.length;t++)this._geometries[t].normalize();CS.sort(this._geometries)}getCoordinate(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}getBoundaryDimension(){let t=yS.FALSE;for(let e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t}reverseInternal(){const t=this._geometries.length,e=new kS(t);for(let n=0;n<t;n++)e.add(this._geometries[n].reverse());return this.getFactory().buildGeometry(e)}getTypeCode(){return cS.TYPECODE_GEOMETRYCOLLECTION}getDimension(){let t=yS.FALSE;for(let e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t}getLength(){let t=0;for(let e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t}getNumPoints(){let t=0;for(let e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t}getNumGeometries(){return this._geometries.length}compareToSameClass(){if(1===arguments.length){const t=arguments[0],e=new qS(CS.asList(this._geometries)),n=new qS(CS.asList(t._geometries));return this.compare(e,n)}if(2===arguments.length){const t=arguments[1],e=arguments[0],n=this.getNumGeometries(),i=e.getNumGeometries();let r=0;for(;r<n&&r<i;){const n=this.getGeometryN(r),i=e.getGeometryN(r),s=n.compareToSameClass(i,t);if(0!==s)return s;r++}return r<n?1:r<i?-1:0}}apply(){if(BN(arguments[0],uS)){const t=arguments[0];for(let e=0;e<this._geometries.length;e++)this._geometries[e].apply(t)}else if(BN(arguments[0],xS)){const t=arguments[0];if(0===this._geometries.length)return null;for(let e=0;e<this._geometries.length&&(this._geometries[e].apply(t),!t.isDone());e++);t.isGeometryChanged()&&this.geometryChanged()}else if(BN(arguments[0],mS)){const t=arguments[0];t.filter(this);for(let e=0;e<this._geometries.length;e++)this._geometries[e].apply(t)}else if(BN(arguments[0],ZN)){const t=arguments[0];t.filter(this);for(let e=0;e<this._geometries.length;e++)this._geometries[e].apply(t)}}getBoundary(){return cS.checkNotGeometryCollection(this),iS.shouldNeverReachHere(),null}getGeometryType(){return cS.TYPENAME_GEOMETRYCOLLECTION}isEmpty(){for(let t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0}}class US extends BS{constructor(){super(),US.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],e=arguments[1];BS.constructor_.call(this,t,e)}copyInternal(){const t=new Array(this._geometries.length).fill(null);for(let e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new US(t,this._factory)}isValid(){return!0}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof cS){const t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&super.equalsExact.call(this,t,e)}return super.equalsExact.apply(this,arguments)}getCoordinate(){if(1===arguments.length&&Number.isInteger(arguments[0])){const t=arguments[0];return this._geometries[t].getCoordinate()}return super.getCoordinate.apply(this,arguments)}getBoundaryDimension(){return yS.FALSE}getTypeCode(){return cS.TYPECODE_MULTIPOINT}getDimension(){return 0}getBoundary(){return this.getFactory().createGeometryCollection()}getGeometryType(){return cS.TYPENAME_MULTIPOINT}get interfaces_(){return[bS]}}class YS extends vS{constructor(){super(),YS.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],e=arguments[1];vS.constructor_.call(this,t,e),this.validateConstruction()}copyInternal(){return new YS(this._points.copy(),this._factory)}getBoundaryDimension(){return yS.FALSE}isClosed(){return!!this.isEmpty()||super.isClosed.call(this)}reverseInternal(){const t=this._points.copy();return pS.reverse(t),this.getFactory().createLinearRing(t)}getTypeCode(){return cS.TYPECODE_LINEARRING}validateConstruction(){if(!this.isEmpty()&&!super.isClosed.call(this))throw new HN("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<YS.MINIMUM_VALID_SIZE)throw new HN("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}getGeometryType(){return cS.TYPENAME_LINEARRING}}YS.MINIMUM_VALID_SIZE=4;class WS extends aS{constructor(){super(),WS.constructor_.apply(this,arguments)}static constructor_(){if(0===arguments.length)aS.constructor_.call(this);else if(1===arguments.length){if(arguments[0]instanceof WS){const t=arguments[0];aS.constructor_.call(this,t.x,t.y)}else if(arguments[0]instanceof aS){const t=arguments[0];aS.constructor_.call(this,t.x,t.y)}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];aS.constructor_.call(this,t,e,aS.NULL_ORDINATE)}}setOrdinate(t,e){switch(t){case WS.X:this.x=e;break;case WS.Y:this.y=e;break;default:throw new HN("Invalid ordinate index: "+t)}}getZ(){return aS.NULL_ORDINATE}getOrdinate(t){switch(t){case WS.X:return this.x;case WS.Y:return this.y}throw new HN("Invalid ordinate index: "+t)}setZ(t){throw new HN("CoordinateXY dimension 2 does not support z-ordinate")}copy(){return new WS(this)}toString(){return"("+this.x+", "+this.y+")"}setCoordinate(t){this.x=t.x,this.y=t.y,this.z=t.getZ()}}WS.X=0,WS.Y=1,WS.Z=-1,WS.M=-1;class $S extends aS{constructor(){super(),$S.constructor_.apply(this,arguments)}static constructor_(){if(this._m=null,0===arguments.length)aS.constructor_.call(this),this._m=0;else if(1===arguments.length){if(arguments[0]instanceof $S){const t=arguments[0];aS.constructor_.call(this,t.x,t.y),this._m=t._m}else if(arguments[0]instanceof aS){const t=arguments[0];aS.constructor_.call(this,t.x,t.y),this._m=this.getM()}}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];aS.constructor_.call(this,t,e,aS.NULL_ORDINATE),this._m=n}}getM(){return this._m}setOrdinate(t,e){switch(t){case $S.X:this.x=e;break;case $S.Y:this.y=e;break;case $S.M:this._m=e;break;default:throw new HN("Invalid ordinate index: "+t)}}setM(t){this._m=t}getZ(){return aS.NULL_ORDINATE}getOrdinate(t){switch(t){case $S.X:return this.x;case $S.Y:return this.y;case $S.M:return this._m}throw new HN("Invalid ordinate index: "+t)}setZ(t){throw new HN("CoordinateXY dimension 2 does not support z-ordinate")}copy(){return new $S(this)}toString(){return"("+this.x+", "+this.y+" m="+this.getM()+")"}setCoordinate(t){this.x=t.x,this.y=t.y,this.z=t.getZ(),this._m=t.getM()}}$S.X=0,$S.Y=1,$S.Z=-1,$S.M=2;class XS extends aS{constructor(){super(),XS.constructor_.apply(this,arguments)}static constructor_(){if(this._m=null,0===arguments.length)aS.constructor_.call(this),this._m=0;else if(1===arguments.length){if(arguments[0]instanceof XS){const t=arguments[0];aS.constructor_.call(this,t),this._m=t._m}else if(arguments[0]instanceof aS){const t=arguments[0];aS.constructor_.call(this,t),this._m=this.getM()}}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];aS.constructor_.call(this,t,e,n),this._m=i}}getM(){return this._m}setOrdinate(t,e){switch(t){case aS.X:this.x=e;break;case aS.Y:this.y=e;break;case aS.Z:this.z=e;break;case aS.M:this._m=e;break;default:throw new HN("Invalid ordinate index: "+t)}}setM(t){this._m=t}getOrdinate(t){switch(t){case aS.X:return this.x;case aS.Y:return this.y;case aS.Z:return this.getZ();case aS.M:return this.getM()}throw new HN("Invalid ordinate index: "+t)}copy(){return new XS(this)}toString(){return"("+this.x+", "+this.y+", "+this.getZ()+" m="+this.getM()+")"}setCoordinate(t){this.x=t.x,this.y=t.y,this.z=t.getZ(),this._m=t.getM()}}class VS{static measures(t){return t instanceof WS?0:t instanceof $S||t instanceof XS?1:0}static dimension(t){return t instanceof WS?2:t instanceof $S?3:t instanceof XS?4:3}static create(){if(1===arguments.length){const t=arguments[0];return VS.create(t,0)}if(2===arguments.length){const t=arguments[0],e=arguments[1];return 2===t?new WS:3===t&&0===e?new aS:3===t&&1===e?new $S:4===t&&1===e?new XS:new aS}}}class HS extends kS{constructor(){super(),HS.constructor_.apply(this,arguments)}static constructor_(){if(0===arguments.length);else if(1===arguments.length){const t=arguments[0];this.ensureCapacity(t.length),this.add(t,!0)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.ensureCapacity(t.length),this.add(t,e)}}getCoordinate(t){return this.get(t)}addAll(){if(2===arguments.length&&"boolean"==typeof arguments[1]&&BN(arguments[0],ES)){const t=arguments[1];let e=!1;for(let n=arguments[0].iterator();n.hasNext();)this.add(n.next(),t),e=!0;return e}return super.addAll.apply(this,arguments)}clone(){const t=super.clone.call(this);for(let e=0;e<this.size();e++)t.add(e,this.get(e).clone());return t}toCoordinateArray(){if(0===arguments.length)return this.toArray(HS.coordArrayType);if(1===arguments.length){if(arguments[0])return this.toArray(HS.coordArrayType);const t=this.size(),e=new Array(t).fill(null);for(let n=0;n<t;n++)e[n]=this.get(t-n-1);return e}}add(){if(1===arguments.length){const t=arguments[0];return super.add.call(this,t)}if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){const t=arguments[0],e=arguments[1];return this.add(t,e,!0),!0}if(arguments[0]instanceof aS&&"boolean"==typeof arguments[1]){const t=arguments[0];if(!arguments[1]&&this.size()>=1){if(this.get(this.size()-1).equals2D(t))return null}super.add.call(this,t)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){const t=arguments[0],e=arguments[1];return this.add(t,e),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){const t=arguments[0],e=arguments[1];if(arguments[2])for(let n=0;n<t.length;n++)this.add(t[n],e);else for(let n=t.length-1;n>=0;n--)this.add(t[n],e);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof aS){const t=arguments[0],e=arguments[1];if(!arguments[2]){const n=this.size();if(n>0){if(t>0){if(this.get(t-1).equals2D(e))return null}if(t<n){if(this.get(t).equals2D(e))return null}}}super.add.call(this,t,e)}}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];let r=1;n>i&&(r=-1);for(let s=n;s!==i;s+=r)this.add(t[s],e);return!0}}closeRing(){if(this.size()>0){const t=this.get(0).copy();this.add(t,!1)}}}HS.coordArrayType=new Array(0).fill(null);class ZS{static log10(t){const e=Math.log(t);return YN.isInfinite(e)||YN.isNaN(e)?e:e/ZS.LOG_10}static min(t,e,n,i){let r=t;return e<r&&(r=e),n<r&&(r=n),i<r&&(r=i),r}static clamp(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1],n=arguments[2];return t<e?e:t>n?n:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1],n=arguments[2];return t<e?e:t>n?n:t}}static wrap(t,e){return t<0?e- -t%e:t%e}static max(){if(3===arguments.length){const t=arguments[1],e=arguments[2];let n=arguments[0];return t>n&&(n=t),e>n&&(n=e),n}if(4===arguments.length){const t=arguments[1],e=arguments[2],n=arguments[3];let i=arguments[0];return t>i&&(i=t),e>i&&(i=e),n>i&&(i=n),i}}static average(t,e){return(t+e)/2}}ZS.LOG_10=Math.log(10);class JS{static arraycopy(t,e,n,i,r){let s=0;for(let o=e;o<e+r;o++)n[i+s]=t[o],s++}static getProperty(t){return{"line.separator":"\n"}[t]}}class QS{static isRing(t){return!(t.length<4)&&!!t[0].equals2D(t[t.length-1])}static ptNotInList(t,e){for(let n=0;n<t.length;n++){const i=t[n];if(QS.indexOf(i,e)<0)return i}return null}static scroll(t,e){const n=QS.indexOf(e,t);if(n<0)return null;const i=new Array(t.length).fill(null);JS.arraycopy(t,n,i,0,t.length-n),JS.arraycopy(t,0,i,t.length-n,n),JS.arraycopy(i,0,t,0,t.length)}static equals(){if(2===arguments.length){const t=arguments[0],e=arguments[1];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0}if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(0!==n.compare(t[i],e[i]))return!1;return!0}}static intersection(t,e){const n=new HS;for(let i=0;i<t.length;i++)e.intersects(t[i])&&n.add(t[i],!0);return n.toCoordinateArray()}static measures(t){if(null===t||0===t.length)return 0;let e=0;for(const n of t)e=Math.max(e,VS.measures(n));return e}static hasRepeatedPoints(t){for(let e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1}static removeRepeatedPoints(t){if(!QS.hasRepeatedPoints(t))return t;return new HS(t,!1).toCoordinateArray()}static reverse(t){const e=t.length-1,n=Math.trunc(e/2);for(let i=0;i<=n;i++){const n=t[i];t[i]=t[e-i],t[e-i]=n}}static removeNull(t){let e=0;for(let n=0;n<t.length;n++)null!==t[n]&&e++;const n=new Array(e).fill(null);if(0===e)return n;let i=0;for(let e=0;e<t.length;e++)null!==t[e]&&(n[i++]=t[e]);return n}static copyDeep(){if(1===arguments.length){const t=arguments[0],e=new Array(t.length).fill(null);for(let n=0;n<t.length;n++)e[n]=t[n].copy();return e}if(5===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=arguments[4];for(let s=0;s<r;s++)n[i+s]=t[e+s].copy()}}static isEqualReversed(t,e){for(let n=0;n<t.length;n++){const i=t[n],r=e[t.length-n-1];if(0!==i.compareTo(r))return!1}return!0}static envelope(t){const e=new hS;for(let n=0;n<t.length;n++)e.expandToInclude(t[n]);return e}static toCoordinateArray(t){return t.toArray(QS.coordArrayType)}static dimension(t){if(null===t||0===t.length)return 3;let e=0;for(const n of t)e=Math.max(e,VS.dimension(n));return e}static atLeastNCoordinatesOrNothing(t,e){return e.length>=t?e:[]}static indexOf(t,e){for(let n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1}static increasingDirection(t){for(let e=0;e<Math.trunc(t.length/2);e++){const n=t.length-1-e,i=t[e].compareTo(t[n]);if(0!==i)return i}return 1}static compare(t,e){let n=0;for(;n<t.length&&n<e.length;){const i=t[n].compareTo(e[n]);if(0!==i)return i;n++}return n<e.length?-1:n<t.length?1:0}static minCoordinate(t){let e=null;for(let n=0;n<t.length;n++)(null===e||e.compareTo(t[n])>0)&&(e=t[n]);return e}static extract(t,e,n){e=ZS.clamp(e,0,t.length);let i=(n=ZS.clamp(n,-1,t.length))-e+1;n<0&&(i=0),e>=t.length&&(i=0),n<e&&(i=0);const r=new Array(i).fill(null);if(0===i)return r;let s=0;for(let i=e;i<=n;i++)r[s++]=t[i];return r}}QS.ForwardComparator=class{compare(t,e){const n=t,i=e;return QS.compare(n,i)}get interfaces_(){return[tS]}},QS.BidirectionalComparator=class{compare(t,e){const n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;const r=QS.compare(n,i);return QS.isEqualReversed(n,i)?0:r}OLDcompare(t,e){const n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;const r=QS.increasingDirection(n),s=QS.increasingDirection(i);let o=r>0?0:n.length-1,a=s>0?0:n.length-1;for(let t=0;t<n.length;t++){const t=n[o].compareTo(i[a]);if(0!==t)return t;o+=r,a+=s}return 0}get interfaces_(){return[tS]}},QS.coordArrayType=new Array(0).fill(null);class KS{constructor(t){this.str=t}append(t){this.str+=t}setCharAt(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)}toString(){return this.str}}class tI{constructor(){tI.constructor_.apply(this,arguments)}static constructor_(){if(this._dimension=3,this._measures=0,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array){const t=arguments[0];tI.constructor_.call(this,t,QS.dimension(t),QS.measures(t))}else if(Number.isInteger(arguments[0])){const t=arguments[0];this._coordinates=new Array(t).fill(null);for(let e=0;e<t;e++)this._coordinates[e]=new aS}else if(BN(arguments[0],$N)){const t=arguments[0];if(null===t)return this._coordinates=new Array(0).fill(null),null;this._dimension=t.getDimension(),this._measures=t.getMeasures(),this._coordinates=new Array(t.size()).fill(null);for(let e=0;e<this._coordinates.length;e++)this._coordinates[e]=t.getCoordinateCopy(e)}}else if(2===arguments.length){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1];tI.constructor_.call(this,t,e,QS.measures(t))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1];this._coordinates=new Array(t).fill(null),this._dimension=e;for(let n=0;n<t;n++)this._coordinates[n]=VS.create(e)}}else if(3===arguments.length)if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1],n=arguments[2];this._dimension=e,this._measures=n,this._coordinates=null===t?new Array(0).fill(null):t}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1],n=arguments[2];this._coordinates=new Array(t).fill(null),this._dimension=e,this._measures=n;for(let e=0;e<t;e++)this._coordinates[e]=this.createCoordinate()}}getM(t){return this.hasM()?this._coordinates[t].getM():YN.NaN}setOrdinate(t,e,n){switch(e){case $N.X:this._coordinates[t].x=n;break;case $N.Y:this._coordinates[t].y=n;break;default:this._coordinates[t].setOrdinate(e,n)}}getZ(t){return this.hasZ()?this._coordinates[t].getZ():YN.NaN}size(){return this._coordinates.length}getOrdinate(t,e){switch(e){case $N.X:return this._coordinates[t].x;case $N.Y:return this._coordinates[t].y;default:return this._coordinates[t].getOrdinate(e)}}getCoordinate(){if(1===arguments.length){const t=arguments[0];return this._coordinates[t]}if(2===arguments.length){const t=arguments[0];arguments[1].setCoordinate(this._coordinates[t])}}getCoordinateCopy(t){const e=this.createCoordinate();return e.setCoordinate(this._coordinates[t]),e}createCoordinate(){return VS.create(this.getDimension(),this.getMeasures())}getDimension(){return this._dimension}getX(t){return this._coordinates[t].x}getMeasures(){return this._measures}expandEnvelope(t){for(let e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t}copy(){const t=new Array(this.size()).fill(null);for(let e=0;e<this._coordinates.length;e++){const n=this.createCoordinate();n.setCoordinate(this._coordinates[e]),t[e]=n}return new tI(t,this._dimension,this._measures)}toString(){if(this._coordinates.length>0){const t=new KS(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(let e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"}getY(t){return this._coordinates[t].y}toCoordinateArray(){return this._coordinates}get interfaces_(){return[$N,QN]}}class eI{static instance(){return eI.instanceObject}readResolve(){return eI.instance()}create(){if(1===arguments.length){if(arguments[0]instanceof Array){return new tI(arguments[0])}if(BN(arguments[0],$N)){return new tI(arguments[0])}}else{if(2===arguments.length){let t=arguments[1];return t>3&&(t=3),t<2&&(t=2),new tI(arguments[0],t)}if(3===arguments.length){let t=arguments[2],e=arguments[1]-t;return t>1&&(t=1),e>3&&(e=3),e<2&&(e=2),new tI(arguments[0],e+t,t)}}}get interfaces_(){return[XN,QN]}}eI.instanceObject=new eI;class nI extends BS{constructor(){super(),nI.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],e=arguments[1];BS.constructor_.call(this,t,e)}copyInternal(){const t=new Array(this._geometries.length).fill(null);for(let e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new nI(t,this._factory)}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof cS){const t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&super.equalsExact.call(this,t,e)}return super.equalsExact.apply(this,arguments)}getBoundaryDimension(){return 1}getTypeCode(){return cS.TYPECODE_MULTIPOLYGON}getDimension(){return 2}getBoundary(){if(this.isEmpty())return this.getFactory().createMultiLineString();const t=new kS;for(let e=0;e<this._geometries.length;e++){const n=this._geometries[e].getBoundary();for(let e=0;e<n.getNumGeometries();e++)t.add(n.getGeometryN(e))}const e=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(e))}getGeometryType(){return cS.TYPENAME_MULTIPOLYGON}get interfaces_(){return[DS]}}class iI{get(){}put(){}size(){}values(){}entrySet(){}}class rI extends FS{constructor(t){super(),this.map=new Map,t instanceof ES&&this.addAll(t)}contains(t){const e=t.hashCode?t.hashCode():t;return!!this.map.has(e)}add(t){const e=t.hashCode?t.hashCode():t;return!this.map.has(e)&&!!this.map.set(e,t)}addAll(t){for(const e of t)this.add(e);return!0}remove(){throw new gS}size(){return this.map.size}isEmpty(){return 0===this.map.size}toArray(){return Array.from(this.map.values())}iterator(){return new sI(this.map)}[Symbol.iterator](){return this.map}}class sI{constructor(t){this.iterator=t.values();const{done:e,value:n}=this.iterator.next();this.done=e,this.value=n}next(){if(this.done)throw new IS;const t=this.value,{done:e,value:n}=this.iterator.next();return this.done=e,this.value=n,t}hasNext(){return!this.done}remove(){throw new gS}}class oI extends iI{constructor(){super(),this.map=new Map}get(t){return this.map.get(t)||null}put(t,e){return this.map.set(t,e),e}values(){const t=new kS,e=this.map.values();let n=e.next();for(;!n.done;)t.add(n.value),n=e.next();return t}entrySet(){const t=new rI;return this.map.entries().forEach((e=>t.add(e))),t}size(){return this.map.size()}}class aI{constructor(){aI.constructor_.apply(this,arguments)}static constructor_(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=aI.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof lI){const t=arguments[0];this._modelType=t,t===aI.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){const t=arguments[0];this._modelType=aI.FIXED,this.setScale(t)}else if(arguments[0]instanceof aI){const t=arguments[0];this._modelType=t._modelType,this._scale=t._scale}}static mostPrecise(t,e){return t.compareTo(e)>=0?t:e}equals(t){if(!(t instanceof aI))return!1;const e=t;return this._modelType===e._modelType&&this._scale===e._scale}compareTo(t){const e=t,n=this.getMaximumSignificantDigits(),i=e.getMaximumSignificantDigits();return RS.compare(n,i)}getScale(){return this._scale}isFloating(){return this._modelType===aI.FLOATING||this._modelType===aI.FLOATING_SINGLE}getType(){return this._modelType}toString(){let t="UNKNOWN";return this._modelType===aI.FLOATING?t="Floating":this._modelType===aI.FLOATING_SINGLE?t="Floating-Single":this._modelType===aI.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t}makePrecise(){if("number"==typeof arguments[0]){const t=arguments[0];if(YN.isNaN(t))return t;if(this._modelType===aI.FLOATING_SINGLE){return t}return this._modelType===aI.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof aS){const t=arguments[0];if(this._modelType===aI.FLOATING)return null;t.x=this.makePrecise(t.x),t.y=this.makePrecise(t.y)}}getMaximumSignificantDigits(){let t=16;return this._modelType===aI.FLOATING?t=16:this._modelType===aI.FLOATING_SINGLE?t=6:this._modelType===aI.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t}setScale(t){this._scale=Math.abs(t)}get interfaces_(){return[QN,JN]}}class lI{constructor(){lI.constructor_.apply(this,arguments)}static constructor_(){this._name=null;const t=arguments[0];this._name=t,lI.nameToTypeMap.put(t,this)}readResolve(){return lI.nameToTypeMap.get(this._name)}toString(){return this._name}get interfaces_(){return[QN]}}lI.nameToTypeMap=new oI,aI.Type=lI,aI.FIXED=new lI("FIXED"),aI.FLOATING=new lI("FLOATING"),aI.FLOATING_SINGLE=new lI("FLOATING SINGLE"),aI.maximumPreciseValue=9007199254740992;class hI extends BS{constructor(){super(),hI.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],e=arguments[1];BS.constructor_.call(this,t,e)}copyInternal(){const t=new Array(this._geometries.length).fill(null);for(let e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new hI(t,this._factory)}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof cS){const t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&super.equalsExact.call(this,t,e)}return super.equalsExact.apply(this,arguments)}getBoundaryDimension(){return this.isClosed()?yS.FALSE:0}isClosed(){if(this.isEmpty())return!1;for(let t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0}getTypeCode(){return cS.TYPECODE_MULTILINESTRING}getDimension(){return 1}getBoundary(){throw new gS}getGeometryType(){return cS.TYPENAME_MULTILINESTRING}get interfaces_(){return[dS]}}class cI{constructor(){cI.constructor_.apply(this,arguments)}static constructor_(){if(this._precisionModel=null,this._coordinateSequenceFactory=null,this._SRID=null,0===arguments.length)cI.constructor_.call(this,new aI,0);else if(1===arguments.length){if(BN(arguments[0],XN)){const t=arguments[0];cI.constructor_.call(this,new aI,0,t)}else if(arguments[0]instanceof aI){const t=arguments[0];cI.constructor_.call(this,t,0,cI.getDefaultCoordinateSequenceFactory())}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];cI.constructor_.call(this,t,e,cI.getDefaultCoordinateSequenceFactory())}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this._precisionModel=t,this._coordinateSequenceFactory=n,this._SRID=e}}static toMultiPolygonArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static toGeometryArray(t){if(null===t)return null;const e=new Array(t.size()).fill(null);return t.toArray(e)}static getDefaultCoordinateSequenceFactory(){return eI.instance()}static toMultiLineStringArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static toLineStringArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static toMultiPointArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static toLinearRingArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static toPointArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static toPolygonArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static createPointFromInternalCoord(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)}createEmpty(t){switch(t){case-1:return this.createGeometryCollection();case 0:return this.createPoint();case 1:return this.createLineString();case 2:return this.createPolygon();default:throw new HN("Invalid dimension: "+t)}}toGeometry(t){return t.isNull()?this.createPoint():t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new aS(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new aS(t.getMinX(),t.getMinY()),new aS(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new aS(t.getMinX(),t.getMinY()),new aS(t.getMinX(),t.getMaxY()),new aS(t.getMaxX(),t.getMaxY()),new aS(t.getMaxX(),t.getMinY()),new aS(t.getMinX(),t.getMinY())]),null)}createLineString(){if(0===arguments.length)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){const t=arguments[0];return this.createLineString(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(BN(arguments[0],$N)){return new vS(arguments[0],this)}}}createMultiLineString(){if(0===arguments.length)return new hI(null,this);if(1===arguments.length){return new hI(arguments[0],this)}}buildGeometry(t){let e=null,n=!1,i=!1;for(let r=t.iterator();r.hasNext();){const t=r.next(),s=t.getTypeCode();null===e&&(e=s),s!==e&&(n=!0),t instanceof BS&&(i=!0)}if(null===e)return this.createGeometryCollection();if(n||i)return this.createGeometryCollection(cI.toGeometryArray(t));const r=t.iterator().next();if(t.size()>1){if(r instanceof zS)return this.createMultiPolygon(cI.toPolygonArray(t));if(r instanceof vS)return this.createMultiLineString(cI.toLineStringArray(t));if(r instanceof MS)return this.createMultiPoint(cI.toPointArray(t));iS.shouldNeverReachHere("Unhandled geometry type: "+r.getGeometryType())}return r}createMultiPointFromCoords(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)}createPoint(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof aS){const t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(BN(arguments[0],$N)){return new MS(arguments[0],this)}}}getCoordinateSequenceFactory(){return this._coordinateSequenceFactory}createPolygon(){if(0===arguments.length)return this.createPolygon(null,null);if(1===arguments.length){if(BN(arguments[0],$N)){const t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){const t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof YS){const t=arguments[0];return this.createPolygon(t,null)}}else if(2===arguments.length){return new zS(arguments[0],arguments[1],this)}}getSRID(){return this._SRID}createGeometryCollection(){if(0===arguments.length)return new BS(null,this);if(1===arguments.length){return new BS(arguments[0],this)}}getPrecisionModel(){return this._precisionModel}createLinearRing(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){const t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(BN(arguments[0],$N)){return new YS(arguments[0],this)}}}createMultiPolygon(){if(0===arguments.length)return new nI(null,this);if(1===arguments.length){return new nI(arguments[0],this)}}createMultiPoint(){if(0===arguments.length)return new US(null,this);if(1===arguments.length){if(arguments[0]instanceof Array){return new US(arguments[0],this)}if(BN(arguments[0],$N)){const t=arguments[0];if(null===t)return this.createMultiPoint(new Array(0).fill(null));const e=new Array(t.size()).fill(null);for(let n=0;n<t.size();n++){const i=this.getCoordinateSequenceFactory().create(1,t.getDimension(),t.getMeasures());pS.copy(t,n,i,0,1),e[n]=this.createPoint(i)}return this.createMultiPoint(e)}}}get interfaces_(){return[QN]}}const uI=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"];class fI{constructor(t){this.geometryFactory=t||new cI}read(t){let e;e="string"==typeof t?JSON.parse(t):t;const n=e.type;if(!dI[n])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==uI.indexOf(n)?dI[n].call(this,e.coordinates):"GeometryCollection"===n?dI[n].call(this,e.geometries):dI[n].call(this,e)}write(t){const e=t.getGeometryType();if(!pI[e])throw new Error("Geometry is not supported");return pI[e].call(this,t)}}const dI={Feature:function(t){const e={};for(const n in t)e[n]=t[n];if(t.geometry){const n=t.geometry.type;if(!dI[n])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=dI.bbox.call(this,t.bbox)),e},FeatureCollection:function(t){const e={};if(t.features){e.features=[];for(let n=0;n<t.features.length;++n)e.features.push(this.read(t.features[n]))}return t.bbox&&(e.bbox=this.parse.bbox.call(this,t.bbox)),e},coordinates:function(t){const e=[];for(let n=0;n<t.length;++n){const i=t[n];e.push(new aS(...i))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new aS(t[0],t[1]),new aS(t[2],t[1]),new aS(t[2],t[3]),new aS(t[0],t[3]),new aS(t[0],t[1])])},Point:function(t){const e=new aS(...t);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){const e=[];for(let n=0;n<t.length;++n)e.push(dI.Point.call(this,t[n]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){const e=dI.coordinates.call(this,t);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){const e=[];for(let n=0;n<t.length;++n)e.push(dI.LineString.call(this,t[n]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){const e=dI.coordinates.call(this,t[0]),n=this.geometryFactory.createLinearRing(e),i=[];for(let e=1;e<t.length;++e){const n=t[e],r=dI.coordinates.call(this,n),s=this.geometryFactory.createLinearRing(r);i.push(s)}return this.geometryFactory.createPolygon(n,i)},MultiPolygon:function(t){const e=[];for(let n=0;n<t.length;++n){const i=t[n];e.push(dI.Polygon.call(this,i))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){const e=[];for(let n=0;n<t.length;++n){const i=t[n];e.push(this.read(i))}return this.geometryFactory.createGeometryCollection(e)}},pI={coordinate:function(t){const e=[t.x,t.y];return t.z&&e.push(t.z),t.m&&e.push(t.m),e},Point:function(t){return{type:"Point",coordinates:pI.coordinate.call(this,t.getCoordinate())}},MultiPoint:function(t){const e=[];for(let n=0;n<t._geometries.length;++n){const i=t._geometries[n],r=pI.Point.call(this,i);e.push(r.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){const e=[],n=t.getCoordinates();for(let t=0;t<n.length;++t){const i=n[t];e.push(pI.coordinate.call(this,i))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){const e=[];for(let n=0;n<t._geometries.length;++n){const i=t._geometries[n],r=pI.LineString.call(this,i);e.push(r.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){const e=[],n=pI.LineString.call(this,t._shell);e.push(n.coordinates);for(let n=0;n<t._holes.length;++n){const i=t._holes[n],r=pI.LineString.call(this,i);e.push(r.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){const e=[];for(let n=0;n<t._geometries.length;++n){const i=t._geometries[n],r=pI.Polygon.call(this,i);e.push(r.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){const e=[];for(let n=0;n<t._geometries.length;++n){const i=t._geometries[n],r=i.getGeometryType();e.push(pI[r].call(this,i))}return{type:"GeometryCollection",geometries:e}}};class gI{constructor(t){this.parser=new fI(t||new cI)}read(t){return this.parser.read(t)}}class _I{constructor(){this.parser=new fI(this.geometryFactory)}write(t){return this.parser.write(t)}}class yI{constructor(){yI.constructor_.apply(this,arguments)}static constructor_(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1}transformPoint(t,e){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))}transformPolygon(t,e){let n=!0;const i=this.transformLinearRing(t.getExteriorRing(),t);null!==i&&i instanceof YS&&!i.isEmpty()||(n=!1);const r=new kS;for(let e=0;e<t.getNumInteriorRing();e++){const i=this.transformLinearRing(t.getInteriorRingN(e),t);null===i||i.isEmpty()||(i instanceof YS||(n=!1),r.add(i))}if(n)return this._factory.createPolygon(i,r.toArray([]));{const t=new kS;return null!==i&&t.add(i),t.addAll(r),this._factory.buildGeometry(t)}}createCoordinateSequence(t){return this._factory.getCoordinateSequenceFactory().create(t)}getInputGeometry(){return this._inputGeom}transformMultiLineString(t,e){const n=new kS;for(let e=0;e<t.getNumGeometries();e++){const i=this.transformLineString(t.getGeometryN(e),t);null!==i&&(i.isEmpty()||n.add(i))}return this._factory.buildGeometry(n)}transformCoordinates(t,e){return this.copy(t)}transformLineString(t,e){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))}transformMultiPoint(t,e){const n=new kS;for(let e=0;e<t.getNumGeometries();e++){const i=this.transformPoint(t.getGeometryN(e),t);null!==i&&(i.isEmpty()||n.add(i))}return this._factory.buildGeometry(n)}transformMultiPolygon(t,e){const n=new kS;for(let e=0;e<t.getNumGeometries();e++){const i=this.transformPolygon(t.getGeometryN(e),t);null!==i&&(i.isEmpty()||n.add(i))}return this._factory.buildGeometry(n)}copy(t){return t.copy()}transformGeometryCollection(t,e){const n=new kS;for(let e=0;e<t.getNumGeometries();e++){const i=this.transform(t.getGeometryN(e));null!==i&&(this._pruneEmptyGeometry&&i.isEmpty()||n.add(i))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(cI.toGeometryArray(n)):this._factory.buildGeometry(n)}transform(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof MS)return this.transformPoint(t,null);if(t instanceof US)return this.transformMultiPoint(t,null);if(t instanceof YS)return this.transformLinearRing(t,null);if(t instanceof vS)return this.transformLineString(t,null);if(t instanceof hI)return this.transformMultiLineString(t,null);if(t instanceof zS)return this.transformPolygon(t,null);if(t instanceof nI)return this.transformMultiPolygon(t,null);if(t instanceof BS)return this.transformGeometryCollection(t,null);throw new HN("Unknown Geometry subtype: "+t.getGeometryType())}transformLinearRing(t,e){const n=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===n)return this._factory.createLinearRing(null);const i=n.size();return i>0&&i<4&&!this._preserveType?this._factory.createLineString(n):this._factory.createLinearRing(n)}}class mI{static intersection(t,e,n,i){const r=t.x<e.x?t.x:e.x,s=t.y<e.y?t.y:e.y,o=t.x>e.x?t.x:e.x,a=t.y>e.y?t.y:e.y,l=n.x<i.x?n.x:i.x,h=n.y<i.y?n.y:i.y,c=n.x>i.x?n.x:i.x,u=n.y>i.y?n.y:i.y,f=((r>l?r:l)+(o<c?o:c))/2,d=((s>h?s:h)+(a<u?a:u))/2,p=t.x-f,g=t.y-d,_=e.x-f,y=e.y-d,m=n.x-f,x=n.y-d,v=i.x-f,b=i.y-d,M=g-y,w=_-p,E=p*y-_*g,N=x-b,S=v-m,I=m*b-v*x,k=M*S-N*w,O=(w*I-S*E)/k,C=(N*E-M*I)/k;return YN.isNaN(O)||YN.isInfinite(O)||YN.isNaN(C)||YN.isInfinite(C)?null:new aS(O+f,C+d)}}class xI{static segmentToSegment(t,e,n,i){if(t.equals(e))return xI.pointToSegment(t,n,i);if(n.equals(i))return xI.pointToSegment(i,t,e);let r=!1;if(hS.intersects(t,e,n,i)){const s=(e.x-t.x)*(i.y-n.y)-(e.y-t.y)*(i.x-n.x);if(0===s)r=!0;else{const o=(t.y-n.y)*(i.x-n.x)-(t.x-n.x)*(i.y-n.y),a=((t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y))/s,l=o/s;(l<0||l>1||a<0||a>1)&&(r=!0)}}else r=!0;return r?ZS.min(xI.pointToSegment(t,n,i),xI.pointToSegment(e,n,i),xI.pointToSegment(n,t,e),xI.pointToSegment(i,t,e)):0}static pointToSegment(t,e,n){if(e.x===n.x&&e.y===n.y)return t.distance(e);const i=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),r=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/i;if(r<=0)return t.distance(e);if(r>=1)return t.distance(n);const s=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/i;return Math.abs(s)*Math.sqrt(i)}static pointToLinePerpendicular(t,e,n){const i=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),r=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/i;return Math.abs(r)*Math.sqrt(i)}static pointToSegmentString(t,e){if(0===e.length)throw new HN("Line array must contain at least one vertex");let n=t.distance(e[0]);for(let i=0;i<e.length-1;i++){const r=xI.pointToSegment(t,e[i],e[i+1]);r<n&&(n=r)}return n}}const vI="XY",bI="XYZ",MI="XYM",wI="XYZM",EI={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},NI="EMPTY",SI=1,II=2,kI=3,OI=4,CI=5,TI=6;for(const t in EI)EI[t].toUpperCase();class RI{constructor(t){this.wkt=t,this.index_=-1}isAlpha_(t){return t>="a"&&t<="z"||t>="A"&&t<="Z"}isNumeric_(t,e){return t>="0"&&t<="9"||"."==t&&!(void 0!==e&&e)}isWhiteSpace_(t){return" "==t||"\t"==t||"\r"==t||"\n"==t}nextChar_(){return this.wkt.charAt(++this.index_)}nextToken(){const t=this.nextChar_(),e=this.index_;let n,i=t;if("("==t)n=II;else if(","==t)n=CI;else if(")"==t)n=kI;else if(this.isNumeric_(t)||"-"==t)n=OI,i=this.readNumber_();else if(this.isAlpha_(t))n=SI,i=this.readText_();else{if(this.isWhiteSpace_(t))return this.nextToken();if(""!==t)throw new Error("Unexpected character: "+t);n=TI}return{position:e,value:i,type:n}}readNumber_(){let t;const e=this.index_;let n=!1,i=!1;do{"."==t?n=!0:"e"!=t&&"E"!=t||(i=!0),t=this.nextChar_()}while(this.isNumeric_(t,n)||!i&&("e"==t||"E"==t)||i&&("-"==t||"+"==t));return parseFloat(this.wkt.substring(e,this.index_--))}readText_(){let t;const e=this.index_;do{t=this.nextChar_()}while(this.isAlpha_(t));return this.wkt.substring(e,this.index_--).toUpperCase()}}class AI{constructor(t,e){this.lexer_=t,this.token_,this.layout_=vI,this.factory=e}consume_(){this.token_=this.lexer_.nextToken()}isTokenType(t){return this.token_.type==t}match(t){const e=this.isTokenType(t);return e&&this.consume_(),e}parse(){this.consume_();return this.parseGeometry_()}parseGeometryLayout_(){let t=vI;const e=this.token_;if(this.isTokenType(SI)){const n=e.value;"Z"===n?t=bI:"M"===n?t=MI:"ZM"===n&&(t=wI),t!==vI&&this.consume_()}return t}parseGeometryCollectionText_(){if(this.match(II)){const t=[];do{t.push(this.parseGeometry_())}while(this.match(CI));if(this.match(kI))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parsePointText_(){if(this.match(II)){const t=this.parsePoint_();if(this.match(kI))return t}else if(this.isEmptyGeometry_())return null;throw new Error(this.formatErrorMessage_())}parseLineStringText_(){if(this.match(II)){const t=this.parsePointList_();if(this.match(kI))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parsePolygonText_(){if(this.match(II)){const t=this.parseLineStringTextList_();if(this.match(kI))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parseMultiPointText_(){if(this.match(II)){let t;if(t=this.token_.type==II?this.parsePointTextList_():this.parsePointList_(),this.match(kI))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parseMultiLineStringText_(){if(this.match(II)){const t=this.parseLineStringTextList_();if(this.match(kI))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parseMultiPolygonText_(){if(this.match(II)){const t=this.parsePolygonTextList_();if(this.match(kI))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parsePoint_(){const t=[],e=this.layout_.length;for(let n=0;n<e;++n){const e=this.token_;if(!this.match(OI))break;t.push(e.value)}if(t.length==e)return t;throw new Error(this.formatErrorMessage_())}parsePointList_(){const t=[this.parsePoint_()];for(;this.match(CI);)t.push(this.parsePoint_());return t}parsePointTextList_(){const t=[this.parsePointText_()];for(;this.match(CI);)t.push(this.parsePointText_());return t}parseLineStringTextList_(){const t=[this.parseLineStringText_()];for(;this.match(CI);)t.push(this.parseLineStringText_());return t}parsePolygonTextList_(){const t=[this.parsePolygonText_()];for(;this.match(CI);)t.push(this.parsePolygonText_());return t}isEmptyGeometry_(){const t=this.isTokenType(SI)&&this.token_.value==NI;return t&&this.consume_(),t}formatErrorMessage_(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}parseGeometry_(){const t=this.factory,e=t=>new aS(...t),n=n=>{const i=n.map((n=>t.createLinearRing(n.map(e))));return i.length>1?t.createPolygon(i[0],i.slice(1)):t.createPolygon(i[0])},i=this.token_;if(this.match(SI)){const r=i.value;if(this.layout_=this.parseGeometryLayout_(),"GEOMETRYCOLLECTION"==r){const e=this.parseGeometryCollectionText_();return t.createGeometryCollection(e)}switch(r){case"POINT":{const e=this.parsePointText_();return e?t.createPoint(new aS(...e)):t.createPoint()}case"LINESTRING":{const n=this.parseLineStringText_().map(e);return t.createLineString(n)}case"LINEARRING":{const n=this.parseLineStringText_().map(e);return t.createLinearRing(n)}case"POLYGON":{const e=this.parsePolygonText_();return e&&0!==e.length?n(e):t.createPolygon()}case"MULTIPOINT":{const n=this.parseMultiPointText_();if(!n||0===n.length)return t.createMultiPoint();const i=n.map(e).map((e=>t.createPoint(e)));return t.createMultiPoint(i)}case"MULTILINESTRING":{const n=this.parseMultiLineStringText_().map((n=>t.createLineString(n.map(e))));return t.createMultiLineString(n)}case"MULTIPOLYGON":{const e=this.parseMultiPolygonText_();if(!e||0===e.length)return t.createMultiPolygon();const i=e.map(n);return t.createMultiPolygon(i)}default:throw new Error("Invalid geometry type: "+r)}}throw new Error(this.formatErrorMessage_())}}function LI(t){if(t.isEmpty())return"";const e=t.getCoordinate(),n=[e.x,e.y];return void 0===e.z||Number.isNaN(e.z)||n.push(e.z),void 0===e.m||Number.isNaN(e.m)||n.push(e.m),n.join(" ")}function PI(t){const e=t.getCoordinates().map((t=>{const e=[t.x,t.y];return void 0===t.z||Number.isNaN(t.z)||e.push(t.z),void 0===t.m||Number.isNaN(t.m)||e.push(t.m),e})),n=[];for(let t=0,i=e.length;t<i;++t)n.push(e[t].join(" "));return n.join(", ")}function DI(t){const e=[];e.push("("+PI(t.getExteriorRing())+")");for(let n=0,i=t.getNumInteriorRing();n<i;++n)e.push("("+PI(t.getInteriorRingN(n))+")");return e.join(", ")}const zI={Point:LI,LineString:PI,LinearRing:PI,Polygon:DI,MultiPoint:function(t){const e=[];for(let n=0,i=t.getNumGeometries();n<i;++n)e.push("("+LI(t.getGeometryN(n))+")");return e.join(", ")},MultiLineString:function(t){const e=[];for(let n=0,i=t.getNumGeometries();n<i;++n)e.push("("+PI(t.getGeometryN(n))+")");return e.join(", ")},MultiPolygon:function(t){const e=[];for(let n=0,i=t.getNumGeometries();n<i;++n)e.push("("+DI(t.getGeometryN(n))+")");return e.join(", ")},GeometryCollection:function(t){const e=[];for(let n=0,i=t.getNumGeometries();n<i;++n)e.push(FI(t.getGeometryN(n)));return e.join(", ")}};function FI(t){let e=t.getGeometryType();const n=zI[e];e=e.toUpperCase();const i=function(t){let e="";if(t.isEmpty())return e;const n=t.getCoordinate();return void 0===n.z||Number.isNaN(n.z)||(e+="Z"),void 0===n.m||Number.isNaN(n.m)||(e+="M"),e}(t);if(i.length>0&&(e+=" "+i),t.isEmpty())return e+" "+NI;return e+" ("+n(t)+")"}class GI{constructor(t){this.geometryFactory=t||new cI,this.precisionModel=this.geometryFactory.getPrecisionModel()}read(t){const e=new RI(t);return new AI(e,this.geometryFactory).parse()}write(t){return FI(t)}}class qI{constructor(t){this.parser=new GI(t)}write(t){return this.parser.write(t)}static toLineString(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"}}class jI{constructor(){jI.constructor_.apply(this,arguments)}static constructor_(){this._result=null,this._inputLines=Array(2).fill().map((()=>Array(2))),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new aS,this._intPt[1]=new aS,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0}static computeEdgeDistance(t,e,n){const i=Math.abs(n.x-e.x),r=Math.abs(n.y-e.y);let s=-1;if(t.equals(e))s=0;else if(t.equals(n))s=i>r?i:r;else{const n=Math.abs(t.x-e.x),o=Math.abs(t.y-e.y);s=i>r?n:o,0!==s||t.equals(e)||(s=Math.max(n,o))}return iS.isTrue(!(0===s&&!t.equals(e)),"Bad distance calculation"),s}static nonRobustComputeEdgeDistance(t,e,n){const i=t.x-e.x,r=t.y-e.y,s=Math.sqrt(i*i+r*r);return iS.isTrue(!(0===s&&!t.equals(e)),"Invalid distance calculation"),s}getIndexAlongSegment(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]}getTopologySummary(){const t=new KS;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()}computeIntersection(t,e,n,i){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=n,this._inputLines[1][1]=i,this._result=this.computeIntersect(t,e,n,i)}getIntersectionNum(){return this._result}computeIntLineIndex(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map((()=>Array(2))),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){const t=arguments[0];this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}}isProper(){return this.hasIntersection()&&this._isProper}setPrecisionModel(t){this._precisionModel=t}isInteriorIntersection(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){const t=arguments[0];for(let e=0;e<this._result;e++)if(!this._intPt[e].equals2D(this._inputLines[t][0])&&!this._intPt[e].equals2D(this._inputLines[t][1]))return!0;return!1}}getIntersection(t){return this._intPt[t]}isEndPoint(){return this.hasIntersection()&&!this._isProper}hasIntersection(){return this._result!==jI.NO_INTERSECTION}getEdgeDistance(t,e){return jI.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])}isCollinear(){return this._result===jI.COLLINEAR_INTERSECTION}toString(){return qI.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+qI.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()}getEndpoint(t,e){return this._inputLines[t][e]}isIntersection(t){for(let e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1}getIntersectionAlongSegment(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]}}jI.DONT_INTERSECT=0,jI.DO_INTERSECT=1,jI.COLLINEAR=2,jI.NO_INTERSECTION=0,jI.POINT_INTERSECTION=1,jI.COLLINEAR_INTERSECTION=2;class BI extends jI{constructor(){super()}static nearestEndpoint(t,e,n,i){let r=t,s=xI.pointToSegment(t,n,i),o=xI.pointToSegment(e,n,i);return o<s&&(s=o,r=e),o=xI.pointToSegment(n,t,e),o<s&&(s=o,r=n),o=xI.pointToSegment(i,t,e),o<s&&(s=o,r=i),r}isInSegmentEnvelopes(t){const e=new hS(this._inputLines[0][0],this._inputLines[0][1]),n=new hS(this._inputLines[1][0],this._inputLines[1][1]);return e.contains(t)&&n.contains(t)}computeIntersection(){if(3!==arguments.length)return super.computeIntersection.apply(this,arguments);{const t=arguments[0],e=arguments[1],n=arguments[2];if(this._isProper=!1,hS.intersects(e,n,t)&&0===PS.index(e,n,t)&&0===PS.index(n,e,t))return this._isProper=!0,(t.equals(e)||t.equals(n))&&(this._isProper=!1),this._result=jI.POINT_INTERSECTION,null;this._result=jI.NO_INTERSECTION}}intersection(t,e,n,i){let r=this.intersectionSafe(t,e,n,i);return this.isInSegmentEnvelopes(r)||(r=new aS(BI.nearestEndpoint(t,e,n,i))),null!==this._precisionModel&&this._precisionModel.makePrecise(r),r}checkDD(t,e,n,i,r){const s=LS.intersection(t,e,n,i),o=this.isInSegmentEnvelopes(s);JS.out.println("DD in env = "+o+"  --------------------- "+s),r.distance(s)>1e-4&&JS.out.println("Distance = "+r.distance(s))}intersectionSafe(t,e,n,i){let r=mI.intersection(t,e,n,i);return null===r&&(r=BI.nearestEndpoint(t,e,n,i)),r}computeCollinearIntersection(t,e,n,i){const r=hS.intersects(t,e,n),s=hS.intersects(t,e,i),o=hS.intersects(n,i,t),a=hS.intersects(n,i,e);return r&&s?(this._intPt[0]=n,this._intPt[1]=i,jI.COLLINEAR_INTERSECTION):o&&a?(this._intPt[0]=t,this._intPt[1]=e,jI.COLLINEAR_INTERSECTION):r&&o?(this._intPt[0]=n,this._intPt[1]=t,!n.equals(t)||s||a?jI.COLLINEAR_INTERSECTION:jI.POINT_INTERSECTION):r&&a?(this._intPt[0]=n,this._intPt[1]=e,!n.equals(e)||s||o?jI.COLLINEAR_INTERSECTION:jI.POINT_INTERSECTION):s&&o?(this._intPt[0]=i,this._intPt[1]=t,!i.equals(t)||r||a?jI.COLLINEAR_INTERSECTION:jI.POINT_INTERSECTION):s&&a?(this._intPt[0]=i,this._intPt[1]=e,!i.equals(e)||r||o?jI.COLLINEAR_INTERSECTION:jI.POINT_INTERSECTION):jI.NO_INTERSECTION}computeIntersect(t,e,n,i){if(this._isProper=!1,!hS.intersects(t,e,n,i))return jI.NO_INTERSECTION;const r=PS.index(t,e,n),s=PS.index(t,e,i);if(r>0&&s>0||r<0&&s<0)return jI.NO_INTERSECTION;const o=PS.index(n,i,t),a=PS.index(n,i,e);if(o>0&&a>0||o<0&&a<0)return jI.NO_INTERSECTION;return 0===r&&0===s&&0===o&&0===a?this.computeCollinearIntersection(t,e,n,i):(0===r||0===s||0===o||0===a?(this._isProper=!1,t.equals2D(n)||t.equals2D(i)?this._intPt[0]=t:e.equals2D(n)||e.equals2D(i)?this._intPt[0]=e:0===r?this._intPt[0]=new aS(n):0===s?this._intPt[0]=new aS(i):0===o?this._intPt[0]=new aS(t):0===a&&(this._intPt[0]=new aS(e))):(this._isProper=!0,this._intPt[0]=this.intersection(t,e,n,i)),jI.POINT_INTERSECTION)}}class UI{constructor(){UI.constructor_.apply(this,arguments)}static constructor_(){if(this.p0=null,this.p1=null,0===arguments.length)UI.constructor_.call(this,new aS,new aS);else if(1===arguments.length){const t=arguments[0];UI.constructor_.call(this,t.p0,t.p1)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.p0=t,this.p1=e}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];UI.constructor_.call(this,new aS(t,e),new aS(n,i))}}static midPoint(t,e){return new aS((t.x+e.x)/2,(t.y+e.y)/2)}minX(){return Math.min(this.p0.x,this.p1.x)}orientationIndex(){if(arguments[0]instanceof UI){const t=arguments[0],e=PS.index(this.p0,this.p1,t.p0),n=PS.index(this.p0,this.p1,t.p1);return e>=0&&n>=0||e<=0&&n<=0?Math.max(e,n):0}if(arguments[0]instanceof aS){const t=arguments[0];return PS.index(this.p0,this.p1,t)}}toGeometry(t){return t.createLineString([this.p0,this.p1])}isVertical(){return this.p0.x===this.p1.x}equals(t){if(!(t instanceof UI))return!1;const e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)}intersection(t){const e=new BI;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null}project(){if(arguments[0]instanceof aS){const t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new aS(t);const e=this.projectionFactor(t),n=new aS;return n.x=this.p0.x+e*(this.p1.x-this.p0.x),n.y=this.p0.y+e*(this.p1.y-this.p0.y),n}if(arguments[0]instanceof UI){const t=arguments[0],e=this.projectionFactor(t.p0),n=this.projectionFactor(t.p1);if(e>=1&&n>=1)return null;if(e<=0&&n<=0)return null;let i=this.project(t.p0);e<0&&(i=this.p0),e>1&&(i=this.p1);let r=this.project(t.p1);return n<0&&(r=this.p0),n>1&&(r=this.p1),new UI(i,r)}}normalize(){this.p1.compareTo(this.p0)<0&&this.reverse()}angle(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)}getCoordinate(t){return 0===t?this.p0:this.p1}distancePerpendicular(t){return xI.pointToLinePerpendicular(t,this.p0,this.p1)}minY(){return Math.min(this.p0.y,this.p1.y)}midPoint(){return UI.midPoint(this.p0,this.p1)}projectionFactor(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;const e=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,i=e*e+n*n;if(i<=0)return YN.NaN;return((t.x-this.p0.x)*e+(t.y-this.p0.y)*n)/i}closestPoints(t){const e=this.intersection(t);if(null!==e)return[e,e];const n=new Array(2).fill(null);let i=YN.MAX_VALUE,r=null;const s=this.closestPoint(t.p0);i=s.distance(t.p0),n[0]=s,n[1]=t.p0;const o=this.closestPoint(t.p1);r=o.distance(t.p1),r<i&&(i=r,n[0]=o,n[1]=t.p1);const a=t.closestPoint(this.p0);r=a.distance(this.p0),r<i&&(i=r,n[0]=this.p0,n[1]=a);const l=t.closestPoint(this.p1);return r=l.distance(this.p1),r<i&&(i=r,n[0]=this.p1,n[1]=l),n}closestPoint(t){const e=this.projectionFactor(t);if(e>0&&e<1)return this.project(t);return this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1}maxX(){return Math.max(this.p0.x,this.p1.x)}getLength(){return this.p0.distance(this.p1)}compareTo(t){const e=t,n=this.p0.compareTo(e.p0);return 0!==n?n:this.p1.compareTo(e.p1)}reverse(){const t=this.p0;this.p0=this.p1,this.p1=t}equalsTopo(t){return this.p0.equals(t.p0)&&this.p1.equals(t.p1)||this.p0.equals(t.p1)&&this.p1.equals(t.p0)}lineIntersection(t){return mI.intersection(this.p0,this.p1,t.p0,t.p1)}maxY(){return Math.max(this.p0.y,this.p1.y)}pointAlongOffset(t,e){const n=this.p0.x+t*(this.p1.x-this.p0.x),i=this.p0.y+t*(this.p1.y-this.p0.y),r=this.p1.x-this.p0.x,s=this.p1.y-this.p0.y,o=Math.sqrt(r*r+s*s);let a=0,l=0;if(0!==e){if(o<=0)throw new IllegalStateException("Cannot compute offset from zero-length line segment");a=e*r/o,l=e*s/o}return new aS(n-l,i+a)}setCoordinates(){if(1===arguments.length){const t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.p0.x=t.x,this.p0.y=t.y,this.p1.x=e.x,this.p1.y=e.y}}segmentFraction(t){let e=this.projectionFactor(t);return e<0?e=0:(e>1||YN.isNaN(e))&&(e=1),e}toString(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"}isHorizontal(){return this.p0.y===this.p1.y}reflect(t){const e=this.p1.getY()-this.p0.getY(),n=this.p0.getX()-this.p1.getX(),i=this.p0.getY()*(this.p1.getX()-this.p0.getX())-this.p0.getX()*(this.p1.getY()-this.p0.getY()),r=e*e+n*n,s=e*e-n*n,o=t.getX(),a=t.getY();return new aS((-s*o-2*e*n*a-2*e*i)/r,(s*a-2*e*n*o-2*n*i)/r)}distance(){if(arguments[0]instanceof UI){const t=arguments[0];return xI.segmentToSegment(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof aS){const t=arguments[0];return xI.pointToSegment(t,this.p0,this.p1)}}pointAlong(t){const e=new aS;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e}hashCode(){let t=YN.doubleToLongBits(this.p0.x);t^=31*YN.doubleToLongBits(this.p0.y);const e=Math.trunc(t)^Math.trunc(t>>32);let n=YN.doubleToLongBits(this.p1.x);n^=31*YN.doubleToLongBits(this.p1.y);return e^(Math.trunc(n)^Math.trunc(n>>32))}get interfaces_(){return[JN,QN]}}class YI{constructor(){YI.constructor_.apply(this,arguments)}static constructor_(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new UI,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof vS&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1];YI.constructor_.call(this,t.getCoordinates(),e)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1];this._srcPts=t,this._isClosed=YI.isClosed(t),this._snapTolerance=e}}static isClosed(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])}snapVertices(t,e){const n=this._isClosed?t.size()-1:t.size();for(let i=0;i<n;i++){const n=t.get(i),r=this.findSnapForVertex(n,e);null!==r&&(t.set(i,new aS(r)),0===i&&this._isClosed&&t.set(t.size()-1,new aS(r)))}}findSnapForVertex(t,e){for(let n=0;n<e.length;n++){if(t.equals2D(e[n]))return null;if(t.distance(e[n])<this._snapTolerance)return e[n]}return null}snapTo(t){const e=new HS(this._srcPts);this.snapVertices(e,t),this.snapSegments(e,t);return e.toCoordinateArray()}snapSegments(t,e){if(0===e.length)return null;let n=e.length;e[0].equals2D(e[e.length-1])&&(n=e.length-1);for(let i=0;i<n;i++){const n=e[i],r=this.findSegmentIndexToSnap(n,t);r>=0&&t.add(r+1,new aS(n),!1)}}findSegmentIndexToSnap(t,e){let n=YN.MAX_VALUE,i=-1;for(let r=0;r<e.size()-1;r++){if(this._seg.p0=e.get(r),this._seg.p1=e.get(r+1),this._seg.p0.equals2D(t)||this._seg.p1.equals2D(t)){if(this._allowSnappingToSourceVertices)continue;return-1}const s=this._seg.distance(t);s<this._snapTolerance&&s<n&&(n=s,i=r)}return i}setAllowSnappingToSourceVertices(t){this._allowSnappingToSourceVertices=t}}class WI{constructor(){WI.constructor_.apply(this,arguments)}static constructor_(){this._srcGeom=null;const t=arguments[0];this._srcGeom=t}static snap(t,e,n){const i=new Array(2).fill(null),r=new WI(t);i[0]=r.snapTo(e,n);const s=new WI(e);return i[1]=s.snapTo(i[0],n),i}static computeOverlaySnapTolerance(){if(1===arguments.length){const t=arguments[0];let e=WI.computeSizeBasedSnapTolerance(t);const n=t.getPrecisionModel();if(n.getType()===aI.FIXED){const t=1/n.getScale()*2/1.415;t>e&&(e=t)}return e}if(2===arguments.length){const t=arguments[0],e=arguments[1];return Math.min(WI.computeOverlaySnapTolerance(t),WI.computeOverlaySnapTolerance(e))}}static computeSizeBasedSnapTolerance(t){const e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*WI.SNAP_PRECISION_FACTOR}static snapToSelf(t,e,n){return new WI(t).snapToSelf(e,n)}snapTo(t,e){const n=this.extractTargetCoordinates(t);return new $I(e,n).transform(this._srcGeom)}snapToSelf(t,e){const n=this.extractTargetCoordinates(this._srcGeom),i=new $I(t,n,!0).transform(this._srcGeom);let r=i;return e&&BN(r,DS)&&(r=i.buffer(0)),r}computeSnapTolerance(t){return this.computeMinimumSegmentLength(t)/10}extractTargetCoordinates(t){const e=new qS,n=t.getCoordinates();for(let t=0;t<n.length;t++)e.add(n[t]);return e.toArray(new Array(0).fill(null))}computeMinimumSegmentLength(t){let e=YN.MAX_VALUE;for(let n=0;n<t.length-1;n++){const i=t[n].distance(t[n+1]);i<e&&(e=i)}return e}}WI.SNAP_PRECISION_FACTOR=1e-9;class $I extends yI{constructor(){super(),$I.constructor_.apply(this,arguments)}static constructor_(){if(this._snapTolerance=null,this._snapPts=null,this._isSelfSnap=!1,2===arguments.length){const t=arguments[0],e=arguments[1];this._snapTolerance=t,this._snapPts=e}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this._snapTolerance=t,this._snapPts=e,this._isSelfSnap=n}}snapLine(t,e){const n=new YI(t,this._snapTolerance);return n.setAllowSnappingToSourceVertices(this._isSelfSnap),n.snapTo(e)}transformCoordinates(t,e){const n=t.toCoordinateArray(),i=this.snapLine(n,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(i)}}class XI{constructor(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=new UN,this._commonSignExp=null}getCommon(){return YN.longBitsToDouble(this._commonBits)}add(t){const e=YN.doubleToLongBits(t);if(this._isFirst)return this._commonBits=e,this._commonSignExp=XI.signExpBits(this._commonBits),this._isFirst=!1,null;if(XI.signExpBits(e)!==this._commonSignExp)return this._commonBits.high=0,this._commonBits.low=0,null;this._commonMantissaBitsCount=XI.numCommonMostSigMantissaBits(this._commonBits,e),this._commonBits=XI.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))}toString(){if(1===arguments.length){const t=arguments[0],e=YN.longBitsToDouble(t),n="0000000000000000000000000000000000000000000000000000000000000000"+UN.toBinaryString(t),i=n.substring(n.length-64);return i.substring(0,1)+"  "+i.substring(1,12)+"(exp) "+i.substring(12)+" [ "+e+" ]"}}getClass(){return XI}get interfaces_(){return[]}static getBit(t,e){const n=1<<e%32;return e<32?0!=(t.low&n)?1:0:0!=(t.high&n)?1:0}static signExpBits(t){return t.high>>>20}static zeroLowerBits(t,e){let n="low";if(e>32&&(t.low=0,e%=32,n="high"),e>0){const i=e<32?~((1<<e)-1):0;t[n]&=i}return t}static numCommonMostSigMantissaBits(t,e){let n=0;for(let i=52;i>=0;i--){if(XI.getBit(t,i)!==XI.getBit(e,i))return n;n++}return 52}}class VI{constructor(){VI.constructor_.apply(this,arguments)}static constructor_(){this._commonCoord=null,this._ccFilter=new HI}addCommonBits(t){const e=new ZI(this._commonCoord);t.apply(e),t.geometryChanged()}removeCommonBits(t){if(0===this._commonCoord.x&&0===this._commonCoord.y)return t;const e=new aS(this._commonCoord);e.x=-e.x,e.y=-e.y;const n=new ZI(e);return t.apply(n),t.geometryChanged(),t}getCommonCoordinate(){return this._commonCoord}add(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()}}class HI{constructor(){HI.constructor_.apply(this,arguments)}static constructor_(){this._commonBitsX=new XI,this._commonBitsY=new XI}filter(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)}getCommonCoordinate(){return new aS(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())}get interfaces_(){return[uS]}}class ZI{constructor(){ZI.constructor_.apply(this,arguments)}static constructor_(){this.trans=null;const t=arguments[0];this.trans=t}filter(t,e){const n=t.getOrdinate(e,0)+this.trans.x,i=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,n),t.setOrdinate(e,1,i)}isDone(){return!1}isGeometryChanged(){return!0}get interfaces_(){return[xS]}}VI.CommonCoordinateFilter=HI,VI.Translater=ZI;class JI{static toLocationSymbol(t){switch(t){case JI.EXTERIOR:return"e";case JI.BOUNDARY:return"b";case JI.INTERIOR:return"i";case JI.NONE:return"-"}throw new HN("Unknown location value: "+t)}}JI.INTERIOR=0,JI.BOUNDARY=1,JI.EXTERIOR=2,JI.NONE=-1;class QI{constructor(){QI.constructor_.apply(this,arguments)}static constructor_(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;const t=arguments[0];this._p=t}static locatePointInRing(){if(arguments[0]instanceof aS&&BN(arguments[1],$N)){const t=arguments[1],e=new QI(arguments[0]),n=new aS,i=new aS;for(let r=1;r<t.size();r++)if(t.getCoordinate(r,n),t.getCoordinate(r-1,i),e.countSegment(n,i),e.isOnSegment())return e.getLocation();return e.getLocation()}if(arguments[0]instanceof aS&&arguments[1]instanceof Array){const t=arguments[1],e=new QI(arguments[0]);for(let n=1;n<t.length;n++){const i=t[n],r=t[n-1];if(e.countSegment(i,r),e.isOnSegment())return e.getLocation()}return e.getLocation()}}countSegment(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){let n=t.x,i=e.x;return n>i&&(n=e.x,i=t.x),this._p.x>=n&&this._p.x<=i&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){let n=PS.index(t,e,this._p);if(n===PS.COLLINEAR)return this._isPointOnSegment=!0,null;e.y<t.y&&(n=-n),n===PS.LEFT&&this._crossingCount++}}isPointInPolygon(){return this.getLocation()!==JI.EXTERIOR}getLocation(){return this._isPointOnSegment?JI.BOUNDARY:this._crossingCount%2==1?JI.INTERIOR:JI.EXTERIOR}isOnSegment(){return this._isPointOnSegment}}class KI{static isOnLine(){if(arguments[0]instanceof aS&&BN(arguments[1],$N)){const t=arguments[0],e=arguments[1],n=new BI,i=new aS,r=new aS,s=e.size();for(let o=1;o<s;o++)if(e.getCoordinate(o-1,i),e.getCoordinate(o,r),n.computeIntersection(t,i,r),n.hasIntersection())return!0;return!1}if(arguments[0]instanceof aS&&arguments[1]instanceof Array){const t=arguments[0],e=arguments[1],n=new BI;for(let i=1;i<e.length;i++){const r=e[i-1],s=e[i];if(n.computeIntersection(t,r,s),n.hasIntersection())return!0}return!1}}static locateInRing(t,e){return QI.locatePointInRing(t,e)}static isInRing(t,e){return KI.locateInRing(t,e)!==JI.EXTERIOR}}class tk{isInBoundary(t){}}class ek{isInBoundary(t){return t%2==1}get interfaces_(){return[tk]}}class nk{isInBoundary(t){return t>0}get interfaces_(){return[tk]}}class ik{isInBoundary(t){return t>1}get interfaces_(){return[tk]}}class rk{isInBoundary(t){return 1===t}get interfaces_(){return[tk]}}tk.Mod2BoundaryNodeRule=ek,tk.EndPointBoundaryNodeRule=nk,tk.MultiValentEndPointBoundaryNodeRule=ik,tk.MonoValentEndPointBoundaryNodeRule=rk,tk.MOD2_BOUNDARY_RULE=new ek,tk.ENDPOINT_BOUNDARY_RULE=new nk,tk.MULTIVALENT_ENDPOINT_BOUNDARY_RULE=new ik,tk.MONOVALENT_ENDPOINT_BOUNDARY_RULE=new rk,tk.OGC_SFS_BOUNDARY_RULE=tk.MOD2_BOUNDARY_RULE;class sk{hasNext(){}next(){}remove(){}}class ok{constructor(){ok.constructor_.apply(this,arguments)}static constructor_(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;const t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()}static isAtomic(t){return!(t instanceof BS)}next(){if(this._atStart)return this._atStart=!1,ok.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new IS;const t=this._parent.getGeometryN(this._index++);return t instanceof BS?(this._subcollectionIterator=new ok(t),this._subcollectionIterator.next()):t}remove(){throw new gS(this.getClass().getName())}hasNext(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)}get interfaces_(){return[sk]}}class ak{constructor(){ak.constructor_.apply(this,arguments)}static constructor_(){if(this._boundaryRule=tk.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0===arguments.length);else if(1===arguments.length){const t=arguments[0];if(null===t)throw new HN("Rule must be non-null");this._boundaryRule=t}}locateInPolygonRing(t,e){return e.getEnvelopeInternal().intersects(t)?KI.locateInRing(t,e.getCoordinates()):JI.EXTERIOR}intersects(t,e){return this.locate(t,e)!==JI.EXTERIOR}updateLocationInfo(t){t===JI.INTERIOR&&(this._isIn=!0),t===JI.BOUNDARY&&this._numBoundaries++}computeLocation(t,e){if(e instanceof MS&&this.updateLocationInfo(this.locateOnPoint(t,e)),e instanceof vS)this.updateLocationInfo(this.locateOnLineString(t,e));else if(e instanceof zS)this.updateLocationInfo(this.locateInPolygon(t,e));else if(e instanceof hI){const n=e;for(let e=0;e<n.getNumGeometries();e++){const i=n.getGeometryN(e);this.updateLocationInfo(this.locateOnLineString(t,i))}}else if(e instanceof nI){const n=e;for(let e=0;e<n.getNumGeometries();e++){const i=n.getGeometryN(e);this.updateLocationInfo(this.locateInPolygon(t,i))}}else if(e instanceof BS){const n=new ok(e);for(;n.hasNext();){const i=n.next();i!==e&&this.computeLocation(t,i)}}}locateOnPoint(t,e){return e.getCoordinate().equals2D(t)?JI.INTERIOR:JI.EXTERIOR}locateOnLineString(t,e){if(!e.getEnvelopeInternal().intersects(t))return JI.EXTERIOR;const n=e.getCoordinateSequence();return e.isClosed()||!t.equals(n.getCoordinate(0))&&!t.equals(n.getCoordinate(n.size()-1))?KI.isOnLine(t,n)?JI.INTERIOR:JI.EXTERIOR:JI.BOUNDARY}locateInPolygon(t,e){if(e.isEmpty())return JI.EXTERIOR;const n=e.getExteriorRing(),i=this.locateInPolygonRing(t,n);if(i===JI.EXTERIOR)return JI.EXTERIOR;if(i===JI.BOUNDARY)return JI.BOUNDARY;for(let n=0;n<e.getNumInteriorRing();n++){const i=e.getInteriorRingN(n),r=this.locateInPolygonRing(t,i);if(r===JI.INTERIOR)return JI.EXTERIOR;if(r===JI.BOUNDARY)return JI.BOUNDARY}return JI.INTERIOR}locate(t,e){return e.isEmpty()?JI.EXTERIOR:e instanceof vS?this.locateOnLineString(t,e):e instanceof zS?this.locateInPolygon(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?JI.BOUNDARY:this._numBoundaries>0||this._isIn?JI.INTERIOR:JI.EXTERIOR)}}class lk{static octant(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new HN("Cannot compute the octant for point ( "+t+", "+e+" )");const n=Math.abs(t),i=Math.abs(e);return t>=0?e>=0?n>=i?0:1:n>=i?7:6:e>=0?n>=i?3:2:n>=i?4:5}if(arguments[0]instanceof aS&&arguments[1]instanceof aS){const t=arguments[0],e=arguments[1],n=e.x-t.x,i=e.y-t.y;if(0===n&&0===i)throw new HN("Cannot compute the octant for two identical points "+t);return lk.octant(n,i)}}}class hk{getCoordinates(){}size(){}getCoordinate(t){}isClosed(){}setData(t){}getData(){}}class ck{constructor(){ck.constructor_.apply(this,arguments)}static constructor_(){this._pts=null,this._data=null;const t=arguments[0],e=arguments[1];this._pts=t,this._data=e}getCoordinates(){return this._pts}size(){return this._pts.length}getCoordinate(t){return this._pts[t]}isClosed(){return this._pts[0].equals(this._pts[this._pts.length-1])}getSegmentOctant(t){return t===this._pts.length-1?-1:lk.octant(this.getCoordinate(t),this.getCoordinate(t+1))}setData(t){this._data=t}getData(){return this._data}toString(){return qI.toLineString(new tI(this._pts))}get interfaces_(){return[hk]}}class uk{getBounds(){}}class fk{constructor(){fk.constructor_.apply(this,arguments)}static constructor_(){this._bounds=null,this._item=null;const t=arguments[0],e=arguments[1];this._bounds=t,this._item=e}getItem(){return this._item}getBounds(){return this._bounds}get interfaces_(){return[uk,QN]}}class dk{constructor(){dk.constructor_.apply(this,arguments)}static constructor_(){this._size=null,this._items=null,this._size=0,this._items=new kS,this._items.add(null)}poll(){if(this.isEmpty())return null;const t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t}size(){return this._size}reorder(t){let e=null;const n=this._items.get(t);for(;2*t<=this._size&&(e=2*t,e!==this._size&&this._items.get(e+1).compareTo(this._items.get(e))<0&&e++,this._items.get(e).compareTo(n)<0);t=e)this._items.set(t,this._items.get(e));this._items.set(t,n)}clear(){this._size=0,this._items.clear()}peek(){if(this.isEmpty())return null;return this._items.get(1)}isEmpty(){return 0===this._size}add(t){this._items.add(null),this._size+=1;let e=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,t)}}class pk{insert(t,e){}remove(t,e){}query(){}}class gk{constructor(){gk.constructor_.apply(this,arguments)}static constructor_(){if(this._childBoundables=new kS,this._bounds=null,this._level=null,0===arguments.length);else if(1===arguments.length){const t=arguments[0];this._level=t}}getLevel(){return this._level}size(){return this._childBoundables.size()}getChildBoundables(){return this._childBoundables}addChildBoundable(t){iS.isTrue(null===this._bounds),this._childBoundables.add(t)}isEmpty(){return this._childBoundables.isEmpty()}getBounds(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds}get interfaces_(){return[uk,QN]}}const _k={reverseOrder:function(){return{compare:(t,e)=>e.compareTo(t)}},min:function(t){return _k.sort(t),t.get(0)},sort:function(t,e){const n=t.toArray();e?CS.sort(n,e):CS.sort(n);const i=t.iterator();for(let t=0,e=n.length;t<e;t++)i.next(),i.set(n[t])},singletonList:function(t){const e=new kS;return e.add(t),e}};class yk{static maxDistance(t,e,n,i,r,s,o,a){let l=yk.distance(t,e,r,s);return l=Math.max(l,yk.distance(t,e,o,a)),l=Math.max(l,yk.distance(n,i,r,s)),l=Math.max(l,yk.distance(n,i,o,a)),l}static distance(t,e,n,i){const r=n-t,s=i-e;return Math.sqrt(r*r+s*s)}static maximumDistance(t,e){const n=Math.min(t.getMinX(),e.getMinX()),i=Math.min(t.getMinY(),e.getMinY()),r=Math.max(t.getMaxX(),e.getMaxX()),s=Math.max(t.getMaxY(),e.getMaxY());return yk.distance(n,i,r,s)}static minMaxDistance(t,e){const n=t.getMinX(),i=t.getMinY(),r=t.getMaxX(),s=t.getMaxY(),o=e.getMinX(),a=e.getMinY(),l=e.getMaxX(),h=e.getMaxY();let c=yk.maxDistance(n,i,n,s,o,a,o,h);return c=Math.min(c,yk.maxDistance(n,i,n,s,o,a,l,a)),c=Math.min(c,yk.maxDistance(n,i,n,s,l,h,o,h)),c=Math.min(c,yk.maxDistance(n,i,n,s,l,h,l,a)),c=Math.min(c,yk.maxDistance(n,i,r,i,o,a,o,h)),c=Math.min(c,yk.maxDistance(n,i,r,i,o,a,l,a)),c=Math.min(c,yk.maxDistance(n,i,r,i,l,h,o,h)),c=Math.min(c,yk.maxDistance(n,i,r,i,l,h,l,a)),c=Math.min(c,yk.maxDistance(r,s,n,s,o,a,o,h)),c=Math.min(c,yk.maxDistance(r,s,n,s,o,a,l,a)),c=Math.min(c,yk.maxDistance(r,s,n,s,l,h,o,h)),c=Math.min(c,yk.maxDistance(r,s,n,s,l,h,l,a)),c=Math.min(c,yk.maxDistance(r,s,r,i,o,a,o,h)),c=Math.min(c,yk.maxDistance(r,s,r,i,o,a,l,a)),c=Math.min(c,yk.maxDistance(r,s,r,i,l,h,o,h)),c=Math.min(c,yk.maxDistance(r,s,r,i,l,h,l,a)),c}}class mk{constructor(){mk.constructor_.apply(this,arguments)}static constructor_(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;const t=arguments[0],e=arguments[1],n=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=n,this._distance=this.distance()}static area(t){return t.getBounds().getArea()}static isComposite(t){return t instanceof gk}maximumDistance(){return yk.maximumDistance(this._boundable1.getBounds(),this._boundable2.getBounds())}expandToQueue(t,e){const n=mk.isComposite(this._boundable1),i=mk.isComposite(this._boundable2);if(n&&i)return mk.area(this._boundable1)>mk.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,!1,t,e),null):(this.expand(this._boundable2,this._boundable1,!0,t,e),null);if(n)return this.expand(this._boundable1,this._boundable2,!1,t,e),null;if(i)return this.expand(this._boundable2,this._boundable1,!0,t,e),null;throw new HN("neither boundable is composite")}isLeaves(){return!(mk.isComposite(this._boundable1)||mk.isComposite(this._boundable2))}compareTo(t){const e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0}expand(t,e,n,i,r){for(let s=t.getChildBoundables().iterator();s.hasNext();){const t=s.next();let o=null;o=n?new mk(e,t,this._itemDistance):new mk(t,e,this._itemDistance),o.getDistance()<r&&i.add(o)}}getBoundable(t){return 0===t?this._boundable1:this._boundable2}getDistance(){return this._distance}distance(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())}get interfaces_(){return[JN]}}class xk{visitItem(t){}}class vk{constructor(){vk.constructor_.apply(this,arguments)}static constructor_(){if(this._root=null,this._built=!1,this._itemBoundables=new kS,this._nodeCapacity=null,0===arguments.length)vk.constructor_.call(this,vk.DEFAULT_NODE_CAPACITY);else if(1===arguments.length){const t=arguments[0];iS.isTrue(t>1,"Node capacity must be greater than 1"),this._nodeCapacity=t}}static compareDoubles(t,e){return t>e?1:t<e?-1:0}queryInternal(){if(BN(arguments[2],xk)&&arguments[0]instanceof Object&&arguments[1]instanceof gk){const t=arguments[0],e=arguments[2],n=arguments[1].getChildBoundables();for(let i=0;i<n.size();i++){const r=n.get(i);this.getIntersectsOp().intersects(r.getBounds(),t)&&(r instanceof gk?this.queryInternal(t,r,e):r instanceof fk?e.visitItem(r.getItem()):iS.shouldNeverReachHere())}}else if(BN(arguments[2],SS)&&arguments[0]instanceof Object&&arguments[1]instanceof gk){const t=arguments[0],e=arguments[2],n=arguments[1].getChildBoundables();for(let i=0;i<n.size();i++){const r=n.get(i);this.getIntersectsOp().intersects(r.getBounds(),t)&&(r instanceof gk?this.queryInternal(t,r,e):r instanceof fk?e.add(r.getItem()):iS.shouldNeverReachHere())}}}getNodeCapacity(){return this._nodeCapacity}lastNode(t){return t.get(t.size()-1)}size(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){let t=0;for(let e=arguments[0].getChildBoundables().iterator();e.hasNext();){const n=e.next();n instanceof gk?t+=this.size(n):n instanceof fk&&(t+=1)}return t}}removeItem(t,e){let n=null;for(let i=t.getChildBoundables().iterator();i.hasNext();){const t=i.next();t instanceof fk&&t.getItem()===e&&(n=t)}return null!==n&&(t.getChildBoundables().remove(n),!0)}itemsTree(){if(0===arguments.length){this.build();const t=this.itemsTree(this._root);return null===t?new kS:t}if(1===arguments.length){const t=arguments[0],e=new kS;for(let n=t.getChildBoundables().iterator();n.hasNext();){const t=n.next();if(t instanceof gk){const n=this.itemsTree(t);null!==n&&e.add(n)}else t instanceof fk?e.add(t.getItem()):iS.shouldNeverReachHere()}return e.size()<=0?null:e}}insert(t,e){iS.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new fk(t,e))}boundablesAtLevel(){if(1===arguments.length){const t=arguments[0],e=new kS;return this.boundablesAtLevel(t,this._root,e),e}if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];if(iS.isTrue(t>-2),e.getLevel()===t)return n.add(e),null;for(let i=e.getChildBoundables().iterator();i.hasNext();){const e=i.next();e instanceof gk?this.boundablesAtLevel(t,e,n):(iS.isTrue(e instanceof fk),-1===t&&n.add(e))}return null}}query(){if(1===arguments.length){const t=arguments[0];this.build();const e=new kS;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.queryInternal(t,this._root,e),e}if(2===arguments.length){const t=arguments[0],e=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.queryInternal(t,this._root,e)}}build(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0}getRoot(){return this.build(),this._root}remove(){if(2===arguments.length){const t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.remove(t,this._root,e)}if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];let i=this.removeItem(e,n);if(i)return!0;let r=null;for(let s=e.getChildBoundables().iterator();s.hasNext();){const e=s.next();if(this.getIntersectsOp().intersects(e.getBounds(),t)&&(e instanceof gk&&(i=this.remove(t,e,n),i))){r=e;break}}return null!==r&&r.getChildBoundables().isEmpty()&&e.getChildBoundables().remove(r),i}}createHigherLevels(t,e){iS.isTrue(!t.isEmpty());const n=this.createParentBoundables(t,e+1);return 1===n.size()?n.get(0):this.createHigherLevels(n,e+1)}depth(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){let t=0;for(let e=arguments[0].getChildBoundables().iterator();e.hasNext();){const n=e.next();if(n instanceof gk){const e=this.depth(n);e>t&&(t=e)}}return t+1}}createParentBoundables(t,e){iS.isTrue(!t.isEmpty());const n=new kS;n.add(this.createNode(e));const i=new kS(t);_k.sort(i,this.getComparator());for(let t=i.iterator();t.hasNext();){const i=t.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(e)),this.lastNode(n).addChildBoundable(i)}return n}isEmpty(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()}get interfaces_(){return[QN]}}vk.IntersectsOp=function(){},vk.DEFAULT_NODE_CAPACITY=10;class bk{distance(t,e){}}class Mk extends vk{constructor(){super(),Mk.constructor_.apply(this,arguments)}static constructor_(){if(0===arguments.length)Mk.constructor_.call(this,Mk.DEFAULT_NODE_CAPACITY);else if(1===arguments.length){const t=arguments[0];vk.constructor_.call(this,t)}}static centreX(t){return Mk.avg(t.getMinX(),t.getMaxX())}static avg(t,e){return(t+e)/2}static getItems(t){const e=new Array(t.size()).fill(null);let n=0;for(;!t.isEmpty();){const i=t.poll();e[n]=i.getBoundable(0).getItem(),n++}return e}static centreY(t){return Mk.avg(t.getMinY(),t.getMaxY())}createParentBoundablesFromVerticalSlices(t,e){iS.isTrue(t.length>0);const n=new kS;for(let i=0;i<t.length;i++)n.addAll(this.createParentBoundablesFromVerticalSlice(t[i],e));return n}nearestNeighbourK(){if(2===arguments.length){const t=arguments[0],e=arguments[1];return this.nearestNeighbourK(t,YN.POSITIVE_INFINITY,e)}if(3===arguments.length){const t=arguments[0],e=arguments[2];let n=arguments[1];const i=new dk;i.add(t);const r=new dk;for(;!i.isEmpty()&&n>=0;){const t=i.poll(),s=t.getDistance();if(s>=n)break;if(t.isLeaves())if(r.size()<e)r.add(t);else{r.peek().getDistance()>s&&(r.poll(),r.add(t));n=r.peek().getDistance()}else t.expandToQueue(i,n)}return Mk.getItems(r)}}createNode(t){return new wk(t)}size(){return 0===arguments.length?super.size.call(this):super.size.apply(this,arguments)}insert(){if(!(2===arguments.length&&arguments[1]instanceof Object&&arguments[0]instanceof hS))return super.insert.apply(this,arguments);{const t=arguments[0],e=arguments[1];if(t.isNull())return null;super.insert.call(this,t,e)}}getIntersectsOp(){return Mk.intersectsOp}verticalSlices(t,e){const n=Math.trunc(Math.ceil(t.size()/e)),i=new Array(e).fill(null),r=t.iterator();for(let t=0;t<e;t++){i[t]=new kS;let e=0;for(;r.hasNext()&&e<n;){const n=r.next();i[t].add(n),e++}}return i}query(){if(1===arguments.length){const t=arguments[0];return super.query.call(this,t)}if(2===arguments.length){const t=arguments[0],e=arguments[1];super.query.call(this,t,e)}}getComparator(){return Mk.yComparator}createParentBoundablesFromVerticalSlice(t,e){return super.createParentBoundables.call(this,t,e)}remove(){if(2===arguments.length&&arguments[1]instanceof Object&&arguments[0]instanceof hS){const t=arguments[0],e=arguments[1];return super.remove.call(this,t,e)}return super.remove.apply(this,arguments)}depth(){return 0===arguments.length?super.depth.call(this):super.depth.apply(this,arguments)}createParentBoundables(t,e){iS.isTrue(!t.isEmpty());const n=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),i=new kS(t);_k.sort(i,Mk.xComparator);const r=this.verticalSlices(i,Math.trunc(Math.ceil(Math.sqrt(n))));return this.createParentBoundablesFromVerticalSlices(r,e)}nearestNeighbour(){if(1===arguments.length){if(BN(arguments[0],bk)){const t=arguments[0];if(this.isEmpty())return null;const e=new mk(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(e)}if(arguments[0]instanceof mk){const t=arguments[0];let e=YN.POSITIVE_INFINITY,n=null;const i=new dk;for(i.add(t);!i.isEmpty()&&e>0;){const t=i.poll(),r=t.getDistance();if(r>=e)break;t.isLeaves()?(e=r,n=t):t.expandToQueue(i,e)}return null===n?null:[n.getBoundable(0).getItem(),n.getBoundable(1).getItem()]}}else{if(2===arguments.length){const t=arguments[0],e=arguments[1];if(this.isEmpty()||t.isEmpty())return null;const n=new mk(this.getRoot(),t.getRoot(),e);return this.nearestNeighbour(n)}if(3===arguments.length){const t=arguments[2],e=new fk(arguments[0],arguments[1]),n=new mk(this.getRoot(),e,t);return this.nearestNeighbour(n)[0]}if(4===arguments.length){const t=arguments[2],e=arguments[3],n=new fk(arguments[0],arguments[1]),i=new mk(this.getRoot(),n,t);return this.nearestNeighbourK(i,e)}}}isWithinDistance(){if(2===arguments.length){const t=arguments[0],e=arguments[1];let n=YN.POSITIVE_INFINITY;const i=new dk;for(i.add(t);!i.isEmpty();){const t=i.poll(),r=t.getDistance();if(r>e)return!1;if(t.maximumDistance()<=e)return!0;if(t.isLeaves()){if(n=r,n<=e)return!0}else t.expandToQueue(i,n)}return!1}if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=new mk(this.getRoot(),t.getRoot(),e);return this.isWithinDistance(i,n)}}get interfaces_(){return[pk,QN]}}class wk extends gk{constructor(){super(),wk.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0];gk.constructor_.call(this,t)}computeBounds(){let t=null;for(let e=this.getChildBoundables().iterator();e.hasNext();){const n=e.next();null===t?t=new hS(n.getBounds()):t.expandToInclude(n.getBounds())}return t}}Mk.STRtreeNode=wk,Mk.xComparator=new class{get interfaces_(){return[tS]}compare(t,e){return vk.compareDoubles(Mk.centreX(t.getBounds()),Mk.centreX(e.getBounds()))}},Mk.yComparator=new class{get interfaces_(){return[tS]}compare(t,e){return vk.compareDoubles(Mk.centreY(t.getBounds()),Mk.centreY(e.getBounds()))}},Mk.intersectsOp=new class{get interfaces_(){return[IntersectsOp]}intersects(t,e){return t.intersects(e)}},Mk.DEFAULT_NODE_CAPACITY=10;class Ek{static relativeSign(t,e){return t<e?-1:t>e?1:0}static compare(t,e,n){if(e.equals2D(n))return 0;const i=Ek.relativeSign(e.x,n.x),r=Ek.relativeSign(e.y,n.y);switch(t){case 0:return Ek.compareValue(i,r);case 1:return Ek.compareValue(r,i);case 2:return Ek.compareValue(r,-i);case 3:return Ek.compareValue(-i,r);case 4:return Ek.compareValue(-i,-r);case 5:return Ek.compareValue(-r,-i);case 6:return Ek.compareValue(-r,i);case 7:return Ek.compareValue(i,-r)}return iS.shouldNeverReachHere("invalid octant value"),0}static compareValue(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0}}class Nk{constructor(){Nk.constructor_.apply(this,arguments)}static constructor_(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this._segString=t,this.coord=new aS(e),this.segmentIndex=n,this._segmentOctant=i,this._isInterior=!e.equals2D(t.getCoordinate(n))}getCoordinate(){return this.coord}print(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)}compareTo(t){const e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:this._isInterior?e._isInterior?Ek.compare(this._segmentOctant,this.coord,e.coord):1:-1}isEndPoint(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t}toString(){return this.segmentIndex+":"+this.coord.toString()}isInterior(){return this._isInterior}get interfaces_(){return[JN]}}class Sk extends iI{}function Ik(t){return null==t?0:t.color}function kk(t){return null==t?null:t.parent}function Ok(t,e){null!==t&&(t.color=e)}function Ck(t){return null==t?null:t.left}function Tk(t){return null==t?null:t.right}class Rk extends Sk{constructor(){super(),this.root_=null,this.size_=0}get(t){let e=this.root_;for(;null!==e;){const n=t.compareTo(e.key);if(n<0)e=e.left;else{if(!(n>0))return e.value;e=e.right}}return null}put(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:0,getValue(){return this.value},getKey(){return this.key}},this.size_=1,null;let n,i,r=this.root_;do{if(n=r,i=t.compareTo(r.key),i<0)r=r.left;else{if(!(i>0)){const t=r.value;return r.value=e,t}r=r.right}}while(null!==r);const s={key:t,left:null,right:null,value:e,parent:n,color:0,getValue(){return this.value},getKey(){return this.key}};return i<0?n.left=s:n.right=s,this.fixAfterInsertion(s),this.size_++,null}fixAfterInsertion(t){let e;for(t.color=1;null!=t&&t!==this.root_&&1===t.parent.color;)kk(t)===Ck(kk(kk(t)))?(e=Tk(kk(kk(t))),1===Ik(e)?(Ok(kk(t),0),Ok(e,0),Ok(kk(kk(t)),1),t=kk(kk(t))):(t===Tk(kk(t))&&(t=kk(t),this.rotateLeft(t)),Ok(kk(t),0),Ok(kk(kk(t)),1),this.rotateRight(kk(kk(t))))):(e=Ck(kk(kk(t))),1===Ik(e)?(Ok(kk(t),0),Ok(e,0),Ok(kk(kk(t)),1),t=kk(kk(t))):(t===Ck(kk(t))&&(t=kk(t),this.rotateRight(t)),Ok(kk(t),0),Ok(kk(kk(t)),1),this.rotateLeft(kk(kk(t)))));this.root_.color=0}values(){const t=new kS;let e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=Rk.successor(e));)t.add(e.value);return t}entrySet(){const t=new rI;let e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=Rk.successor(e));)t.add(e);return t}rotateLeft(t){if(null!=t){const e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null==t.parent?this.root_=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}}rotateRight(t){if(null!=t){const e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null==t.parent?this.root_=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}}getFirstEntry(){let t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t}static successor(t){let e;if(null===t)return null;if(null!==t.right){for(e=t.right;null!==e.left;)e=e.left;return e}{e=t.parent;let n=t;for(;null!==e&&n===e.right;)n=e,e=e.parent;return e}}size(){return this.size_}containsKey(t){let e=this.root_;for(;null!==e;){const n=t.compareTo(e.key);if(n<0)e=e.left;else{if(!(n>0))return!0;e=e.right}}return!1}}class Ak{constructor(){Ak.constructor_.apply(this,arguments)}static constructor_(){this._nodeMap=new Rk,this._edge=null;const t=arguments[0];this._edge=t}getSplitCoordinates(){const t=new HS;this.addEndpoints();const e=this.iterator();let n=e.next();for(;e.hasNext();){const i=e.next();this.addEdgeCoordinates(n,i,t),n=i}return t.toCoordinateArray()}addCollapsedNodes(){const t=new kS;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(let e=t.iterator();e.hasNext();){const t=e.next().intValue();this.add(this._edge.getCoordinate(t),t)}}createSplitEdgePts(t,e){let n=e.segmentIndex-t.segmentIndex+2;if(2===n)return[new aS(t.coord),new aS(e.coord)];const i=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);r||n--;const s=new Array(n).fill(null);let o=0;s[o++]=new aS(t.coord);for(let n=t.segmentIndex+1;n<=e.segmentIndex;n++)s[o++]=this._edge.getCoordinate(n);return r&&(s[o]=new aS(e.coord)),s}print(t){t.println("Intersections:");for(let e=this.iterator();e.hasNext();){e.next().print(t)}}findCollapsesFromExistingVertices(t){for(let e=0;e<this._edge.size()-2;e++){const n=this._edge.getCoordinate(e);this._edge.getCoordinate(e+1);const i=this._edge.getCoordinate(e+2);n.equals2D(i)&&t.add(RS.valueOf(e+1))}}addEdgeCoordinates(t,e,n){const i=this.createSplitEdgePts(t,e);n.add(i,!1)}iterator(){return this._nodeMap.values().iterator()}addSplitEdges(t){this.addEndpoints(),this.addCollapsedNodes();const e=this.iterator();let n=e.next();for(;e.hasNext();){const i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}}findCollapseIndex(t,e,n){if(!t.coord.equals2D(e.coord))return!1;let i=e.segmentIndex-t.segmentIndex;return e.isInterior()||i--,1===i&&(n[0]=t.segmentIndex+1,!0)}findCollapsesFromInsertedNodes(t){const e=new Array(1).fill(null),n=this.iterator();let i=n.next();for(;n.hasNext();){const r=n.next();this.findCollapseIndex(i,r,e)&&t.add(RS.valueOf(e[0])),i=r}}getEdge(){return this._edge}addEndpoints(){const t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)}createSplitEdge(t,e){const n=this.createSplitEdgePts(t,e);return new Pk(n,this._edge.getData())}add(t,e){const n=new Nk(this._edge,t,e,this._edge.getSegmentOctant(e)),i=this._nodeMap.get(n);return null!==i?(iS.isTrue(i.coord.equals2D(t),"Found equal nodes with different coordinates"),i):(this._nodeMap.put(n,n),n)}checkSplitEdgesCorrectness(t){const e=this._edge.getCoordinates(),n=t.get(0).getCoordinate(0);if(!n.equals2D(e[0]))throw new eS("bad split edge start point at "+n);const i=t.get(t.size()-1).getCoordinates(),r=i[i.length-1];if(!r.equals2D(e[e.length-1]))throw new eS("bad split edge end point at "+r)}}class Lk{addIntersection(t,e){}get interfaces_(){return[hk]}}class Pk{constructor(){Pk.constructor_.apply(this,arguments)}static constructor_(){this._nodeList=new Ak(this),this._pts=null,this._data=null;const t=arguments[0],e=arguments[1];this._pts=t,this._data=e}static getNodedSubstrings(){if(1===arguments.length){const t=arguments[0],e=new kS;return Pk.getNodedSubstrings(t,e),e}if(2===arguments.length){const t=arguments[1];for(let e=arguments[0].iterator();e.hasNext();){e.next().getNodeList().addSplitEdges(t)}}}getCoordinates(){return this._pts}size(){return this._pts.length}getCoordinate(t){return this._pts[t]}isClosed(){return this._pts[0].equals(this._pts[this._pts.length-1])}getSegmentOctant(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))}setData(t){this._data=t}safeOctant(t,e){return t.equals2D(e)?0:lk.octant(t,e)}getData(){return this._data}addIntersection(){if(2===arguments.length){const t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){const t=arguments[1],e=arguments[3],n=new aS(arguments[0].getIntersection(e));this.addIntersection(n,t)}}toString(){return qI.toLineString(new tI(this._pts))}getNodeList(){return this._nodeList}addIntersectionNode(t,e){let n=e;const i=n+1;if(i<this._pts.length){const e=this._pts[i];t.equals2D(e)&&(n=i)}return this._nodeList.add(t,n)}addIntersections(t,e,n){for(let i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)}get interfaces_(){return[Lk]}}class Dk{constructor(){Dk.constructor_.apply(this,arguments)}static constructor_(){this._overlapSeg1=new UI,this._overlapSeg2=new UI}overlap(){if(2===arguments.length);else if(4===arguments.length){const t=arguments[1],e=arguments[2],n=arguments[3];arguments[0].getLineSegment(t,this._overlapSeg1),e.getLineSegment(n,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}}class zk{constructor(){zk.constructor_.apply(this,arguments)}static constructor_(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this._pts=t,this._start=e,this._end=n,this._context=i}getLineSegment(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]}computeSelect(t,e,n,i){const r=this._pts[e],s=this._pts[n];if(n-e==1)return i.select(this,e),null;if(!t.intersects(r,s))return null;const o=Math.trunc((e+n)/2);e<o&&this.computeSelect(t,e,o,i),o<n&&this.computeSelect(t,o,n,i)}getCoordinates(){const t=new Array(this._end-this._start+1).fill(null);let e=0;for(let n=this._start;n<=this._end;n++)t[e++]=this._pts[n];return t}computeOverlaps(){if(2===arguments.length){const t=arguments[0],e=arguments[1];this.computeOverlaps(this._start,this._end,t,t._start,t._end,e)}else if(6===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=arguments[4],s=arguments[5];if(e-t==1&&r-i==1)return s.overlap(this,t,n,i),null;if(!this.overlaps(t,e,n,i,r))return null;const o=Math.trunc((t+e)/2),a=Math.trunc((i+r)/2);t<o&&(i<a&&this.computeOverlaps(t,o,n,i,a,s),a<r&&this.computeOverlaps(t,o,n,a,r,s)),o<e&&(i<a&&this.computeOverlaps(o,e,n,i,a,s),a<r&&this.computeOverlaps(o,e,n,a,r,s))}}setId(t){this._id=t}select(t,e){this.computeSelect(t,this._start,this._end,e)}getEnvelope(){if(null===this._env){const t=this._pts[this._start],e=this._pts[this._end];this._env=new hS(t,e)}return this._env}overlaps(t,e,n,i,r){return hS.intersects(this._pts[t],this._pts[e],n._pts[i],n._pts[r])}getEndIndex(){return this._end}getStartIndex(){return this._start}getContext(){return this._context}getId(){return this._id}}class Fk{static isNorthern(t){return t===Fk.NE||t===Fk.NW}static isOpposite(t,e){if(t===e)return!1;return 2===(t-e+4)%4}static commonHalfPlane(t,e){if(t===e)return t;if(2===(t-e+4)%4)return-1;const n=t<e?t:e;return 0===n&&3===(t>e?t:e)?3:n}static isInHalfPlane(t,e){return e===Fk.SE?t===Fk.SE||t===Fk.SW:t===e||t===e+1}static quadrant(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new HN("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?Fk.NE:Fk.SE:e>=0?Fk.NW:Fk.SW}if(arguments[0]instanceof aS&&arguments[1]instanceof aS){const t=arguments[0],e=arguments[1];if(e.x===t.x&&e.y===t.y)throw new HN("Cannot compute the quadrant for two identical points "+t);return e.x>=t.x?e.y>=t.y?Fk.NE:Fk.SE:e.y>=t.y?Fk.NW:Fk.SW}}}Fk.NE=0,Fk.NW=1,Fk.SW=2,Fk.SE=3;class Gk{static findChainEnd(t,e){let n=e;for(;n<t.length-1&&t[n].equals2D(t[n+1]);)n++;if(n>=t.length-1)return t.length-1;const i=Fk.quadrant(t[n],t[n+1]);let r=e+1;for(;r<t.length;){if(!t[r-1].equals2D(t[r])){if(Fk.quadrant(t[r-1],t[r])!==i)break}r++}return r-1}static getChains(){if(1===arguments.length){const t=arguments[0];return Gk.getChains(t,null)}if(2===arguments.length){const t=arguments[0],e=arguments[1],n=new kS;let i=0;do{const r=Gk.findChainEnd(t,i),s=new zk(t,i,r,e);n.add(s),i=r}while(i<t.length-1);return n}}}class qk{computeNodes(t){}getNodedSubstrings(){}}class jk{constructor(){jk.constructor_.apply(this,arguments)}static constructor_(){if(this._segInt=null,0===arguments.length);else if(1===arguments.length){const t=arguments[0];this.setSegmentIntersector(t)}}setSegmentIntersector(t){this._segInt=t}get interfaces_(){return[qk]}}class Bk extends jk{constructor(){super(),Bk.constructor_.apply(this,arguments)}static constructor_(){if(this._monoChains=new kS,this._index=new Mk,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0,0===arguments.length);else if(1===arguments.length){const t=arguments[0];jk.constructor_.call(this,t)}}getMonotoneChains(){return this._monoChains}getNodedSubstrings(){return Pk.getNodedSubstrings(this._nodedSegStrings)}getIndex(){return this._index}add(t){for(let e=Gk.getChains(t.getCoordinates(),t).iterator();e.hasNext();){const t=e.next();t.setId(this._idCounter++),this._index.insert(t.getEnvelope(),t),this._monoChains.add(t)}}computeNodes(t){this._nodedSegStrings=t;for(let e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()}intersectChains(){const t=new Uk(this._segInt);for(let e=this._monoChains.iterator();e.hasNext();){const n=e.next();for(let e=this._index.query(n.getEnvelope()).iterator();e.hasNext();){const i=e.next();if(i.getId()>n.getId()&&(n.computeOverlaps(i,t),this._nOverlaps++),this._segInt.isDone())return null}}}}class Uk extends Dk{constructor(){super(),Uk.constructor_.apply(this,arguments)}static constructor_(){this._si=null;const t=arguments[0];this._si=t}overlap(){if(4!==arguments.length)return super.overlap.apply(this,arguments);{const t=arguments[1],e=arguments[2],n=arguments[3],i=arguments[0].getContext(),r=e.getContext();this._si.processIntersections(i,t,r,n)}}}Bk.SegmentOverlapAction=Uk;class Yk extends eS{constructor(t,e){super(e?t+" [ "+e+" ]":t),this.pt=e?new aS(e):void 0,this.name=Object.keys({TopologyException:Yk})[0]}getCoordinate(){return this.pt}}class Wk{processIntersections(t,e,n,i){}isDone(){}}class $k{constructor(){$k.constructor_.apply(this,arguments)}static constructor_(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._keepIntersections=!0,this._isInteriorIntersectionsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new kS,this._intersectionCount=0;const t=arguments[0];this._li=t,this._interiorIntersection=null}static createAllIntersectionsFinder(t){const e=new $k(t);return e.setFindAllIntersections(!0),e}static isInteriorVertexIntersection(){if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[3];return(!arguments[2]||!n)&&!!t.equals2D(e)}if(8===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=arguments[4],s=arguments[5],o=arguments[6],a=arguments[7];return!!$k.isInteriorVertexIntersection(t,n,r,o)||(!!$k.isInteriorVertexIntersection(t,i,r,a)||(!!$k.isInteriorVertexIntersection(e,n,s,o)||!!$k.isInteriorVertexIntersection(e,i,s,a)))}}static createInteriorIntersectionCounter(t){const e=new $k(t);return e.setInteriorIntersectionsOnly(!0),e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e}static createIntersectionCounter(t){const e=new $k(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e}static isEndSegment(t,e){return 0===e||e>=t.size()-2}static createAnyIntersectionFinder(t){return new $k(t)}static createInteriorIntersectionsFinder(t){const e=new $k(t);return e.setFindAllIntersections(!0),e.setInteriorIntersectionsOnly(!0),e}setCheckEndSegmentsOnly(t){this._isCheckEndSegmentsOnly=t}getIntersectionSegments(){return this._intSegments}count(){return this._intersectionCount}getIntersections(){return this._intersections}setFindAllIntersections(t){this._findAllIntersections=t}setKeepIntersections(t){this._keepIntersections=t}getIntersection(){return this._interiorIntersection}processIntersections(t,e,n,i){if(!this._findAllIntersections&&this.hasIntersection())return null;const r=t===n;if(r&&e===i)return null;if(this._isCheckEndSegmentsOnly){if(!($k.isEndSegment(t,e)||$k.isEndSegment(n,i)))return null}const s=t.getCoordinate(e),o=t.getCoordinate(e+1),a=n.getCoordinate(i),l=n.getCoordinate(i+1),h=0===e,c=e+2===t.size(),u=0===i,f=i+2===n.size();this._li.computeIntersection(s,o,a,l);const d=this._li.hasIntersection()&&this._li.isInteriorIntersection();let p=!1;if(!this._isInteriorIntersectionsOnly){p=!(r&&Math.abs(i-e)<=1)&&$k.isInteriorVertexIntersection(s,o,a,l,h,c,u,f)}(d||p)&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=s,this._intSegments[1]=o,this._intSegments[2]=a,this._intSegments[3]=l,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)}hasIntersection(){return null!==this._interiorIntersection}isDone(){return!this._findAllIntersections&&null!==this._interiorIntersection}setInteriorIntersectionsOnly(t){this._isInteriorIntersectionsOnly=t}get interfaces_(){return[Wk]}}class Xk{constructor(){Xk.constructor_.apply(this,arguments)}static constructor_(){this._li=new BI,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;const t=arguments[0];this._segStrings=t}static computeIntersections(t){const e=new Xk(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()}execute(){if(null!==this._segInt)return null;this.checkInteriorIntersections()}getIntersections(){return this._segInt.getIntersections()}isValid(){return this.execute(),this._isValid}setFindAllIntersections(t){this._findAllIntersections=t}checkInteriorIntersections(){this._isValid=!0,this._segInt=new $k(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);const t=new Bk;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null}checkValid(){if(this.execute(),!this._isValid)throw new Yk(this.getErrorMessage(),this._segInt.getIntersection())}getErrorMessage(){if(this._isValid)return"no intersections found";const t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+qI.toLineString(t[0],t[1])+" and "+qI.toLineString(t[2],t[3])}}class Vk{constructor(){Vk.constructor_.apply(this,arguments)}static constructor_(){this._nv=null;const t=arguments[0];this._nv=new Xk(Vk.toSegmentStrings(t))}static toSegmentStrings(t){const e=new kS;for(let n=t.iterator();n.hasNext();){const t=n.next();e.add(new ck(t.getCoordinates(),t))}return e}static checkValid(t){new Vk(t).checkValid()}checkValid(){this._nv.checkValid()}}class Hk{constructor(){Hk.constructor_.apply(this,arguments)}static constructor_(){this._mapOp=null;const t=arguments[0];this._mapOp=t}static map(t,e){return new Hk(e).map(t)}map(t){const e=new kS;for(let n=0;n<t.getNumGeometries();n++){const i=this._mapOp.map(t.getGeometryN(n));i.isEmpty()||e.add(i)}return t.getFactory().createGeometryCollection(cI.toGeometryArray(e))}}class Zk{static opposite(t){return t===Zk.LEFT?Zk.RIGHT:t===Zk.RIGHT?Zk.LEFT:t}}Zk.ON=0,Zk.LEFT=1,Zk.RIGHT=2;class Jk{constructor(){Jk.constructor_.apply(this,arguments)}static constructor_(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){const t=arguments[0];this.init(t.length)}else if(Number.isInteger(arguments[0])){const t=arguments[0];this.init(1),this.location[Zk.ON]=t}else if(arguments[0]instanceof Jk){const t=arguments[0];if(this.init(t.location.length),null!==t)for(let e=0;e<this.location.length;e++)this.location[e]=t.location[e]}}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this.init(3),this.location[Zk.ON]=t,this.location[Zk.LEFT]=e,this.location[Zk.RIGHT]=n}}setAllLocations(t){for(let e=0;e<this.location.length;e++)this.location[e]=t}isNull(){for(let t=0;t<this.location.length;t++)if(this.location[t]!==JI.NONE)return!1;return!0}setAllLocationsIfNull(t){for(let e=0;e<this.location.length;e++)this.location[e]===JI.NONE&&(this.location[e]=t)}isLine(){return 1===this.location.length}merge(t){if(t.location.length>this.location.length){const t=new Array(3).fill(null);t[Zk.ON]=this.location[Zk.ON],t[Zk.LEFT]=JI.NONE,t[Zk.RIGHT]=JI.NONE,this.location=t}for(let e=0;e<this.location.length;e++)this.location[e]===JI.NONE&&e<t.location.length&&(this.location[e]=t.location[e])}getLocations(){return this.location}flip(){if(this.location.length<=1)return null;const t=this.location[Zk.LEFT];this.location[Zk.LEFT]=this.location[Zk.RIGHT],this.location[Zk.RIGHT]=t}toString(){const t=new TS;return this.location.length>1&&t.append(JI.toLocationSymbol(this.location[Zk.LEFT])),t.append(JI.toLocationSymbol(this.location[Zk.ON])),this.location.length>1&&t.append(JI.toLocationSymbol(this.location[Zk.RIGHT])),t.toString()}setLocations(t,e,n){this.location[Zk.ON]=t,this.location[Zk.LEFT]=e,this.location[Zk.RIGHT]=n}get(t){return t<this.location.length?this.location[t]:JI.NONE}isArea(){return this.location.length>1}isAnyNull(){for(let t=0;t<this.location.length;t++)if(this.location[t]===JI.NONE)return!0;return!1}setLocation(){if(1===arguments.length){const t=arguments[0];this.setLocation(Zk.ON,t)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.location[t]=e}}init(t){this.location=new Array(t).fill(null),this.setAllLocations(JI.NONE)}isEqualOnSide(t,e){return this.location[e]===t.location[e]}allPositionsEqual(t){for(let e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0}}class Qk{constructor(){Qk.constructor_.apply(this,arguments)}static constructor_(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){const t=arguments[0];this.elt[0]=new Jk(t),this.elt[1]=new Jk(t)}else if(arguments[0]instanceof Qk){const t=arguments[0];this.elt[0]=new Jk(t.elt[0]),this.elt[1]=new Jk(t.elt[1])}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.elt[0]=new Jk(JI.NONE),this.elt[1]=new Jk(JI.NONE),this.elt[t].setLocation(e)}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this.elt[0]=new Jk(t,e,n),this.elt[1]=new Jk(t,e,n)}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.elt[0]=new Jk(JI.NONE,JI.NONE,JI.NONE),this.elt[1]=new Jk(JI.NONE,JI.NONE,JI.NONE),this.elt[t].setLocations(e,n,i)}}static toLineLabel(t){const e=new Qk(JI.NONE);for(let n=0;n<2;n++)e.setLocation(n,t.getLocation(n));return e}getGeometryCount(){let t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t}setAllLocations(t,e){this.elt[t].setAllLocations(e)}isNull(t){return this.elt[t].isNull()}setAllLocationsIfNull(){if(1===arguments.length){const t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.elt[t].setAllLocationsIfNull(e)}}isLine(t){return this.elt[t].isLine()}merge(t){for(let e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new Jk(t.elt[e]):this.elt[e].merge(t.elt[e])}flip(){this.elt[0].flip(),this.elt[1].flip()}getLocation(){if(1===arguments.length){const t=arguments[0];return this.elt[t].get(Zk.ON)}if(2===arguments.length){const t=arguments[0],e=arguments[1];return this.elt[t].get(e)}}toString(){const t=new TS;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()}isArea(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){const t=arguments[0];return this.elt[t].isArea()}}isAnyNull(t){return this.elt[t].isAnyNull()}setLocation(){if(2===arguments.length){const t=arguments[0],e=arguments[1];this.elt[t].setLocation(Zk.ON,e)}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this.elt[t].setLocation(e,n)}}isEqualOnSide(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)}allPositionsEqual(t,e){return this.elt[t].allPositionsEqual(e)}toLine(t){this.elt[t].isArea()&&(this.elt[t]=new Jk(this.elt[t].location[0]))}}class Kk{constructor(){Kk.constructor_.apply(this,arguments)}static constructor_(){if(this._startDe=null,this._maxNodeDegree=-1,this._edges=new kS,this._pts=new kS,this._label=new Qk(JI.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new kS,this._geometryFactory=null,0===arguments.length);else if(2===arguments.length){const t=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(t),this.computeRing()}}computeRing(){if(null!==this._ring)return null;const t=new Array(this._pts.size()).fill(null);for(let e=0;e<this._pts.size();e++)t[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=PS.isCCW(this._ring.getCoordinates())}isIsolated(){return 1===this._label.getGeometryCount()}computePoints(t){this._startDe=t;let e=t,n=!0;do{if(null===e)throw new Yk("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new Yk("Directed Edge visited twice during ring-building at "+e.getCoordinate());this._edges.add(e);const t=e.getLabel();iS.isTrue(t.isArea()),this.mergeLabel(t),this.addPoints(e.getEdge(),e.isForward(),n),n=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this._startDe)}getLinearRing(){return this._ring}getCoordinate(t){return this._pts.get(t)}computeMaxNodeDegree(){this._maxNodeDegree=0;let t=this._startDe;do{const e=t.getNode().getEdges().getOutgoingDegree(this);e>this._maxNodeDegree&&(this._maxNodeDegree=e),t=this.getNext(t)}while(t!==this._startDe);this._maxNodeDegree*=2}addPoints(t,e,n){const i=t.getCoordinates();if(e){let t=1;n&&(t=0);for(let e=t;e<i.length;e++)this._pts.add(i[e])}else{let t=i.length-2;n&&(t=i.length-1);for(let e=t;e>=0;e--)this._pts.add(i[e])}}isHole(){return this._isHole}setInResult(){let t=this._startDe;do{t.getEdge().setInResult(!0),t=t.getNext()}while(t!==this._startDe)}containsPoint(t){const e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!KI.isInRing(t,e.getCoordinates()))return!1;for(let e=this._holes.iterator();e.hasNext();){if(e.next().containsPoint(t))return!1}return!0}addHole(t){this._holes.add(t)}isShell(){return null===this._shell}getLabel(){return this._label}getEdges(){return this._edges}getMaxNodeDegree(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree}getShell(){return this._shell}mergeLabel(){if(1===arguments.length){const t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){const t=arguments[1],e=arguments[0].getLocation(t,Zk.RIGHT);if(e===JI.NONE)return null;if(this._label.getLocation(t)===JI.NONE)return this._label.setLocation(t,e),null}}setShell(t){this._shell=t,null!==t&&t.addHole(this)}toPolygon(t){const e=new Array(this._holes.size()).fill(null);for(let t=0;t<this._holes.size();t++)e[t]=this._holes.get(t).getLinearRing();return t.createPolygon(this.getLinearRing(),e)}}class tO extends Kk{constructor(){super(),tO.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],e=arguments[1];Kk.constructor_.call(this,t,e)}setEdgeRing(t,e){t.setMinEdgeRing(e)}getNext(t){return t.getNextMin()}}class eO extends Kk{constructor(){super(),eO.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],e=arguments[1];Kk.constructor_.call(this,t,e)}buildMinimalRings(){const t=new kS;let e=this._startDe;do{if(null===e.getMinEdgeRing()){const n=new tO(e,this._geometryFactory);t.add(n)}e=e.getNext()}while(e!==this._startDe);return t}setEdgeRing(t,e){t.setEdgeRing(e)}linkDirectedEdgesForMinimalEdgeRings(){let t=this._startDe;do{t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!==this._startDe)}getNext(t){return t.getNext()}}class nO{constructor(){nO.constructor_.apply(this,arguments)}static constructor_(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){const t=arguments[0];this._label=t}}setVisited(t){this._isVisited=t}setInResult(t){this._isInResult=t}isCovered(){return this._isCovered}isCoveredSet(){return this._isCoveredSet}setLabel(t){this._label=t}getLabel(){return this._label}setCovered(t){this._isCovered=t,this._isCoveredSet=!0}updateIM(t){iS.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)}isInResult(){return this._isInResult}isVisited(){return this._isVisited}}class iO extends nO{constructor(){super(),iO.constructor_.apply(this,arguments)}static constructor_(){this._coord=null,this._edges=null;const t=arguments[0],e=arguments[1];this._coord=t,this._edges=e,this._label=new Qk(0,JI.NONE)}isIncidentEdgeInResult(){for(let t=this.getEdges().getEdges().iterator();t.hasNext();){if(t.next().getEdge().isInResult())return!0}return!1}isIsolated(){return 1===this._label.getGeometryCount()}getCoordinate(){return this._coord}print(t){t.println("node "+this._coord+" lbl: "+this._label)}computeIM(t){}computeMergedLocation(t,e){let n=JI.NONE;if(n=this._label.getLocation(e),!t.isNull(e)){const i=t.getLocation(e);n!==JI.BOUNDARY&&(n=i)}return n}setLabel(){if(2!==arguments.length||!Number.isInteger(arguments[1])||!Number.isInteger(arguments[0]))return super.setLabel.apply(this,arguments);{const t=arguments[0],e=arguments[1];null===this._label?this._label=new Qk(t,e):this._label.setLocation(t,e)}}getEdges(){return this._edges}mergeLabel(){if(arguments[0]instanceof iO){const t=arguments[0];this.mergeLabel(t._label)}else if(arguments[0]instanceof Qk){const t=arguments[0];for(let e=0;e<2;e++){const n=this.computeMergedLocation(t,e);this._label.getLocation(e)===JI.NONE&&this._label.setLocation(e,n)}}}add(t){this._edges.insert(t),t.setNode(this)}setLabelBoundary(t){if(null===this._label)return null;let e=JI.NONE;null!==this._label&&(e=this._label.getLocation(t));let n=null;switch(e){case JI.BOUNDARY:n=JI.INTERIOR;break;case JI.INTERIOR:default:n=JI.BOUNDARY}this._label.setLocation(t,n)}}class rO{constructor(){rO.constructor_.apply(this,arguments)}static constructor_(){this.nodeMap=new Rk,this.nodeFact=null;const t=arguments[0];this.nodeFact=t}find(t){return this.nodeMap.get(t)}addNode(){if(arguments[0]instanceof aS){const t=arguments[0];let e=this.nodeMap.get(t);return null===e&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof iO){const t=arguments[0],e=this.nodeMap.get(t.getCoordinate());return null===e?(this.nodeMap.put(t.getCoordinate(),t),t):(e.mergeLabel(t),e)}}print(t){for(let e=this.iterator();e.hasNext();){e.next().print(t)}}iterator(){return this.nodeMap.values().iterator()}values(){return this.nodeMap.values()}getBoundaryNodes(t){const e=new kS;for(let n=this.iterator();n.hasNext();){const i=n.next();i.getLabel().getLocation(t)===JI.BOUNDARY&&e.add(i)}return e}add(t){const e=t.getCoordinate();this.addNode(e).add(t)}}class sO{constructor(){sO.constructor_.apply(this,arguments)}static constructor_(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){const t=arguments[0];this._edge=t}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];sO.constructor_.call(this,t,e,n,null)}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];sO.constructor_.call(this,t),this.init(e,n),this._label=i}}compareDirection(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:PS.index(t._p0,t._p1,this._p1)}getDy(){return this._dy}getCoordinate(){return this._p0}setNode(t){this._node=t}print(t){const e=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),i=n.lastIndexOf("."),r=n.substring(i+1);t.print("  "+r+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)}compareTo(t){const e=t;return this.compareDirection(e)}getDirectedCoordinate(){return this._p1}getDx(){return this._dx}getLabel(){return this._label}getEdge(){return this._edge}getQuadrant(){return this._quadrant}getNode(){return this._node}toString(){const t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),n=e.lastIndexOf(".");return"  "+e.substring(n+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label}computeLabel(t){}init(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=Fk.quadrant(this._dx,this._dy),iS.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")}get interfaces_(){return[JN]}}class oO extends sO{constructor(){super(),oO.constructor_.apply(this,arguments)}static constructor_(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999];const t=arguments[0],e=arguments[1];if(sO.constructor_.call(this,t),this._isForward=e,e)this.init(t.getCoordinate(0),t.getCoordinate(1));else{const e=t.getNumPoints()-1;this.init(t.getCoordinate(e),t.getCoordinate(e-1))}this.computeDirectedLabel()}static depthFactor(t,e){return t===JI.EXTERIOR&&e===JI.INTERIOR?1:t===JI.INTERIOR&&e===JI.EXTERIOR?-1:0}getNextMin(){return this._nextMin}getDepth(t){return this._depth[t]}setVisited(t){this._isVisited=t}computeDirectedLabel(){this._label=new Qk(this._edge.getLabel()),this._isForward||this._label.flip()}getNext(){return this._next}setDepth(t,e){if(-999!==this._depth[t]&&this._depth[t]!==e)throw new Yk("assigned depths do not match",this.getCoordinate());this._depth[t]=e}isInteriorAreaEdge(){let t=!0;for(let e=0;e<2;e++)this._label.isArea(e)&&this._label.getLocation(e,Zk.LEFT)===JI.INTERIOR&&this._label.getLocation(e,Zk.RIGHT)===JI.INTERIOR||(t=!1);return t}setNextMin(t){this._nextMin=t}print(t){super.print.call(this,t),t.print(" "+this._depth[Zk.LEFT]+"/"+this._depth[Zk.RIGHT]),t.print(" ("+this.getDepthDelta()+")"),this._isInResult&&t.print(" inResult")}setMinEdgeRing(t){this._minEdgeRing=t}isLineEdge(){const t=this._label.isLine(0)||this._label.isLine(1),e=!this._label.isArea(0)||this._label.allPositionsEqual(0,JI.EXTERIOR),n=!this._label.isArea(1)||this._label.allPositionsEqual(1,JI.EXTERIOR);return t&&e&&n}setEdgeRing(t){this._edgeRing=t}getMinEdgeRing(){return this._minEdgeRing}getDepthDelta(){let t=this._edge.getDepthDelta();return this._isForward||(t=-t),t}setInResult(t){this._isInResult=t}getSym(){return this._sym}isForward(){return this._isForward}getEdge(){return this._edge}printEdge(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)}setSym(t){this._sym=t}setVisitedEdge(t){this.setVisited(t),this._sym.setVisited(t)}setEdgeDepths(t,e){let n=this.getEdge().getDepthDelta();this._isForward||(n=-n);let i=1;t===Zk.LEFT&&(i=-1);const r=Zk.opposite(t),s=e+n*i;this.setDepth(t,e),this.setDepth(r,s)}getEdgeRing(){return this._edgeRing}isInResult(){return this._isInResult}setNext(t){this._next=t}isVisited(){return this._isVisited}}class aO{createNode(t){return new iO(t,null)}}class lO{constructor(){lO.constructor_.apply(this,arguments)}static constructor_(){if(this._edges=new kS,this._nodes=null,this._edgeEndList=new kS,0===arguments.length)this._nodes=new rO(new aO);else if(1===arguments.length){const t=arguments[0];this._nodes=new rO(t)}}static linkResultDirectedEdges(t){for(let e=t.iterator();e.hasNext();){e.next().getEdges().linkResultDirectedEdges()}}printEdges(t){t.println("Edges:");for(let e=0;e<this._edges.size();e++){t.println("edge "+e+":");const n=this._edges.get(e);n.print(t),n.eiList.print(t)}}find(t){return this._nodes.find(t)}addNode(){if(arguments[0]instanceof iO){const t=arguments[0];return this._nodes.addNode(t)}if(arguments[0]instanceof aS){const t=arguments[0];return this._nodes.addNode(t)}}getNodeIterator(){return this._nodes.iterator()}linkResultDirectedEdges(){for(let t=this._nodes.iterator();t.hasNext();){t.next().getEdges().linkResultDirectedEdges()}}debugPrintln(t){JS.out.println(t)}isBoundaryNode(t,e){const n=this._nodes.find(e);if(null===n)return!1;const i=n.getLabel();return null!==i&&i.getLocation(t)===JI.BOUNDARY}linkAllDirectedEdges(){for(let t=this._nodes.iterator();t.hasNext();){t.next().getEdges().linkAllDirectedEdges()}}matchInSameDirection(t,e,n,i){return!!t.equals(n)&&(PS.index(t,e,i)===PS.COLLINEAR&&Fk.quadrant(t,e)===Fk.quadrant(n,i))}getEdgeEnds(){return this._edgeEndList}debugPrint(t){JS.out.print(t)}getEdgeIterator(){return this._edges.iterator()}findEdgeInSameDirection(t,e){for(let n=0;n<this._edges.size();n++){const i=this._edges.get(n),r=i.getCoordinates();if(this.matchInSameDirection(t,e,r[0],r[1]))return i;if(this.matchInSameDirection(t,e,r[r.length-1],r[r.length-2]))return i}return null}insertEdge(t){this._edges.add(t)}findEdgeEnd(t){for(let e=this.getEdgeEnds().iterator();e.hasNext();){const n=e.next();if(n.getEdge()===t)return n}return null}addEdges(t){for(let e=t.iterator();e.hasNext();){const t=e.next();this._edges.add(t);const n=new oO(t,!0),i=new oO(t,!1);n.setSym(i),i.setSym(n),this.add(n),this.add(i)}}add(t){this._nodes.add(t),this._edgeEndList.add(t)}getNodes(){return this._nodes.values()}findEdge(t,e){for(let n=0;n<this._edges.size();n++){const i=this._edges.get(n),r=i.getCoordinates();if(t.equals(r[0])&&e.equals(r[1]))return i}return null}}class hO{constructor(){hO.constructor_.apply(this,arguments)}static constructor_(){this._geometryFactory=null,this._shellList=new kS;const t=arguments[0];this._geometryFactory=t}static findEdgeRingContaining(t,e){const n=t.getLinearRing(),i=n.getEnvelopeInternal();let r=n.getCoordinateN(0),s=null,o=null;for(let t=e.iterator();t.hasNext();){const e=t.next(),a=e.getLinearRing(),l=a.getEnvelopeInternal();if(l.equals(i))continue;if(!l.contains(i))continue;r=QS.ptNotInList(n.getCoordinates(),a.getCoordinates());let h=!1;KI.isInRing(r,a.getCoordinates())&&(h=!0),h&&(null===s||o.contains(l))&&(s=e,o=s.getLinearRing().getEnvelopeInternal())}return s}sortShellsAndHoles(t,e,n){for(let i=t.iterator();i.hasNext();){const t=i.next();t.isHole()?n.add(t):e.add(t)}}computePolygons(t){const e=new kS;for(let n=t.iterator();n.hasNext();){const t=n.next().toPolygon(this._geometryFactory);e.add(t)}return e}placeFreeHoles(t,e){for(let n=e.iterator();n.hasNext();){const e=n.next();if(null===e.getShell()){const n=hO.findEdgeRingContaining(e,t);if(null===n)throw new Yk("unable to assign hole to a shell",e.getCoordinate(0));e.setShell(n)}}}buildMinimalEdgeRings(t,e,n){const i=new kS;for(let r=t.iterator();r.hasNext();){const t=r.next();if(t.getMaxNodeDegree()>2){t.linkDirectedEdgesForMinimalEdgeRings();const i=t.buildMinimalRings(),r=this.findShell(i);null!==r?(this.placePolygonHoles(r,i),e.add(r)):n.addAll(i)}else i.add(t)}return i}buildMaximalEdgeRings(t){const e=new kS;for(let n=t.iterator();n.hasNext();){const t=n.next();if(t.isInResult()&&t.getLabel().isArea()&&null===t.getEdgeRing()){const n=new eO(t,this._geometryFactory);e.add(n),n.setInResult()}}return e}placePolygonHoles(t,e){for(let n=e.iterator();n.hasNext();){const e=n.next();e.isHole()&&e.setShell(t)}}getPolygons(){return this.computePolygons(this._shellList)}findShell(t){let e=0,n=null;for(let i=t.iterator();i.hasNext();){const t=i.next();t.isHole()||(n=t,e++)}return iS.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),n}add(){if(1===arguments.length){const t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){const t=arguments[0],e=arguments[1];lO.linkResultDirectedEdges(e);const n=this.buildMaximalEdgeRings(t),i=new kS,r=this.buildMinimalEdgeRings(n,this._shellList,i);this.sortShellsAndHoles(r,this._shellList,i),this.placeFreeHoles(this._shellList,i)}}}class cO{constructor(){cO.constructor_.apply(this,arguments)}static constructor_(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new kS,this._resultLineList=new kS;const t=arguments[0],e=arguments[1],n=arguments[2];this._op=t,this._geometryFactory=e,this._ptLocator=n}collectLines(t){for(let e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){const n=e.next();this.collectLineEdge(n,t,this._lineEdgesList),this.collectBoundaryTouchEdge(n,t,this._lineEdgesList)}}labelIsolatedLine(t,e){const n=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(e));t.getLabel().setLocation(e,n)}build(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList}collectLineEdge(t,e,n){const i=t.getLabel(),r=t.getEdge();t.isLineEdge()&&(t.isVisited()||!UO.isResultOfOp(i,e)||r.isCovered()||(n.add(r),t.setVisitedEdge(!0)))}findCoveredLineEdges(){for(let t=this._op.getGraph().getNodes().iterator();t.hasNext();){t.next().getEdges().findCoveredLineEdges()}for(let t=this._op.getGraph().getEdgeEnds().iterator();t.hasNext();){const e=t.next(),n=e.getEdge();if(e.isLineEdge()&&!n.isCoveredSet()){const t=this._op.isCoveredByA(e.getCoordinate());n.setCovered(t)}}}labelIsolatedLines(t){for(let e=t.iterator();e.hasNext();){const t=e.next(),n=t.getLabel();t.isIsolated()&&(n.isNull(0)?this.labelIsolatedLine(t,0):this.labelIsolatedLine(t,1))}}buildLines(t){for(let t=this._lineEdgesList.iterator();t.hasNext();){const e=t.next(),n=this._geometryFactory.createLineString(e.getCoordinates());this._resultLineList.add(n),e.setInResult(!0)}}collectBoundaryTouchEdge(t,e,n){const i=t.getLabel();return t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult()?null:(iS.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(UO.isResultOfOp(i,e)&&e===UO.INTERSECTION&&(n.add(t.getEdge()),t.setVisitedEdge(!0))))}}class uO{constructor(){uO.constructor_.apply(this,arguments)}static constructor_(){this._op=null,this._geometryFactory=null,this._resultPointList=new kS;const t=arguments[0],e=arguments[1];this._op=t,this._geometryFactory=e}filterCoveredNodeToPoint(t){const e=t.getCoordinate();if(!this._op.isCoveredByLA(e)){const t=this._geometryFactory.createPoint(e);this._resultPointList.add(t)}}extractNonCoveredResultNodes(t){for(let e=this._op.getGraph().getNodes().iterator();e.hasNext();){const n=e.next();if(!n.isInResult()&&(!n.isIncidentEdgeInResult()&&(0===n.getEdges().getDegree()||t===UO.INTERSECTION))){const e=n.getLabel();UO.isResultOfOp(e,t)&&this.filterCoveredNodeToPoint(n)}}}build(t){return this.extractNonCoveredResultNodes(t),this._resultPointList}}class fO{locate(t){}}class dO{constructor(){dO.constructor_.apply(this,arguments)}static constructor_(){this._geom=null;const t=arguments[0];this._geom=t}static locatePointInPolygon(t,e){if(e.isEmpty())return JI.EXTERIOR;const n=e.getExteriorRing(),i=dO.locatePointInRing(t,n);if(i!==JI.INTERIOR)return i;for(let n=0;n<e.getNumInteriorRing();n++){const i=e.getInteriorRingN(n),r=dO.locatePointInRing(t,i);if(r===JI.BOUNDARY)return JI.BOUNDARY;if(r===JI.INTERIOR)return JI.EXTERIOR}return JI.INTERIOR}static locatePointInRing(t,e){return e.getEnvelopeInternal().intersects(t)?KI.locateInRing(t,e.getCoordinates()):JI.EXTERIOR}static containsPointInPolygon(t,e){return JI.EXTERIOR!==dO.locatePointInPolygon(t,e)}static locateInGeometry(t,e){if(e instanceof zS)return dO.locatePointInPolygon(t,e);if(e instanceof BS){const n=new ok(e);for(;n.hasNext();){const i=n.next();if(i!==e){const e=dO.locateInGeometry(t,i);if(e!==JI.EXTERIOR)return e}}}return JI.EXTERIOR}static isContained(t,e){return JI.EXTERIOR!==dO.locate(t,e)}static locate(t,e){return e.isEmpty()?JI.EXTERIOR:e.getEnvelopeInternal().intersects(t)?dO.locateInGeometry(t,e):JI.EXTERIOR}locate(t){return dO.locate(t,this._geom)}get interfaces_(){return[fO]}}class pO{constructor(){pO.constructor_.apply(this,arguments)}static constructor_(){this._edgeMap=new Rk,this._edgeList=null,this._ptInAreaLocation=[JI.NONE,JI.NONE]}getNextCW(t){this.getEdges();const e=this._edgeList.indexOf(t);let n=e-1;return 0===e&&(n=this._edgeList.size()-1),this._edgeList.get(n)}propagateSideLabels(t){let e=JI.NONE;for(let n=this.iterator();n.hasNext();){const i=n.next().getLabel();i.isArea(t)&&i.getLocation(t,Zk.LEFT)!==JI.NONE&&(e=i.getLocation(t,Zk.LEFT))}if(e===JI.NONE)return null;let n=e;for(let e=this.iterator();e.hasNext();){const i=e.next(),r=i.getLabel();if(r.getLocation(t,Zk.ON)===JI.NONE&&r.setLocation(t,Zk.ON,n),r.isArea(t)){const e=r.getLocation(t,Zk.LEFT),s=r.getLocation(t,Zk.RIGHT);if(s!==JI.NONE){if(s!==n)throw new Yk("side location conflict",i.getCoordinate());e===JI.NONE&&iS.shouldNeverReachHere("found single null side (at "+i.getCoordinate()+")"),n=e}else iS.isTrue(r.getLocation(t,Zk.LEFT)===JI.NONE,"found single null side"),r.setLocation(t,Zk.RIGHT,n),r.setLocation(t,Zk.LEFT,n)}}}getCoordinate(){const t=this.iterator();if(!t.hasNext())return null;return t.next().getCoordinate()}print(t){JS.out.println("EdgeEndStar:   "+this.getCoordinate());for(let e=this.iterator();e.hasNext();){e.next().print(t)}}isAreaLabelsConsistent(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)}checkAreaLabelsConsistent(t){const e=this.getEdges();if(e.size()<=0)return!0;const n=e.size()-1,i=e.get(n).getLabel().getLocation(t,Zk.LEFT);iS.isTrue(i!==JI.NONE,"Found unlabelled area edge");let r=i;for(let e=this.iterator();e.hasNext();){const n=e.next().getLabel();iS.isTrue(n.isArea(t),"Found non-area edge");const i=n.getLocation(t,Zk.LEFT),s=n.getLocation(t,Zk.RIGHT);if(i===s)return!1;if(s!==r)return!1;r=i}return!0}findIndex(t){this.iterator();for(let e=0;e<this._edgeList.size();e++){if(this._edgeList.get(e)===t)return e}return-1}iterator(){return this.getEdges().iterator()}getEdges(){return null===this._edgeList&&(this._edgeList=new kS(this._edgeMap.values())),this._edgeList}getLocation(t,e,n){return this._ptInAreaLocation[t]===JI.NONE&&(this._ptInAreaLocation[t]=dO.locate(e,n[t].getGeometry())),this._ptInAreaLocation[t]}toString(){const t=new TS;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(let e=this.iterator();e.hasNext();){const n=e.next();t.append(n),t.append("\n")}return t.toString()}computeEdgeEndLabels(t){for(let e=this.iterator();e.hasNext();){e.next().computeLabel(t)}}computeLabelling(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);const e=[!1,!1];for(let t=this.iterator();t.hasNext();){const n=t.next().getLabel();for(let t=0;t<2;t++)n.isLine(t)&&n.getLocation(t)===JI.BOUNDARY&&(e[t]=!0)}for(let n=this.iterator();n.hasNext();){const i=n.next(),r=i.getLabel();for(let n=0;n<2;n++)if(r.isAnyNull(n)){let s=JI.NONE;if(e[n])s=JI.EXTERIOR;else{const e=i.getCoordinate();s=this.getLocation(n,e,t)}r.setAllLocationsIfNull(n,s)}}}getDegree(){return this._edgeMap.size()}insertEdgeEnd(t,e){this._edgeMap.put(t,e),this._edgeList=null}}class gO extends pO{constructor(){super(),gO.constructor_.apply(this,arguments)}static constructor_(){this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}linkResultDirectedEdges(){this.getResultAreaEdges();let t=null,e=null,n=this._SCANNING_FOR_INCOMING;for(let i=0;i<this._resultAreaEdgeList.size();i++){const r=this._resultAreaEdgeList.get(i),s=r.getSym();if(r.getLabel().isArea())switch(null===t&&r.isInResult()&&(t=r),n){case this._SCANNING_FOR_INCOMING:if(!s.isInResult())continue;e=s,n=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!r.isInResult())continue;e.setNext(r),n=this._SCANNING_FOR_INCOMING}}if(n===this._LINKING_TO_OUTGOING){if(null===t)throw new Yk("no outgoing dirEdge found",this.getCoordinate());iS.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}}insert(t){const e=t;this.insertEdgeEnd(e,e)}getRightmostEdge(){const t=this.getEdges(),e=t.size();if(e<1)return null;const n=t.get(0);if(1===e)return n;const i=t.get(e-1),r=n.getQuadrant(),s=i.getQuadrant();return Fk.isNorthern(r)&&Fk.isNorthern(s)?n:Fk.isNorthern(r)||Fk.isNorthern(s)?0!==n.getDy()?n:0!==i.getDy()?i:(iS.shouldNeverReachHere("found two horizontal edges incident on node"),null):i}print(t){JS.out.println("DirectedEdgeStar: "+this.getCoordinate());for(let e=this.iterator();e.hasNext();){const n=e.next();t.print("out "),n.print(t),t.println(),t.print("in "),n.getSym().print(t),t.println()}}getResultAreaEdges(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new kS;for(let t=this.iterator();t.hasNext();){const e=t.next();(e.isInResult()||e.getSym().isInResult())&&this._resultAreaEdgeList.add(e)}return this._resultAreaEdgeList}updateLabelling(t){for(let e=this.iterator();e.hasNext();){const n=e.next().getLabel();n.setAllLocationsIfNull(0,t.getLocation(0)),n.setAllLocationsIfNull(1,t.getLocation(1))}}linkAllDirectedEdges(){this.getEdges();let t=null,e=null;for(let n=this._edgeList.size()-1;n>=0;n--){const i=this._edgeList.get(n),r=i.getSym();null===e&&(e=r),null!==t&&r.setNext(t),t=i}e.setNext(t)}computeDepths(){if(1===arguments.length){const t=arguments[0],e=this.findIndex(t),n=t.getDepth(Zk.LEFT),i=t.getDepth(Zk.RIGHT),r=this.computeDepths(e+1,this._edgeList.size(),n);if(this.computeDepths(0,e,r)!==i)throw new Yk("depth mismatch at "+t.getCoordinate())}else if(3===arguments.length){const t=arguments[1];let e=arguments[2];for(let n=arguments[0];n<t;n++){const t=this._edgeList.get(n);t.setEdgeDepths(Zk.RIGHT,e),e=t.getDepth(Zk.LEFT)}return e}}mergeSymLabels(){for(let t=this.iterator();t.hasNext();){const e=t.next();e.getLabel().merge(e.getSym().getLabel())}}linkMinimalDirectedEdges(t){let e=null,n=null,i=this._SCANNING_FOR_INCOMING;for(let r=this._resultAreaEdgeList.size()-1;r>=0;r--){const s=this._resultAreaEdgeList.get(r),o=s.getSym();switch(null===e&&s.getEdgeRing()===t&&(e=s),i){case this._SCANNING_FOR_INCOMING:if(o.getEdgeRing()!==t)continue;n=o,i=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(s.getEdgeRing()!==t)continue;n.setNextMin(s),i=this._SCANNING_FOR_INCOMING}}i===this._LINKING_TO_OUTGOING&&(iS.isTrue(null!==e,"found null for first outgoing dirEdge"),iS.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),n.setNextMin(e))}getOutgoingDegree(){if(0===arguments.length){let t=0;for(let e=this.iterator();e.hasNext();){e.next().isInResult()&&t++}return t}if(1===arguments.length){const t=arguments[0];let e=0;for(let n=this.iterator();n.hasNext();){n.next().getEdgeRing()===t&&e++}return e}}getLabel(){return this._label}findCoveredLineEdges(){let t=JI.NONE;for(let e=this.iterator();e.hasNext();){const n=e.next(),i=n.getSym();if(!n.isLineEdge()){if(n.isInResult()){t=JI.INTERIOR;break}if(i.isInResult()){t=JI.EXTERIOR;break}}}if(t===JI.NONE)return null;let e=t;for(let t=this.iterator();t.hasNext();){const n=t.next(),i=n.getSym();n.isLineEdge()?n.getEdge().setCovered(e===JI.INTERIOR):(n.isInResult()&&(e=JI.EXTERIOR),i.isInResult()&&(e=JI.INTERIOR))}}computeLabelling(t){super.computeLabelling.call(this,t),this._label=new Qk(JI.NONE);for(let t=this.iterator();t.hasNext();){const e=t.next().getEdge().getLabel();for(let t=0;t<2;t++){const n=e.getLocation(t);n!==JI.INTERIOR&&n!==JI.BOUNDARY||this._label.setLocation(t,JI.INTERIOR)}}}}class _O extends aO{constructor(){super()}createNode(t){return new iO(t,new gO)}}class yO{constructor(){yO.constructor_.apply(this,arguments)}static constructor_(){this.mce=null,this.chainIndex=null;const t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e}computeIntersections(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)}}class mO{constructor(){mO.constructor_.apply(this,arguments)}static constructor_(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){const t=arguments[0],e=arguments[1];this._eventType=mO.DELETE,this._xValue=t,this._insertEvent=e}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this._eventType=mO.INSERT,this._label=t,this._xValue=e,this._obj=n}}isDelete(){return this._eventType===mO.DELETE}setDeleteEventIndex(t){this._deleteEventIndex=t}getObject(){return this._obj}compareTo(t){const e=t;return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0}getInsertEvent(){return this._insertEvent}isInsert(){return this._eventType===mO.INSERT}isSameLabel(t){return null!==this._label&&this._label===t._label}getDeleteEventIndex(){return this._deleteEventIndex}get interfaces_(){return[JN]}}mO.INSERT=1,mO.DELETE=2;class xO{}class vO{constructor(){vO.constructor_.apply(this,arguments)}static constructor_(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;const t=arguments[0],e=arguments[1],n=arguments[2];this._li=t,this._includeProper=e,this._recordIsolated=n}static isAdjacentSegments(t,e){return 1===Math.abs(t-e)}isTrivialIntersection(t,e,n,i){if(t===n&&1===this._li.getIntersectionNum()){if(vO.isAdjacentSegments(e,i))return!0;if(t.isClosed()){const n=t.getNumPoints()-1;if(0===e&&i===n||0===i&&e===n)return!0}}return!1}getProperIntersectionPoint(){return this._properIntersectionPoint}setIsDoneIfProperInt(t){this._isDoneWhenProperInt=t}hasProperInteriorIntersection(){return this._hasProperInterior}isBoundaryPointInternal(t,e){for(let n=e.iterator();n.hasNext();){const e=n.next().getCoordinate();if(t.isIntersection(e))return!0}return!1}hasProperIntersection(){return this._hasProper}hasIntersection(){return this._hasIntersection}isDone(){return this._isDone}isBoundaryPoint(t,e){return null!==e&&(!!this.isBoundaryPointInternal(t,e[0])||!!this.isBoundaryPointInternal(t,e[1]))}setBoundaryNodes(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e}addIntersections(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;const r=t.getCoordinates()[e],s=t.getCoordinates()[e+1],o=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,s,o,a),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),n.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))}}class bO extends xO{constructor(){super(),bO.constructor_.apply(this,arguments)}static constructor_(){this.events=new kS,this.nOverlaps=null}prepareEvents(){_k.sort(this.events);for(let t=0;t<this.events.size();t++){const e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}}computeIntersections(){if(1===arguments.length){const t=arguments[0];this.nOverlaps=0,this.prepareEvents();for(let e=0;e<this.events.size();e++){const n=this.events.get(e);if(n.isInsert()&&this.processOverlaps(e,n.getDeleteEventIndex(),n,t),t.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof vO&&BN(arguments[0],SS)&&BN(arguments[1],SS)){const t=arguments[0],e=arguments[1],n=arguments[2];this.addEdges(t,t),this.addEdges(e,e),this.computeIntersections(n)}else if("boolean"==typeof arguments[2]&&BN(arguments[0],SS)&&arguments[1]instanceof vO){const t=arguments[0],e=arguments[1];arguments[2]?this.addEdges(t,null):this.addEdges(t),this.computeIntersections(e)}}addEdge(t,e){const n=t.getMonotoneChainEdge(),i=n.getStartIndexes();for(let t=0;t<i.length-1;t++){const i=new yO(n,t),r=new mO(e,n.getMinX(t),i);this.events.add(r),this.events.add(new mO(n.getMaxX(t),r))}}processOverlaps(t,e,n,i){const r=n.getObject();for(let s=t;s<e;s++){const t=this.events.get(s);if(t.isInsert()){const e=t.getObject();n.isSameLabel(t)||(r.computeIntersections(e,i),this.nOverlaps++)}}}addEdges(){if(1===arguments.length){for(let t=arguments[0].iterator();t.hasNext();){const e=t.next();this.addEdge(e,e)}}else if(2===arguments.length){const t=arguments[1];for(let e=arguments[0].iterator();e.hasNext();){const n=e.next();this.addEdge(n,t)}}}}class MO{constructor(){MO.constructor_.apply(this,arguments)}static constructor_(){this._min=YN.POSITIVE_INFINITY,this._max=YN.NEGATIVE_INFINITY}getMin(){return this._min}intersects(t,e){return!(this._min>e||this._max<t)}getMax(){return this._max}toString(){return qI.toLineString(new aS(this._min,0),new aS(this._max,0))}}MO.NodeComparator=class{compare(t,e){const n=t,i=e,r=(n._min+n._max)/2,s=(i._min+i._max)/2;return r<s?-1:r>s?1:0}get interfaces_(){return[tS]}};class wO extends MO{constructor(){super(),wO.constructor_.apply(this,arguments)}static constructor_(){this._item=null;const t=arguments[0],e=arguments[1],n=arguments[2];this._min=t,this._max=e,this._item=n}query(t,e,n){if(!this.intersects(t,e))return null;n.visitItem(this._item)}}class EO extends MO{constructor(){super(),EO.constructor_.apply(this,arguments)}static constructor_(){this._node1=null,this._node2=null;const t=arguments[0],e=arguments[1];this._node1=t,this._node2=e,this.buildExtent(this._node1,this._node2)}buildExtent(t,e){this._min=Math.min(t._min,e._min),this._max=Math.max(t._max,e._max)}query(t,e,n){if(!this.intersects(t,e))return null;null!==this._node1&&this._node1.query(t,e,n),null!==this._node2&&this._node2.query(t,e,n)}}class NO{constructor(){NO.constructor_.apply(this,arguments)}static constructor_(){this._leaves=new kS,this._root=null,this._level=0}buildTree(){_k.sort(this._leaves,new MO.NodeComparator);let t=this._leaves,e=null,n=new kS;for(;;){if(this.buildLevel(t,n),1===n.size())return n.get(0);e=t,t=n,n=e}}insert(t,e,n){if(null!==this._root)throw new IllegalStateException("Index cannot be added to once it has been queried");this._leaves.add(new wO(t,e,n))}query(t,e,n){if(this.init(),null===this._root)return null;this._root.query(t,e,n)}buildRoot(){if(null!==this._root)return null;this._root=this.buildTree()}printNode(t){JS.out.println(qI.toLineString(new aS(t._min,this._level),new aS(t._max,this._level)))}init(){return null!==this._root||0===this._leaves.size()?null:void this.buildRoot()}buildLevel(t,e){this._level++,e.clear();for(let n=0;n<t.size();n+=2){const i=t.get(n);if(null===(n+1<t.size()?t.get(n):null))e.add(i);else{const i=new EO(t.get(n),t.get(n+1));e.add(i)}}}}class SO{constructor(){SO.constructor_.apply(this,arguments)}static constructor_(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length){const t=arguments[0];this._lines=t}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this._lines=t,this._isForcedToLineString=e}}static getGeometry(){if(1===arguments.length){const t=arguments[0];return t.getFactory().buildGeometry(SO.getLines(t))}if(2===arguments.length){const t=arguments[0],e=arguments[1];return t.getFactory().buildGeometry(SO.getLines(t,e))}}static getLines(){if(1===arguments.length){const t=arguments[0];return SO.getLines(t,!1)}if(2===arguments.length){if(BN(arguments[0],ES)&&BN(arguments[1],ES)){const t=arguments[1];for(let e=arguments[0].iterator();e.hasNext();){const n=e.next();SO.getLines(n,t)}return t}if(arguments[0]instanceof cS&&"boolean"==typeof arguments[1]){const t=arguments[0],e=arguments[1],n=new kS;return t.apply(new SO(n,e)),n}if(arguments[0]instanceof cS&&BN(arguments[1],ES)){const t=arguments[0],e=arguments[1];return t instanceof vS?e.add(t):t.apply(new SO(e)),e}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&BN(arguments[0],ES)&&BN(arguments[1],ES)){const t=arguments[1],e=arguments[2];for(let n=arguments[0].iterator();n.hasNext();){const i=n.next();SO.getLines(i,t,e)}return t}if("boolean"==typeof arguments[2]&&arguments[0]instanceof cS&&BN(arguments[1],ES)){const t=arguments[1],e=arguments[2];return arguments[0].apply(new SO(t,e)),t}}}filter(t){if(this._isForcedToLineString&&t instanceof YS){const e=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(e),null}t instanceof vS&&this._lines.add(t)}setForceToLineString(t){this._isForcedToLineString=t}get interfaces_(){return[ZN]}}class IO{constructor(){IO.constructor_.apply(this,arguments)}static constructor_(){this._items=new kS}visitItem(t){this._items.add(t)}getItems(){return this._items}get interfaces_(){return[xk]}}class kO{constructor(){kO.constructor_.apply(this,arguments)}static constructor_(){this._geom=null,this._index=null;const t=arguments[0];if(!(BN(t,DS)||t instanceof YS))throw new HN("Argument must be Polygonal or LinearRing");this._geom=t}locate(t){null===this._index&&(this._index=new CO(this._geom),this._geom=null);const e=new QI(t),n=new OO(e);return this._index.query(t.y,t.y,n),e.getLocation()}get interfaces_(){return[fO]}}class OO{constructor(){OO.constructor_.apply(this,arguments)}static constructor_(){this._counter=null;const t=arguments[0];this._counter=t}visitItem(t){const e=t;this._counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))}get interfaces_(){return[xk]}}class CO{constructor(){CO.constructor_.apply(this,arguments)}static constructor_(){this._isEmpty=!1,this._index=new NO;const t=arguments[0];t.isEmpty()?this._isEmpty=!0:this.init(t)}init(t){for(let e=SO.getLines(t).iterator();e.hasNext();){const t=e.next().getCoordinates();this.addLine(t)}}addLine(t){for(let e=1;e<t.length;e++){const n=new UI(t[e-1],t[e]),i=Math.min(n.p0.y,n.p1.y),r=Math.max(n.p0.y,n.p1.y);this._index.insert(i,r,n)}}query(){if(2===arguments.length){const t=arguments[0],e=arguments[1];if(this._isEmpty)return new kS;const n=new IO;return this._index.query(t,e,n),n.getItems()}if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];if(this._isEmpty)return null;this._index.query(t,e,n)}}}kO.SegmentVisitor=OO,kO.IntervalIndexedGeometry=CO;class TO{constructor(){TO.constructor_.apply(this,arguments)}static constructor_(){this.coord=null,this.segmentIndex=null,this.dist=null;const t=arguments[0],e=arguments[1],n=arguments[2];this.coord=new aS(t),this.segmentIndex=e,this.dist=n}getSegmentIndex(){return this.segmentIndex}getCoordinate(){return this.coord}print(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)}compareTo(t){const e=t;return this.compare(e.segmentIndex,e.dist)}isEndPoint(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t}toString(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist}getDistance(){return this.dist}compare(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0}get interfaces_(){return[JN]}}class RO{constructor(){RO.constructor_.apply(this,arguments)}static constructor_(){this._nodeMap=new Rk,this.edge=null;const t=arguments[0];this.edge=t}print(t){t.println("Intersections:");for(let e=this.iterator();e.hasNext();){e.next().print(t)}}iterator(){return this._nodeMap.values().iterator()}addSplitEdges(t){this.addEndpoints();const e=this.iterator();let n=e.next();for(;e.hasNext();){const i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}}addEndpoints(){const t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)}createSplitEdge(t,e){let n=e.segmentIndex-t.segmentIndex+2;const i=this.edge.pts[e.segmentIndex],r=e.dist>0||!e.coord.equals2D(i);r||n--;const s=new Array(n).fill(null);let o=0;s[o++]=new aS(t.coord);for(let n=t.segmentIndex+1;n<=e.segmentIndex;n++)s[o++]=this.edge.pts[n];return r&&(s[o]=e.coord),new FO(s,new Qk(this.edge._label))}add(t,e,n){const i=new TO(t,e,n),r=this._nodeMap.get(i);return null!==r?r:(this._nodeMap.put(i,i),i)}isIntersection(t){for(let e=this.iterator();e.hasNext();){if(e.next().coord.equals(t))return!0}return!1}}class AO{constructor(){AO.constructor_.apply(this,arguments)}static constructor_(){if(this._matrix=null,0===arguments.length)this._matrix=Array(3).fill().map((()=>Array(3))),this.setAll(yS.FALSE);else if(1===arguments.length)if("string"==typeof arguments[0]){const t=arguments[0];AO.constructor_.call(this),this.set(t)}else if(arguments[0]instanceof AO){const t=arguments[0];AO.constructor_.call(this),this._matrix[JI.INTERIOR][JI.INTERIOR]=t._matrix[JI.INTERIOR][JI.INTERIOR],this._matrix[JI.INTERIOR][JI.BOUNDARY]=t._matrix[JI.INTERIOR][JI.BOUNDARY],this._matrix[JI.INTERIOR][JI.EXTERIOR]=t._matrix[JI.INTERIOR][JI.EXTERIOR],this._matrix[JI.BOUNDARY][JI.INTERIOR]=t._matrix[JI.BOUNDARY][JI.INTERIOR],this._matrix[JI.BOUNDARY][JI.BOUNDARY]=t._matrix[JI.BOUNDARY][JI.BOUNDARY],this._matrix[JI.BOUNDARY][JI.EXTERIOR]=t._matrix[JI.BOUNDARY][JI.EXTERIOR],this._matrix[JI.EXTERIOR][JI.INTERIOR]=t._matrix[JI.EXTERIOR][JI.INTERIOR],this._matrix[JI.EXTERIOR][JI.BOUNDARY]=t._matrix[JI.EXTERIOR][JI.BOUNDARY],this._matrix[JI.EXTERIOR][JI.EXTERIOR]=t._matrix[JI.EXTERIOR][JI.EXTERIOR]}}static matches(){if(Number.isInteger(arguments[0])&&"string"==typeof arguments[1]){const t=arguments[0],e=arguments[1];return e===yS.SYM_DONTCARE||(e===yS.SYM_TRUE&&(t>=0||t===yS.TRUE)||(e===yS.SYM_FALSE&&t===yS.FALSE||(e===yS.SYM_P&&t===yS.P||(e===yS.SYM_L&&t===yS.L||e===yS.SYM_A&&t===yS.A))))}if("string"==typeof arguments[0]&&"string"==typeof arguments[1]){const t=arguments[1];return new AO(arguments[0]).matches(t)}}static isTrue(t){return t>=0||t===yS.TRUE}isIntersects(){return!this.isDisjoint()}isCovers(){return(AO.isTrue(this._matrix[JI.INTERIOR][JI.INTERIOR])||AO.isTrue(this._matrix[JI.INTERIOR][JI.BOUNDARY])||AO.isTrue(this._matrix[JI.BOUNDARY][JI.INTERIOR])||AO.isTrue(this._matrix[JI.BOUNDARY][JI.BOUNDARY]))&&this._matrix[JI.EXTERIOR][JI.INTERIOR]===yS.FALSE&&this._matrix[JI.EXTERIOR][JI.BOUNDARY]===yS.FALSE}isCoveredBy(){return(AO.isTrue(this._matrix[JI.INTERIOR][JI.INTERIOR])||AO.isTrue(this._matrix[JI.INTERIOR][JI.BOUNDARY])||AO.isTrue(this._matrix[JI.BOUNDARY][JI.INTERIOR])||AO.isTrue(this._matrix[JI.BOUNDARY][JI.BOUNDARY]))&&this._matrix[JI.INTERIOR][JI.EXTERIOR]===yS.FALSE&&this._matrix[JI.BOUNDARY][JI.EXTERIOR]===yS.FALSE}set(){if(1===arguments.length){const t=arguments[0];for(let e=0;e<t.length;e++){const n=Math.trunc(e/3),i=e%3;this._matrix[n][i]=yS.toDimensionValue(t.charAt(e))}}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this._matrix[t][e]=n}}isContains(){return AO.isTrue(this._matrix[JI.INTERIOR][JI.INTERIOR])&&this._matrix[JI.EXTERIOR][JI.INTERIOR]===yS.FALSE&&this._matrix[JI.EXTERIOR][JI.BOUNDARY]===yS.FALSE}setAtLeast(){if(1===arguments.length){const t=arguments[0];for(let e=0;e<t.length;e++){const n=Math.trunc(e/3),i=e%3;this.setAtLeast(n,i,yS.toDimensionValue(t.charAt(e)))}}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this._matrix[t][e]<n&&(this._matrix[t][e]=n)}}setAtLeastIfValid(t,e,n){t>=0&&e>=0&&this.setAtLeast(t,e,n)}isWithin(){return AO.isTrue(this._matrix[JI.INTERIOR][JI.INTERIOR])&&this._matrix[JI.INTERIOR][JI.EXTERIOR]===yS.FALSE&&this._matrix[JI.BOUNDARY][JI.EXTERIOR]===yS.FALSE}isTouches(t,e){return t>e?this.isTouches(e,t):(t===yS.A&&e===yS.A||t===yS.L&&e===yS.L||t===yS.L&&e===yS.A||t===yS.P&&e===yS.A||t===yS.P&&e===yS.L)&&(this._matrix[JI.INTERIOR][JI.INTERIOR]===yS.FALSE&&(AO.isTrue(this._matrix[JI.INTERIOR][JI.BOUNDARY])||AO.isTrue(this._matrix[JI.BOUNDARY][JI.INTERIOR])||AO.isTrue(this._matrix[JI.BOUNDARY][JI.BOUNDARY])))}isOverlaps(t,e){return t===yS.P&&e===yS.P||t===yS.A&&e===yS.A?AO.isTrue(this._matrix[JI.INTERIOR][JI.INTERIOR])&&AO.isTrue(this._matrix[JI.INTERIOR][JI.EXTERIOR])&&AO.isTrue(this._matrix[JI.EXTERIOR][JI.INTERIOR]):t===yS.L&&e===yS.L&&(1===this._matrix[JI.INTERIOR][JI.INTERIOR]&&AO.isTrue(this._matrix[JI.INTERIOR][JI.EXTERIOR])&&AO.isTrue(this._matrix[JI.EXTERIOR][JI.INTERIOR]))}isEquals(t,e){return t===e&&(AO.isTrue(this._matrix[JI.INTERIOR][JI.INTERIOR])&&this._matrix[JI.INTERIOR][JI.EXTERIOR]===yS.FALSE&&this._matrix[JI.BOUNDARY][JI.EXTERIOR]===yS.FALSE&&this._matrix[JI.EXTERIOR][JI.INTERIOR]===yS.FALSE&&this._matrix[JI.EXTERIOR][JI.BOUNDARY]===yS.FALSE)}toString(){const t=new KS("123456789");for(let e=0;e<3;e++)for(let n=0;n<3;n++)t.setCharAt(3*e+n,yS.toDimensionSymbol(this._matrix[e][n]));return t.toString()}setAll(t){for(let e=0;e<3;e++)for(let n=0;n<3;n++)this._matrix[e][n]=t}get(t,e){return this._matrix[t][e]}transpose(){let t=this._matrix[1][0];return this._matrix[1][0]=this._matrix[0][1],this._matrix[0][1]=t,t=this._matrix[2][0],this._matrix[2][0]=this._matrix[0][2],this._matrix[0][2]=t,t=this._matrix[2][1],this._matrix[2][1]=this._matrix[1][2],this._matrix[1][2]=t,this}matches(t){if(9!==t.length)throw new HN("Should be length 9: "+t);for(let e=0;e<3;e++)for(let n=0;n<3;n++)if(!AO.matches(this._matrix[e][n],t.charAt(3*e+n)))return!1;return!0}add(t){for(let e=0;e<3;e++)for(let n=0;n<3;n++)this.setAtLeast(e,n,t.get(e,n))}isDisjoint(){return this._matrix[JI.INTERIOR][JI.INTERIOR]===yS.FALSE&&this._matrix[JI.INTERIOR][JI.BOUNDARY]===yS.FALSE&&this._matrix[JI.BOUNDARY][JI.INTERIOR]===yS.FALSE&&this._matrix[JI.BOUNDARY][JI.BOUNDARY]===yS.FALSE}isCrosses(t,e){return t===yS.P&&e===yS.L||t===yS.P&&e===yS.A||t===yS.L&&e===yS.A?AO.isTrue(this._matrix[JI.INTERIOR][JI.INTERIOR])&&AO.isTrue(this._matrix[JI.INTERIOR][JI.EXTERIOR]):t===yS.L&&e===yS.P||t===yS.A&&e===yS.P||t===yS.A&&e===yS.L?AO.isTrue(this._matrix[JI.INTERIOR][JI.INTERIOR])&&AO.isTrue(this._matrix[JI.EXTERIOR][JI.INTERIOR]):t===yS.L&&e===yS.L&&0===this._matrix[JI.INTERIOR][JI.INTERIOR]}get interfaces_(){return[WN]}}class LO{constructor(){LO.constructor_.apply(this,arguments)}static constructor_(){if(this._data=null,this._size=0,0===arguments.length)LO.constructor_.call(this,10);else if(1===arguments.length){const t=arguments[0];this._data=new Array(t).fill(null)}}size(){return this._size}addAll(t){return null===t||0===t.length?null:(this.ensureCapacity(this._size+t.length),JS.arraycopy(t,0,this._data,this._size,t.length),void(this._size+=t.length))}ensureCapacity(t){if(t<=this._data.length)return null;const e=Math.max(t,2*this._data.length);this._data=CS.copyOf(this._data,e)}toArray(){const t=new Array(this._size).fill(null);return JS.arraycopy(this._data,0,t,0,this._size),t}add(t){this.ensureCapacity(this._size+1),this._data[this._size]=t,++this._size}}class PO{static toIntArray(t){const e=new Array(t.size()).fill(null);for(let n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e}getChainStartIndices(t){let e=0;const n=new LO(Math.trunc(t.length/2));n.add(e);do{const i=this.findChainEnd(t,e);n.add(i),e=i}while(e<t.length-1);return n.toArray()}findChainEnd(t,e){const n=Fk.quadrant(t[e],t[e+1]);let i=e+1;for(;i<t.length;){if(Fk.quadrant(t[i-1],t[i])!==n)break;i++}return i-1}OLDgetChainStartIndices(t){let e=0;const n=new kS;n.add(e);do{const i=this.findChainEnd(t,e);n.add(i),e=i}while(e<t.length-1);return PO.toIntArray(n)}}class DO{constructor(){DO.constructor_.apply(this,arguments)}static constructor_(){this.e=null,this.pts=null,this.startIndex=null;const t=arguments[0];this.e=t,this.pts=t.getCoordinates();const e=new PO;this.startIndex=e.getChainStartIndices(this.pts)}getCoordinates(){return this.pts}getMaxX(t){const e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e>n?e:n}getMinX(t){const e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e<n?e:n}computeIntersectsForChain(){if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[n],e.startIndex[n+1],i)}else if(6===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=arguments[4],s=arguments[5];if(e-t==1&&r-i==1)return s.addIntersections(this.e,t,n.e,i),null;if(!this.overlaps(t,e,n,i,r))return null;const o=Math.trunc((t+e)/2),a=Math.trunc((i+r)/2);t<o&&(i<a&&this.computeIntersectsForChain(t,o,n,i,a,s),a<r&&this.computeIntersectsForChain(t,o,n,a,r,s)),o<e&&(i<a&&this.computeIntersectsForChain(o,e,n,i,a,s),a<r&&this.computeIntersectsForChain(o,e,n,a,r,s))}}overlaps(t,e,n,i,r){return hS.intersects(this.pts[t],this.pts[e],n.pts[i],n.pts[r])}getStartIndexes(){return this.startIndex}computeIntersects(t,e){for(let n=0;n<this.startIndex.length-1;n++)for(let i=0;i<t.startIndex.length-1;i++)this.computeIntersectsForChain(n,t,i,e)}}class zO{constructor(){zO.constructor_.apply(this,arguments)}static constructor_(){this._depth=Array(2).fill().map((()=>Array(3)));for(let t=0;t<2;t++)for(let e=0;e<3;e++)this._depth[t][e]=zO.NULL_VALUE}static depthAtLocation(t){return t===JI.EXTERIOR?0:t===JI.INTERIOR?1:zO.NULL_VALUE}getDepth(t,e){return this._depth[t][e]}setDepth(t,e,n){this._depth[t][e]=n}isNull(){if(0===arguments.length){for(let t=0;t<2;t++)for(let e=0;e<3;e++)if(this._depth[t][e]!==zO.NULL_VALUE)return!1;return!0}if(1===arguments.length){const t=arguments[0];return this._depth[t][1]===zO.NULL_VALUE}if(2===arguments.length){const t=arguments[0],e=arguments[1];return this._depth[t][e]===zO.NULL_VALUE}}normalize(){for(let t=0;t<2;t++)if(!this.isNull(t)){let e=this._depth[t][1];this._depth[t][2]<e&&(e=this._depth[t][2]),e<0&&(e=0);for(let n=1;n<3;n++){let i=0;this._depth[t][n]>e&&(i=1),this._depth[t][n]=i}}}getDelta(t){return this._depth[t][Zk.RIGHT]-this._depth[t][Zk.LEFT]}getLocation(t,e){return this._depth[t][e]<=0?JI.EXTERIOR:JI.INTERIOR}toString(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]}add(){if(1===arguments.length){const t=arguments[0];for(let e=0;e<2;e++)for(let n=1;n<3;n++){const i=t.getLocation(e,n);i!==JI.EXTERIOR&&i!==JI.INTERIOR||(this.isNull(e,n)?this._depth[e][n]=zO.depthAtLocation(i):this._depth[e][n]+=zO.depthAtLocation(i))}}else if(3===arguments.length){const t=arguments[0],e=arguments[1];arguments[2]===JI.INTERIOR&&this._depth[t][e]++}}}zO.NULL_VALUE=-1;class FO extends nO{constructor(){super(),FO.constructor_.apply(this,arguments)}static constructor_(){if(this.pts=null,this._env=null,this.eiList=new RO(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new zO,this._depthDelta=0,1===arguments.length){const t=arguments[0];FO.constructor_.call(this,t,null)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.pts=t,this._label=e}}static updateIM(){if(!(2===arguments.length&&arguments[1]instanceof AO&&arguments[0]instanceof Qk))return super.updateIM.apply(this,arguments);{const t=arguments[0],e=arguments[1];e.setAtLeastIfValid(t.getLocation(0,Zk.ON),t.getLocation(1,Zk.ON),1),t.isArea()&&(e.setAtLeastIfValid(t.getLocation(0,Zk.LEFT),t.getLocation(1,Zk.LEFT),2),e.setAtLeastIfValid(t.getLocation(0,Zk.RIGHT),t.getLocation(1,Zk.RIGHT),2))}}getDepth(){return this._depth}getCollapsedEdge(){const t=new Array(2).fill(null);t[0]=this.pts[0],t[1]=this.pts[1];return new FO(t,Qk.toLineLabel(this._label))}isIsolated(){return this._isIsolated}getCoordinates(){return this.pts}setIsolated(t){this._isIsolated=t}setName(t){this._name=t}equals(t){if(!(t instanceof FO))return!1;const e=t;if(this.pts.length!==e.pts.length)return!1;let n=!0,i=!0,r=this.pts.length;for(let t=0;t<this.pts.length;t++)if(this.pts[t].equals2D(e.pts[t])||(n=!1),this.pts[t].equals2D(e.pts[--r])||(i=!1),!n&&!i)return!1;return!0}getCoordinate(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){const t=arguments[0];return this.pts[t]}}print(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(let e=0;e<this.pts.length;e++)e>0&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this._label+" "+this._depthDelta)}computeIM(t){FO.updateIM(this._label,t)}isCollapsed(){return!!this._label.isArea()&&(3===this.pts.length&&!!this.pts[0].equals(this.pts[2]))}isClosed(){return this.pts[0].equals(this.pts[this.pts.length-1])}getMaximumSegmentIndex(){return this.pts.length-1}getDepthDelta(){return this._depthDelta}getNumPoints(){return this.pts.length}printReverse(t){t.print("edge "+this._name+": ");for(let e=this.pts.length-1;e>=0;e--)t.print(this.pts[e]+" ");t.println("")}getMonotoneChainEdge(){return null===this._mce&&(this._mce=new DO(this)),this._mce}getEnvelope(){if(null===this._env){this._env=new hS;for(let t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env}addIntersection(t,e,n,i){const r=new aS(t.getIntersection(i));let s=e,o=t.getEdgeDistance(n,i);const a=s+1;if(a<this.pts.length){const t=this.pts[a];r.equals2D(t)&&(s=a,o=0)}this.eiList.add(r,s,o)}toString(){const t=new KS;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(let e=0;e<this.pts.length;e++)e>0&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()}isPointwiseEqual(t){if(this.pts.length!==t.pts.length)return!1;for(let e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0}setDepthDelta(t){this._depthDelta=t}getEdgeIntersectionList(){return this.eiList}addIntersections(t,e,n){for(let i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)}}class GO extends lO{constructor(){super(),GO.constructor_.apply(this,arguments)}static constructor_(){if(this._parentGeom=null,this._lineEdgeMap=new oI,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new ak,2===arguments.length){const t=arguments[0],e=arguments[1];GO.constructor_.call(this,t,e,tk.OGC_SFS_BOUNDARY_RULE)}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this._argIndex=t,this._parentGeom=e,this._boundaryNodeRule=n,null!==e&&this.add(e)}}static determineBoundary(t,e){return t.isInBoundary(e)?JI.BOUNDARY:JI.INTERIOR}insertBoundaryPoint(t,e){const n=this._nodes.addNode(e).getLabel();let i=1,r=JI.NONE;r=n.getLocation(t,Zk.ON),r===JI.BOUNDARY&&i++;const s=GO.determineBoundary(this._boundaryNodeRule,i);n.setLocation(t,s)}computeSelfNodes(){if(2===arguments.length){const t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){const t=arguments[1],e=arguments[2],n=new vO(arguments[0],!0,!1);n.setIsDoneIfProperInt(e);const i=this.createEdgeSetIntersector(),r=this._parentGeom instanceof YS||this._parentGeom instanceof zS||this._parentGeom instanceof nI,s=t||!r;return i.computeIntersections(this._edges,n,s),this.addSelfIntersectionNodes(this._argIndex),n}}computeSplitEdges(t){for(let e=this._edges.iterator();e.hasNext();){e.next().eiList.addSplitEdges(t)}}computeEdgeIntersections(t,e,n){const i=new vO(e,n,!0);i.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes());return this.createEdgeSetIntersector().computeIntersections(this._edges,t._edges,i),i}getGeometry(){return this._parentGeom}getBoundaryNodeRule(){return this._boundaryNodeRule}hasTooFewPoints(){return this._hasTooFewPoints}addPoint(){if(arguments[0]instanceof MS){const t=arguments[0].getCoordinate();this.insertPoint(this._argIndex,t,JI.INTERIOR)}else if(arguments[0]instanceof aS){const t=arguments[0];this.insertPoint(this._argIndex,t,JI.INTERIOR)}}addPolygon(t){this.addPolygonRing(t.getExteriorRing(),JI.EXTERIOR,JI.INTERIOR);for(let e=0;e<t.getNumInteriorRing();e++){const n=t.getInteriorRingN(e);this.addPolygonRing(n,JI.INTERIOR,JI.EXTERIOR)}}addEdge(t){this.insertEdge(t);const e=t.getCoordinates();this.insertPoint(this._argIndex,e[0],JI.BOUNDARY),this.insertPoint(this._argIndex,e[e.length-1],JI.BOUNDARY)}addLineString(t){const e=QS.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=e[0],null;const n=new FO(e,new Qk(this._argIndex,JI.INTERIOR));this._lineEdgeMap.put(t,n),this.insertEdge(n),iS.isTrue(e.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,e[0]),this.insertBoundaryPoint(this._argIndex,e[e.length-1])}getInvalidPoint(){return this._invalidPoint}getBoundaryPoints(){const t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null);let n=0;for(let i=t.iterator();i.hasNext();){const t=i.next();e[n++]=t.getCoordinate().copy()}return e}getBoundaryNodes(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes}addSelfIntersectionNode(t,e,n){if(this.isBoundaryNode(t,e))return null;n===JI.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,n)}addPolygonRing(t,e,n){if(t.isEmpty())return null;const i=QS.removeRepeatedPoints(t.getCoordinates());if(i.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=i[0],null;let r=e,s=n;PS.isCCW(i)&&(r=n,s=e);const o=new FO(i,new Qk(this._argIndex,JI.BOUNDARY,r,s));this._lineEdgeMap.put(t,o),this.insertEdge(o),this.insertPoint(this._argIndex,i[0],JI.BOUNDARY)}insertPoint(t,e,n){const i=this._nodes.addNode(e),r=i.getLabel();null===r?i._label=new Qk(t,n):r.setLocation(t,n)}createEdgeSetIntersector(){return new bO}addSelfIntersectionNodes(t){for(let e=this._edges.iterator();e.hasNext();){const n=e.next(),i=n.getLabel().getLocation(t);for(let e=n.eiList.iterator();e.hasNext();){const n=e.next();this.addSelfIntersectionNode(t,n.coord,i)}}}add(){if(!(1===arguments.length&&arguments[0]instanceof cS))return super.add.apply(this,arguments);{const t=arguments[0];if(t.isEmpty())return null;if(t instanceof nI&&(this._useBoundaryDeterminationRule=!1),t instanceof zS)this.addPolygon(t);else if(t instanceof vS)this.addLineString(t);else if(t instanceof MS)this.addPoint(t);else if(t instanceof US)this.addCollection(t);else if(t instanceof hI)this.addCollection(t);else if(t instanceof nI)this.addCollection(t);else{if(!(t instanceof BS))throw new gS(t.getGeometryType());this.addCollection(t)}}}addCollection(t){for(let e=0;e<t.getNumGeometries();e++){const n=t.getGeometryN(e);this.add(n)}}locate(t){return BN(this._parentGeom,DS)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new kO(this._parentGeom)),this._areaPtLocator.locate(t)):this._ptLocator.locate(t,this._parentGeom)}findEdge(){if(1===arguments.length&&arguments[0]instanceof vS){const t=arguments[0];return this._lineEdgeMap.get(t)}return super.findEdge.apply(this,arguments)}}class qO{constructor(){qO.constructor_.apply(this,arguments)}static constructor_(){if(this._li=new BI,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){const t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new GO(0,t)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];qO.constructor_.call(this,t,e,tk.OGC_SFS_BOUNDARY_RULE)}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];t.getPrecisionModel().compareTo(e.getPrecisionModel())>=0?this.setComputationPrecision(t.getPrecisionModel()):this.setComputationPrecision(e.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new GO(0,t,n),this._arg[1]=new GO(1,e,n)}}getArgGeometry(t){return this._arg[t].getGeometry()}setComputationPrecision(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)}}class jO{constructor(){jO.constructor_.apply(this,arguments)}static constructor_(){this._pts=null,this._orientation=null;const t=arguments[0];this._pts=t,this._orientation=jO.orientation(t)}static orientation(t){return 1===QS.increasingDirection(t)}static compareOriented(t,e,n,i){const r=e?1:-1,s=i?1:-1,o=e?t.length:-1,a=i?n.length:-1;let l=e?0:t.length-1,h=i?0:n.length-1;for(;;){const e=t[l].compareTo(n[h]);if(0!==e)return e;l+=r,h+=s;const i=l===o,c=h===a;if(i&&!c)return-1;if(!i&&c)return 1;if(i&&c)return 0}}compareTo(t){const e=t;return jO.compareOriented(this._pts,this._orientation,e._pts,e._orientation)}get interfaces_(){return[JN]}}class BO{constructor(){BO.constructor_.apply(this,arguments)}static constructor_(){this._edges=new kS,this._ocaMap=new Rk}print(t){t.print("MULTILINESTRING ( ");for(let e=0;e<this._edges.size();e++){const n=this._edges.get(e);e>0&&t.print(","),t.print("(");const i=n.getCoordinates();for(let e=0;e<i.length;e++)e>0&&t.print(","),t.print(i[e].x+" "+i[e].y);t.println(")")}t.print(")  ")}addAll(t){for(let e=t.iterator();e.hasNext();)this.add(e.next())}findEdgeIndex(t){for(let e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(t))return e;return-1}iterator(){return this._edges.iterator()}getEdges(){return this._edges}get(t){return this._edges.get(t)}findEqualEdge(t){const e=new jO(t.getCoordinates());return this._ocaMap.get(e)}add(t){this._edges.add(t);const e=new jO(t.getCoordinates());this._ocaMap.put(e,t)}}class UO extends qO{constructor(){super(),UO.constructor_.apply(this,arguments)}static constructor_(){this._ptLocator=new ak,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new BO,this._resultPolyList=new kS,this._resultLineList=new kS,this._resultPointList=new kS;const t=arguments[0],e=arguments[1];qO.constructor_.call(this,t,e),this._graph=new lO(new _O),this._geomFact=t.getFactory()}static overlayOp(t,e,n){return new UO(t,e).getResultGeometry(n)}static union(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return UO.createEmptyResult(UO.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}if(t.isGeometryCollection()||e.isGeometryCollection())throw new HN("This method does not support GeometryCollection arguments");return WO.overlayOp(t,e,UO.UNION)}static intersection(t,e){if(t.isEmpty()||e.isEmpty())return UO.createEmptyResult(UO.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){const n=e;return Hk.map(t,new class{get interfaces_(){return[MapOp]}map(t){return UO.intersection(t,n)}})}return WO.overlayOp(t,e,UO.INTERSECTION)}static symDifference(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return UO.createEmptyResult(UO.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}if(t.isGeometryCollection()||e.isGeometryCollection())throw new HN("This method does not support GeometryCollection arguments");return WO.overlayOp(t,e,UO.SYMDIFFERENCE)}static resultDimension(t,e,n){const i=e.getDimension(),r=n.getDimension();let s=-1;switch(t){case UO.INTERSECTION:s=Math.min(i,r);break;case UO.UNION:s=Math.max(i,r);break;case UO.DIFFERENCE:s=i;break;case UO.SYMDIFFERENCE:s=Math.max(i,r)}return s}static createEmptyResult(t,e,n,i){const r=UO.resultDimension(t,e,n);return i.createEmpty(r)}static difference(t,e){if(t.isEmpty())return UO.createEmptyResult(UO.DIFFERENCE,t,e,t.getFactory());if(e.isEmpty())return t.copy();if(t.isGeometryCollection()||e.isGeometryCollection())throw new HN("This method does not support GeometryCollection arguments");return WO.overlayOp(t,e,UO.DIFFERENCE)}static isResultOfOp(){if(2===arguments.length){const t=arguments[0],e=arguments[1],n=t.getLocation(0),i=t.getLocation(1);return UO.isResultOfOp(n,i,e)}if(3===arguments.length){let t=arguments[0],e=arguments[1],n=arguments[2];switch(t===JI.BOUNDARY&&(t=JI.INTERIOR),e===JI.BOUNDARY&&(e=JI.INTERIOR),n){case UO.INTERSECTION:return t===JI.INTERIOR&&e===JI.INTERIOR;case UO.UNION:return t===JI.INTERIOR||e===JI.INTERIOR;case UO.DIFFERENCE:return t===JI.INTERIOR&&e!==JI.INTERIOR;case UO.SYMDIFFERENCE:return t===JI.INTERIOR&&e!==JI.INTERIOR||t!==JI.INTERIOR&&e===JI.INTERIOR}return!1}}insertUniqueEdge(t){const e=this._edgeList.findEqualEdge(t);if(null!==e){const n=e.getLabel();let i=t.getLabel();e.isPointwiseEqual(t)||(i=new Qk(t.getLabel()),i.flip());const r=e.getDepth();r.isNull()&&r.add(n),r.add(i),n.merge(i)}else this._edgeList.add(t)}getGraph(){return this._graph}cancelDuplicateResultEdges(){for(let t=this._graph.getEdgeEnds().iterator();t.hasNext();){const e=t.next(),n=e.getSym();e.isInResult()&&n.isInResult()&&(e.setInResult(!1),n.setInResult(!1))}}isCoveredByLA(t){return!!this.isCovered(t,this._resultLineList)||!!this.isCovered(t,this._resultPolyList)}computeGeometry(t,e,n,i){const r=new kS;return r.addAll(t),r.addAll(e),r.addAll(n),r.isEmpty()?UO.createEmptyResult(i,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(r)}mergeSymLabels(){for(let t=this._graph.getNodes().iterator();t.hasNext();){t.next().getEdges().mergeSymLabels()}}isCovered(t,e){for(let n=e.iterator();n.hasNext();){const e=n.next();if(this._ptLocator.locate(t,e)!==JI.EXTERIOR)return!0}return!1}replaceCollapsedEdges(){const t=new kS;for(let e=this._edgeList.iterator();e.hasNext();){const n=e.next();n.isCollapsed()&&(e.remove(),t.add(n.getCollapsedEdge()))}this._edgeList.addAll(t)}updateNodeLabelling(){for(let t=this._graph.getNodes().iterator();t.hasNext();){const e=t.next(),n=e.getEdges().getLabel();e.getLabel().merge(n)}}getResultGeometry(t){return this.computeOverlay(t),this._resultGeom}insertUniqueEdges(t){for(let e=t.iterator();e.hasNext();){const t=e.next();this.insertUniqueEdge(t)}}computeOverlay(t){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);const e=new kS;this._arg[0].computeSplitEdges(e),this._arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),Vk.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();const n=new hO(this._geomFact);n.add(this._graph),this._resultPolyList=n.getPolygons();const i=new cO(this,this._geomFact,this._ptLocator);this._resultLineList=i.build(t);const r=new uO(this,this._geomFact,this._ptLocator);this._resultPointList=r.build(t),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,t)}labelIncompleteNode(t,e){const n=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setLocation(e,n)}copyPoints(t){for(let e=this._arg[t].getNodeIterator();e.hasNext();){const n=e.next();this._graph.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}}findResultAreaEdges(t){for(let e=this._graph.getEdgeEnds().iterator();e.hasNext();){const n=e.next(),i=n.getLabel();i.isArea()&&!n.isInteriorAreaEdge()&&UO.isResultOfOp(i.getLocation(0,Zk.RIGHT),i.getLocation(1,Zk.RIGHT),t)&&n.setInResult(!0)}}computeLabelsFromDepths(){for(let t=this._edgeList.iterator();t.hasNext();){const e=t.next(),n=e.getLabel(),i=e.getDepth();if(!i.isNull()){i.normalize();for(let t=0;t<2;t++)n.isNull(t)||!n.isArea()||i.isNull(t)||(0===i.getDelta(t)?n.toLine(t):(iS.isTrue(!i.isNull(t,Zk.LEFT),"depth of LEFT side has not been initialized"),n.setLocation(t,Zk.LEFT,i.getLocation(t,Zk.LEFT)),iS.isTrue(!i.isNull(t,Zk.RIGHT),"depth of RIGHT side has not been initialized"),n.setLocation(t,Zk.RIGHT,i.getLocation(t,Zk.RIGHT))))}}}computeLabelling(){for(let t=this._graph.getNodes().iterator();t.hasNext();){t.next().getEdges().computeLabelling(this._arg)}this.mergeSymLabels(),this.updateNodeLabelling()}labelIncompleteNodes(){for(let t=this._graph.getNodes().iterator();t.hasNext();){const e=t.next(),n=e.getLabel();e.isIsolated()&&(n.isNull(0)?this.labelIncompleteNode(e,0):this.labelIncompleteNode(e,1)),e.getEdges().updateLabelling(n)}}isCoveredByA(t){return!!this.isCovered(t,this._resultPolyList)}}UO.INTERSECTION=1,UO.UNION=2,UO.DIFFERENCE=3,UO.SYMDIFFERENCE=4;class YO{constructor(){YO.constructor_.apply(this,arguments)}static constructor_(){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null;const t=arguments[0],e=arguments[1];this._geom[0]=t,this._geom[1]=e,this.computeSnapTolerance()}static overlayOp(t,e,n){return new YO(t,e).getResultGeometry(n)}static union(t,e){return YO.overlayOp(t,e,UO.UNION)}static intersection(t,e){return YO.overlayOp(t,e,UO.INTERSECTION)}static symDifference(t,e){return YO.overlayOp(t,e,UO.SYMDIFFERENCE)}static difference(t,e){return YO.overlayOp(t,e,UO.DIFFERENCE)}selfSnap(t){return new WI(t).snapTo(t,this._snapTolerance)}removeCommonBits(t){this._cbr=new VI,this._cbr.add(t[0]),this._cbr.add(t[1]);const e=new Array(2).fill(null);return e[0]=this._cbr.removeCommonBits(t[0].copy()),e[1]=this._cbr.removeCommonBits(t[1].copy()),e}prepareResult(t){return this._cbr.addCommonBits(t),t}getResultGeometry(t){const e=this.snap(this._geom),n=UO.overlayOp(e[0],e[1],t);return this.prepareResult(n)}checkValid(t){t.isValid()||JS.out.println("Snapped geometry is invalid")}computeSnapTolerance(){this._snapTolerance=WI.computeOverlaySnapTolerance(this._geom[0],this._geom[1])}snap(t){const e=this.removeCommonBits(t);return WI.snap(e[0],e[1],this._snapTolerance)}}class WO{constructor(){WO.constructor_.apply(this,arguments)}static constructor_(){this._geom=new Array(2).fill(null);const t=arguments[0],e=arguments[1];this._geom[0]=t,this._geom[1]=e}static overlayOp(t,e,n){return new WO(t,e).getResultGeometry(n)}static union(t,e){return WO.overlayOp(t,e,UO.UNION)}static intersection(t,e){return WO.overlayOp(t,e,UO.INTERSECTION)}static symDifference(t,e){return WO.overlayOp(t,e,UO.SYMDIFFERENCE)}static difference(t,e){return WO.overlayOp(t,e,UO.DIFFERENCE)}getResultGeometry(t){let e=null,n=!1,i=null;try{e=UO.overlayOp(this._geom[0],this._geom[1],t);!0&&(n=!0)}catch(t){if(!(t instanceof eS))throw t;i=t}if(!n)try{e=YO.overlayOp(this._geom[0],this._geom[1],t)}catch(t){throw t instanceof eS?i:t}return e}}class $O{get interfaces_(){return[]}getClass(){return $O}static union(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return UO.createEmptyResult(UO.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),WO.overlayOp(t,e,UO.UNION)}}class XO{constructor(){XO.constructor_.apply(this,arguments)}static constructor_(){if(this._quadrantSegments=XO.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=XO.CAP_ROUND,this._joinStyle=XO.JOIN_ROUND,this._mitreLimit=XO.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=XO.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){const t=arguments[0];this.setQuadrantSegments(t)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.setQuadrantSegments(t),this.setEndCapStyle(e)}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.setQuadrantSegments(t),this.setEndCapStyle(e),this.setJoinStyle(n),this.setMitreLimit(i)}}static bufferDistanceError(t){const e=Math.PI/2/t;return 1-Math.cos(e/2)}getEndCapStyle(){return this._endCapStyle}isSingleSided(){return this._isSingleSided}setQuadrantSegments(t){this._quadrantSegments=t,0===this._quadrantSegments&&(this._joinStyle=XO.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=XO.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==XO.JOIN_ROUND&&(this._quadrantSegments=XO.DEFAULT_QUADRANT_SEGMENTS)}getJoinStyle(){return this._joinStyle}setJoinStyle(t){this._joinStyle=t}setSimplifyFactor(t){this._simplifyFactor=t<0?0:t}getSimplifyFactor(){return this._simplifyFactor}getQuadrantSegments(){return this._quadrantSegments}setEndCapStyle(t){this._endCapStyle=t}getMitreLimit(){return this._mitreLimit}setMitreLimit(t){this._mitreLimit=t}setSingleSided(t){this._isSingleSided=t}}XO.CAP_ROUND=1,XO.CAP_FLAT=2,XO.CAP_SQUARE=3,XO.JOIN_ROUND=1,XO.JOIN_MITRE=2,XO.JOIN_BEVEL=3,XO.DEFAULT_QUADRANT_SEGMENTS=8,XO.DEFAULT_MITRE_LIMIT=5,XO.DEFAULT_SIMPLIFY_FACTOR=.01;class VO extends VN{constructor(t){super(t),this.name=Object.keys({EmptyStackException:VO})[0]}}class HO extends SS{constructor(){super(),this.array=[]}add(t){return this.array.push(t),!0}get(t){if(t<0||t>=this.size())throw new NS;return this.array[t]}push(t){return this.array.push(t),t}pop(){if(0===this.array.length)throw new VO;return this.array.pop()}peek(){if(0===this.array.length)throw new VO;return this.array[this.array.length-1]}empty(){return 0===this.array.length}isEmpty(){return this.empty()}search(t){return this.array.indexOf(t)}size(){return this.array.length}toArray(){return this.array.slice()}}class ZO{constructor(){ZO.constructor_.apply(this,arguments)}static constructor_(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null}getCoordinate(){return this._minCoord}getRightmostSide(t,e){let n=this.getRightmostSideOfSegment(t,e);return n<0&&(n=this.getRightmostSideOfSegment(t,e-1)),n<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),n}findRightmostEdgeAtVertex(){const t=this._minDe.getEdge().getCoordinates();iS.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");const e=t[this._minIndex-1],n=t[this._minIndex+1],i=PS.index(this._minCoord,n,e);let r=!1;(e.y<this._minCoord.y&&n.y<this._minCoord.y&&i===PS.COUNTERCLOCKWISE||e.y>this._minCoord.y&&n.y>this._minCoord.y&&i===PS.CLOCKWISE)&&(r=!0),r&&(this._minIndex=this._minIndex-1)}getRightmostSideOfSegment(t,e){const n=t.getEdge().getCoordinates();if(e<0||e+1>=n.length)return-1;if(n[e].y===n[e+1].y)return-1;let i=Zk.LEFT;return n[e].y<n[e+1].y&&(i=Zk.RIGHT),i}getEdge(){return this._orientedDe}checkForRightmostCoordinate(t){const e=t.getEdge().getCoordinates();for(let n=0;n<e.length-1;n++)(null===this._minCoord||e[n].x>this._minCoord.x)&&(this._minDe=t,this._minIndex=n,this._minCoord=e[n])}findRightmostEdgeAtNode(){const t=this._minDe.getNode().getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)}findEdge(t){for(let e=t.iterator();e.hasNext();){const t=e.next();t.isForward()&&this.checkForRightmostCoordinate(t)}iS.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe;this.getRightmostSide(this._minDe,this._minIndex)===Zk.LEFT&&(this._orientedDe=this._minDe.getSym())}}class JO{constructor(){this.array=[]}addLast(t){this.array.push(t)}removeFirst(){return this.array.shift()}isEmpty(){return 0===this.array.length}}class QO{constructor(){QO.constructor_.apply(this,arguments)}static constructor_(){this._finder=null,this._dirEdgeList=new kS,this._nodes=new kS,this._rightMostCoord=null,this._env=null,this._finder=new ZO}clearVisitedEdges(){for(let t=this._dirEdgeList.iterator();t.hasNext();){t.next().setVisited(!1)}}getRightmostCoordinate(){return this._rightMostCoord}computeNodeDepth(t){let e=null;for(let n=t.getEdges().iterator();n.hasNext();){const t=n.next();if(t.isVisited()||t.getSym().isVisited()){e=t;break}}if(null===e)throw new Yk("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(let e=t.getEdges().iterator();e.hasNext();){const t=e.next();t.setVisited(!0),this.copySymDepths(t)}}computeDepth(t){this.clearVisitedEdges();const e=this._finder.getEdge();e.getNode(),e.getLabel(),e.setEdgeDepths(Zk.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)}create(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()}findResultEdges(){for(let t=this._dirEdgeList.iterator();t.hasNext();){const e=t.next();e.getDepth(Zk.RIGHT)>=1&&e.getDepth(Zk.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}}computeDepths(t){const e=new rI,n=new JO,i=t.getNode();for(n.addLast(i),e.add(i),t.setVisited(!0);!n.isEmpty();){const t=n.removeFirst();e.add(t),this.computeNodeDepth(t);for(let i=t.getEdges().iterator();i.hasNext();){const t=i.next().getSym();if(t.isVisited())continue;const r=t.getNode();e.contains(r)||(n.addLast(r),e.add(r))}}}compareTo(t){const e=t;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0}getEnvelope(){if(null===this._env){const t=new hS;for(let e=this._dirEdgeList.iterator();e.hasNext();){const n=e.next().getEdge().getCoordinates();for(let e=0;e<n.length-1;e++)t.expandToInclude(n[e])}this._env=t}return this._env}addReachable(t){const e=new HO;for(e.add(t);!e.empty();){const t=e.pop();this.add(t,e)}}copySymDepths(t){const e=t.getSym();e.setDepth(Zk.LEFT,t.getDepth(Zk.RIGHT)),e.setDepth(Zk.RIGHT,t.getDepth(Zk.LEFT))}add(t,e){t.setVisited(!0),this._nodes.add(t);for(let n=t.getEdges().iterator();n.hasNext();){const t=n.next();this._dirEdgeList.add(t);const i=t.getSym().getNode();i.isVisited()||e.push(i)}}getNodes(){return this._nodes}getDirectedEdges(){return this._dirEdgeList}get interfaces_(){return[JN]}}class KO{constructor(){KO.constructor_.apply(this,arguments)}static constructor_(){this._inputLine=null,this._distanceTol=null,this._isDeleted=null,this._angleOrientation=PS.COUNTERCLOCKWISE;const t=arguments[0];this._inputLine=t}static simplify(t,e){return new KO(t).simplify(e)}isDeletable(t,e,n,i){const r=this._inputLine[t],s=this._inputLine[e],o=this._inputLine[n];return!!this.isConcave(r,s,o)&&(!!this.isShallow(r,s,o,i)&&this.isShallowSampled(r,s,t,n,i))}deleteShallowConcavities(){let t=1,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e),i=!1;for(;n<this._inputLine.length;){let r=!1;this.isDeletable(t,e,n,this._distanceTol)&&(this._isDeleted[e]=KO.DELETE,r=!0,i=!0),t=r?n:e,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e)}return i}isShallowConcavity(t,e,n,i){if(!(PS.index(t,e,n)===this._angleOrientation))return!1;return xI.pointToSegment(e,t,n)<i}isShallowSampled(t,e,n,i,r){let s=Math.trunc((i-n)/KO.NUM_PTS_TO_CHECK);s<=0&&(s=1);for(let o=n;o<i;o+=s)if(!this.isShallow(t,e,this._inputLine[o],r))return!1;return!0}isConcave(t,e,n){return PS.index(t,e,n)===this._angleOrientation}simplify(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=PS.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);let e=!1;do{e=this.deleteShallowConcavities()}while(e);return this.collapseLine()}findNextNonDeletedIndex(t){let e=t+1;for(;e<this._inputLine.length&&this._isDeleted[e]===KO.DELETE;)e++;return e}isShallow(t,e,n,i){return xI.pointToSegment(e,t,n)<i}collapseLine(){const t=new HS;for(let e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==KO.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()}}KO.INIT=0,KO.DELETE=1,KO.KEEP=1,KO.NUM_PTS_TO_CHECK=10;class tC{constructor(){tC.constructor_.apply(this,arguments)}static constructor_(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new kS}getCoordinates(){return this._ptList.toArray(tC.COORDINATE_ARRAY_TYPE)}setPrecisionModel(t){this._precisionModel=t}addPt(t){const e=new aS(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)}reverse(){}addPts(t,e){if(e)for(let e=0;e<t.length;e++)this.addPt(t[e]);else for(let e=t.length-1;e>=0;e--)this.addPt(t[e])}isRedundant(t){if(this._ptList.size()<1)return!1;const e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance}toString(){return(new cI).createLineString(this.getCoordinates()).toString()}closeRing(){if(this._ptList.size()<1)return null;const t=new aS(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)}setMinimumVertexDistance(t){this._minimimVertexDistance=t}}tC.COORDINATE_ARRAY_TYPE=new Array(0).fill(null);class eC{static toDegrees(t){return 180*t/Math.PI}static normalize(t){for(;t>Math.PI;)t-=eC.PI_TIMES_2;for(;t<=-Math.PI;)t+=eC.PI_TIMES_2;return t}static angle(){if(1===arguments.length){const t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){const t=arguments[0],e=arguments[1],n=e.x-t.x,i=e.y-t.y;return Math.atan2(i,n)}}static isAcute(t,e,n){const i=t.x-e.x,r=t.y-e.y;return i*(n.x-e.x)+r*(n.y-e.y)>0}static isObtuse(t,e,n){const i=t.x-e.x,r=t.y-e.y;return i*(n.x-e.x)+r*(n.y-e.y)<0}static interiorAngle(t,e,n){const i=eC.angle(e,t),r=eC.angle(e,n);return Math.abs(r-i)}static normalizePositive(t){if(t<0){for(;t<0;)t+=eC.PI_TIMES_2;t>=eC.PI_TIMES_2&&(t=0)}else{for(;t>=eC.PI_TIMES_2;)t-=eC.PI_TIMES_2;t<0&&(t=0)}return t}static angleBetween(t,e,n){const i=eC.angle(e,t),r=eC.angle(e,n);return eC.diff(i,r)}static diff(t,e){let n=null;return n=t<e?e-t:t-e,n>Math.PI&&(n=2*Math.PI-n),n}static toRadians(t){return t*Math.PI/180}static getTurn(t,e){const n=Math.sin(e-t);return n>0?eC.COUNTERCLOCKWISE:n<0?eC.CLOCKWISE:eC.NONE}static angleBetweenOriented(t,e,n){const i=eC.angle(e,t),r=eC.angle(e,n)-i;return r<=-Math.PI?r+eC.PI_TIMES_2:r>Math.PI?r-eC.PI_TIMES_2:r}}eC.PI_TIMES_2=2*Math.PI,eC.PI_OVER_2=Math.PI/2,eC.PI_OVER_4=Math.PI/4,eC.COUNTERCLOCKWISE=PS.COUNTERCLOCKWISE,eC.CLOCKWISE=PS.CLOCKWISE,eC.NONE=PS.COLLINEAR;class nC{constructor(){nC.constructor_.apply(this,arguments)}static constructor_(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new UI,this._seg1=new UI,this._offset0=new UI,this._offset1=new UI,this._side=0,this._hasNarrowConcaveAngle=!1;const t=arguments[0],e=arguments[1],n=arguments[2];this._precisionModel=t,this._bufParams=e,this._li=new BI,this._filletAngleQuantum=Math.PI/2/e.getQuadrantSegments(),e.getQuadrantSegments()>=8&&e.getJoinStyle()===XO.JOIN_ROUND&&(this._closingSegLengthFactor=nC.MAX_CLOSING_SEG_LEN_FACTOR),this.init(n)}addNextSegment(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;const n=PS.index(this._s0,this._s1,this._s2),i=n===PS.CLOCKWISE&&this._side===Zk.LEFT||n===PS.COUNTERCLOCKWISE&&this._side===Zk.RIGHT;0===n?this.addCollinear(e):i?this.addOutsideTurn(n,e):this.addInsideTurn(n,e)}addLineEndCap(t,e){const n=new UI(t,e),i=new UI;this.computeOffsetSegment(n,Zk.LEFT,this._distance,i);const r=new UI;this.computeOffsetSegment(n,Zk.RIGHT,this._distance,r);const s=e.x-t.x,o=e.y-t.y,a=Math.atan2(o,s);switch(this._bufParams.getEndCapStyle()){case XO.CAP_ROUND:this._segList.addPt(i.p1),this.addDirectedFillet(e,a+Math.PI/2,a-Math.PI/2,PS.CLOCKWISE,this._distance),this._segList.addPt(r.p1);break;case XO.CAP_FLAT:this._segList.addPt(i.p1),this._segList.addPt(r.p1);break;case XO.CAP_SQUARE:const t=new aS;t.x=Math.abs(this._distance)*Math.cos(a),t.y=Math.abs(this._distance)*Math.sin(a);const n=new aS(i.p1.x+t.x,i.p1.y+t.y),s=new aS(r.p1.x+t.x,r.p1.y+t.y);this._segList.addPt(n),this._segList.addPt(s)}}getCoordinates(){return this._segList.getCoordinates()}addMitreJoin(t,e,n,i){const r=mI.intersection(e.p0,e.p1,n.p0,n.p1);if(null!==r){if((i<=0?1:r.distance(t)/Math.abs(i))<=this._bufParams.getMitreLimit())return this._segList.addPt(r),null}this.addLimitedMitreJoin(e,n,i,this._bufParams.getMitreLimit())}addOutsideTurn(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*nC.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===XO.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===XO.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))}createSquare(t){this._segList.addPt(new aS(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new aS(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new aS(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new aS(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()}addSegments(t,e){this._segList.addPts(t,e)}addFirstSegment(){this._segList.addPt(this._offset1.p0)}addCornerFillet(t,e,n,i,r){const s=e.x-t.x,o=e.y-t.y;let a=Math.atan2(o,s);const l=n.x-t.x,h=n.y-t.y,c=Math.atan2(h,l);i===PS.CLOCKWISE?a<=c&&(a+=2*Math.PI):a>=c&&(a-=2*Math.PI),this._segList.addPt(e),this.addDirectedFillet(t,a,c,i,r),this._segList.addPt(n)}addLastSegment(){this._segList.addPt(this._offset1.p1)}initSideSegments(t,e,n){this._s1=t,this._s2=e,this._side=n,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,n,this._distance,this._offset1)}addLimitedMitreJoin(t,e,n,i){const r=this._seg0.p1,s=eC.angle(r,this._seg0.p0),o=eC.angleBetweenOriented(this._seg0.p0,r,this._seg1.p1)/2,a=eC.normalize(s+o),l=eC.normalize(a+Math.PI),h=i*n,c=n-h*Math.abs(Math.sin(o)),u=r.x+h*Math.cos(l),f=r.y+h*Math.sin(l),d=new aS(u,f),p=new UI(r,d),g=p.pointAlongOffset(1,c),_=p.pointAlongOffset(1,-c);this._side===Zk.LEFT?(this._segList.addPt(g),this._segList.addPt(_)):(this._segList.addPt(_),this._segList.addPt(g))}addDirectedFillet(t,e,n,i,r){const s=i===PS.CLOCKWISE?-1:1,o=Math.abs(e-n),a=Math.trunc(o/this._filletAngleQuantum+.5);if(a<1)return null;const l=o/a,h=new aS;for(let n=0;n<a;n++){const i=e+s*n*l;h.x=t.x+r*Math.cos(i),h.y=t.y+r*Math.sin(i),this._segList.addPt(h)}}computeOffsetSegment(t,e,n,i){const r=e===Zk.LEFT?1:-1,s=t.p1.x-t.p0.x,o=t.p1.y-t.p0.y,a=Math.sqrt(s*s+o*o),l=r*n*s/a,h=r*n*o/a;i.p0.x=t.p0.x-h,i.p0.y=t.p0.y+l,i.p1.x=t.p1.x-h,i.p1.y=t.p1.y+l}addInsideTurn(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*nC.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){const t=new aS((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(t);const e=new aS((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(e)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}}createCircle(t){const e=new aS(t.x+this._distance,t.y);this._segList.addPt(e),this.addDirectedFillet(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()}addBevelJoin(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)}init(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new tC,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*nC.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)}addCollinear(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2);this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===XO.JOIN_BEVEL||this._bufParams.getJoinStyle()===XO.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,PS.CLOCKWISE,this._distance))}closeRing(){this._segList.closeRing()}hasNarrowConcaveAngle(){return this._hasNarrowConcaveAngle}}nC.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,nC.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,nC.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,nC.MAX_CLOSING_SEG_LEN_FACTOR=80;class iC{constructor(){iC.constructor_.apply(this,arguments)}static constructor_(){this._distance=0,this._precisionModel=null,this._bufParams=null;const t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e}static copyCoordinates(t){const e=new Array(t.length).fill(null);for(let n=0;n<e.length;n++)e[n]=new aS(t[n]);return e}getOffsetCurve(t,e){if(this._distance=e,0===e)return null;const n=e<0,i=Math.abs(e),r=this.getSegGen(i);t.length<=1?this.computePointCurve(t[0],r):this.computeOffsetCurve(t,n,r);const s=r.getCoordinates();return n&&QS.reverse(s),s}computeSingleSidedBufferCurve(t,e,n){const i=this.simplifyTolerance(this._distance);if(e){n.addSegments(t,!0);const e=KO.simplify(t,-i),r=e.length-1;n.initSideSegments(e[r],e[r-1],Zk.LEFT),n.addFirstSegment();for(let t=r-2;t>=0;t--)n.addNextSegment(e[t],!0)}else{n.addSegments(t,!1);const e=KO.simplify(t,i),r=e.length-1;n.initSideSegments(e[0],e[1],Zk.LEFT),n.addFirstSegment();for(let t=2;t<=r;t++)n.addNextSegment(e[t],!0)}n.addLastSegment(),n.closeRing()}computeRingBufferCurve(t,e,n){let i=this.simplifyTolerance(this._distance);e===Zk.RIGHT&&(i=-i);const r=KO.simplify(t,i),s=r.length-1;n.initSideSegments(r[s-1],r[0],e);for(let t=1;t<=s;t++){const e=1!==t;n.addNextSegment(r[t],e)}n.closeRing()}computeLineBufferCurve(t,e){const n=this.simplifyTolerance(this._distance),i=KO.simplify(t,n),r=i.length-1;e.initSideSegments(i[0],i[1],Zk.LEFT);for(let t=2;t<=r;t++)e.addNextSegment(i[t],!0);e.addLastSegment(),e.addLineEndCap(i[r-1],i[r]);const s=KO.simplify(t,-n),o=s.length-1;e.initSideSegments(s[o],s[o-1],Zk.LEFT);for(let t=o-2;t>=0;t--)e.addNextSegment(s[t],!0);e.addLastSegment(),e.addLineEndCap(s[1],s[0]),e.closeRing()}computePointCurve(t,e){switch(this._bufParams.getEndCapStyle()){case XO.CAP_ROUND:e.createCircle(t);break;case XO.CAP_SQUARE:e.createSquare(t)}}getLineCurve(t,e){if(this._distance=e,this.isLineOffsetEmpty(e))return null;const n=Math.abs(e),i=this.getSegGen(n);if(t.length<=1)this.computePointCurve(t[0],i);else if(this._bufParams.isSingleSided()){const n=e<0;this.computeSingleSidedBufferCurve(t,n,i)}else this.computeLineBufferCurve(t,i);return i.getCoordinates()}getBufferParameters(){return this._bufParams}simplifyTolerance(t){return t*this._bufParams.getSimplifyFactor()}getRingCurve(t,e,n){if(this._distance=n,t.length<=2)return this.getLineCurve(t,n);if(0===n)return iC.copyCoordinates(t);const i=this.getSegGen(n);return this.computeRingBufferCurve(t,e,i),i.getCoordinates()}computeOffsetCurve(t,e,n){const i=this.simplifyTolerance(this._distance);if(e){const e=KO.simplify(t,-i),r=e.length-1;n.initSideSegments(e[r],e[r-1],Zk.LEFT),n.addFirstSegment();for(let t=r-2;t>=0;t--)n.addNextSegment(e[t],!0)}else{const e=KO.simplify(t,i),r=e.length-1;n.initSideSegments(e[0],e[1],Zk.LEFT),n.addFirstSegment();for(let t=2;t<=r;t++)n.addNextSegment(e[t],!0)}n.addLastSegment()}isLineOffsetEmpty(t){return 0===t||t<0&&!this._bufParams.isSingleSided()}getSegGen(t){return new nC(this._precisionModel,this._bufParams,t)}}class rC{constructor(){rC.constructor_.apply(this,arguments)}static constructor_(){this._subgraphs=null,this._seg=new UI;const t=arguments[0];this._subgraphs=t}findStabbedSegments(){if(1===arguments.length){const t=arguments[0],e=new kS;for(let n=this._subgraphs.iterator();n.hasNext();){const i=n.next(),r=i.getEnvelope();t.y<r.getMinY()||t.y>r.getMaxY()||this.findStabbedSegments(t,i.getDirectedEdges(),e)}return e}if(3===arguments.length)if(BN(arguments[2],SS)&&arguments[0]instanceof aS&&arguments[1]instanceof oO){const t=arguments[0],e=arguments[1],n=arguments[2],i=e.getEdge().getCoordinates();for(let r=0;r<i.length-1;r++){this._seg.p0=i[r],this._seg.p1=i[r+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse();if(Math.max(this._seg.p0.x,this._seg.p1.x)<t.x)continue;if(this._seg.isHorizontal())continue;if(t.y<this._seg.p0.y||t.y>this._seg.p1.y)continue;if(PS.index(this._seg.p0,this._seg.p1,t)===PS.RIGHT)continue;let s=e.getDepth(Zk.LEFT);this._seg.p0.equals(i[r])||(s=e.getDepth(Zk.RIGHT));const o=new sC(this._seg,s);n.add(o)}}else if(BN(arguments[2],SS)&&arguments[0]instanceof aS&&BN(arguments[1],SS)){const t=arguments[0],e=arguments[2];for(let n=arguments[1].iterator();n.hasNext();){const i=n.next();i.isForward()&&this.findStabbedSegments(t,i,e)}}}getDepth(t){const e=this.findStabbedSegments(t);if(0===e.size())return 0;return _k.min(e)._leftDepth}}class sC{constructor(){sC.constructor_.apply(this,arguments)}static constructor_(){this._upwardSeg=null,this._leftDepth=null;const t=arguments[0],e=arguments[1];this._upwardSeg=new UI(t),this._leftDepth=e}compareTo(t){const e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;let n=this._upwardSeg.orientationIndex(e._upwardSeg);return 0!==n?n:(n=-1*e._upwardSeg.orientationIndex(this._upwardSeg),0!==n?n:this._upwardSeg.compareTo(e._upwardSeg))}compareX(t,e){const n=t.p0.compareTo(e.p0);return 0!==n?n:t.p1.compareTo(e.p1)}toString(){return this._upwardSeg.toString()}get interfaces_(){return[JN]}}rC.DepthSegment=sC;class oC extends VN{constructor(){super(),oC.constructor_.apply(this,arguments)}static constructor_(){VN.constructor_.call(this,"Projective point not representable on the Cartesian plane.")}}class aC{constructor(){aC.constructor_.apply(this,arguments)}static constructor_(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){const t=arguments[0];this.x=t.x,this.y=t.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1];this.x=t,this.y=e,this.w=1}else if(arguments[0]instanceof aC&&arguments[1]instanceof aC){const t=arguments[0],e=arguments[1];this.x=t.y*e.w-e.y*t.w,this.y=e.x*t.w-t.x*e.w,this.w=t.x*e.y-e.x*t.y}else if(arguments[0]instanceof aS&&arguments[1]instanceof aS){const t=arguments[0],e=arguments[1];this.x=t.y-e.y,this.y=e.x-t.x,this.w=t.x*e.y-e.x*t.y}}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this.x=t,this.y=e,this.w=n}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=t.y-e.y,s=e.x-t.x,o=t.x*e.y-e.x*t.y,a=n.y-i.y,l=i.x-n.x,h=n.x*i.y-i.x*n.y;this.x=s*h-l*o,this.y=a*o-r*h,this.w=r*l-a*s}}getY(){const t=this.y/this.w;if(YN.isNaN(t)||YN.isInfinite(t))throw new oC;return t}getX(){const t=this.x/this.w;if(YN.isNaN(t)||YN.isInfinite(t))throw new oC;return t}getCoordinate(){const t=new aS;return t.x=this.getX(),t.y=this.getY(),t}}class lC{constructor(){lC.constructor_.apply(this,arguments)}static constructor_(){this.p0=null,this.p1=null,this.p2=null;const t=arguments[0],e=arguments[1],n=arguments[2];this.p0=t,this.p1=e,this.p2=n}static area(t,e,n){return Math.abs(((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2)}static signedArea(t,e,n){return((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2}static det(t,e,n,i){return t*i-e*n}static interpolateZ(t,e,n,i){const r=e.x,s=e.y,o=n.x-r,a=i.x-r,l=n.y-s,h=i.y-s,c=o*h-a*l,u=t.x-r,f=t.y-s,d=(h*u-a*f)/c,p=(-l*u+o*f)/c;return e.getZ()+d*(n.getZ()-e.getZ())+p*(i.getZ()-e.getZ())}static longestSideLength(t,e,n){const i=t.distance(e),r=e.distance(n),s=n.distance(t);let o=i;return r>o&&(o=r),s>o&&(o=s),o}static circumcentreDD(t,e,n){const i=AS.valueOf(t.x).subtract(n.x),r=AS.valueOf(t.y).subtract(n.y),s=AS.valueOf(e.x).subtract(n.x),o=AS.valueOf(e.y).subtract(n.y),a=AS.determinant(i,r,s,o).multiply(2),l=i.sqr().add(r.sqr()),h=s.sqr().add(o.sqr()),c=AS.determinant(r,l,o,h),u=AS.determinant(i,l,s,h),f=AS.valueOf(n.x).subtract(c.divide(a)).doubleValue(),d=AS.valueOf(n.y).add(u.divide(a)).doubleValue();return new aS(f,d)}static isAcute(t,e,n){return!!eC.isAcute(t,e,n)&&(!!eC.isAcute(e,n,t)&&!!eC.isAcute(n,t,e))}static circumcentre(t,e,n){const i=n.x,r=n.y,s=t.x-i,o=t.y-r,a=e.x-i,l=e.y-r,h=2*lC.det(s,o,a,l),c=lC.det(o,s*s+o*o,l,a*a+l*l),u=lC.det(s,s*s+o*o,a,a*a+l*l);return new aS(i-c/h,r+u/h)}static perpendicularBisector(t,e){const n=e.x-t.x,i=e.y-t.y,r=new aC(t.x+n/2,t.y+i/2,1),s=new aC(t.x-i+n/2,t.y+n+i/2,1);return new aC(r,s)}static angleBisector(t,e,n){const i=e.distance(t),r=i/(i+e.distance(n)),s=n.x-t.x,o=n.y-t.y;return new aS(t.x+r*s,t.y+r*o)}static area3D(t,e,n){const i=e.x-t.x,r=e.y-t.y,s=e.getZ()-t.getZ(),o=n.x-t.x,a=n.y-t.y,l=n.getZ()-t.getZ(),h=r*l-s*a,c=s*o-i*l,u=i*a-r*o,f=h*h+c*c+u*u;return Math.sqrt(f)/2}static centroid(t,e,n){const i=(t.x+e.x+n.x)/3,r=(t.y+e.y+n.y)/3;return new aS(i,r)}static inCentre(t,e,n){const i=e.distance(n),r=t.distance(n),s=t.distance(e),o=i+r+s,a=(i*t.x+r*e.x+s*n.x)/o,l=(i*t.y+r*e.y+s*n.y)/o;return new aS(a,l)}area(){return lC.area(this.p0,this.p1,this.p2)}signedArea(){return lC.signedArea(this.p0,this.p1,this.p2)}interpolateZ(t){if(null===t)throw new HN("Supplied point is null.");return lC.interpolateZ(t,this.p0,this.p1,this.p2)}longestSideLength(){return lC.longestSideLength(this.p0,this.p1,this.p2)}isAcute(){return lC.isAcute(this.p0,this.p1,this.p2)}circumcentre(){return lC.circumcentre(this.p0,this.p1,this.p2)}area3D(){return lC.area3D(this.p0,this.p1,this.p2)}centroid(){return lC.centroid(this.p0,this.p1,this.p2)}inCentre(){return lC.inCentre(this.p0,this.p1,this.p2)}}class hC{constructor(){hC.constructor_.apply(this,arguments)}static constructor_(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new kS;const t=arguments[0],e=arguments[1],n=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=n}addRingSide(t,e,n,i,r){if(0===e&&t.length<YS.MINIMUM_VALID_SIZE)return null;let s=i,o=r;t.length>=YS.MINIMUM_VALID_SIZE&&PS.isCCW(t)&&(s=r,o=i,n=Zk.opposite(n));const a=this._curveBuilder.getRingCurve(t,n,e);this.addCurve(a,s,o)}addRingBothSides(t,e){this.addRingSide(t,e,Zk.LEFT,JI.EXTERIOR,JI.INTERIOR),this.addRingSide(t,e,Zk.RIGHT,JI.INTERIOR,JI.EXTERIOR)}addPoint(t){if(this._distance<=0)return null;const e=t.getCoordinates(),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,JI.EXTERIOR,JI.INTERIOR)}addPolygon(t){let e=this._distance,n=Zk.LEFT;this._distance<0&&(e=-this._distance,n=Zk.RIGHT);const i=t.getExteriorRing(),r=QS.removeRepeatedPoints(i.getCoordinates());if(this._distance<0&&this.isErodedCompletely(i,this._distance))return null;if(this._distance<=0&&r.length<3)return null;this.addRingSide(r,e,n,JI.EXTERIOR,JI.INTERIOR);for(let i=0;i<t.getNumInteriorRing();i++){const r=t.getInteriorRingN(i),s=QS.removeRepeatedPoints(r.getCoordinates());this._distance>0&&this.isErodedCompletely(r,-this._distance)||this.addRingSide(s,e,Zk.opposite(n),JI.INTERIOR,JI.EXTERIOR)}}isTriangleErodedCompletely(t,e){const n=new lC(t[0],t[1],t[2]),i=n.inCentre();return xI.pointToSegment(i,n.p0,n.p1)<Math.abs(e)}addLineString(t){if(this._curveBuilder.isLineOffsetEmpty(this._distance))return null;const e=QS.removeRepeatedPoints(t.getCoordinates());if(QS.isRing(e)&&!this._curveBuilder.getBufferParameters().isSingleSided())this.addRingBothSides(e,this._distance);else{const t=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(t,JI.EXTERIOR,JI.INTERIOR)}}addCurve(t,e,n){if(null===t||t.length<2)return null;const i=new Pk(t,new Qk(0,JI.BOUNDARY,e,n));this._curveList.add(i)}getCurves(){return this.add(this._inputGeom),this._curveList}add(t){if(t.isEmpty())return null;if(t instanceof zS)this.addPolygon(t);else if(t instanceof vS)this.addLineString(t);else if(t instanceof MS)this.addPoint(t);else if(t instanceof US)this.addCollection(t);else if(t instanceof hI)this.addCollection(t);else if(t instanceof nI)this.addCollection(t);else{if(!(t instanceof BS))throw new gS(t.getGeometryType());this.addCollection(t)}}isErodedCompletely(t,e){const n=t.getCoordinates();if(n.length<4)return e<0;if(4===n.length)return this.isTriangleErodedCompletely(n,e);const i=t.getEnvelopeInternal(),r=Math.min(i.getHeight(),i.getWidth());return e<0&&2*Math.abs(e)>r}addCollection(t){for(let e=0;e<t.getNumGeometries();e++){const n=t.getGeometryN(e);this.add(n)}}}class cC{constructor(){cC.constructor_.apply(this,arguments)}static constructor_(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;const t=arguments[0];this._li=t}static isAdjacentSegments(t,e){return 1===Math.abs(t-e)}isTrivialIntersection(t,e,n,i){if(t===n&&1===this._li.getIntersectionNum()){if(cC.isAdjacentSegments(e,i))return!0;if(t.isClosed()){const n=t.size()-1;if(0===e&&i===n||0===i&&e===n)return!0}}return!1}getProperIntersectionPoint(){return this._properIntersectionPoint}hasProperInteriorIntersection(){return this._hasProperInterior}getLineIntersector(){return this._li}hasProperIntersection(){return this._hasProper}processIntersections(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;const r=t.getCoordinates()[e],s=t.getCoordinates()[e+1],o=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,s,o,a),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))}hasIntersection(){return this._hasIntersection}isDone(){return!1}hasInteriorIntersection(){return this._hasInterior}get interfaces_(){return[Wk]}}class uC{constructor(){uC.constructor_.apply(this,arguments)}static constructor_(){this._bufParams=null,this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new BO;const t=arguments[0];this._bufParams=t}static depthDelta(t){const e=t.getLocation(0,Zk.LEFT),n=t.getLocation(0,Zk.RIGHT);return e===JI.INTERIOR&&n===JI.EXTERIOR?1:e===JI.EXTERIOR&&n===JI.INTERIOR?-1:0}static convertSegStrings(t){const e=new cI,n=new kS;for(;t.hasNext();){const i=t.next(),r=e.createLineString(i.getCoordinates());n.add(r)}return e.buildGeometry(n)}setWorkingPrecisionModel(t){this._workingPrecisionModel=t}insertUniqueEdge(t){const e=this._edgeList.findEqualEdge(t);if(null!==e){const n=e.getLabel();let i=t.getLabel();e.isPointwiseEqual(t)||(i=new Qk(t.getLabel()),i.flip()),n.merge(i);const r=uC.depthDelta(i),s=e.getDepthDelta()+r;e.setDepthDelta(s)}else this._edgeList.add(t),t.setDepthDelta(uC.depthDelta(t.getLabel()))}buildSubgraphs(t,e){const n=new kS;for(let i=t.iterator();i.hasNext();){const t=i.next(),r=t.getRightmostCoordinate(),s=new rC(n).getDepth(r);t.computeDepth(s),t.findResultEdges(),n.add(t),e.add(t.getDirectedEdges(),t.getNodes())}}createSubgraphs(t){const e=new kS;for(let n=t.getNodes().iterator();n.hasNext();){const t=n.next();if(!t.isVisited()){const n=new QO;n.create(t),e.add(n)}}return _k.sort(e,_k.reverseOrder()),e}createEmptyResultGeometry(){return this._geomFact.createPolygon()}getNoder(t){if(null!==this._workingNoder)return this._workingNoder;const e=new Bk,n=new BI;return n.setPrecisionModel(t),e.setSegmentIntersector(new cC(n)),e}buffer(t,e){let n=this._workingPrecisionModel;null===n&&(n=t.getPrecisionModel()),this._geomFact=t.getFactory();const i=new iC(n,this._bufParams),r=new hC(t,e,i).getCurves();if(r.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(r,n),this._graph=new lO(new _O),this._graph.addEdges(this._edgeList.getEdges());const s=this.createSubgraphs(this._graph),o=new hO(this._geomFact);this.buildSubgraphs(s,o);const a=o.getPolygons();if(a.size()<=0)return this.createEmptyResultGeometry();return this._geomFact.buildGeometry(a)}computeNodedEdges(t,e){const n=this.getNoder(e);n.computeNodes(t);for(let t=n.getNodedSubstrings().iterator();t.hasNext();){const e=t.next(),n=e.getCoordinates();if(2===n.length&&n[0].equals2D(n[1]))continue;const i=e.getData(),r=new FO(e.getCoordinates(),new Qk(i));this.insertUniqueEdge(r)}}setNoder(t){this._workingNoder=t}}class fC{constructor(){fC.constructor_.apply(this,arguments)}static constructor_(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){const t=arguments[0],e=arguments[1];fC.constructor_.call(this,t,e,0,0)}else if(4===arguments.length){const t=arguments[0],e=arguments[1];this._noder=t,this._scaleFactor=e,this._isScaled=!this.isIntegerPrecision()}}rescale(){if(BN(arguments[0],ES)){for(let t=arguments[0].iterator();t.hasNext();){const e=t.next();this.rescale(e.getCoordinates())}}else if(arguments[0]instanceof Array){const t=arguments[0];for(let e=0;e<t.length;e++)t[e].x=t[e].x/this._scaleFactor+this._offsetX,t[e].y=t[e].y/this._scaleFactor+this._offsetY;2===t.length&&t[0].equals2D(t[1])&&JS.out.println(t)}}scale(){if(BN(arguments[0],ES)){const t=arguments[0],e=new kS(t.size());for(let n=t.iterator();n.hasNext();){const t=n.next();e.add(new Pk(this.scale(t.getCoordinates()),t.getData()))}return e}if(arguments[0]instanceof Array){const t=arguments[0],e=new Array(t.length).fill(null);for(let n=0;n<t.length;n++)e[n]=new aS(Math.round((t[n].x-this._offsetX)*this._scaleFactor),Math.round((t[n].y-this._offsetY)*this._scaleFactor),t[n].getZ());return QS.removeRepeatedPoints(e)}}isIntegerPrecision(){return 1===this._scaleFactor}getNodedSubstrings(){const t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t}computeNodes(t){let e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)}get interfaces_(){return[qk]}}class dC{constructor(){dC.constructor_.apply(this,arguments)}static constructor_(){this._li=new BI,this._segStrings=null;const t=arguments[0];this._segStrings=t}checkEndPtVertexIntersections(){if(0===arguments.length)for(let t=this._segStrings.iterator();t.hasNext();){const e=t.next().getCoordinates();this.checkEndPtVertexIntersections(e[0],this._segStrings),this.checkEndPtVertexIntersections(e[e.length-1],this._segStrings)}else if(2===arguments.length){const t=arguments[0];for(let e=arguments[1].iterator();e.hasNext();){const n=e.next().getCoordinates();for(let e=1;e<n.length-1;e++)if(n[e].equals(t))throw new eS("found endpt/interior pt intersection at index "+e+" :pt "+t)}}}checkInteriorIntersections(){if(0===arguments.length)for(let t=this._segStrings.iterator();t.hasNext();){const e=t.next();for(let t=this._segStrings.iterator();t.hasNext();){const n=t.next();this.checkInteriorIntersections(e,n)}}else if(2===arguments.length){const t=arguments[0],e=arguments[1],n=t.getCoordinates(),i=e.getCoordinates();for(let r=0;r<n.length-1;r++)for(let n=0;n<i.length-1;n++)this.checkInteriorIntersections(t,r,e,n)}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];if(t===n&&e===i)return null;const r=t.getCoordinates()[e],s=t.getCoordinates()[e+1],o=n.getCoordinates()[i],a=n.getCoordinates()[i+1];if(this._li.computeIntersection(r,s,o,a),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,r,s)||this.hasInteriorIntersection(this._li,o,a)))throw new eS("found non-noded intersection at "+r+"-"+s+" and "+o+"-"+a)}}checkValid(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()}checkCollapses(){if(0===arguments.length)for(let t=this._segStrings.iterator();t.hasNext();){const e=t.next();this.checkCollapses(e)}else if(1===arguments.length){const t=arguments[0].getCoordinates();for(let e=0;e<t.length-2;e++)this.checkCollapse(t[e],t[e+1],t[e+2])}}hasInteriorIntersection(t,e,n){for(let i=0;i<t.getIntersectionNum();i++){const r=t.getIntersection(i);if(!r.equals(e)&&!r.equals(n))return!0}return!1}checkCollapse(t,e,n){if(t.equals(n))throw new eS("found non-noded collapse at "+dC.fact.createLineString([t,e,n]))}}dC.fact=new cI;class pC{constructor(){pC.constructor_.apply(this,arguments)}static constructor_(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;const t=arguments[0],e=arguments[1],n=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=n,e<=0)throw new HN("Scale factor must be non-zero");1!==e&&(this._pt=new aS(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new aS,this._p1Scaled=new aS),this.initCorners(this._pt)}intersectsScaled(t,e){const n=Math.min(t.x,e.x),i=Math.max(t.x,e.x),r=Math.min(t.y,e.y),s=Math.max(t.y,e.y),o=this._maxx<n||this._minx>i||this._maxy<r||this._miny>s;if(o)return!1;const a=this.intersectsToleranceSquare(t,e);return iS.isTrue(!(o&&a),"Found bad envelope test"),a}initCorners(t){const e=.5;this._minx=t.x-e,this._maxx=t.x+e,this._miny=t.y-e,this._maxy=t.y+e,this._corner[0]=new aS(this._maxx,this._maxy),this._corner[1]=new aS(this._minx,this._maxy),this._corner[2]=new aS(this._minx,this._miny),this._corner[3]=new aS(this._maxx,this._miny)}intersects(t,e){return 1===this._scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))}scale(t){return Math.round(t*this._scaleFactor)}getCoordinate(){return this._originalPt}copyScaled(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)}getSafeEnvelope(){if(null===this._safeEnv){const t=pC.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new hS(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv}intersectsPixelClosure(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))}intersectsToleranceSquare(t,e){let n=!1,i=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(i=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),!!this._li.isProper()||(!(!n||!i)||(!!t.equals(this._pt)||!!e.equals(this._pt))))))}addSnappedNode(t,e){const n=t.getCoordinate(e),i=t.getCoordinate(e+1);return!!this.intersects(n,i)&&(t.addIntersection(this.getCoordinate(),e),!0)}}pC.SAFE_ENV_EXPANSION_FACTOR=.75;class gC{constructor(){gC.constructor_.apply(this,arguments)}static constructor_(){this.selectedSegment=new UI}select(){if(1===arguments.length);else if(2===arguments.length){const t=arguments[1];arguments[0].getLineSegment(t,this.selectedSegment),this.select(this.selectedSegment)}}}class _C{constructor(){_C.constructor_.apply(this,arguments)}static constructor_(){this._index=null;const t=arguments[0];this._index=t}snap(){if(1===arguments.length){const t=arguments[0];return this.snap(t,null,-1)}if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=t.getSafeEnvelope(),r=new yC(t,e,n);return this._index.query(i,new class{get interfaces_(){return[xk]}visitItem(t){t.select(i,r)}}),r.isNodeAdded()}}}class yC extends gC{constructor(){super(),yC.constructor_.apply(this,arguments)}static constructor_(){this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;const t=arguments[0],e=arguments[1],n=arguments[2];this._hotPixel=t,this._parentEdge=e,this._hotPixelVertexIndex=n}isNodeAdded(){return this._isNodeAdded}select(){if(!(2===arguments.length&&Number.isInteger(arguments[1])&&arguments[0]instanceof zk))return super.select.apply(this,arguments);{const t=arguments[1],e=arguments[0].getContext();if(this._parentEdge===e&&(t===this._hotPixelVertexIndex||t+1===this._hotPixelVertexIndex))return null;this._isNodeAdded|=this._hotPixel.addSnappedNode(e,t)}}}_C.HotPixelSnapAction=yC;class mC{constructor(){mC.constructor_.apply(this,arguments)}static constructor_(){this._li=null,this._interiorIntersections=null;const t=arguments[0];this._li=t,this._interiorIntersections=new kS}processIntersections(t,e,n,i){if(t===n&&e===i)return null;const r=t.getCoordinates()[e],s=t.getCoordinates()[e+1],o=n.getCoordinates()[i],a=n.getCoordinates()[i+1];if(this._li.computeIntersection(r,s,o,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(let t=0;t<this._li.getIntersectionNum();t++)this._interiorIntersections.add(this._li.getIntersection(t));t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1)}}isDone(){return!1}getInteriorIntersections(){return this._interiorIntersections}get interfaces_(){return[Wk]}}class xC{constructor(){xC.constructor_.apply(this,arguments)}static constructor_(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;const t=arguments[0];this._pm=t,this._li=new BI,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()}checkCorrectness(t){const e=Pk.getNodedSubstrings(t),n=new dC(e);try{n.checkValid()}catch(t){if(!(t instanceof VN))throw t;t.printStackTrace()}}getNodedSubstrings(){return Pk.getNodedSubstrings(this._nodedSegStrings)}snapRound(t,e){const n=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(n),this.computeVertexSnaps(t)}findInteriorIntersections(t,e){const n=new mC(e);return this._noder.setSegmentIntersector(n),this._noder.computeNodes(t),n.getInteriorIntersections()}computeVertexSnaps(){if(BN(arguments[0],ES)){for(let t=arguments[0].iterator();t.hasNext();){const e=t.next();this.computeVertexSnaps(e)}}else if(arguments[0]instanceof Pk){const t=arguments[0],e=t.getCoordinates();for(let n=0;n<e.length;n++){const i=new pC(e[n],this._scaleFactor,this._li);this._pointSnapper.snap(i,t,n)&&t.addIntersection(e[n],n)}}}computeNodes(t){this._nodedSegStrings=t,this._noder=new Bk,this._pointSnapper=new _C(this._noder.getIndex()),this.snapRound(t,this._li)}computeIntersectionSnaps(t){for(let e=t.iterator();e.hasNext();){const t=e.next(),n=new pC(t,this._scaleFactor,this._li);this._pointSnapper.snap(n)}}get interfaces_(){return[qk]}}class vC{constructor(){vC.constructor_.apply(this,arguments)}static constructor_(){if(this._argGeom=null,this._distance=null,this._bufParams=new XO,this._resultGeometry=null,this._saveException=null,1===arguments.length){const t=arguments[0];this._argGeom=t}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this._argGeom=t,this._bufParams=e}}static bufferOp(){if(2===arguments.length){const t=arguments[1];return new vC(arguments[0]).getResultGeometry(t)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof cS&&"number"==typeof arguments[1]){const t=arguments[1],e=arguments[2],n=new vC(arguments[0]);n.setQuadrantSegments(e);return n.getResultGeometry(t)}if(arguments[2]instanceof XO&&arguments[0]instanceof cS&&"number"==typeof arguments[1]){const t=arguments[1];return new vC(arguments[0],arguments[2]).getResultGeometry(t)}}else if(4===arguments.length){const t=arguments[1],e=arguments[2],n=arguments[3],i=new vC(arguments[0]);i.setQuadrantSegments(e),i.setEndCapStyle(n);return i.getResultGeometry(t)}}static precisionScaleFactor(t,e,n){const i=t.getEnvelopeInternal(),r=ZS.max(Math.abs(i.getMaxX()),Math.abs(i.getMaxY()),Math.abs(i.getMinX()),Math.abs(i.getMinY()))+2*(e>0?e:0),s=n-Math.trunc(Math.log(r)/Math.log(10)+1);return Math.pow(10,s)}bufferFixedPrecision(t){const e=new fC(new xC(new aI(1)),t.getScale()),n=new uC(this._bufParams);n.setWorkingPrecisionModel(t),n.setNoder(e),this._resultGeometry=n.buffer(this._argGeom,this._distance)}bufferReducedPrecision(){if(0===arguments.length){for(let t=vC.MAX_PRECISION_DIGITS;t>=0;t--){try{this.bufferReducedPrecision(t)}catch(t){if(!(t instanceof Yk))throw t;this._saveException=t}if(null!==this._resultGeometry)return null}throw this._saveException}if(1===arguments.length){const t=arguments[0],e=vC.precisionScaleFactor(this._argGeom,this._distance,t),n=new aI(e);this.bufferFixedPrecision(n)}}computeGeometry(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;const t=this._argGeom.getFactory().getPrecisionModel();t.getType()===aI.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()}setQuadrantSegments(t){this._bufParams.setQuadrantSegments(t)}bufferOriginalPrecision(){try{const t=new uC(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof eS))throw t;this._saveException=t}}getResultGeometry(t){return this._distance=t,this.computeGeometry(),this._resultGeometry}setEndCapStyle(t){this._bufParams.setEndCapStyle(t)}}function bC(t){return 180*(t/6371.0088%(2*Math.PI))/Math.PI}vC.CAP_ROUND=XO.CAP_ROUND,vC.CAP_BUTT=XO.CAP_FLAT,vC.CAP_FLAT=XO.CAP_FLAT,vC.CAP_SQUARE=XO.CAP_SQUARE,vC.MAX_PRECISION_DIGITS=12;const MC=Object.assign({},{GeoJSONReader:gI,GeoJSONWriter:_I,BufferOp:vC});function wC(t,e={}){let n=e.step?e.step:8,i=!1!==e.wgs84,r=0;switch(typeof e.dist){case"number":r=i?bC(e.dist):e.dist;break;case"string":r=e.dist;break;default:r=0}let s=(new MC.GeoJSONReader).read(Wo(t)),o=[];return s.features.forEach((t=>{let e=0;e="number"==typeof r?r:i?bC(t.properties[r]):t.properties[r];let s=(new MC.GeoJSONWriter).write(MC.BufferOp.bufferOp(t.geometry,e,n));0!==s.coordinates[0].length&&o.push({type:"Feature",properties:t.properties,geometry:s})})),o={type:"FeatureCollection",features:o},e.merge&&(o=NC(o)),o}const EC=Object.assign({},{GeoJSONReader:gI,GeoJSONWriter:_I,UnionOp:$O});function NC(t,e={}){let n=(new EC.GeoJSONReader).read(wC(t));if(null!=e.id&&null!=e.id){let t=Array.from(new Set(n.features.map((t=>t.properties[e.id])))),i=[];return t.forEach((t=>{let r=n.features.filter((n=>n.properties[e.id]==t)),s=r[0].geometry;for(let t=1;t<r.length;t++)s=EC.UnionOp.union(s,r[t].geometry);i.push({type:"Feature",properties:{id:t},geometry:(new EC.GeoJSONWriter).write(s)})})),{type:"FeatureCollection",features:i}}{let t=n.features[0].geometry;for(let e=1;e<n.features.length;e++)t=EC.UnionOp.union(t,n.features[e].geometry);return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:(new EC.GeoJSONWriter).write(t)}]}}}const SC=Object.assign({},{geoPath:vr});const IC=Object.assign({},{scaleLinear:kx,geoPath:vr,geoProject:lc});const kC=Object.assign({},{geoPath:vr});function OC(){this.reset()}OC.prototype={constructor:OC,reset:function(){this.s=this.t=0},add:function(t){TC(CC,t,this.t),TC(this,CC.s,this.s),this.s?this.t+=CC.t:this.s=CC.t},valueOf:function(){return this.s}};const CC=new OC;function TC(t,e,n){const i=t.s=e+n,r=i-e,s=i-r;t.t=e-s+(n-r)}function RC(t,e){t&&LC.hasOwnProperty(t.type)&&LC[t.type](t,e)}const AC={Feature:function(t,e){RC(t.geometry,e)},FeatureCollection:function(t,e){let n=t.features,i=-1,r=n.length;for(;++i<r;)RC(n[i].geometry,e)}},LC={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){let n=t.coordinates,i=-1,r=n.length;for(;++i<r;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){PC(t.coordinates,e,0)},MultiLineString:function(t,e){let n=t.coordinates,i=-1,r=n.length;for(;++i<r;)PC(n[i],e,0)},Polygon:function(t,e){DC(t.coordinates,e)},MultiPolygon:function(t,e){let n=t.coordinates,i=-1,r=n.length;for(;++i<r;)DC(n[i],e)},GeometryCollection:function(t,e){let n=t.geometries,i=-1,r=n.length;for(;++i<r;)RC(n[i],e)}};function PC(t,e,n){let i,r=-1,s=t.length-n;for(e.lineStart();++r<s;)i=t[r],e.point(i[0],i[1],i[2]);e.lineEnd()}function DC(t,e){let n=-1,i=t.length;for(e.polygonStart();++n<i;)PC(t[n],e,1);e.polygonEnd()}let zC,FC,GC,qC=new OC;const jC={sphere:t=>{},point:t=>{},lineStart:function(){jC.point=UC,jC.lineEnd=BC},lineEnd:t=>{},polygonStart:t=>{},polygonEnd:t=>{}};function BC(){jC.point=jC.lineEnd=t=>{}}function UC(t,e){t*=Math.PI/180,e*=Math.PI/180,zC=t,FC=Math.sin(e),GC=Math.cos(e),jC.point=YC}function YC(t,e){t*=Math.PI/180,e*=Math.PI/180;const n=Math.sin(e),i=Math.cos(e),r=Math.abs(t-zC),s=Math.cos(r),o=i*Math.sin(r),a=GC*n-FC*i*s,l=FC*n+GC*i*s;qC.add(Math.atan2(Math.sqrt(o*o+a*a),l)),zC=t,FC=n,GC=i}function WC(t){return qC.reset(),function(t,e){t&&AC.hasOwnProperty(t.type)?AC[t.type](t,e):RC(t,e)}(t,jC),+qC}const $C=[null,null],XC={type:"LineString",coordinates:$C};function VC(t,e){return $C[0]=t,$C[1]=e,WC(XC)}function HC(){return 1}var ZC={units:"kilometers",radius:6371.0088};var JC=Object.freeze({__proto__:null,geoScaleBar:function(){let t,e,n,i,r,s=null,o=0,a=0,l=1,h=ZC.radius,c=ZC.units,u=t=>+t.toFixed(2),f=2,d=4,p="start",g=1,_=!0;function y(y){r=null===r?null:r||c.charAt(0).toUpperCase()+c.slice(1);let m=s[1][0]-s[0][0],x=s[1][1]-s[0][1],v=s[0][0]+m*o,b=s[0][1]+x*a,M=t.invert([v,b]),w=0,E=0;if(e)w=e,E=w/(VC(M,t.invert([v+1,b]))*h);else{let e=.01,i=80/(_?1:g),r=0,s=100,o=[1,2,4,5];for(;E<i&&r<s;){for(let n=0,r=o.length;n<r&&(w=e*o[n],E=w/(VC(M,t.invert([v+1,b]))*h),!(E>=i));n++);e*=10,r++}n=w}let N=w/(_?g:1),S=null===i?[]:i||[0,N/4,N/2,N],I=t=>t*E/(w/g),k=y.selection?y.selection():y,O=k.selectAll(".label").data([r]),C=k.selectAll(".domain").data([null]),T=k.selectAll(".tick").data(S,I).order(),R=T.exit(),A=T.enter().append("g").attr("class","tick"),L=T.select("line"),P=T.select("text"),D=T.select("rect");k.attr("font-family","sans-serif").attr("transform",`translate(${[v,b]})`),C=C.merge(C.enter().insert("path",".tick").attr("class","domain").attr("fill","none").attr("stroke","currentColor")),T=T.merge(A),L=L.merge(A.append("line").attr("stroke","currentColor").attr("y2",d*l)),P=P.merge(A.append("text").attr("fill","currentColor").attr("y",d*l+f*l).attr("font-size",10).attr("text-anchor","middle").attr("dy",(1===l?.71:0)+"em")),D=D.merge(A.append("rect").attr("fill",((t,e)=>e%2==0?"currentColor":"#fff")).attr("stroke","currentColor").attr("stroke-width",.5).attr("width",((t,e,n)=>e===n.length-1?0:I(S[e+1]-t))).attr("y",1===l?0:-d).attr("height",d)),y!==k&&(T=T.transition(y),C=C.transition(y),D=D.transition(y),R=R.transition(y).attr("opacity",1e-6).attr("transform",(t=>`translate(${I(t)})`)),A.attr("opacity",1e-6).attr("transform",(t=>`translate(${I(t)})`))),R.remove(),C.attr("d",`M${I(0)},${d*l} L${I(0)},0 L${I(N)},0 L${I(N)},${d*l}`),T.attr("transform",(t=>`translate(${I(t)})`)).attr("opacity",1),L.attr("y2",d*l),P.attr("y",d*l+f*l).text(u),D.attr("fill",((t,e)=>e%2==0?"currentColor":"#fff")).attr("width",((t,e,n)=>e===n.length-1?0:I(S[e+1]-t))).attr("y",1===l?0:-d).attr("height",d),null===O?O.remove():(y!==k?O.transition(y).attr("x","start"===p?0:I("middle"===p?N/2:N)).attr("y",1===l?0:"1.3em").attr("text-anchor",p).text((t=>t)):O.attr("x","start"===p?0:I("middle"===p?N/2:N)).attr("y",1===l?0:"1.3em").attr("text-anchor",p).text((t=>t)),O.enter().append("text").attr("class","label").attr("fill","currentColor").attr("font-size",12).attr("dy","-0.32em").attr("x","start"===p?0:I("middle"===p?N/2:N)).attr("y",1===l?0:"1.3em").attr("text-anchor",p).text((t=>t)))}return y.distance=function(t){return arguments.length?(e=+t,y):e||n},y.extent=function(t){return arguments.length?(s=t,y):s},y.label=function(t){return arguments.length?(r=t,y):r},y.labelAnchor=function(t){return arguments.length?(p=t,y):p},y.left=function(t){return arguments.length?(o=+t>1?1:+t<0?0:+t,y):o},y.orient=function(t){return arguments.length?(l=t(),y):1===l?"bottom":"top"},y.projection=function(e){return arguments.length?(t=e,y):t},y.radius=function(t){return arguments.length?(h=+t,y):h},y.size=function(t){return arguments.length?(s=[[0,0],t],y):s[1]},y.top=function(t){return arguments.length?(a=+t>1?1:+t<0?0:+t,y):a},y.tickFormat=function(t){return arguments.length?(u=t,y):u},y.tickPadding=function(t){return arguments.length?(f=+t,y):f},y.tickSize=function(t){return arguments.length?(d=+t,y):d},y.tickValues=function(t){return arguments.length?(i=t,y):i},y.units=function(t){return arguments.length?(({units:c,radius:h}=t),y):c},y.zoomClamp=function(t){return arguments.length?(_=!!t,y):_},y.zoomFactor=function(t){return arguments.length?(g=+t,y):g},y},geoScaleBottom:HC,geoScaleTop:function(){return-1},geoScaleFeet:{units:"feet",radius:20902259.664},geoScaleKilometers:ZC,geoScaleMeters:{units:"meters",radius:6371008.8},geoScaleMiles:{units:"miles",radius:3958.7613}});const QC=Object.assign({},JC);function KC(t,e,n,i={}){if(0!=i.display){let r,s,o,a,l,h,c=i.position?i.position:"topright",u=i.text?i.text:"Your text here!",f=i.fontSize?i.fontSize:15,d=i.fontFamily?i.fontFamily:"Roboto",p=i.margin?i.margin:0,g=i.textDecoration?i.textDecoration:"none",_=i.fontWeight?i.fontWeight:"normal",y=i.fontStyle?i.fontStyle:"normal",m=i.anchor?i.anchor:"start",x=i.baseline?i.baseline:"baseline",v=i.fill?i.fill:"#474342",b=i.stroke?i.stroke:"none",M=i.frame_fill?i.frame_fill:"none",w=i.frame_stroke?i.frame_stroke:"none",E=i.strokeWidth?i.strokeWidth:1,N=i.frame_opacity?i.frame_opacity:1;switch(c){case"topleft":m="start",x="hanging",r=5,s=5;break;case"topright":m="end",x="hanging",r=e-5,s=5;break;case"top":m="middle",x="hanging",r=e/2,s=5;break;case"left":m="start",x="middle",r=5,s=n/2;break;case"middle":m="middle",x="middle",r=e/2,s=n/2;break;case"right":m="end",x="middle",r=e-5,s=n/2;break;case"bottomleft":m="start",x="baseline",r=5,s=n-5;break;case"bottom":m="middle",x="baseline",r=e/2,s=n-5;break;case"bottomright":m="end",x="baseline",r=e-5,s=n-5;break;default:r=c[0],s=c[1]}let S=u.split("\n"),I=[];S.forEach((t=>I.push(t.length)));let k=I.indexOf(Math.max(...I)),O=t.append("text").attr("font-size",`${f}px`).attr("font-family",d).attr("font-style",y).attr("text-decoration",g).attr("font-weight",_).text(S[k]);t.node().appendChild(O.node()),document.body.appendChild(t.node());const C=O.node().getBBox().width;document.body.removeChild(t.node()),O.remove();let T=f*I.length;"hanging"==x&&(l=0,a=p),"middle"==x&&(l=f*S.length/2,a=0),"baseline"==x&&(l=f*S.length,a=-p),"start"==m&&(h=0,o=p),"middle"==m&&(h=C/2,o=0),"end"==m&&(h=C,o=-p);let R=t.append("g").attr(":inkscape:groupmode","layer").attr("id","note").attr(":inkscape:label","note");R.append("rect").attr("x",r-p-h+o).attr("y",s-p-l+a).attr("height",T+2*p).attr("width",C+2*p).attr("fill",M).attr("stroke-width",E).attr("fill-opacity",N).attr("stroke",w),R.selectAll("text").data(S).join("text").attr("x",r+o).attr("y",s-+l+a).attr("font-size",`${f}px`).attr("font-style",y).attr("text-decoration",g).attr("font-weight",_).attr("font-family",d).attr("dy",((t,e)=>e*f)).attr("text-anchor",m).attr("dominant-baseline","hanging").attr("fill",v).attr("stroke",b).text((t=>t))}}const tT=Object.assign({},{select:Io,pointer:Ao,min:st,max:it,descending:n,scaleLinear:kx});const eT=Object.assign({},{sum:xt,select:Io,pointer:Ao,forceX:Cy,forceY:Ty,forceCollide:iy,forceSimulation:Oy});function nT(t){t=Wo(t);let e=[];t.features.forEach((t=>{e.push(function(t){let e=[];t.geometry.type.includes("Multi")?t.geometry.coordinates.forEach((n=>{e.push({type:"Feature",properties:t.properties,geometry:{type:t.geometry.type.replace("Multi",""),coordinates:n}})})):e.push({...t});const n=Ie(t);return e.forEach((t=>t.__share=Ie(t)/n)),JSON.parse(JSON.stringify(e))}(t))}));const n=Object.keys(t).filter((t=>"features"!=t)),i={};return n.forEach((e=>{i[e]=t[e]})),i.features=e.flat(),i}function iT(t,e,n){if(null!==t)for(var i,r,s,o,a,l,h,c,u=0,f=0,d=t.type,p="FeatureCollection"===d,g="Feature"===d,_=p?t.features.length:1,y=0;y<_;y++){a=(c=!!(h=p?t.features[y].geometry:g?t.geometry:t)&&"GeometryCollection"===h.type)?h.geometries.length:1;for(var m=0;m<a;m++){var x=0,v=0;if(null!==(o=c?h.geometries[m]:h)){l=o.coordinates;var b=o.type;switch(u=!n||"Polygon"!==b&&"MultiPolygon"!==b?0:1,b){case null:break;case"Point":if(!1===e(l,f,y,x,v))return!1;f++,x++;break;case"LineString":case"MultiPoint":for(i=0;i<l.length;i++){if(!1===e(l[i],f,y,x,v))return!1;f++,"MultiPoint"===b&&x++}"LineString"===b&&x++;break;case"Polygon":case"MultiLineString":for(i=0;i<l.length;i++){for(r=0;r<l[i].length-u;r++){if(!1===e(l[i][r],f,y,x,v))return!1;f++}"MultiLineString"===b&&x++,"Polygon"===b&&v++}"Polygon"===b&&x++;break;case"MultiPolygon":for(i=0;i<l.length;i++){for(v=0,r=0;r<l[i].length;r++){for(s=0;s<l[i][r].length-u;s++){if(!1===e(l[i][r][s],f,y,x,v))return!1;f++}v++}x++}break;case"GeometryCollection":for(i=0;i<o.geometries.length;i++)if(!1===iT(o.geometries[i],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function rT(t){var e=[1/0,1/0,-1/0,-1/0];return iT(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}function sT(t){return Array.isArray(t)?aT(t):t&&t.bbox?aT(t.bbox):[360*oT(),180*oT()]}function oT(){return Math.random()-.5}function aT(t){return[Math.random()*(t[2]-t[0])+t[0],Math.random()*(t[3]-t[1])+t[1]]}function lT(t,e,n){let i=[];t.features.forEach((t=>{i.push(function(t,e,n){let i=[],r=0,s=0;const o=Math.round(+t.properties[e]/n),a=rT(t);for(;r<o&&s<10*o;){const e=sT(a),n={type:"Feature",properties:t.properties,geometry:{type:"Point",coordinates:e}};TE(n,t)&&(i.push(n),r++),s++}return JSON.parse(JSON.stringify(i))}(t,e,n))}));const r=Object.keys(t).filter((t=>"features"!=t)),s={};return r.forEach((e=>{s[e]=t[e]})),s.features=i.flat(),s}rT.default=rT;const hT=Object.assign({},{sum:xt});function cT(t){return t.k}function uT(t){return[t.x,t.y]}function fT(t){return function(){return t}}const dT=Object.assign({},{tile:function(){let t=0,e=0,n=960,i=500,r=!0,s=!0,o=256,a=cT,l=uT,h=0;function c(){const c=+a.apply(this,arguments),u=l.apply(this,arguments),f=Math.log2(c/o),d=Math.round(Math.max(f+h,0)),p=Math.pow(2,f-d)*o,g=+u[0]-c/2,_=+u[1]-c/2,y=Math.max(r?0:-1/0,Math.floor((t-g)/p)),m=Math.min(r?1<<d:1/0,Math.ceil((n-g)/p)),x=Math.max(s?0:-1/0,Math.floor((e-_)/p)),v=Math.min(s?1<<d:1/0,Math.ceil((i-_)/p)),b=[];for(let t=x;t<v;++t)for(let e=y;e<m;++e)b.push([e,t,d]);return b.translate=[g/p,_/p],b.scale=p,b}return c.size=function(r){return arguments.length?(t=e=0,n=+r[0],i=+r[1],c):[n-t,i-e]},c.extent=function(r){return arguments.length?(t=+r[0][0],e=+r[0][1],n=+r[1][0],i=+r[1][1],c):[[t,e],[n,i]]},c.scale=function(t){return arguments.length?(a="function"==typeof t?t:fT(+t),c):a},c.translate=function(t){return arguments.length?(l="function"==typeof t?t:fT([+t[0],+t[1]]),c):l},c.zoomDelta=function(t){return arguments.length?(h=+t,c):h},c.tileSize=function(t){return arguments.length?(o=+t,c):o},c.clamp=function(t){return arguments.length?(r=s=!!t,c):r&&s},c.clampX=function(t){return arguments.length?(r=!!t,c):r},c.clampY=function(t){return arguments.length?(s=!!t,c):s},c},geoPath:vr});function pT(t,e,n,i={},r){if(0!=i.display&&!n){let n=i.fill?i.fill:"#d91848",s=i.fillOpacity?i.fillOpacity:.5,o=i.stroke?i.stroke:"#d91848",a=null!=i.strokeWidth?i.strokeWidth:.2,l=null!=i.strokeOpacity?i.strokeOpacity:.6,h=i.step?i.step:10;t.append("g").attr("clip-path",null==r?"none":`url(#clip_${r})`).append("path").datum(function(t){const e=Rn().center((t=>t)).radius(t/4).precision(10),n=[];for(let i=-80;i<=80;i+=t)for(let r=-180;r<180;r+=t)n.push({type:"Feature",properties:{},geometry:{type:"MultiPolygon",coordinates:[e([r,i]).coordinates]}});return{type:"FeatureCollection",features:n}}(h)).attr("d",vr(e)).style("fill",n).style("fill-opacity",s).style("stroke",o).style("stroke-width",a).style("stroke-opacity",l)}}const gT=Object.assign({},{geoPath:vr,geoArea:Ie});const _T={type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"MultiPolygon",coordinates:[[[[9.8,1],[4.41,6.36],[-7.54,4.35],[-16.73,12.33],[-17.01,21.2],[-5.91,35.81],[11.31,37],[10.33,33.7],[19.06,30.27],[21.61,32.93],[34.48,31.58],[36.02,36.93],[27.67,36.66],[26.74,40.4],[41.5,42.64],[31.19,46.63],[22.57,40.05],[13.71,45.59],[15.61,40.07],[3.94,43.53],[-2.13,36.74],[-9,37.02],[-9.29,42.92],[-1.79,43.39],[-1.37,48.66],[9.44,54.81],[21.04,55.3],[21.85,65.54],[13.28,55.35],[7.42,62.6],[18.6,70.1],[27.77,71.19],[41.02,67.7],[34.77,64.56],[66.93,71.3],[102.03,77.22],[111.14,76.75],[106.36,73.19],[124.38,73.81],[130.57,70.96],[141.55,72.77],[160.54,69.36],[179.95,68.97],[179.61,62.71],[163.39,59.62],[156.72,50.89],[155.55,55.28],[164.03,61.35],[146.33,59.71],[135.22,54.89],[141.53,53.18],[140.17,48.45],[126.67,37.83],[117.76,39.11],[121.63,28.54],[116.49,22.94],[106.79,21.01],[109.44,14.1],[104.89,9.85],[91.62,22.54],[80.26,15.67],[76.54,8.94],[70.98,20.71],[66.25,25.47],[57.33,25.78],[47.95,29.99],[51.22,24.63],[56.08,26.11],[57.84,19.02],[43.95,12.6],[35.22,28.05],[39.72,15.26],[44.27,10.46],[51.29,11.83],[47.95,4.46],[40.17,-2.76],[39.86,-16.43],[27.1,-33.53],[19.95,-34.81],[11.85,-18.14],[13.64,-12.25],[9.8,1]],[[27.64,58],[27.64,58]],[[5.07,52.92],[5.07,52.92]],[[133.26,45.54],[133.26,45.54]],[[57.64,42.15],[57.64,42.15]],[[60.06,44.85],[60.06,44.85]],[[34.86,-13.51],[34.86,-13.51]],[[29.21,-3.33],[29.21,-3.33]],[[34,.25],[34,.25]],[[48.87,38.43],[54.01,36.82],[50.3,44.66],[48.87,38.43]]],[[[8.72,3.8],[8.72,3.8]]],[[[179.08,-8.36],[179.08,-8.36]]],[[[179.18,-8],[179.18,-8]]],[[[73.71,4.23],[73.71,4.23]]],[[[73.41,5.19],[73.41,5.19]]],[[[73.37,3.53],[73.37,3.53]]],[[[-61.77,17.13],[-61.77,17.13]]],[[[50.42,26.6],[50.42,26.6]]],[[[-78.15,25.26],[-78.15,25.26]]],[[[-77.25,25.13],[-77.25,25.13]]],[[[-59.53,13.06],[-59.53,13.06]]],[[[43.87,-12.2],[43.87,-12.2]]],[[[-23.9,15.8],[-23.9,15.8]]],[[[-61.45,15.56],[-61.45,15.56]]],[[[11.95,55.99],[11.95,55.99]]],[[[-16.13,28.6],[-16.13,28.6]]],[[[3.2,39.88],[3.2,39.88]]],[[[-7.41,62.14],[-7.41,62.14]]],[[[158.06,6.98],[158.06,6.98]]],[[[-2.51,49.41],[-2.51,49.41]]],[[[-61.56,12.03],[-61.56,12.03]]],[[[-4.6,54.09],[-4.6,54.09]]],[[[15.66,38.42],[15.66,38.42]]],[[[9.12,41.24],[9.12,41.24]]],[[[-2.12,49.26],[-2.12,49.26]]],[[[-158.96,2.2],[-158.96,2.2]]],[[[-62.67,17.34],[-62.67,17.34]]],[[[-60.95,13.71],[-60.95,13.71]]],[[[171.05,7.14],[171.05,7.14]]],[[[14.55,35.76],[14.55,35.76]]],[[[57.71,-20.1],[57.71,-20.1]]],[[[167.02,-.55],[167.02,-.55]]],[[[134.66,7.59],[134.66,7.59]]],[[[104.28,1.37],[104.28,1.37]]],[[[6.69,.07],[6.69,.07]]],[[[55.49,-4.52],[55.49,-4.52]]],[[[-175.25,-20.99],[-175.25,-20.99]]],[[[-61.2,13.1],[-61.2,13.1]]],[[[-172.27,-13.44],[-172.27,-13.44]]],[[[-53.38,-33.74],[-64.89,-40.71],[-65.97,-48.05],[-71.03,-53.81],[-75.43,-47.25],[-72.46,-41.99],[-70.39,-18.34],[-81.1,-6.07],[-77.34,6.54],[-94.85,16.43],[-103.5,18.33],[-123.73,38.92],[-122.21,47.99],[-134.24,58.21],[-151.57,60.99],[-156.55,56.98],[-166.37,63.1],[-166.55,68.36],[-156.82,71.31],[-135.87,68.91],[-127.84,70.24],[-113.86,67.7],[-96.46,67.47],[-96.88,71.01],[-81.24,67.46],[-92.45,62.79],[-92.42,57.35],[-79.77,54.65],[-77.49,62.59],[-67.03,58.18],[-64.07,60.45],[-55.81,53.33],[-66.41,50.26],[-64.51,46.24],[-73.65,41],[-76.07,35.38],[-84.02,30.11],[-97.55,27.01],[-95.75,18.77],[-86.83,21.43],[-88.69,15.84],[-83.13,15],[-82.25,9.01],[-62.62,9.74],[-52.99,5.46],[-50.4,-.07],[-35.51,-5.14],[-42.06,-22.95],[-48.58,-25.87],[-53.38,-33.74]],[[-79.06,43.28],[-79.06,43.28]],[[-82.64,42.56],[-82.64,42.56]],[[-89.58,48],[-89.58,48]],[[-69.37,-15.52],[-69.37,-15.52]],[[-84.11,46.35],[-84.11,46.35]]],[[[9.44,42.77],[9.44,42.77]]],[[[-61.9,16.22],[-61.9,16.22]]],[[[-60.6,14.51],[-60.6,14.51]]],[[[55.75,-20.58],[55.75,-20.58]]],[[[143.1,54.4],[143.1,54.4]]],[[[-179.96,65.13],[-179.94,68.93],[-170.01,66.09],[-179.96,65.13]]],[[[50.59,69.33],[50.59,69.33]]],[[[-179.92,70.99],[-179.92,70.99]]],[[[143.02,74.29],[143.02,74.29]]],[[[146.73,75.49],[146.73,75.49]]],[[[139.11,76.1],[139.11,76.1]]],[[[67.15,76.1],[67.15,76.1]]],[[[102.93,79.28],[102.93,79.28]]],[[[97.77,80.13],[97.77,80.13]]],[[[48.83,80.81],[48.83,80.81]]],[[[96.49,81.64],[96.49,81.64]]],[[[-68.63,-52.64],[-68.63,-52.64]]],[[[180,-90],[-180,-90],[-180,-84.35],[-157.56,-83.39],[-149.08,-79.48],[-157.93,-77.06],[-133.87,-74.93],[-98.4,-75.24],[-102.72,-73],[-77.24,-73.81],[-67.51,-72.83],[-64.78,-67.02],[-59.9,-72.99],[-63.16,-75.41],[-80.3,-78.85],[-61.85,-83.37],[-29.76,-80.18],[-33.72,-77.31],[-18.87,-75.25],[-9.45,-71.1],[26.45,-71.03],[50.32,-66.39],[69.56,-67.74],[67,-72.9],[84.96,-67.08],[113.2,-65.77],[130.73,-66.15],[167.7,-70.79],[162.19,-75.39],[166.09,-78.57],[160.13,-81.2],[180,-84.35],[180,-90]]],[[[-60.07,-79.69],[-60.07,-79.69]]],[[[-160.29,-79.27],[-160.29,-79.27]]],[[[-66.83,-78.44],[-66.83,-78.44]]],[[[-45.35,-78.69],[-45.35,-78.69]]],[[[-121.2,-73.5],[-121.2,-73.5]]],[[[-126.08,-73.3],[-126.08,-73.3]]],[[[-73.93,-72.46],[-73.93,-72.46]]],[[[-96.74,-71.63],[-96.74,-71.63]]],[[[-70.02,-69.19],[-70.02,-69.19]]],[[[144.4,-40.46],[144.4,-40.46]]],[[[137.56,-35.64],[137.56,-35.64]]],[[[130.24,-11.09],[130.24,-11.09]]],[[[142.55,-10.71],[146.28,-18.87],[153.21,-25.93],[150.01,-37.7],[140.36,-37.88],[131.18,-31.48],[115.12,-34.36],[113.65,-22.58],[130.99,-12.24],[140,-17.71],[142.55,-10.71]]],[[[109.65,2.08],[116.78,7.03],[115.97,-3.61],[109.65,2.08]]],[[[-66.84,-55.18],[-66.84,-55.18]]],[[[-73.17,-53.52],[-73.17,-53.52]]],[[[-74.68,-50],[-74.68,-50]]],[[[-73.89,-42.06],[-73.89,-42.06]]],[[[-75.1,19.9],[-75.1,19.9]]],[[[33.02,34.57],[33.02,34.57]]],[[[-71.76,19.71],[-71.76,19.71]]],[[[179.99,-16.17],[179.99,-16.17]]],[[[178.27,-17.35],[178.27,-17.35]]],[[[-59.2,-51.32],[-59.2,-51.32]]],[[[-58.78,-51.32],[-58.78,-51.32]]],[[[-7.25,55.07],[-7.25,55.07]]],[[[-3.35,58.65],[1.36,51.13],[-5.44,50.19],[-3.35,58.65]]],[[[23.9,35.53],[23.9,35.53]]],[[[23.39,39.02],[23.39,39.02]]],[[[-52.73,69.93],[-52.73,69.93]]],[[[-25.45,70.62],[-25.45,70.62]]],[[[-32.21,83.61],[-13.54,81.21],[-19.08,80.28],[-22.37,70.12],[-41.06,65.1],[-43.14,60.08],[-48.64,61.24],[-59.82,75.91],[-72.59,78.52],[-61,81.49],[-32.21,83.61]]],[[[120.01,-9.36],[120.01,-9.36]]],[[[124.47,-8.97],[124.47,-8.97]]],[[[116.82,-8.31],[116.82,-8.31]]],[[[117.97,-8.1],[117.97,-8.1]]],[[[124.04,-7.96],[124.04,-7.96]]],[[[115.49,-8.15],[115.49,-8.15]]],[[[138.52,-8.15],[138.52,-8.15]]],[[[115,-6.89],[115,-6.89]]],[[[106.16,-6.01],[106.16,-6.01]]],[[[134.58,-5.42],[134.58,-5.42]]],[[[127.07,-3.18],[127.07,-3.18]]],[[[129.1,-2.86],[129.1,-2.86]]],[[[107.85,-2.55],[107.85,-2.55]]],[[[124.53,-1.64],[124.53,-1.64]]],[[[135.48,-1.59],[135.48,-1.59]]],[[[105.88,-1.49],[105.88,-1.49]]],[[[98.86,-.79],[98.86,-.79]]],[[[140.98,-9.11],[133.89,-3.81],[137.79,-1.48],[147.45,-5.96],[140.98,-9.11]]],[[[97.41,1.72],[97.41,1.72]]],[[[125.06,1.67],[125.06,1.67]]],[[[128.17,1.92],[128.17,1.92]]],[[[95.5,5.61],[103.76,.24],[104.54,-5.84],[95.5,5.61]]],[[[92.79,13.31],[92.79,13.31]]],[[[-16.04,66.54],[-16.04,66.54]]],[[[-76.7,18.45],[-76.7,18.45]]],[[[130.98,33.79],[130.98,33.79]]],[[[134.16,34.36],[134.16,34.36]]],[[[141.28,41.35],[141.28,41.35]]],[[[142.02,45.46],[142.02,45.46]]],[[[80.41,9.71],[80.41,9.71]]],[[[49.35,-12.09],[47.13,-24.93],[43.94,-17.46],[49.35,-12.09]]],[[[22.85,78.36],[22.85,78.36]]],[[[16.82,79.88],[16.82,79.88]]],[[[23.14,80.38],[23.14,80.38]]],[[[172.9,-40.51],[172.9,-40.51]]],[[[173.08,-34.41],[173.08,-34.41]]],[[[125.64,9.61],[125.64,9.61]]],[[[123.27,10.98],[123.27,10.98]]],[[[124,11.08],[124,11.08]]],[[[119.82,11.47],[119.82,11.47]]],[[[124.44,11.45],[124.44,11.45]]],[[[122.3,11.76],[122.3,11.76]]],[[[124.92,12.56],[124.92,12.56]]],[[[121.17,13.38],[121.17,13.38]]],[[[120.91,18.57],[120.91,18.57]]],[[[154.81,-5.48],[154.81,-5.48]]],[[[152.23,-4.19],[152.23,-4.19]]],[[[151.04,-2.71],[151.04,-2.71]]],[[[-67.11,18.55],[-67.11,18.55]]],[[[161.69,-10.04],[161.69,-10.04]]],[[[159.62,-9.38],[159.62,-9.38]]],[[[160.8,-8.36],[160.8,-8.36]]],[[[158.6,-7.59],[158.6,-7.59]]],[[[-60.22,10.8],[-60.22,10.8]]],[[[121.64,25.22],[121.64,25.22]]],[[[-155.73,20.19],[-155.73,20.19]]],[[[-163.76,55.06],[-163.76,55.06]]],[[[-133.53,56.59],[-133.53,56.59]]],[[[-135.67,57.36],[-135.67,57.36]]],[[[-153.01,57.93],[-153.01,57.93]]],[[[-135.71,58.23],[-135.71,58.23]]],[[[-135.43,58.33],[-135.43,58.33]]],[[[-166.09,60.46],[-166.09,60.46]]],[[[-171.67,63.8],[-171.67,63.8]]],[[[166.95,-15.02],[166.95,-15.02]]],[[[-83.84,46.15],[-83.84,46.15]]],[[[-64.34,47.05],[-64.34,47.05]]],[[[-60.5,47],[-60.5,47]]],[[[-64.13,49.95],[-64.13,49.95]]],[[[-55.7,51.32],[-55.7,51.32]]],[[[-81.43,53.37],[-81.43,53.37]]],[[[-132.69,53.93],[-132.69,53.93]]],[[[-81.74,63.06],[-81.74,63.06]]],[[[-85.49,65.8],[-85.49,65.8]]],[[[-75.44,68.71],[-75.44,68.71]]],[[[-99.03,70.19],[-99.03,70.19]]],[[[-114.2,73.31],[-104.87,73.13],[-101.81,69.01],[-113.35,68.59],[-114.2,73.31]]],[[[-81.06,73.85],[-81.06,73.85]]],[[[-86.56,73.86],[-68.36,70.58],[-61.89,66.88],[-64.54,61.74],[-73.2,64.22],[-72.99,68.24],[-88.69,70.47],[-86.56,73.86]]],[[[-99.83,73.9],[-99.83,73.9]]],[[[-92.75,74.09],[-92.75,74.09]]],[[[-121.58,74.56],[-121.58,74.56]]],[[[-94.39,75.6],[-94.39,75.6]]],[[[-98.41,76.67],[-98.41,76.67]]],[[[-108.67,76.82],[-108.67,76.82]]],[[[-95.24,77.01],[-79.65,75.47],[-89.95,74.53],[-95.24,77.01]]],[[[-116.13,77.47],[-116.13,77.47]]],[[[-109.6,78.07],[-109.6,78.07]]],[[[-96.23,78.64],[-96.23,78.64]]],[[[-111.36,79.26],[-111.36,79.26]]],[[[-103.66,79.34],[-103.66,79.34]]],[[[-94.75,82.12],[-94.75,82.12]]],[[[-69.69,83.12],[-61.31,82.2],[-77.77,76.66],[-86.91,77.27],[-90.81,81.72],[-69.69,83.12]]],[[[-127.81,50.44],[-127.81,50.44]]],[[[163.52,-20.03],[163.52,-20.03]]],[[[110.69,20.15],[110.69,20.15]]]]}}]},yT=Object.assign({},{geoMercator:Yr,create:ko,geoPath:vr});function mT({params:t={},layers:e={}}={}){let n="user"==t.projection,i=t.projection,r=t.height,s=!t.reverse;const o=e.map((t=>t.type));i=o.includes("tiles")?yT.geoMercator():Np(i);let a=t.width?t.width:1e3,l=t.extent?t.extent:null;l=Array.isArray(l)&&Array.isArray(l[0])&&Array.isArray(l[1])?Xo(l):l;let h=t.margin?t.margin:1,c=t.background,u=1==t.clip;r=null==r?function(t,e,n,i,r,s){let o;const a=t.map((t=>t.geojson)).filter((t=>void 0!==t)).length,l=t.map((t=>t.type));if(e||!(l.includes("outline")||l.includes("tissot")||l.includes("geolines"))||r||(o={type:"Sphere"}),!e&&a>0&&!l.includes("outline")&&!l.includes("tissot")&&!l.includes("geolines")||r){let e=t.map((t=>t.geojson)).filter((t=>void 0!==t)),n=[];e.forEach((t=>n.push(Uo(t).features))),o={type:"FeatureCollection",features:n.flat()}}!e&&0==a&&l.includes("tiles")&&(o={type:"Sphere"}),e&&(o=e);const[[h,c],[u,f]]=Yo.geoPath(i.fitWidth(s-2*n,o)).bounds(o);let d=i.translate();return i.translate([d[0]+n,d[1]+n]),Math.ceil(f-c)+2*n}(e,l,h,i,n,a):r;let f=0,d=e.find((t=>"header"==t.type));d&&(d.text&&(f=25*d.text.split("\n").length+10),d.fontSize&&(f=d.fontSize*d.text.split("\n").length+10));let p=0,g=e.find((t=>"footer"==t.type));g&&(g.text&&(p=10*g.text.split("\n").length+10),g.fontSize&&(p=g.fontSize*g.text.split("\n").length+10));const _=yT.create("svg").attr("id","bertinmap").attr("width",a).attr("height",r+f+p).attr("viewBox",[0,-f,a,r+f+p]).attr("style","max-width: 100%; height: auto; height: intrinsic; background-color: white;");_.append("defs").append("style").attr("type","text/css").text("@import url('https://fonts.googleapis.com/css2?family=Pacifico&family=Roboto&family=Rubik&family=Ubuntu&display=swap');");let y=null;u&&(y=Date.now().toString(36)+Math.random().toString(36).substring(2),_.append("clipPath").attr("id",`clip_${y}`).append("path").datum({type:"Sphere"}).attr("d",yT.geoPath(i))),c&&_.append("rect").attr("x",0).attr("y",0).attr("width",a).attr("height",r).attr("fill",c);let m=e.find((t=>"outline"==t.type));m&&Tp(_,i,n,{display:m.display,fill:m.fill,fillOpacity:m.fillOpacity,stroke:"none",strokeWidth:"none"}),(s?[...e].reverse():[...e]).forEach((t=>{if("graticule"==t.type&&function(t,e,n,i={},r){if(0!=i.display&&!n){let n=i.stroke?i.stroke:"white",s=null!=i.strokeWidth?i.strokeWidth:.8,o=null!=i.strokeOpacity?i.strokeOpacity:.5,a=null!=i.strokeDasharray?i.strokeDasharray:2,l=i.strokeLinecap?i.strokeLinecap:"round",h=i.strokeLinejoin?i.strokeLinejoin:"round",c=i.step?i.step:[10,10];c=Array.isArray(c)?c:[c,c],t.append("g").attr("clip-path",null==r?"none":`url(#clip_${r})`).append("path").datum(Sp.geoGraticule().step(c)).attr("d",Sp.geoPath(e)).style("fill","none").style("stroke",n).style("stroke-width",s).style("stroke-opacity",o).style("stroke-linecap",l).style("stroke-linejoin",h).style("stroke-dasharray",a)}}(_,i,n,{display:t.display,stroke:t.stroke,strokeWidth:t.strokeWidth,strokeOpacity:t.strokeOpacity,strokeDasharray:t.strokeDasharray,strokeLinecap:t.strokeLinecap,strokeLinejoin:t.strokeLinejoin,step:t.step},y),"geolines"==t.type&&Op(_,i,n,{display:t.display,stroke:t.stroke,strokeWidth:t.strokeWidth,strokeOpacity:t.strokeOpacity,strokeDasharray:t.strokeDasharray,strokeLinecap:t.strokeLinecap},y),"minimap"!=t.type&&"location"!=t.type||function({mainmap:t={selection:null,projection:null,width:null,height:null},x:e=5,y:n=5,geojson:i=_T,extent:r=null,threshold:s=.1,precision:o=10,projection:a="Equirectangular",width:l=200,background:h={stroke:"black",strokeWidth:1,strokeOpacity:1,fill:"white",fillOpacity:1},frame:c={stroke:"none",strokeWidth:1,strokeOpacity:1,fill:"red",fillOpacity:.25},geometries:u={fill:"#CCC",stroke:"none",strokeWidth:1,fillOpacity:1,strokeOpacity:1},raise:f={fill:"red",stroke:"none",strokeWidth:1,fillOpacity:1,strokeOpacity:1},dot:d={fill:"red",r:5,stroke:"none",strokeWidth:1,fillOpacity:1,strokeOpacity:1}}={}){const p=Date.now().toString(36)+Math.random().toString(36).substring(2);r=Array.isArray(r)&&Array.isArray(r[0])&&Array.isArray(r[1])?Xo(r):r;const g={type:"Sphere"};let _=t.selection;a=(a=Np(a)).fitWidth(l,r||g);const y=gT.geoPath(a);let m="";null!=r&&(m=y.bounds(r),_.append("clipPath").attr("id",`extent_${p}`).append("rect").attr("x",0).attr("y",0).attr("width",m[1][0]).attr("height",m[1][1])),null==r?_.append("g").append("path").attr("d",y(g)).attr("fill",h.fill).attr("fill-opacity",h.fillOpacity).attr("stroke","none").attr("transform",`translate(${e} ${n})`):_.append("g").append("rect").attr("x",0).attr("y",0).attr("width",m[1][0]).attr("height",m[1][1]).attr("fill",h.fill).attr("fill-opacity",h.fillOpacity).attr("stroke","none").attr("transform",`translate(${e} ${n})`),_.append("g").append("path").datum(i).attr("fill",u.fill).attr("fill-opacity",u.fillOpacity).attr("stroke",u.stroke).attr("stroke-width",u.strokeWidth).attr("stroke-opacity",u.strokeOpacity).attr("d",y).attr("transform",`translate(${e} ${n})`).attr("clip-path",`url(#extent_${p})`),null==r?_.append("g").append("path").attr("d",y(g)).attr("fill","none").attr("stroke",h.stroke).attr("stroke-width",h.strokeWidth).attr("stroke-opacity",h.strokeOpacity).attr("transform",`translate(${e} ${n})`):_.append("g").append("rect").attr("x",0).attr("y",0).attr("width",m[1][0]).attr("height",m[1][1]).attr("fill","none").attr("stroke",h.stroke).attr("stroke-width",h.strokeWidth).attr("stroke-opacity",h.strokeOpacity).attr("transform",`translate(${e} ${n})`);let x=[];for(let e=0;e<=t.width;e+=t.width/o)x.push(e);let v=[];for(let e=0;e<=t.height;e+=t.width/o)v.push(e);let b=[];b.push(x.map((e=>t.projection.invert([e,0])))),b.push(v.map((e=>t.projection.invert([t.width,e])))),b.push(x.reverse().map((e=>t.projection.invert([e,t.height])))),b.push(v.reverse().map((e=>t.projection.invert([0,e]))));const M={type:"Feature",geometry:{type:"Polygon",coordinates:[b.flat()]}};if(gT.geoArea(M)>s)_.append("g").append("path").datum(M).attr("fill",c.fill).attr("fill-opacity",c.fillOpacity).attr("stroke",c.stroke).attr("stroke-width",c.strokeWidth).attr("stroke-opacity",c.strokeOpacity).attr("d",y).attr("transform",`translate(${e} ${n})`),_.append("clipPath").attr("id",`clipminimap_${p}`).append("path").datum(M).attr("d",gT.geoPath(a)),_.append("g").append("path").attr("clip-path",`url(#clipminimap_${p})`).datum(i).attr("fill",f.fill).attr("fill-opacity",f.fillOpacity).attr("stroke",f.stroke).attr("stroke-width",f.strokeWidth).attr("stroke-opacity",f.strokeOpacity).attr("d",y).attr("transform",`translate(${e} ${n})`);else{const i=t.projection.invert([t.width/2,t.height/2]);_.append("circle").attr("cx",a(i)[0]).attr("cy",a(i)[1]).attr("fill",d.fill).attr("fill-opacity",d.fillOpacity).attr("stroke",d.stroke).attr("stroke-width",d.strokeWidth).attr("stroke-opacity",d.strokeOpacity).attr("r",d.r).attr("transform",`translate(${e} ${n})`)}}({x:t.x,y:t.y,width:t.width,projection:t.projection,geojson:t.geojson,extent:t.extent,threshold:t.threshold,background:t.background,geometries:t.geometries,raise:t.raise,frame:t.frame,dot:t.dot,mainmap:{selection:_,projection:i,width:a,height:r}}),"tiles"==t.type&&function(t,e,n,i,r={}){if(0!=r.display){let s=null!=r.opacity?r.opacity:1,o=null!=r.tileSize?r.tileSize:512;null!=r.zoomDelta&&r.zoomDelta;let a=null!=r.clip?r.clip:void 0,l=r.style?r.style:"opentopomap",h=null!=r.zoomDelta?r.zoomDelta:1,c=null!=r.increasetilesize?r.increasetilesize:1,u=r.source?r.source:"bottomright";const f=[{name:"openstreetmap",provider:"OpenStreetMap contributors",url:(t,e,n)=>`https://tile.openstreetmap.org/${n}/${t}/${e}.png`},{name:"opentopomap",provider:"OpenStreetMap contributors",url:(t,e,n)=>`https://tile.opentopomap.org/${n}/${t}/${e}.png`},{name:"worldterrain",provider:"USGS, Esri, TANA, DeLorme, and NPS",url:(t,e,n)=>`https://server.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/${n}/${e}/${t}.png`},{name:"worldimagery",provider:"Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community",url:(t,e,n)=>`https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/${n}/${e}/${t}.png`},{name:"worldStreet",provider:"Esri, DeLorme, NAVTEQ, USGS, Intermap, iPC, NRCAN, Esri Japan, METI, Esri China (Hong Kong), Esri (Thailand), TomTom, 2012",url:(t,e,n)=>`https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/${n}/${e}/${t}.png`},{name:"worldphysical",provider:"Esri, US National Park Service",url:(t,e,n)=>`https://server.arcgisonline.com/ArcGIS/rest/services/World_Physical_Map/MapServer/tile/${n}/${e}/${t}`},{name:"shadedrelief",provider:"ESRI",url:(t,e,n)=>`https://server.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/${n}/${e}/${t}.png`},{name:"oceanbasemap",provider:"GEBCO, NOAA, CHS, OSU, UNH, CSUMB, National Geographic, DeLorme, NAVTEQ, and Esri",url:(t,e,n)=>`https://server.arcgisonline.com/ArcGIS/rest/services/Ocean_Basemap/MapServer/tile/${n}/${e}/${t}.png`}];Object.hasOwn(l,"provider")&&Object.hasOwn(l,"url")&&(l.name="user",f.push(l),l=l.name);let d=f.find((t=>t.name==l)).url,p=dT.tile().size([e,n]).scale(2*i.scale()*Math.PI).translate(i([0,0])).tileSize(o).zoomDelta(h);const g=Date.now().toString(36)+Math.random().toString(36).substring(2);a&&t.append("clipPath").attr("id",`tileclip_${g}`).append("path").datum(a).attr("d",dT.geoPath(i)),t.append("g").attr("clip-path",`url(#tileclip_${g})`).selectAll("image").data(p()).join("image").attr("xlink:href",(t=>d(t[0],t[1],t[2]))).attr("x",(t=>Math.round((t[0]+p().translate[0])*p().scale))).attr("y",(t=>Math.round((t[1]+p().translate[1])*p().scale))).attr("width",p().scale+c+"px").attr("height",p().scale+c+"px").attr("opacity",s),KC(t,e,n,r={text:`Source: ${f.find((t=>t.name==l)).provider}`,position:u,fontSize:12,fill:"white",frame_fill:"black",frame_opacity:.3,fontFamily:"Roboto",margin:6})}}(_,a,r,i,{display:t.display,opacity:t.opacity,tileSize:t.tileSize,zoomDelta:t.zoomDelta,style:t.style,clip:t.clip,increasetilesize:t.increasetilesize,source:t.source}),"layer"!=t.type&&"simple"!=t.type&&null!=t.type||vE(_,i,{display:t.display,geojson:t.geojson,fill:t.fill,stroke:t.stroke,strokeWidth:t.strokeWidth,strokeLinecap:t.strokeLinecap,strokeLinejoin:t.strokeLinejoin,fillOpacity:t.fillOpacity,strokeOpacity:t.strokeOpacity,strokeDasharray:t.strokeDasharray,symbol:t.symbol,symbol_size:t.symbol_size,symbol_iteration:t.symbol_iteration,symbol_shift:t.symbol_shift,tooltip:t.tooltip,leg_x:t.leg_x,leg_y:t.leg_y,leg_w:t.leg_w,leg_h:t.leg_h,leg_title:t.leg_title,leg_text:t.leg_text,leg_type:t.leg_type,leg_fontSize:t.leg_fontSize,leg_fontSize2:t.leg_fontSize2,leg_stroke:t.leg_stroke,leg_fillOpacity:t.leg_fillOpacity,leg_fill:t.leg_fill,leg_strokeWidth:t.leg_strokeWidth,leg_txtcol:t.leg_txtcol,viewof:t.viewof},y,a,r),"dotdensity"==t.type&&function(t,e,n={},i,r,s){if(0!=n.display){let o=null!=n.nbdots?n.nbdots:hT.sum(n.geojson.features.map((t=>+t.properties[n.values])))/1e3;n.dotvalue=null!=n.dotvalue?n.dotvalue:o,n.symbol_size=null!=n.symbol_size?n.symbol_size:8,n.fill=n.fill?n.fill:"#cc190c",n.leg_text=n.leg_text?n.leg_text:`= ${n.dotvalue}`,n.leg_type=n.symbol?n.symbol:"circle";let a=nT(n.geojson);a.features.forEach(((t,e)=>{t.properties.__value=+t.properties[n.values]*t.__share,t.__test=+t.properties[n.values]*t.__share}));const l=lT(a,"__value",n.dotvalue);n.geojson=JSON.parse(JSON.stringify(l)),vE(t,e,n,i,r,s)}}(_,i,{display:t.display,geojson:t.geojson,values:t.values,dotvalue:t.dotvalue,fill:t.fill,stroke:t.stroke,strokeWidth:t.strokeWidth,strokeLinecap:t.strokeLinecap,strokeLinejoin:t.strokeLinejoin,fillOpacity:t.fillOpacity,strokeOpacity:t.strokeOpacity,strokeDasharray:t.strokeDasharray,symbol:t.symbol,symbol_size:t.symbol_size,symbol_iteration:t.symbol_iteration,symbol_shift:t.symbol_shift,tooltip:t.tooltip,leg_type:t.leg_type,leg_x:t.leg_x,leg_y:t.leg_y,leg_w:t.leg_w,leg_h:t.leg_h,leg_title:t.leg_title,leg_text:t.leg_text,leg_fontSize:t.leg_fontSize,leg_fontSize2:t.leg_fontSize2,leg_stroke:t.leg_stroke,leg_fillOpacity:t.leg_fillOpacity,leg_fill:t.leg_fill,leg_strokeWidth:t.leg_strokeWidth,leg_txtcol:t.leg_txtcol},y,a,r),"spikes"==t.type&&function(t,e,n,i={},r,s,o){if(0!=i.display){let r=Uo(i.geojson),a=i.values,l=null!=i.k?i.k:50,h=null!=i.w?i.w:10,c=i.fill?i.fill:"#ffa3e3",u=i.stroke?i.stroke:"#a31d88",f=null!=i.strokeWidth?i.strokeWidth:1,d=null!=i.fillOpacity?i.fillOpacity:1,p=i.strokeLinecap?i.strokeLinecap:"round",g=i.strokeLinejoin?i.strokeLinejoin:"round",_=null!=i.strokeDasharray?i.strokeDasharray:"none",y=null!=i.strokeOpacity?i.strokeOpacity:1,m=!!i.tooltip&&i.tooltip;Array.isArray(m)&&(m={fields:m}),"string"==typeof m&&(m={fields:[m]});let x=i.leg_x?i.leg_x:null,v=i.leg_y?i.leg_y:null;!i.leg_w||i.leg_w,!i.leg_h||i.leg_h;let b=i.leg_title?i.leg_title:null,M=i.leg_fontSize?i.leg_fontSize:14,w=i.leg_fontSize2?i.leg_fontSize2:10;!i.leg_stroke||i.leg_stroke,!i.fillOpacity||i.fillOpacity,!i.leg_strokeWidth||i.leg_strokeWidth;let E,N=i.leg_txtcol?i.leg_txtcol:"#363636",S=void 0!==i.leg_round?i.leg_round:void 0,I=!!i.viewof,k={};E="p"==mE(r)?r.features:wE(r,{planar:n}).features;const O=tT.scaleLinear().domain([0,tT.max(E.map((t=>+t.properties[a])))]).range([0,l]);t.append("g").selectAll("path").data(E.filter((t=>null!=t.geometry.coordinates)).filter((t=>null!=t.properties[a])).sort(((t,e)=>tT.descending(+t.properties[a],+e.properties[a])))).join("path").attr("fill",(t=>fE(E,c).getcol(t.properties[c.values]))).attr("stroke",(t=>fE(E,u).getcol(t.properties[u.values]))).attr("stroke-width",(t=>pE(E,f).getthickness(t.properties[f.values]||void 0))).attr("fill-opacity",d).attr("stroke-opacity",y).attr("stroke-linecap",p).attr("stroke-linejoin",g).attr("stroke-dasharray",_).attr("d",(t=>`M ${e(t.geometry.coordinates)[0]-h/2}, ${e(t.geometry.coordinates)[1]} ${e(t.geometry.coordinates)[0]}, ${e(t.geometry.coordinates)[1]-O(t.properties[a])} ${e(t.geometry.coordinates)[0]+h/2}, ${e(t.geometry.coordinates)[1]}`)).on("touchmove mousemove",(function(e,n){I&&(tT.select(this).attr("stroke-opacity",y-.3).attr("fill-opacity",d-.3),k=n.properties,t.dispatch("input"),Object.defineProperty(t.node(),"value",{get:()=>k,configurable:!0})),m&&t.select("#info").call(yE,{fields:function(){const t=Array.isArray(m.fields)?m.fields:[m.fields];let e=[];return t.forEach((t=>{e.push("$"==t[0]?`${n.properties[t.substr(1,t.length)]}`:t)})),e}(),fontWeight:m.fontWeight,fontSize:m.fontSize,fontStyle:m.fontStyle,fill:m.fill,stroke:m.stroke,strokeWidth:m.strokeWidth,fillOpacity:m.fillOpacity,strokeOpacity:m.strokeOpacity,col:m.col,type:_E(tT.pointer(e,this),s,o)}),m&&(t.select("#info").attr("transform",`translate(${tT.pointer(e,this)})`),tT.select(this).attr("stroke-opacity",y-.3).attr("fill-opacity",d-.3).raise())})).on("touchend mouseleave",(function(){I&&(k={},t.dispatch("input")),t.select("#info").call(yE,null),tT.select(this).attr("stroke-opacity",y).attr("fill-opacity",d).lower()})),I&&Object.defineProperty(t.node(),"value",{get:()=>k,configurable:!0});const C=E.filter((t=>""!=t.properties[a])).map((t=>+t.properties[a])),T=[tT.min(C),O.invert(l/3),O.invert(l/1.5),tT.max(C)];if(null!=x&&null!=v){let e=t.append("g").attr("class","bertinlegend");null!=b&&(b.split("\n").length,e.append("g").selectAll("text").data(b.split("\n")).join("text").attr("x",x).attr("y",v).attr("font-size",`${M}px`).attr("dy",((t,e)=>e*M)).attr("text-anchor","start").attr("dominant-baseline","hanging").attr("fill",N).text((t=>t))),e.append("g").selectAll("path").data(T.sort(tT.descending)).join("path").attr("d",(t=>`M ${-h/2},0 0,${-O(t)} ${h/2},0`)).attr("fill","object"==typeof c?"white":c).attr("stroke","object"==typeof u?"black":u).attr("stroke-width",1).attr("transform",((t,e)=>`translate(${x+h/2+(h+5)*e},${v+l+(b.split("\n").length+1)*M})`)),e.append("g").selectAll("text").data(T.sort(tT.descending)).join("text").attr("text-anchor","start").attr("dominant-baseline","middle").attr("transform",((t,e)=>`translate(${x+h/2+(h+5)*e},${v+l+(b.split("\n").length+1)*M+w/2}) rotate(90)`)).attr("font-size",`${w}px`).attr("fill",N).text((t=>TM(t,S)))}gE(r,t,c,u,f)}}(_,i,n,{display:t.display,geojson:t.geojson,values:t.values,k:t.k,w:t.w,fill:t.fill,stroke:t.stroke,strokeWidth:t.strokeWidth,fillOpacity:t.fillOpacity,strokeLinecap:t.strokeLinecap,strokeLinejoin:t.strokeLinejoin,strokeDasharray:t.strokeDasharray,strokeOpacity:t.strokeOpacity,tooltip:t.tooltip,leg_x:t.leg_x,leg_y:t.leg_y,leg_w:t.leg_w,leg_h:t.leg_h,leg_title:t.leg_title,leg_fontSize:t.leg_fontSize,leg_fontSize2:t.leg_fontSize2,leg_stroke:t.leg_stroke,leg_fillOpacity:t.leg_fillOpacity,leg_strokeWidth:t.leg_strokeWidth,leg_txtcol:t.leg_txtcol,leg_round:t.leg_round,viewof:t.viewof},0,a,r),"mushroom"==t.type&&function(t,e,n,i={},r,s){if(0!=i.display){let o=Date.now().toString(36)+Math.random().toString(36).substring(2),a=Uo(i.geojson),l=i.top_values,h=i.bottom_values,c=i.top_fill?i.top_fill:"#d64f4f",u=i.bottom_fill?i.bottom_fill:"#4fabd6",f=i.k?i.k:50,d=i.stroke?i.stroke:"white",p=i.strokeWidth?i.strokeWidth:.5,g=i.fillOpacity?i.fillOpacity:1,_=i.strokeOpacity?i.strokeOpacity:1,y=!!i.top_tooltip&&i.top_tooltip;Array.isArray(y)&&(y={fields:y}),"string"==typeof y&&(y={fields:[y]});let m=!!i.bottom_tooltip&&i.bottom_tooltip;Array.isArray(m)&&(m={fields:m}),"string"==typeof m&&(m={fields:[m]});let x=i.leg_x?i.leg_x:null,v=i.leg_y?i.leg_y:null,b=i.leg_fontSize?i.leg_fontSize:14,M=i.leg_fontSize2?i.leg_fontSize2:10,w=i.leg_round?i.leg_round:void 0,E=i.leg_txtcol?i.leg_txtcol:"#363636",N=i.leg_title?i.leg_title:"Title, year",S=i.leg_top_txt?i.leg_top_txt:l,I=i.leg_bottom_txt?i.leg_bottom_txt:h,k=i.leg_top_fill?i.leg_top_fill:c,O=i.leg_bottom_fill?i.leg_bottom_fill:u,C=i.leg_stroke?i.leg_stroke:E,T=i.leg_strokeWidth?i.leg_strokeWidth:.8,R=!!i.viewof,A={};const L=wE(a,{planar:n}).features.sort(((t,e)=>qN.descending(+t.properties[l],+e.properties[l]))).filter((t=>null!=t.geometry.coordinates)),P=qN.max(L,(t=>+t.properties[l])),D=qN.max(L,(t=>+t.properties[h]));let z=qN.scaleSqrt([0,Math.max(P,D)],[0,f]);for(let n=0;n<L.length;n++){const i=e(L[n].geometry.coordinates)[0],a=e(L[n].geometry.coordinates)[1],f=z(L[n].properties[l]),x=z(L[n].properties[h]),v=Math.max(f,x);t.append("circle").attr("cx",i).attr("cy",a).attr("r",f).style("fill",c).attr("stroke",d).attr("stroke-width",p).attr("clip-path","url(#top-clip_"+o+n+")").on("touchmove mousemove",(function(e){R&&(qN.select(this).attr("stroke-opacity",_-.3).attr("fill-opacity",g-.3),A=L[n].properties,t.dispatch("input"),Object.defineProperty(t.node(),"value",{get:()=>A,configurable:!0})),y&&t.select("#info").call(yE,{fields:function(){const t=Array.isArray(y.fields)?y.fields:[y.fields];let e=[];return t.forEach((t=>{e.push("$"==t[0]?`${L[n].properties[t.substr(1,t.length)]}`:t)})),e}(),fontWeight:y.fontWeight,fontSize:y.fontSize,fontStyle:y.fontStyle,fill:y.fill,stroke:y.stroke,strokeWidth:y.strokeWidth,fillOpacity:y.fillOpacity,strokeOpacity:y.strokeOpacity,col:y.col,type:_E(qN.pointer(e,this),r,s)}),y&&(t.select("#info").attr("transform",`translate(${qN.pointer(e,this)})`),qN.select(this).attr("stroke-opacity",_-.3).attr("fill-opacity",g-.3))})).on("touchend mouseleave",(function(){R&&(A={},t.dispatch("input")),t.select("#info").call(yE,null),qN.select(this).attr("stroke-opacity",_).attr("fill-opacity",g)})),t.append("clipPath").attr("id","top-clip_"+o+n).append("rect").attr("x",i-f-p).attr("y",a+-f-p).attr("height",f+p).attr("width",2*f+2*p),t.append("circle").attr("cx",i).attr("cy",a).attr("r",x).style("fill",u).attr("stroke",d).attr("stroke-width",p).attr("clip-path","url(#bottom-clip_"+o+n+")").on("touchmove mousemove",(function(e){R&&(qN.select(this).attr("stroke-opacity",_-.3).attr("fill-opacity",g-.3),A=L[n].properties,t.dispatch("input"),Object.defineProperty(t.node(),"value",{get:()=>A,configurable:!0})),m&&t.select("#info").call(yE,{fields:function(){const t=Array.isArray(m.fields)?m.fields:[m.fields];let e=[];return t.forEach((t=>{e.push("$"==t[0]?`${L[n].properties[t.substr(1,t.length)]}`:t)})),e}(),fontWeight:m.fontWeight,fontSize:m.fontSize,fontStyle:m.fontStyle,fill:m.fill,stroke:m.stroke,strokeWidth:m.strokeWidth,fillOpacity:m.fillOpacity,strokeOpacity:m.strokeOpacity,col:m.col,type:_E(qN.pointer(e,this),r,s)}),m&&(t.select("#info").attr("transform",`translate(${qN.pointer(e,this)})`),qN.select(this).attr("stroke-opacity",_-.3).attr("fill-opacity",g-.3))})).on("touchend mouseleave",(function(){R&&(A={},t.dispatch("input")),t.select("#info").call(yE,null),qN.select(this).attr("stroke-opacity",_).attr("fill-opacity",g)})),t.append("clipPath").attr("id","bottom-clip_"+o+n).append("rect").attr("x",i-x-p).attr("y",a).attr("height",x+p).attr("width",2*x+2*p).attr("fill","none").attr("stroke","red"),t.append("line").attr("x1",i-v).attr("x2",i+v).attr("y1",a).attr("y2",a).attr("stroke",d).attr("stroke-width",p)}if(R&&Object.defineProperty(t.node(),"value",{get:()=>A,configurable:!0}),null!=x&&null!=v){const e=30,n=3,i=z(Math.max(+P,+D));let r=t.append("g");const s=z(qN.max(L,(t=>+t.properties[l])));let c=L.map((t=>+t.properties[l])),u=[z.invert(s/3),z.invert(s/1.5),qN.max(c)];r.selectAll("circle").data(u.sort(qN.descending)).join("circle").attr("cx",x+i).attr("cy",v+s+(N.split("\n").length+1)*b).attr("r",(t=>z(t))).attr("fill",k).attr("stroke",C).attr("stroke-width",T).attr("clip-path","url(#legtop-clip_"+o+")"),r.append("clipPath").attr("id","legtop-clip_"+o).append("rect").attr("x",x-T+i-s).attr("y",v+(N.split("\n").length+1)*b-T).attr("height",s+T).attr("width",2*s+2*T),r.selectAll("line").data(u).join("line").attr("x1",x+i).attr("y1",(t=>v+(N.split("\n").length+1)*b+s-z(t))).attr("x2",x+2*i+b).attr("y2",(t=>v+(N.split("\n").length+1)*b+s-z(t))).attr("stroke",C).attr("stroke-width",T).attr("stroke-dasharray",2),r.selectAll("text").data(u).join("text").attr("x",x+2*i+b+M/2).attr("y",(t=>v+(N.split("\n").length+1)*b+s-z(t))).attr("font-size",M).attr("dominant-baseline","central").attr("fill",E).text((t=>void 0!==w||0!==w?t.toFixed(w):t));let f=t.append("g");const d=z(qN.max(L,(t=>+t.properties[h])));let p=a.features.map((t=>+t.properties[h])),g=[z.invert(d/3),z.invert(d/1.5),qN.max(p)];f.selectAll("circle").data(g.sort(qN.descending)).join("circle").attr("cx",x+i).attr("cy",v+s+(N.split("\n").length+1)*b+e).attr("r",(t=>z(t))).attr("fill",O).attr("stroke",C).attr("stroke-width",T).attr("clip-path","url(#legbottom-clip_"+o+")"),f.append("clipPath").attr("id","legbottom-clip_"+o).append("rect").attr("x",x-T+i-d).attr("y",v+(N.split("\n").length+1)*b+e+s).attr("height",d+T).attr("width",2*d+2*T),f.selectAll("line").data(g).join("line").attr("x1",x+i).attr("y1",(t=>v+(N.split("\n").length+1)*b+s+e+z(t))).attr("x2",x+2*i+b).attr("y2",(t=>v+(N.split("\n").length+1)*b+s+e+z(t))).attr("stroke",C).attr("stroke-width",T).attr("stroke-dasharray",2),f.selectAll("text").data(g).join("text").attr("x",x+2*i+b+M/2).attr("y",(t=>v+(N.split("\n").length+1)*b+s+e+z(t))).attr("font-size",M).attr("dominant-baseline","central").attr("fill",E).text((t=>void 0!==w||0!==w?t.toFixed(w):t));let _=t.append("g").attr("class","bertinlegend");_.append("line").attr("x1",x+i-s).attr("x2",x+i+s).attr("y1",v+(N.split("\n").length+1)*b+s).attr("y2",v+(N.split("\n").length+1)*b+s).attr("stroke",E).attr("stroke-width",T),_.append("line").attr("x1",x+i-d).attr("x2",x+i+d).attr("y1",v+(N.split("\n").length+1)*b+s+e).attr("y2",v+(N.split("\n").length+1)*b+s+e).attr("stroke",E).attr("stroke-width",T),_.append("g").selectAll("text").data(N.split("\n")).join("text").attr("x",x).attr("y",v).attr("font-size",`${b}px`).attr("dy",((t,e)=>e*b)).attr("text-anchor","start").attr("dominant-baseline","hanging").attr("fill",E).text((t=>t)),_.append("text").attr("x",x+i).attr("y",v+(N.split("\n").length+1)*b+s+n).text(S).attr("fill",E).attr("font-size",`${M}px`).attr("text-anchor","middle").attr("dominant-baseline","hanging"),_.append("text").attr("x",x+i).attr("y",v+(N.split("\n").length+1)*b+s+e-n).text(I).attr("fill",E).attr("font-size",`${M}px`).attr("text-anchor","middle").attr("dominant-baseline","baseline")}}}(_,i,n,{display:t.display,geojson:t.geojson,top_values:t.top_values,bottom_values:t.bottom_values,top_fill:t.top_fill,bottom_fill:t.bottom_fill,k:t.k,stroke:t.stroke,strokeWidth:t.strokeWidth,fillOpacity:t.fillOpacity,strokeOpacity:t.strokeOpacity,top_tooltip:t.top_tooltip,bottom_tooltip:t.bottom_tooltip,leg_x:t.leg_x,leg_y:t.leg_y,leg_fontSize:t.leg_fontSize,leg_fontSize2:t.leg_fontSize2,leg_round:t.leg_round,leg_txtcol:t.leg_txtcol,leg_title:t.leg_title,leg_top_txt:t.leg_top_txt,leg_bottom_txt:t.leg_bottom_txt,leg_top_fill:t.leg_top_fill,leg_bottom_fill:t.leg_bottom_fill,leg_stroke:t.leg_stroke,leg_strokeWidth:t.leg_strokeWidth,viewof:t.viewof},a,r),"label"==t.type&&function(t,e,n,i={},r){if(0!=i.display){let r,s=Uo(i.geojson),o=i.values,a=i.fill?i.fill:"#474342",l=i.fontSize?i.fontSize:10,h=i.fontFamily?i.fontFamily:"Roboto",c=i.textDecoration?i.textDecoration:"none",u=i.fontWeight?i.fontWeight:"normal",f=i.fontStyle?i.fontStyle:"normal",d=null!=i.opacity?i.opacity:1,p=1==i.halo,g=i.halo_style?i.halo_style:["white",4,.5];r="p"==mE(s)?s.features:wE(s,{planar:n}).features,t.append("g").selectAll("text").data(r.filter((t=>null!=t.geometry.coordinates)).filter((t=>null!=t.properties[o]))).join("text").attr("x",(t=>e(t.geometry.coordinates)[0])).attr("y",(t=>e(t.geometry.coordinates)[1])).attr("fill",a).attr("opacity",d).attr("font-size",l).attr("font-family",h).attr("font-style",f).attr("text-decoration",c).attr("font-weight",u).attr("text-anchor","middle").attr("dominant-baseline","middle").attr("paint-order","stroke").attr("stroke",p?g[0]:"none").attr("stroke-width",p?g[1]:0).attr("stroke-opacity",p?g[2]:0).attr("stroke-linejoin","round").attr("stroke-linecap","round").text((t=>t.properties[o]))}}(_,i,n,{display:t.display,geojson:t.geojson,values:t.values,fill:t.fill,fontSize:t.fontSize,fontFamily:t.fontFamily,textDecoration:t.textDecoration,fontWeight:t.fontWeight,fontStyle:t.fontStyle,opacity:t.opacity,halo:t.halo,halo_style:t.halo_style}),"text"==t.type&&KC(_,a,r,{display:t.display,position:t.position,text:t.text,fill:t.fill,stroke:t.stroke,fontSize:t.fontSize,fontFamily:t.fontFamily,textDecoration:t.textDecoration,fontWeight:t.fontWeight,fontStyle:t.fontStyle,margin:t.margin,anchor:t.anchor,baseline:t.baseline,frame_fill:t.frame_fill,frame_stroke:t.frame_stroke,frame_opacity:t.frame_opacity,frame_strokeWidth:t.frame_strokeWidth}),"logo"==t.type&&function(t,e,n,i={}){if(0!=i.display){let r=i.url?i.url:"https://github.com/neocarto/bertin/raw/main/img/logo.png",s=i.position?i.position:"left";const o=new Image;o.src=r,o.onload=()=>{let a,l,h=null!=i.size?i.size:100,c=o.height*h/o.width;switch(s){case"left":a=10,l=n-10-c;break;case"middle":a=e/2-h/2,l=n-10-c;break;case"right":a=e-10-h,l=n-10-c;break;default:a=s[0],l=s[1]}t.append("g").append("image").attr("xlink:href",r).attr("width",h).attr("height",c).attr("x",a).attr("y",l)}}}(_,a,r,{display:t.display,url:t.url,size:t.size,position:t.position}),"missing"==t.type&&function(t,e,n={},i){if(0!=n.display){let r=Uo(n.geojson),s=n.values,o=n.fill?n.fill:"white",a=n.stroke?n.stroke:"white",l=n.strokeWidth?n.strokeWidth:.5,h=n.fillOpacity?n.fillOpacity:1,c=r.features.filter((t=>null==t.properties[s]));"l"==mE(r)&&(a=n.stroke?n.stroke:"white",o=n.fill?n.fill:"none",l=n.strokeWidth?n.strokeWidth:1),t.append("g").attr("clip-path",null==i?"none":`url(#clip_${i})`).selectAll("path").data(c).join("path").attr("d",jN.geoPath(e)).attr("fill",o).attr("stroke",a).attr("stroke-width",l).attr("fill-opacity",h),Ay(t,{x:n.leg_x,y:n.leg_y,w:n.leg_w,h:n.leg_h,text:n.leg_text?n.leg_text:"Missing data",fontSize:n.leg_fontSize2,stroke:n.leg_stroke,fillOpacity:n.leg_fillOpacity?n.leg_fillOpacity:h,fill:o,strokeWidth:n.leg_strokeWidth,txtcol:n.leg_txtcol})}}(_,i,{display:t.display,geojson:t.geojson,values:t.values,fill:t.fill,stroke:t.stroke,strokeWidth:t.strokeWidth,fillOpacity:t.fillOpacity,leg_x:t.leg_x,leg_y:t.leg_y,leg_w:t.leg_w,leg_h:t.leg_h,leg_text:t.leg_text,leg_fontSize:t.leg_fontSize,leg_stroke:t.leg_stroke,leg_fillOpacity:t.fillOpacity,leg_fill:t.fill,leg_strokeWidth:t.leg_strokeWidth,leg_txtcol:t.leg_txtcol},y),"shadow"==t.type&&function(t,e,n,i,r={}){if(0!=r.display){let s=r.fill?r.fill:"#35383d",o=null!=r.dx?r.dx:3,a=null!=r.dy?r.dy:3,l=null!=r.stdDeviation?r.stdDeviation:1.5,h=null!=r.opacity?r.opacity:.7,c="none",u=NC(n);t.append("defs").append("filter").attr("id","blur").append("feGaussianBlur").attr("stdDeviation",l);const f=SC.geoPath(e);t.append("g").attr("clip-path",null==i?"none":`url(#clip_${i})`).append("path").datum(u).attr("d",f).attr("fill",s).attr("opacity",h).attr("stroke",c).attr("filter","url(#blur)").attr("transform",`translate(${o} ${a})`)}}(_,i,t.geojson,y,{display:t.display,fill:t.fill,dx:t.dx,dy:t.dy,opacity:t.opacity,stdDeviation:t.stdDeviation}),"waterlines"==t.type&&function(t,e,n,i,r={}){if(0!=r.display){let s=null!=r.precision?r.precision:3,o=null!=r.dist?r.dist:5,a=null!=r.nb?r.nb:3;null==r.steps||r.steps;let l=null!=r.stroke?r.stroke:"#5d81ba",h=null!=r.strokeOpacity?r.strokeOpacity:[1,.1],c=null!=r.strokeWidth?r.strokeWidth:[1.2,.2],u=null!=r.strokeDasharray?r.strokeDasharray:"none",f=null!=r.strokeLinecap?r.strokeLinecap:"round",d=null!=r.strokeLinejoin?r.strokeLinejoin:"round",p=[],g=wC(IC.geoProject(NC(n),e),{dist:o,wgs84:!1,step:s});p.push(g.features[0]);for(let t=1;t<=a;t++)g=wC(g,{dist:o,wgs84:!1,step:s}),p.push(g.features[0]);t.append("g").attr("clip-path",null==i?"none":`url(#clip_${i})`).selectAll("path").data(p).join("path").attr("d",IC.geoPath()).attr("fill","none").attr("stroke-opacity",((t,e)=>Array.isArray(h)?IC.scaleLinear().domain([1,a]).range(h)(e):h)).attr("stroke-width",((t,e)=>Array.isArray(c)?IC.scaleLinear().domain([1,a]).range(c)(e):c)).attr("stroke",((t,e)=>Array.isArray(l)?IC.scaleLinear().domain([1,a]).range(l)(e):l)).attr("stroke-dasharray",u).attr("stroke-linecap",f).attr("stroke-linejoin",d)}}(_,i,t.geojson,y,{display:t.display,stroke:t.stroke,dist:t.dist,unit:t.unit,nb:t.nb,precision:t.precision,strokeOpacity:t.strokeOpacity,strokeWidth:t.strokeWidth,stroke:t.stroke,strokeDasharray:t.strokeDasharray,strokeLinecap:t.strokeLinecap,strokeLinejoin:t.strokeLinejoin}),"inner"==t.type&&function(t,e,n={}){if(0!=n.display){let i=n.geojson,r=null!=n.thickness&&null!=n.thickness?n.thickness:7,s=null!=n.fill&&null!=n.fill?n.fill:"#9e9477",o=null!=n.fillOpacity&&null!=n.fillOpacity?n.fillOpacity:.2,a=null!=n.blur&&null!=n.blur?n.blur:4;const l=Date.now().toString(36)+Math.random().toString(36).substring(2);t.append("defs").append("filter").attr("id",`blur${l}`).append("feGaussianBlur").attr("stdDeviation",a);let h=NC(i);t.append("clipPath").attr("id",`inner${l}`).append("path").datum(h).attr("d",kC.geoPath(e)),t.append("g").attr("clip-path",`url(#inner${l})`).append("path").datum(h).attr("fill","none").attr("stroke",s).attr("stroke-linecap","round").attr("stroke-linejoin","round").attr("stroke-opacity",o).attr("stroke-width",2*r).attr("filter",`url(#blur${l})`).attr("d",kC.geoPath(e))}}(_,i,{display:t.display,geojson:t.geojson,fill:t.fill,fillOpacity:t.fillOpacity,blur:t.blur,thickness:t.thickness}),"rhumbs"==t.type&&function(t,e,n,i,r={}){if(0!=r.display){let s=null!=r.nb?r.nb:16,o=null!=r.position?r.position:[e/4,n-n/4],a=r.stroke?r.stroke:"#394a70",l=null!=r.strokeWidth?r.strokeWidth:1,h=null!=r.strokeOpacity?r.strokeOpacity:.3,c=r.strokeDasharray?r.strokeDasharray:[3,2],u=[];for(let t=0;t<s;t++)u[t]=360/s*t*(Math.PI/180);let f=Math.max(e,n);t.append("g").attr("clip-path",null==i?"none":`url(#clip_${i})`).selectAll("polyline").data(u).enter().append("polyline").attr("fill","none").attr("stroke",a).attr("stroke-opacity",h).attr("stroke-width",l).attr("stroke-dasharray",c).attr("points",(function(t,e){let n=o[0]+Math.cos(t)*f,i=o[1]+Math.sin(t)*f;return o[0]+","+o[1]+" "+n+","+i}))}}(_,a,r,y,{display:t.display,nb:t.nb,position:t.position,stroke:t.stroke,strokeWidth:t.strokeWidth,strokeOpacity:t.strokeOpacity,strokeDasharray:t.strokeDasharray}),"tissot"==t.type&&pT(_,i,n,{display:t.display,step:t.step,fill:t.fill,fillOpacity:t.fillOpacity,stroke:t.stroke,strokeWidth:t.strokeWidth,strokeOpacity:t.strokeOpacity},y),"dotcartogram"==t.type&&function(t,e,n,i={},r,s,o){if(0!=i.display){let r=["#66c2a5","#fc8d62","#8da0cb","#e78ac3"],a=Uo(i.geojson),l=i.values,h=null!=i.radius?i.radius:4,c=null!=i.nbmax?i.nbmax:200,u=null!=i.onedot?i.onedot:Math.round(eT.sum(a.features.map((t=>+t.properties[l])))/c),f=null!=i.span?i.span:.5,d=null!=i.fill?i.fill:r[Math.floor(Math.random()*r.length)],p=null!=i.stroke?i.stroke:"none",g=null!=i.strokeWidth?i.strokeWidth:0,_=null!=i.fillOpacity?i.fillOpacity:1,y=null!=i.strokeDasharray?i.strokeDasharray:"none",m=null!=i.strokeOpacity?i.strokeOpacity:1,x=!!i.viewof,v=!!i.tooltip&&i.tooltip;Array.isArray(v)&&(v={fields:v}),"string"==typeof v&&(v={fields:[v]});let b,M=null!=i.iteration?i.iteration:200;b="p"==mE(a)?a.features:wE(a,{planar:n}).features;let w=[];for(let t=0;t<=b.length-1;t++){let e=Math.round(+b[t].properties[l]/u);for(let n=1;n<=e;n++)w.push({...b[t]})}const E=eT.forceSimulation(w).force("x",eT.forceX((t=>e(t.geometry.coordinates)[0]))).force("y",eT.forceY((t=>e(t.geometry.coordinates)[1]))).force("collide",eT.forceCollide(h+f+g/2));for(let t=0;t<M;t++)E.tick();let N={};t.append("g").selectAll("circle").data(w.filter((t=>null!=t.geometry.coordinates))).join("circle").attr("fill",(t=>fE(w,d).getcol(t.properties[d.values]))).attr("stroke",(t=>fE(w,p).getcol(t.properties[p.values]))).attr("stroke-width",(t=>pE(w,g).getthickness(t.properties[g.values]||void 0))).attr("fill-opacity",_).attr("stroke-dasharray",y).attr("stroke-opacity",m).attr("cx",(t=>t.x)).attr("cy",(t=>t.y)).attr("r",h).on("touchmove mousemove",(function(e,n){x&&(eT.select(this).attr("stroke-opacity",m-.3).attr("fill-opacity",_-.3),N=n.properties,t.dispatch("input"),Object.defineProperty(t.node(),"value",{get:()=>N,configurable:!0})),v&&t.select("#info").call(yE,{fields:function(){const t=Array.isArray(v.fields)?v.fields:[v.fields];let e=[];return t.forEach((t=>{e.push("$"==t[0]?`${n.properties[t.substr(1,t.length)]}`:t)})),e}(),fontWeight:v.fontWeight,fontSize:v.fontSize,fontStyle:v.fontStyle,fill:v.fill,stroke:v.stroke,strokeWidth:v.strokeWidth,fillOpacity:v.fillOpacity,strokeOpacity:v.strokeOpacity,col:v.col,type:_E(eT.pointer(e,this),s,o)}),v&&(t.select("#info").attr("transform",`translate(${eT.pointer(e,this)})`),eT.select(this).attr("stroke-opacity",m-.3).attr("fill-opacity",_-.3))})).on("touchend mouseleave",(function(){x&&(N={},t.dispatch("input")),t.select("#info").call(yE,null),eT.select(this).attr("stroke-opacity",m).attr("fill-opacity",_)})),x&&Object.defineProperty(t.node(),"value",{get:()=>N,configurable:!0});const S=null!=i.leg_x?i.leg_x:null,I=null!=i.leg_y?i.leg_y:null,k=i.leg_title?i.leg_title:"leg_title",O=null!=i.leg_fontSize?i.leg_fontSize:14,C=null!=i.leg_fontSize2?i.leg_fontSize2:10,T=i.leg_txtcol?i.leg_txtcol:"#363636",R=i.leg_stroke?i.leg_stroke:p,A=null!=i.leg_strokeWidth?i.leg_strokeWidth:g,L="string"==typeof d?d:i.leg_fill,P=i.leg_txt?i.leg_txt:u;if(null!=S&&null!=I){let e=t.append("g").attr("class","bertinlegend");null!=k&&(k.split("\n").length,e.append("g").selectAll("text").data(k.split("\n")).join("text").attr("x",S).attr("y",I).attr("font-size",`${O}px`).attr("dy",((t,e)=>e*O)).attr("text-anchor","start").attr("dominant-baseline","hanging").attr("fill",T).text((t=>t))),e.append("circle").attr("r",h).attr("fill",L).attr("stroke",R).attr("stroke-width",A).attr("cx",S+h).attr("cy",I+2*h+k.split("\n").length*O),e.append("text").attr("fill",T).attr("font-size",`${C}px`).attr("dominant-baseline","middle").attr("x",S+2*h+C).attr("y",I+2*h+k.split("\n").length*O).text(P)}gE({type:"FeatureCollection",features:w},t,d,p,g)}}(_,i,n,{display:t.display,geojson:t.geojson,values:t.values,radius:t.radius,nbmax:t.nbmax,onedot:t.onedot,span:t.span,fill:t.fill,stroke:t.stroke,strokeWidth:t.strokeWidth,fillOpacity:t.fillOpacity,strokeDasharray:t.strokeDasharray,strokeOpacity:t.strokeOpacity,iteration:t.iteration,tooltip:t.tooltip,leg_x:t.leg_x,leg_y:t.leg_y,leg_title:t.leg_title,leg_fontSize:t.leg_fontSize,leg_fontSize2:t.leg_fontSize2,leg_txtcol:t.leg_txtcol,leg_stroke:t.leg_stroke,leg_strokeWidth:t.leg_strokeWidth,leg_fill:t.leg_fill,leg_txt:t.leg_txt,viewof:t.viewof},0,a,r),"bubble"==t.type&&NE(_,i,n,{display:t.display,geojson:t.geojson,values:t.values,planar:t.planar,k:t.k,fixmax:t.fixmax,fill:t.fill,stroke:t.stroke,strokeWidth:t.strokeWidth,fillOpacity:t.fillOpacity,strokeDasharray:t.strokeDasharray,strokeOpacity:t.strokeOpacity,dorling:t.dorling,iteration:t.iteration,tooltip:t.tooltip,leg_x:t.leg_x,leg_y:t.leg_y,leg_stroke:t.leg_stroke,leg_fill:t.leg_fill,leg_strokeWidth:t.leg_strokeWidth,leg_txtcol:t.leg_txtcol,leg_title:t.leg_title,leg_fontSize:t.leg_fontSize,leg_fontSize2:t.leg_fontSize2,leg_round:t.leg_round,viewof:t.viewof},0,a,r),"square"==t.type&&kE(_,i,n,{display:t.display,geojson:t.geojson,values:t.values,planar:t.planar,k:t.k,fixmax:t.fixmax,fill:t.fill,stroke:t.stroke,strokeWidth:t.strokeWidth,fillOpacity:t.fillOpacity,strokeDasharray:t.strokeDasharray,strokeOpacity:t.strokeOpacity,dorling:t.dorling,demers:t.demers,iteration:t.iteration,tooltip:t.tooltip,leg_x:t.leg_x,leg_y:t.leg_y,leg_stroke:t.leg_stroke,leg_fill:t.leg_fill,leg_strokeWidth:t.leg_strokeWidth,leg_txtcol:t.leg_txtcol,leg_title:t.leg_title,leg_fontSize:t.leg_fontSize,leg_fontSize2:t.leg_fontSize2,leg_round:t.leg_round,viewof:t.viewof},0,a,r),"regularbubble"==t.type&&function(t,e,n={},i,r,s){n.geojson=NN({geojson:n.geojson,projection:e,width:r,height:s,step:n.step,values:n.values,blur:n.blur}),n.values="value",NE(t,ss(),!0,n,0,r,s)}(_,i,{display:t.display,geojson:t.geojson,values:t.values,step:t.step,blur:t.blur,planar:t.planar,k:t.k,fixmax:t.fixmax,fill:t.fill,stroke:t.stroke,strokeWidth:t.strokeWidth,fillOpacity:t.fillOpacity,strokeDasharray:t.strokeDasharray,strokeOpacity:t.strokeOpacity,dorling:t.dorling,iteration:t.iteration,tooltip:t.tooltip,leg_x:t.leg_x,leg_y:t.leg_y,leg_stroke:t.leg_stroke,leg_fill:t.leg_fill,leg_strokeWidth:t.leg_strokeWidth,leg_txtcol:t.leg_txtcol,leg_title:t.leg_title,leg_fontSize:t.leg_fontSize,leg_fontSize2:t.leg_fontSize2,leg_round:t.leg_round,viewof:t.viewof},0,a,r),"regularsquare"==t.type&&function(t,e,n={},i,r,s){n.geojson=NN({geojson:n.geojson,projection:e,width:r,height:s,step:n.step,values:n.values,blur:n.blur}),n.values="value",kE(t,ss(),!0,n,0,r,s)}(_,i,{display:t.display,geojson:t.geojson,values:t.values,step:t.step,blur:t.blur,planar:t.planar,k:t.k,fixmax:t.fixmax,fill:t.fill,stroke:t.stroke,strokeWidth:t.strokeWidth,fillOpacity:t.fillOpacity,strokeDasharray:t.strokeDasharray,strokeOpacity:t.strokeOpacity,dorling:t.dorling,demers:t.demers,iteration:t.iteration,tooltip:t.tooltip,leg_x:t.leg_x,leg_y:t.leg_y,leg_stroke:t.leg_stroke,leg_fill:t.leg_fill,leg_strokeWidth:t.leg_strokeWidth,leg_txtcol:t.leg_txtcol,leg_title:t.leg_title,leg_fontSize:t.leg_fontSize,leg_fontSize2:t.leg_fontSize2,leg_round:t.leg_round,viewof:t.viewof},0,a,r),"regulargrid"!=t.type&&"grid"!=t.type||function(t,e,n={},i,r,s){n.geojson=NN({geojson:n.geojson,output:"square",projection:e,width:r,height:s,step:n.step,values:n.values,blur:n.blur}),null==n.fill&&(n.fill={nbreaks:6,method:"quantile",colors:"Blues"}),"object"==typeof n.fill&&null==n.fill.values&&(n.fill.values="value"),"object"==typeof n.fill&&null==n.fill.type&&(n.fill.type="choro"),vE(t,ss(),n,i,r,s)}(_,i,{display:t.display,geojson:t.geojson,values:t.values,step:t.step,blur:t.blur,planar:t.planar,fill:t.fill,stroke:t.stroke,strokeWidth:t.strokeWidth,strokeLinecap:t.strokeLinecap,strokeLinejoin:t.strokeLinejoin,fillOpacity:t.fillOpacity,strokeOpacity:t.strokeOpacity,strokeDasharray:t.strokeDasharray,symbol:t.symbol,symbol_size:t.symbol_size,symbol_iteration:t.symbol_iteration,symbol_shift:t.symbol_shift,tooltip:t.tooltip,leg_x:t.leg_x,leg_y:t.leg_y,leg_w:t.leg_w,leg_h:t.leg_h,leg_title:t.leg_title,leg_text:t.leg_text,leg_type:t.leg_type,leg_fontSize:t.leg_fontSize,leg_fontSize2:t.leg_fontSize2,leg_stroke:t.leg_stroke,leg_fillOpacity:t.leg_fillOpacity,leg_fill:t.leg_fill,leg_strokeWidth:t.leg_strokeWidth,leg_txtcol:t.leg_txtcol,viewof:t.viewof},y,a,r),"smooth"!=t.type&&"contour"!=t.type&&"heatmap"!=t.type||function(t,e,n={},i,r,s){let o=0!=n.display;null!=n.clip&&n.clip;let a=null!=n.reverse&&n.reverse,l=n.fill?n.fill:"RdYlGn",h=n.strokeLinecap?n.strokeLinecap:"round",c=n.strokeLinejoin?n.strokeLinejoin:"round",u=null!=n.strokeDasharray?n.strokeDasharray:"none",f=n.stroke?n.stroke:"none",d=null!=n.strokeWidth?n.strokeWidth:.5,p=null!=n.fillOpacity?n.fillOpacity:.5,g=null!=n.strokeOpacity?n.strokeOpacity:1,_=null!=n.remove?n.remove:0,y=null!=n.thresholds?n.thresholds:100,m=null!=n.bandwidth?n.bandwidth:5,x=null!=n.cellSize?n.cellSize:1,v=null!=n.colorcurve?n.colorcurve:2,b=1e3,M=Date.now().toString(36)+Math.random().toString(36).substring(2);if(o){let i;if("z"==mE(n.geojson))if(n.clip&&t.append("clipPath").attr("id",`clip_${M}`).append("path").datum(n.geojson).attr("d",FN.geoPath(e)),null!=n.grid_step||null!=n.grid_blur){let t=null!=n.grid_step?n.grid_step:20,o=null!=n.grid_blur?n.grid_blur:0;i=GN({geojson:NN({geojson:n.geojson,projection:e,width:r,height:s,step:t,blur:o,values:n.values}),values:"value",nb:b,projection:FN.geoIdentity()})}else n.geojson=wE(n.geojson),i=GN({geojson:n.geojson,values:n.values,nb:b,projection:e});"p"==mE(n.geojson)&&(i=GN({geojson:n.geojson,values:n.values,nb:b,projection:e}));let o,w=FN.contourDensity().x((t=>t[0])).y((t=>t[1])).size([r,s]).bandwidth(m).thresholds(y).cellSize(x)(i),E=new Map([["Blues",FN.interpolateBlues],["Greens",FN.interpolateGreens],["Greys",FN.interpolateGreys],["Oranges",FN.interpolateOranges],["Purples",FN.interpolatePurples],["Reds",FN.interpolateReds],["BrBG",FN.interpolateBrBG],["PRGn",FN.interpolatePRGn],["PiYG",FN.interpolatePiYG],["PuOr",FN.interpolatePuOr],["RdBu",FN.interpolateRdBu],["RdYlBu",FN.interpolateRdYlBu],["RdYlGn",FN.interpolateRdYlGn],["Spectral",FN.interpolateSpectral],["Turbo",FN.interpolateTurbo],["Viridis",FN.interpolateViridis],["Inferno",FN.interpolateInferno],["Magma",FN.interpolateMagma],["Plasma",FN.interpolatePlasma],["Cividis",FN.interpolateCividis],["Warm",FN.interpolateWarm],["Cool",FN.interpolateCool],["CubehelixDefault",FN.interpolateCubehelixDefault],["BuGn",FN.interpolateBuGn],["BuPu",FN.interpolateBuPu],["GnBu",FN.interpolateGnBu],["OrRd",FN.interpolateOrRd],["PuBuGn",FN.interpolatePuBuGn],["PuBu",FN.interpolatePuBu],["PuRd",FN.interpolatePuRd],["RdPu",FN.interpolateRdPu],["YlGnBu",FN.interpolateYlGnBu],["YlGn",FN.interpolateYlGn],["YlOrBr",FN.interpolateYlOrBr],["YlOrRd",FN.interpolateYlOrRd],["Rainbow",FN.interpolateRainbow],["Sinebow",FN.interpolateSinebow]]);o=a?FN.scaleSequentialQuantile([...w.map((t=>t.value))],(t=>E.get(l)(Math.pow(.01+t,1/v)))):FN.scaleSequentialQuantile([...w.map((t=>t.value))],(t=>E.get(l)(1-Math.pow(.01+t,1/v)))),w.splice(0,_),t.append("g").attr("clip-path",null==n.clip?"none":`url(#clip_${M})`).selectAll("path").data(w).join("path").attr("d",FN.geoPath()).attr("fill",(t=>o(t.value))).attr("stroke",f).attr("stroke-width",d).attr("fill-opacity",p).attr("stroke-opacity",g).attr("stroke-linecap",h).attr("stroke-linejoin",c).attr("stroke-dasharray",u)}}(_,i,{display:t.display,clip:t.clip,geojson:t.geojson,values:t.values,grid_step:t.grid_step,grid_blur:t.grid_blur,remove:t.remove,fill:t.fill,reverse:t.reverse,stroke:t.stroke,strokeWidth:t.strokeWidth,strokeLinecap:t.strokeLinecap,strokeLinejoin:t.strokeLinejoin,fillOpacity:t.fillOpacity,strokeOpacity:t.strokeOpacity,strokeDasharray:t.strokeDasharray,thresholds:t.thresholds,bandwidth:t.bandwidth,cellsize:t.cellsize,colorcurve:t.colorcurve},0,a,r),"custom"==t.type||"function"==t.type){const{render:e,type:n,...s}=t;e(_,{projection:i,width:a,height:r,clipid:y},{...s})}"header"==t.type&&function(t,e,n={}){if(0!=n.display){let i;n.text&&(i=25),n.fontSize&&(i=n.fontSize);let r=n.text?n.text:"",s=n.fill?n.fill:"#9e9696",o=n.background?n.background:"white",a=null!=n.backgroundOpacity?n.backgroundOpacity:1,l=n.anchor?n.anchor:"middle";const h=i*r.split("\n").length;let c;"start"==l&&(c=5),"middle"==l&&(c=e/2),"end"==l&&(c=e-5);let u=t.append("g");u.append("rect").attr("x",0).attr("y",0-h-10).attr("width",e).attr("height",h+10).attr("fill",o).attr("fill-opacity",a),u.selectAll("text").data(n.text.split("\n")).join("text").attr("x",c).attr("y",-h-5).attr("font-size",`${i}px`).attr("dy",((t,e)=>e*i+i/2)).attr("text-anchor",l).attr("dominant-baseline","central").attr("fill",s).attr("font-family","sans-serif").attr("font-weight","bold").attr("fill-opacity",1).text((t=>t))}}(_,a,{display:t.display,fontSize:t.fontSize,text:t.text,fill:t.fill,background:t.background,backgroundOpacity:t.backgroundOpacity,anchor:t.anchor}),"footer"==t.type&&function(t,e,n,i={}){if(0!=i.display){let r;i.text&&(r=10),i.fontSize&&(r=i.fontSize);let s=i.text?i.text:"",o=i.fill?i.fill:"#9e9696",a=i.background?i.background:"white",l=i.backgroundOpacity?i.backgroundOpacity:1,h=i.anchor?i.anchor:"end";const c=r*s.split("\n").length;let u;"start"==h&&(u=5),"middle"==h&&(u=e/2),"end"==h&&(u=e-5);let f=t.append("g");f.append("rect").attr("x",0).attr("y",n).attr("width",e).attr("height",c+10).attr("fill",a).attr("fill-opacity",l),f.selectAll("text").data(i.text.split("\n")).join("text").attr("x",u).attr("y",n+5).attr("font-size",`${r}px`).attr("dy",((t,e)=>e*r)).attr("text-anchor",h).attr("dominant-baseline","hanging").attr("fill",o).attr("font-family","sans-serif").attr("fill-opacity",1).text((t=>t))}}(_,a,r,{display:t.display,fontSize:t.fontSize,text:t.text,fill:t.fill,background:t.background,backgroundOpacity:t.backgroundOpacity,anchor:t.anchor}),"hatch"!=t.type&&"hatching"!=t.type||function(t,e={},n,i){if(0!=e.display){let r=t.append("defs");const s=e.stroke?e.stroke:"#786d6c",o=null!=e.strokeWidth?e.strokeWidth:2,a=null!=e.strokeOpacity?e.strokeOpacity:.1,l=null!=e.angle?e.angle:45,h=null!=e.spacing?e.spacing:8,c=e.strokeDasharray?e.strokeDasharray:"none",u=Date.now().toString(36)+Math.random().toString(36).substring(2);r.append("pattern").attr("id",`hatch${u}`).attr("patternUnits","userSpaceOnUse").attr("width",h).attr("height",h).attr("patternTransform",`rotate(${l})`).append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y1",h).attr("stroke",s).attr("stroke-linejoin","butt").attr("stroke-width",o).attr("stroke-dasharray",c).attr("stroke-opacity",a),t.append("rect").attr("x",0).attr("y",0).attr("width",n).attr("height",i).attr("fill","url('#hatch"+u+"')")}}(_,{display:t.display,stroke:t.stroke,strokeWidth:t.strokeWidth,strokeOpacity:t.strokeOpacity,angle:t.angle,spacing:t.spacing,strokeDasharray:t.strokeDasharray},a,r)}));let x=e.find((t=>"scalebar"==t.type));if(x&&function(t,e,n,i,r,s={}){if(0!=s.display&&!n){let n=s.x?s.x:20,o=s.y?s.y:r-30,a=s.units?s.units:"kilometers";n/=i,o/=r;const l=QC.geoScaleBar().projection(e).size([i,r]).left(n).top(o).label("miles"==a?"Miles":"Km").units("miles"==a?QC.geoScaleMiles:QC.geoScaleKilometers).orient(QC.geoScaleBottom).tickPadding(5).tickSize(0);t.append("g").attr("transform",`translate(${n}, ${o})`).append("g").call(l)}}(_,i,n,a,r,{display:x.display,x:x.x,y:x.y,units:x.units}),m&&Tp(_,i,n,{display:m.display,fill:"none",stroke:m.stroke,strokeWidth:m.strokeWidth}),_.append("g").attr("id","info").attr("class","info"),_.selectAll(".bertinlegend").raise(),void 0===e.find((t=>t.viewof))){let t=[];_.on("mousemove",(function(e){const{offsetX:n,offsetY:r}=e;t=i.invert([n,r]),_.dispatch("input")})),Object.defineProperty(_.node(),"value",{get:()=>t})}return Object.assign(_.node(),{info:{width:a,height:r+f+p,height_map:r,height_header:f,height_footer:p,projection:i}}),_.node()}const xT=Object.assign({},{create:ko,scaleLinear:kx});const vT=Object.assign({},{index:G});var bT=Object.prototype.hasOwnProperty;function MT(t,e,n,i,r,s){3===arguments.length&&(i=s=Array,r=null);for(var o=new i(t=1<<Math.max(4,Math.ceil(Math.log(t)/Math.LN2))),a=new s(t),l=t-1,h=0;h<t;++h)o[h]=r;function c(i,s){for(var h=e(i)&l,c=o[h],u=0;c!=r;){if(n(c,i))return a[h]=s;if(++u>=t)throw new Error("full hashmap");c=o[h=h+1&l]}return o[h]=i,a[h]=s,s}function u(i,s){for(var h=e(i)&l,c=o[h],u=0;c!=r;){if(n(c,i))return a[h];if(++u>=t)throw new Error("full hashmap");c=o[h=h+1&l]}return o[h]=i,a[h]=s,s}function f(i,s){for(var h=e(i)&l,c=o[h],u=0;c!=r;){if(n(c,i))return a[h];if(++u>=t)break;c=o[h=h+1&l]}return s}function d(){for(var t=[],e=0,n=o.length;e<n;++e){var i=o[e];i!=r&&t.push(i)}return t}return{set:c,maybeSet:u,get:f,keys:d}}function wT(t,e){return t[0]===e[0]&&t[1]===e[1]}var ET=new ArrayBuffer(16),NT=new Float64Array(ET),ST=new Uint32Array(ET);function IT(t){NT[0]=t[0],NT[1]=t[1];var e=ST[0]^ST[1];return 2147483647&(e=e<<5^e>>7^ST[2]^ST[3])}function kT(t){var e,n,i,r,s=t.coordinates,o=t.lines,a=t.rings,l=function(){for(var t=MT(1.4*s.length,b,M,Int32Array,-1,Int32Array),e=new Int32Array(s.length),n=0,i=s.length;n<i;++n)e[n]=t.maybeSet(n,n);return e}(),h=new Int32Array(s.length),c=new Int32Array(s.length),u=new Int32Array(s.length),f=new Int8Array(s.length),d=0;for(e=0,n=s.length;e<n;++e)h[e]=c[e]=u[e]=-1;for(e=0,n=o.length;e<n;++e){var p=o[e],g=p[0],_=p[1];for(i=l[g],r=l[++g],++d,f[i]=1;++g<=_;)v(e,i,i=r,r=l[g]);++d,f[r]=1}for(e=0,n=s.length;e<n;++e)h[e]=-1;for(e=0,n=a.length;e<n;++e){var y=a[e],m=y[0]+1,x=y[1];for(v(e,l[x-1],i=l[m-1],r=l[m]);++m<=x;)v(e,i,i=r,r=l[m])}function v(t,e,n,i){if(h[n]!==t){h[n]=t;var r=c[n];if(r>=0){var s=u[n];r===e&&s===i||r===i&&s===e||(++d,f[n]=1)}else c[n]=e,u[n]=i}}function b(t){return IT(s[t])}function M(t,e){return wT(s[t],s[e])}h=c=u=null;var w,E=function(t,e,n,i,r){3===arguments.length&&(i=Array,r=null);for(var s=new i(t=1<<Math.max(4,Math.ceil(Math.log(t)/Math.LN2))),o=t-1,a=0;a<t;++a)s[a]=r;function l(i){for(var a=e(i)&o,l=s[a],h=0;l!=r;){if(n(l,i))return!0;if(++h>=t)throw new Error("full hashset");l=s[a=a+1&o]}return s[a]=i,!0}function h(i){for(var a=e(i)&o,l=s[a],h=0;l!=r;){if(n(l,i))return!0;if(++h>=t)break;l=s[a=a+1&o]}return!1}function c(){for(var t=[],e=0,n=s.length;e<n;++e){var i=s[e];i!=r&&t.push(i)}return t}return{add:l,has:h,values:c}}(1.4*d,IT,wT);for(e=0,n=s.length;e<n;++e)f[w=l[e]]&&E.add(s[w]);return E}function OT(t,e,n,i){CT(t,e,n),CT(t,e,e+i),CT(t,e+i,n)}function CT(t,e,n){for(var i,r=e+(n---e>>1);e<r;++e,--n)i=t[e],t[e]=t[n],t[n]=i}function TT(t){var e,n,i={};for(e in t)i[e]=null==(n=t[e])?{type:null}:("FeatureCollection"===n.type?RT:"Feature"===n.type?AT:LT)(n);return i}function RT(t){var e={type:"GeometryCollection",geometries:t.features.map(AT)};return null!=t.bbox&&(e.bbox=t.bbox),e}function AT(t){var e,n=LT(t.geometry);for(e in null!=t.id&&(n.id=t.id),null!=t.bbox&&(n.bbox=t.bbox),t.properties){n.properties=t.properties;break}return n}function LT(t){if(null==t)return{type:null};var e="GeometryCollection"===t.type?{type:"GeometryCollection",geometries:t.geometries.map(LT)}:"Point"===t.type||"MultiPoint"===t.type?{type:t.type,coordinates:t.coordinates}:{type:t.type,arcs:t.coordinates};return null!=t.bbox&&(e.bbox=t.bbox),e}function PT(t){var e,n=t[0],i=t[1];return i<n&&(e=n,n=i,i=e),n+31*i}function DT(t,e){var n,i=t[0],r=t[1],s=e[0],o=e[1];return r<i&&(n=i,i=r,r=n),o<s&&(n=s,s=o,o=n),i===s&&r===o}const zT=Object.assign({},{topology:function(t,e){var n=function(t){var e=1/0,n=1/0,i=-1/0,r=-1/0;function s(t){null!=t&&bT.call(o,t.type)&&o[t.type](t)}var o={GeometryCollection:function(t){t.geometries.forEach(s)},Point:function(t){a(t.coordinates)},MultiPoint:function(t){t.coordinates.forEach(a)},LineString:function(t){l(t.arcs)},MultiLineString:function(t){t.arcs.forEach(l)},Polygon:function(t){t.arcs.forEach(l)},MultiPolygon:function(t){t.arcs.forEach(h)}};function a(t){var s=t[0],o=t[1];s<e&&(e=s),s>i&&(i=s),o<n&&(n=o),o>r&&(r=o)}function l(t){t.forEach(a)}function h(t){t.forEach(l)}for(var c in t)s(t[c]);return i>=e&&r>=n?[e,n,i,r]:void 0}(t=TT(t)),i=e>0&&n&&function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=s-i?(n-1)/(s-i):1,l=o-r?(n-1)/(o-r):1;function h(t){return[Math.round((t[0]-i)*a),Math.round((t[1]-r)*l)]}function c(t,e){for(var n,s,o,h,c,u=-1,f=0,d=t.length,p=new Array(d);++u<d;)n=t[u],h=Math.round((n[0]-i)*a),c=Math.round((n[1]-r)*l),h===s&&c===o||(p[f++]=[s=h,o=c]);for(p.length=f;f<e;)f=p.push([p[0][0],p[0][1]]);return p}function u(t){return c(t,2)}function f(t){return c(t,4)}function d(t){return t.map(f)}function p(t){null!=t&&bT.call(g,t.type)&&g[t.type](t)}var g={GeometryCollection:function(t){t.geometries.forEach(p)},Point:function(t){t.coordinates=h(t.coordinates)},MultiPoint:function(t){t.coordinates=t.coordinates.map(h)},LineString:function(t){t.arcs=u(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(u)},Polygon:function(t){t.arcs=d(t.arcs)},MultiPolygon:function(t){t.arcs=t.arcs.map(d)}};for(var _ in t)p(t[_]);return{scale:[1/a,1/l],translate:[i,r]}}(t,n,e),r=function(t){var e,n,i,r,s=t.coordinates,o=t.lines,a=t.rings,l=o.length+a.length;for(delete t.lines,delete t.rings,i=0,r=o.length;i<r;++i)for(e=o[i];e=e.next;)++l;for(i=0,r=a.length;i<r;++i)for(n=a[i];n=n.next;)++l;var h=MT(2*l*1.4,IT,wT),c=t.arcs=[];for(i=0,r=o.length;i<r;++i){e=o[i];do{u(e)}while(e=e.next)}for(i=0,r=a.length;i<r;++i)if((n=a[i]).next)do{u(n)}while(n=n.next);else f(n);function u(t){var e,n,i,r,o,a,l,u;if(i=h.get(e=s[t[0]]))for(l=0,u=i.length;l<u;++l)if(d(r=i[l],t))return t[0]=r[0],void(t[1]=r[1]);if(o=h.get(n=s[t[1]]))for(l=0,u=o.length;l<u;++l)if(p(a=o[l],t))return t[1]=a[0],void(t[0]=a[1]);i?i.push(t):h.set(e,[t]),o?o.push(t):h.set(n,[t]),c.push(t)}function f(t){var e,n,i,r,o;if(n=h.get(s[t[0]]))for(r=0,o=n.length;r<o;++r){if(g(i=n[r],t))return t[0]=i[0],void(t[1]=i[1]);if(_(i,t))return t[0]=i[1],void(t[1]=i[0])}if(n=h.get(e=s[t[0]+y(t)]))for(r=0,o=n.length;r<o;++r){if(g(i=n[r],t))return t[0]=i[0],void(t[1]=i[1]);if(_(i,t))return t[0]=i[1],void(t[1]=i[0])}n?n.push(t):h.set(e,[t]),c.push(t)}function d(t,e){var n=t[0],i=e[0],r=t[1];if(n-r!=i-e[1])return!1;for(;n<=r;++n,++i)if(!wT(s[n],s[i]))return!1;return!0}function p(t,e){var n=t[0],i=e[0],r=t[1],o=e[1];if(n-r!=i-o)return!1;for(;n<=r;++n,--o)if(!wT(s[n],s[o]))return!1;return!0}function g(t,e){var n=t[0],i=e[0],r=t[1]-n;if(r!==e[1]-i)return!1;for(var o=y(t),a=y(e),l=0;l<r;++l)if(!wT(s[n+(l+o)%r],s[i+(l+a)%r]))return!1;return!0}function _(t,e){var n=t[0],i=e[0],r=t[1],o=e[1],a=r-n;if(a!==o-i)return!1;for(var l=y(t),h=a-y(e),c=0;c<a;++c)if(!wT(s[n+(c+l)%a],s[o-(c+h)%a]))return!1;return!0}function y(t){for(var e=t[0],n=t[1],i=e,r=i,o=s[i];++i<n;){var a=s[i];(a[0]<o[0]||a[0]===o[0]&&a[1]<o[1])&&(r=i,o=a)}return r-e}return t}(function(t){var e,n,i,r=kT(t),s=t.coordinates,o=t.lines,a=t.rings;for(n=0,i=o.length;n<i;++n)for(var l=o[n],h=l[0],c=l[1];++h<c;)r.has(s[h])&&(e={0:h,1:l[1]},l[1]=h,l=l.next=e);for(n=0,i=a.length;n<i;++n)for(var u=a[n],f=u[0],d=f,p=u[1],g=r.has(s[f]);++d<p;)r.has(s[d])&&(g?(e={0:d,1:u[1]},u[1]=d,u=u.next=e):(OT(s,f,p,p-d),s[p]=s[f],g=!0,d=f));return t}(function(t){var e=-1,n=[],i=[],r=[];function s(t){t&&bT.call(o,t.type)&&o[t.type](t)}var o={GeometryCollection:function(t){t.geometries.forEach(s)},LineString:function(t){t.arcs=a(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(a)},Polygon:function(t){t.arcs=t.arcs.map(l)},MultiPolygon:function(t){t.arcs=t.arcs.map(h)}};function a(t){for(var i=0,s=t.length;i<s;++i)r[++e]=t[i];var o={0:e-s+1,1:e};return n.push(o),o}function l(t){for(var n=0,s=t.length;n<s;++n)r[++e]=t[n];var o={0:e-s+1,1:e};return i.push(o),o}function h(t){return t.map(l)}for(var c in t)s(t[c]);return{type:"Topology",coordinates:r,lines:n,rings:i,objects:t}}(t))),s=r.coordinates,o=MT(1.4*r.arcs.length,PT,DT);function a(t){t&&bT.call(l,t.type)&&l[t.type](t)}t=r.objects,r.bbox=n,r.arcs=r.arcs.map((function(t,e){return o.set(t,e),s.slice(t[0],t[1]+1)})),delete r.coordinates,s=null;var l={GeometryCollection:function(t){t.geometries.forEach(a)},LineString:function(t){t.arcs=h(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(h)},Polygon:function(t){t.arcs=t.arcs.map(h)},MultiPolygon:function(t){t.arcs=t.arcs.map(c)}};function h(t){var e=[];do{var n=o.get(t);e.push(t[0]<t[1]?n:~n)}while(t=t.next);return e}function c(t){return t.map(h)}for(var u in t)a(t[u]);return i&&(r.transform=i,r.arcs=function(t){for(var e=-1,n=t.length;++e<n;){for(var i,r,s=t[e],o=0,a=1,l=s.length,h=s[0],c=h[0],u=h[1];++o<l;)i=(h=s[o])[0],r=h[1],i===c&&r===u||(s[a++]=[i-c,r-u],c=i,u=r);1===a&&(s[a++]=[0,0]),s.length=a}return t}(r.arcs)),r},neighbors:function(t){var e={},n=t.map((function(){return[]}));function i(t,n){t.forEach((function(t){t<0&&(t=~t);var i=e[t];i?i.push(n):e[t]=[n]}))}function r(t,e){t.forEach((function(t){i(t,e)}))}var s={LineString:i,MultiLineString:r,Polygon:r,MultiPolygon:function(t,e){t.forEach((function(t){r(t,e)}))}};for(var o in t.forEach((function t(e,n){"GeometryCollection"===e.type?e.geometries.forEach((function(e){t(e,n)})):e.type in s&&s[e.type](e.arcs,n)})),e)for(var a=e[o],l=a.length,h=0;h<l;++h)for(var c=h+1;c<l;++c){var u,f=a[h],d=a[c];(u=n[f])[o=jo(u,d)]!==d&&u.splice(o,0,d),(u=n[d])[o=jo(u,f)]!==f&&u.splice(o,0,f)}return n},mesh:function(t){return zo(t,Go.apply(this,arguments))}}),FT=Object.assign({},St);function GT(t,e={}){let n=Wo(t);if(null==e.values&&null==e.id){const t=zT.topology({d:n});return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:zT.mesh(t,Object.entries(t.objects)[0][1],((t,e)=>t!==e))}]}}{const t=e.id,i=e.values,r=e.type?e.type:"rel",s=e.share?e.share:null,o=zT.topology({d:n}),a=n.features.map((e=>e.properties[t])),l=zT.neighbors(o.objects.d.geometries),h=new Map(n.features.map((e=>[e.properties[t],e.properties[i]])));let c=[];a.forEach((e=>{l[a.indexOf(e)].map((t=>({properties:{i:e,j:a[t],varoptionsi:+h.get(e),varoptionsj:+h.get(a[t]),disc:"rel"==r?0!=FT.min([+h.get(e),+h.get(a[t])])?FT.max([+h.get(e),+h.get(a[t])])/FT.min([+h.get(e),+h.get(a[t])]):null:FT.max([+h.get(e),+h.get(a[t])])-FT.min([+h.get(e),+h.get(a[t])])}}))).forEach((e=>{let n=zT.mesh(o,o.objects.d,((n,i)=>n.properties[t]==e.properties.i&i.properties[t]==e.properties.j)),i=Object.assign({type:"Feature"},e);c.push(Object.assign(i,{geometry:n}))}))})),c.sort(((t,e)=>FT.descending(t.properties.disc,e.properties.disc)));const u=c.length;return c.map((t=>t.properties)).forEach(((t,e)=>{Object.assign(t,{share:(e+1)/u})})),null!=s&&(c=c.filter((t=>t.properties.share<s))),n.features=c,n}}function qT({x:t,field:e}){let n=[...t.features.map((t=>({...t.properties})))];n.forEach((t=>{Array.isArray(e)?e.forEach((e=>delete t[e])):delete t[e]}));let i=JSON.parse(JSON.stringify(t));return i.features.map(((t,e)=>t.properties={...n[e]})),i}function jT(t){return new Function(`return (${t})`)()}const BT=Object.assign({},{table:function(t){return JSON.parse(JSON.stringify(t.features.map((t=>t.properties))))},remove:qT,keep:function({x:t,field:e}){let n=[];t.features.map((t=>t.properties)).forEach((t=>{n.push(Object.keys(t))})),n=Array.from(new Set(n.flat()));let i=n.filter((t=>!e.includes(t)));return qT({x:t,field:i})},add:function({x:t,field:e,expression:n}){let i=[...t.features.map((t=>({...t.properties})))],r=[];t.features.map((t=>t.properties)).forEach((t=>{r.push(Object.keys(t))})),r=Array.from(new Set(r.flat())),r.forEach((t=>{n=n.replace(t,`d.${t}`)})),n="d=> "+n;let s=i.map(jT(n));i.forEach(((t,n)=>{t=Object.assign(t,{[e]:s[n]})}));let o=JSON.parse(JSON.stringify(t));return o.features.map(((t,e)=>t.properties={...i[e]})),o},filter:function({x:t,expression:e}){let n=[...t.features],i=[];t.features.map((t=>t.properties)).forEach((t=>{i.push(Object.keys(t))})),i=Array.from(new Set(i.flat())),i.forEach((t=>{e=e.replace(t,`d.properties.${t}`)})),e="d => "+e;let r=JSON.parse(JSON.stringify(t));return r.features=n.filter(jT(e)),r},subset:function({x:t,field:e,selection:n,inverse:i=!1}){let r=[...t.features];n=Array.isArray(n)?n:[n],i&&(n=Array.from(new Set(r.map((t=>t.properties[e])))).filter((t=>!n.includes(t))));let s=[];n.forEach((t=>{s.push(r.filter((n=>n.properties[e]==t)))}));let o=JSON.parse(JSON.stringify(t));return o.features=s.flat(),o},head:function({x:t,field:e,nb:n=10}){let i=[...t.features];i=i.filter((t=>""!=t.properties[e])).filter((t=>null!=t.properties[e])).filter((t=>null!=t.properties[e])).filter((t=>t.properties[e]!=1/0)).filter((t=>t.properties[e]!=-1/0)).filter((t=>NaN!=t.properties[e])),i.sort(((t,n)=>+n.properties[e]-+t.properties[e])),i=i.slice(0,n);let r=JSON.parse(JSON.stringify(t));return r.features=i,r},tail:function({x:t,field:e,nb:n=10}){let i=[...t.features];i=i.filter((t=>""!=t.properties[e])).filter((t=>null!=t.properties[e])).filter((t=>null!=t.properties[e])).filter((t=>t.properties[e]!=1/0)).filter((t=>t.properties[e]!=-1/0)).filter((t=>NaN!=t.properties[e])),i.sort(((t,n)=>+t.properties[e]-+n.properties[e])),i=i.slice(0,n);let r=JSON.parse(JSON.stringify(t));return r.features=i,r}});let UT={table:BT.table,remove:function({geojson:t,field:e}){return BT.remove({x:t,field:e})},keep:function({geojson:t,field:e}){return BT.keep({x:t,field:e})},add:function({geojson:t,field:e,expression:n}){return BT.add({x:t,field:e,expression:n})},filter:function({geojson:t,expression:e}){return BT.filter({x:t,expression:e})},subset:function({geojson:t,field:e,selection:n,inverse:i}){return BT.subset({x:t,field:e,selection:n,inverse:i})},head:function({geojson:t,field:e,nb:n}){return BT.head({x:t,field:e,nb:n})},tail:function({geojson:t,field:e,nb:n}){return BT.tail({x:t,field:e,nb:n})}};t.bbox=Xo,t.borders=function({geojson:t,id:e,values:n,type:i="rel",share:r=null}){return null==e||null==n?GT(t):GT(t,{id:e,values:n,type:i,share:r})},t.draw=mT,t.links=function(t={}){let e,n=Uo(t.geojson),i=t.geojson_id,r=t.data,s=null!=t.data_i?t.data_i:"i",o=null!=t.data_j?t.data_j:"j",a=!!t.planar;e="p"==mE(n)?n.features:wE(n,{planar:a}).features;const l=new Map(e.map((t=>[t.properties[i],t.geometry.coordinates])));let h=[];return r.forEach((t=>{null!=l.get(t[s])&&null!=l.get(t[o])&&h.push({type:"Feature",properties:t,geometry:{type:"LineString",coordinates:[l.get(t[s]),l.get(t[o])]}})})),{type:"FeatureCollection",features:h}},t.match=function(t,e,n,i){let r=(t=Uo(t)).features.map((t=>t.properties[e])),s=n.map((t=>t[i])),o=Array.from(new Set(r.concat(s))),a=r.filter((t=>s.includes(t))),l=r.filter((t=>!s.includes(t))),h=s.filter((t=>!r.includes(t))),c=a.filter((t=>s.includes(t))),u=a.filter((t=>r.includes(t))),f=1e3,d=100,p=30,g=xT.scaleLinear().domain([0,o.length]).range([0,f]);const _=xT.create("svg").attr("width",f).attr("height",d).attr("viewBox",[0,0,f,d]).attr("style","max-width: 100%; height: auto; height: intrinsic; background-color: white;");return _.append("defs").append("pattern").attr("id","hatch").attr("patternUnits","userSpaceOnUse").attr("width",5).attr("height",5).append("line").attr("x1",0).attr("y1",0).attr("x2",5).attr("y1",5).attr("stroke","#ffcc36").attr("stroke-width",1).attr("stroke-opacity",1),_.append("rect").attr("x",0).attr("y",25).attr("height",10).attr("width",g(l.length+a.length)).attr("stroke","none").attr("fill","#CCC").attr("fill-opacity",.35),_.append("rect").attr("x",f-g(h.length+a.length)).attr("y",65).attr("height",10).attr("width",g(h.length+a.length)).attr("stroke","none").attr("fill","#CCC").attr("fill-opacity",.35),_.append("rect").attr("x",g(l.length)).attr("y",p).attr("height",40).attr("width",g(a.length)).attr("fill","#ffe599"),_.append("rect").attr("x",g(l.length)).attr("y",p).attr("height",40).attr("width",g(a.length)).attr("fill","url('#hatch')"),_.append("text").attr("x",f-g(s.length)+g(a.length)/2).attr("y",53).attr("text-anchor","middle").attr("dominant-baseline","middle").text(`${Math.round(a.length/o.length*100)}%`).attr("font-size",40).attr("fill","black"),_.append("text").attr("x",f-g(s.length)+5).attr("y",37).attr("text-anchor","start").attr("dominant-baseline","hanging").text("Matched geom").attr("font-size",12).attr("fill","black"),_.append("text").attr("x",f-g(s.length)+5).attr("y",62).attr("text-anchor","start").attr("dominant-baseline","baseline").text(`${a.length}/${r.length}`).attr("font-size",14).attr("fill","black"),_.append("text").attr("x",f-g(h.length)-5).attr("y",37).attr("text-anchor","end").attr("dominant-baseline","hanging").text("Matched data").attr("font-size",12).attr("fill","black"),_.append("text").attr("x",f-g(h.length)-5).attr("y",62).attr("text-anchor","end").attr("dominant-baseline","baseline").text(`${a.length}/${s.length}`).attr("font-size",14).attr("fill","black"),_.append("line").attr("x1",0).attr("y1",p).attr("x2",g(r.length)).attr("y2",p).attr("stroke","black").attr("stroke-width",.5),_.append("line").attr("x1",.5).attr("y1",25).attr("x2",.5).attr("y2",35).attr("stroke","black").attr("stroke-width",.5),_.append("line").attr("x1",g(r.length)-.5).attr("y1",25).attr("x2",g(r.length)-.5).attr("y2",35).attr("stroke","black").attr("stroke-width",.5),_.append("line").attr("x1",f-g(s.length)).attr("y1",70).attr("x2",f).attr("y2",70).attr("stroke","black").attr("stroke-width",.5),_.append("line").attr("x1",999.5).attr("y1",65).attr("x2",999.5).attr("y2",75).attr("stroke","black").attr("stroke-width",.5),_.append("line").attr("x1",f-g(s.length)+.5).attr("y1",65).attr("x2",f-g(s.length)+.5).attr("y2",75).attr("stroke","black").attr("stroke-width",.5),_.append("text").attr("x",f-g(s.length/2)).attr("y",95).attr("text-anchor","middle").text("DATA").attr("font-size",28).attr("font-weight","bold").attr("fill","#CCC").attr("opacity",.45),_.append("text").attr("x",g(r.length/2)).attr("y",22).attr("text-anchor","middle").text("GEOMETRIES").attr("font-size",28).attr("font-weight","bold").attr("fill","#CCC").attr("opacity",.45),Object.assign(_.node(),{matched:a,unmatched_geom:l,unmatched_data:h,matched_data:c,matched_geom:u})},t.merge=function(t,e,n,i,r=!0){let s=JSON.parse(JSON.stringify(Uo(t))),o=JSON.parse(JSON.stringify(n)),a=s.features.map((t=>t.properties[e])),l=n.map((t=>t[i]));a.filter((t=>l.includes(t)));let h=Object.keys(s.features[0].properties);if(Object.keys(o[0]).includes(i)){let t=vT.index(o,(t=>t[i]));s.features.forEach((n=>{const i=t.get(n.properties[e]);null!=i&&Object.keys(i).forEach((t=>{void 0!==h.find((e=>e==t))&&(i[`_${t}`]=i[t],delete i[t])})),n.properties=Object.assign(n.properties,i)})),!1===r&&(s.features=s.features.filter((t=>l.includes(t.properties[e]))))}return s},t.properties=UT,t.quickdraw=function(t,e=1e3,n=5){let i=["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],r=[];if(Array.isArray(t)){let s=[];return t.forEach((t=>{let e,n,o,a=i.filter((t=>!r.includes(t)));a.length>0?(e=a[Math.floor(Math.random()*a.length)],r.push(e)):e="#"+(16777215*Math.random()<<0).toString(16),"l"==mE(t)&&(n=e,o="none"),"p"!=mE(t)&&"z"!=mE(t)||(n="none",o=e),s.push({type:"layer",geojson:t,fill:o,stroke:n})})),mT({params:{margin:n,width:e},layers:s})}return mT({params:{margin:n,width:e},layers:[{type:"layer",geojson:t}]})},t.table2geo=function(t,e,n){return{type:"FeatureCollection",features:t.map((t=>({type:"Feature",properties:t,geometry:{type:"Point",coordinates:[+t[n],+t[e]]}})))}},Object.defineProperty(t,"__esModule",{value:!0})}));
