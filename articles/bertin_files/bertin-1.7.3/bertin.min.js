!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).bertin={})}(this,(function(t){"use strict";function e(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function n(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function i(t){let i,s,o;function a(t,e,n=0,r=t.length){if(n<r){if(0!==i(e,e))return r;do{const i=n+r>>>1;s(t[i],e)<0?n=i+1:r=i}while(n<r)}return n}return 2!==t.length?(i=e,s=(n,i)=>e(t(n),i),o=(e,n)=>t(e)-n):(i=t===e||t===n?t:r,s=t,o=t),{left:a,center:function(t,e,n=0,i=t.length){const r=a(t,e,n,i-1);return r>n&&o(t[r-1],e)>-o(t[r],e)?r-1:r},right:function(t,e,n=0,r=t.length){if(n<r){if(0!==i(e,e))return r;do{const i=n+r>>>1;s(t[i],e)<=0?n=i+1:r=i}while(n<r)}return n}}}function r(){return 0}function s(t){return null===t?NaN:+t}function*o(t,e){if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&(yield e);else{let n=-1;for(let i of t)null!=(i=e(i,++n,t))&&(i=+i)>=i&&(yield i)}}const a=i(e),l=a.right,c=a.left,h=i(s).center;var u=l;const f=g(y),d=g((function(t){const e=y(t);return(t,n,i,r,s)=>{e(t,n,(i<<=2)+0,(r<<=2)+0,s<<=2),e(t,n,i+1,r+1,s),e(t,n,i+2,r+2,s),e(t,n,i+3,r+3,s)}}));function g(t){return function(e,n,i=n){if(!((n=+n)>=0))throw new RangeError("invalid rx");if(!((i=+i)>=0))throw new RangeError("invalid ry");let{data:r,width:s,height:o}=e;if(!((s=Math.floor(s))>=0))throw new RangeError("invalid width");if(!((o=Math.floor(void 0!==o?o:r.length/s))>=0))throw new RangeError("invalid height");if(!s||!o||!n&&!i)return e;const a=n&&t(n),l=i&&t(i),c=r.slice();return a&&l?(p(a,c,r,s,o),p(a,r,c,s,o),p(a,c,r,s,o),_(l,r,c,s,o),_(l,c,r,s,o),_(l,r,c,s,o)):a?(p(a,r,c,s,o),p(a,c,r,s,o),p(a,r,c,s,o)):l&&(_(l,r,c,s,o),_(l,c,r,s,o),_(l,r,c,s,o)),e}}function p(t,e,n,i,r){for(let s=0,o=i*r;s<o;)t(e,n,s,s+=i,1)}function _(t,e,n,i,r){for(let s=0,o=i*r;s<i;++s)t(e,n,s,s+o,i)}function y(t){const e=Math.floor(t);if(e===t)return function(t){const e=2*t+1;return(n,i,r,s,o)=>{if(!((s-=o)>=r))return;let a=t*i[r];const l=o*t;for(let t=r,e=r+l;t<e;t+=o)a+=i[Math.min(s,t)];for(let t=r,c=s;t<=c;t+=o)a+=i[Math.min(s,t+l)],n[t]=a/e,a-=i[Math.max(r,t-l)]}}(t);const n=t-e,i=2*t+1;return(t,r,s,o,a)=>{if(!((o-=a)>=s))return;let l=e*r[s];const c=a*e,h=c+a;for(let t=s,e=s+c;t<e;t+=a)l+=r[Math.min(o,t)];for(let e=s,u=o;e<=u;e+=a)l+=r[Math.min(o,e+c)],t[e]=(l+n*(r[Math.max(s,e-h)]+r[Math.min(o,e+h)]))/i,l-=r[Math.max(s,e-c)]}}function m(t,e){let n=0;if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&++n;else{let i=-1;for(let r of t)null!=(r=e(r,++i,t))&&(r=+r)>=r&&++n}return n}function x(t){return 0|t.length}function v(t){return!(t>0)}function b(t){return"object"!=typeof t||"length"in t?t:Array.from(t)}function M(t,e){let n,i=0,r=0,s=0;if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&(n=e-r,r+=n/++i,s+=n*(e-r));else{let o=-1;for(let a of t)null!=(a=e(a,++o,t))&&(a=+a)>=a&&(n=a-r,r+=n/++i,s+=n*(a-r))}if(i>1)return s/(i-1)}function w(t,e){const n=M(t,e);return n?Math.sqrt(n):n}function E(t,e){let n,i;if(void 0===e)for(const e of t)null!=e&&(void 0===n?e>=e&&(n=i=e):(n>e&&(n=e),i<e&&(i=e)));else{let r=-1;for(let s of t)null!=(s=e(s,++r,t))&&(void 0===n?s>=s&&(n=i=s):(n>s&&(n=s),i<s&&(i=s)))}return[n,i]}class S{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let n=0;for(let i=0;i<this._n&&i<32;i++){const r=e[i],s=t+r,o=Math.abs(t)<Math.abs(r)?t-(s-r):r-(s-t);o&&(e[n++]=o),t=s}return e[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let e,n,i,r=this._n,s=0;if(r>0){for(s=t[--r];r>0&&(e=s,n=t[--r],s=e+n,i=n-(s-e),!i););r>0&&(i<0&&t[r-1]<0||i>0&&t[r-1]>0)&&(n=2*i,e=s+n,n==e-s&&(s=e))}return s}}class N extends Map{constructor(t,e=A){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[e,n]of t)this.set(e,n)}get(t){return super.get(k(this,t))}has(t){return super.has(k(this,t))}set(t,e){return super.set(O(this,t),e)}delete(t){return super.delete(C(this,t))}}class I extends Set{constructor(t,e=A){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const e of t)this.add(e)}has(t){return super.has(k(this,t))}add(t){return super.add(O(this,t))}delete(t){return super.delete(C(this,t))}}function k({_intern:t,_key:e},n){const i=e(n);return t.has(i)?t.get(i):n}function O({_intern:t,_key:e},n){const i=e(n);return t.has(i)?t.get(i):(t.set(i,n),n)}function C({_intern:t,_key:e},n){const i=e(n);return t.has(i)&&(n=t.get(i),t.delete(i)),n}function A(t){return null!==t&&"object"==typeof t?t.valueOf():t}function T(t){return t}function R(t,...e){return q(t,T,T,e)}function L(t,...e){return q(t,Array.from,T,e)}function P(t,e){for(let n=1,i=e.length;n<i;++n)t=t.flatMap((t=>t.pop().map((([e,n])=>[...t,e,n]))));return t}function D(t,...e){return P(L(t,...e),e)}function z(t,e,...n){return q(t,T,e,n)}function F(t,e,...n){return q(t,Array.from,e,n)}function G(t,...e){return q(t,T,j,e)}function j(t){if(1!==t.length)throw new Error("duplicate key");return t[0]}function q(t,e,n,i){return function t(r,s){if(s>=i.length)return n(r);const o=new N,a=i[s++];let l=-1;for(const t of r){const e=a(t,++l,r),n=o.get(e);n?n.push(t):o.set(e,[t])}for(const[e,n]of o)o.set(e,t(n,s));return e(o)}(t,0)}function B(t,e){return Array.from(e,(e=>t[e]))}function Y(t,...e){if("function"!=typeof t[Symbol.iterator])throw new TypeError("values is not iterable");t=Array.from(t);let[n]=e;if(n&&2!==n.length||e.length>1){const i=Uint32Array.from(t,((t,e)=>e));return e.length>1?(e=e.map((e=>t.map(e))),i.sort(((t,n)=>{for(const i of e){const e=U(i[t],i[n]);if(e)return e}}))):(n=t.map(n),i.sort(((t,e)=>U(n[t],n[e])))),B(t,i)}return t.sort($(n))}function $(t=e){if(t===e)return U;if("function"!=typeof t)throw new TypeError("compare is not a function");return(e,n)=>{const i=t(e,n);return i||0===i?i:(0===t(n,n))-(0===t(e,e))}}function U(t,e){return(null==t||!(t>=t))-(null==e||!(e>=e))||(t<e?-1:t>e?1:0)}var W=Array.prototype.slice;function X(t){return()=>t}const V=Math.sqrt(50),H=Math.sqrt(10),J=Math.sqrt(2);function Z(t,e,n){const i=(e-t)/Math.max(0,n),r=Math.floor(Math.log10(i)),s=i/Math.pow(10,r),o=s>=V?10:s>=H?5:s>=J?2:1;let a,l,c;return r<0?(c=Math.pow(10,-r)/o,a=Math.round(t*c),l=Math.round(e*c),a/c<t&&++a,l/c>e&&--l,c=-c):(c=Math.pow(10,r)*o,a=Math.round(t/c),l=Math.round(e/c),a*c<t&&++a,l*c>e&&--l),l<a&&.5<=n&&n<2?Z(t,e,2*n):[a,l,c]}function Q(t,e,n){if(!((n=+n)>0))return[];if((t=+t)===(e=+e))return[t];const i=e<t,[r,s,o]=i?Z(e,t,n):Z(t,e,n);if(!(s>=r))return[];const a=s-r+1,l=new Array(a);if(i)if(o<0)for(let t=0;t<a;++t)l[t]=(s-t)/-o;else for(let t=0;t<a;++t)l[t]=(s-t)*o;else if(o<0)for(let t=0;t<a;++t)l[t]=(r+t)/-o;else for(let t=0;t<a;++t)l[t]=(r+t)*o;return l}function K(t,e,n){return Z(t=+t,e=+e,n=+n)[2]}function tt(t,e,n){n=+n;const i=(e=+e)<(t=+t),r=i?K(e,t,n):K(t,e,n);return(i?-1:1)*(r<0?1/-r:r)}function et(t,e,n){let i;for(;;){const r=K(t,e,n);if(r===i||0===r||!isFinite(r))return[t,e];r>0?(t=Math.floor(t/r)*r,e=Math.ceil(e/r)*r):r<0&&(t=Math.ceil(t*r)/r,e=Math.floor(e*r)/r),i=r}}function nt(t){return Math.ceil(Math.log(m(t))/Math.LN2)+1}function it(){var t=T,e=E,n=nt;function i(i){Array.isArray(i)||(i=Array.from(i));var r,s,o,a=i.length,l=new Array(a);for(r=0;r<a;++r)l[r]=t(i[r],r,i);var c=e(l),h=c[0],f=c[1],d=n(l,h,f);if(!Array.isArray(d)){const t=f,n=+d;if(e===E&&([h,f]=et(h,f,n)),(d=Q(h,f,n))[0]<=h&&(o=K(h,f,n)),d[d.length-1]>=f)if(t>=f&&e===E){const t=K(h,f,n);isFinite(t)&&(t>0?f=(Math.floor(f/t)+1)*t:t<0&&(f=(Math.ceil(f*-t)+1)/-t))}else d.pop()}for(var g=d.length,p=0,_=g;d[p]<=h;)++p;for(;d[_-1]>f;)--_;(p||_<g)&&(d=d.slice(p,_),g=_-p);var y,m=new Array(g+1);for(r=0;r<=g;++r)(y=m[r]=[]).x0=r>0?d[r-1]:h,y.x1=r<g?d[r]:f;if(isFinite(o)){if(o>0)for(r=0;r<a;++r)null!=(s=l[r])&&h<=s&&s<=f&&m[Math.min(g,Math.floor((s-h)/o))].push(i[r]);else if(o<0)for(r=0;r<a;++r)if(null!=(s=l[r])&&h<=s&&s<=f){const t=Math.floor((h-s)*o);m[Math.min(g,t+(d[t]<=s))].push(i[r])}}else for(r=0;r<a;++r)null!=(s=l[r])&&h<=s&&s<=f&&m[u(d,s,0,g)].push(i[r]);return m}return i.value=function(e){return arguments.length?(t="function"==typeof e?e:X(e),i):t},i.domain=function(t){return arguments.length?(e="function"==typeof t?t:X([t[0],t[1]]),i):e},i.thresholds=function(t){return arguments.length?(n="function"==typeof t?t:X(Array.isArray(t)?W.call(t):t),i):n},i}function rt(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n<e||void 0===n&&e>=e)&&(n=e);else{let i=-1;for(let r of t)null!=(r=e(r,++i,t))&&(n<r||void 0===n&&r>=r)&&(n=r)}return n}function st(t,e){let n,i=-1,r=-1;if(void 0===e)for(const e of t)++r,null!=e&&(n<e||void 0===n&&e>=e)&&(n=e,i=r);else for(let s of t)null!=(s=e(s,++r,t))&&(n<s||void 0===n&&s>=s)&&(n=s,i=r);return i}function ot(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n>e||void 0===n&&e>=e)&&(n=e);else{let i=-1;for(let r of t)null!=(r=e(r,++i,t))&&(n>r||void 0===n&&r>=r)&&(n=r)}return n}function at(t,e){let n,i=-1,r=-1;if(void 0===e)for(const e of t)++r,null!=e&&(n>e||void 0===n&&e>=e)&&(n=e,i=r);else for(let s of t)null!=(s=e(s,++r,t))&&(n>s||void 0===n&&s>=s)&&(n=s,i=r);return i}function lt(t,e,n=0,i=1/0,r){if(e=Math.floor(e),n=Math.floor(Math.max(0,n)),i=Math.floor(Math.min(t.length-1,i)),!(n<=e&&e<=i))return t;for(r=void 0===r?U:$(r);i>n;){if(i-n>600){const s=i-n+1,o=e-n+1,a=Math.log(s),l=.5*Math.exp(2*a/3),c=.5*Math.sqrt(a*l*(s-l)/s)*(o-s/2<0?-1:1);lt(t,e,Math.max(n,Math.floor(e-o*l/s+c)),Math.min(i,Math.floor(e+(s-o)*l/s+c)),r)}const s=t[e];let o=n,a=i;for(ct(t,n,e),r(t[i],s)>0&&ct(t,n,i);o<a;){for(ct(t,o,a),++o,--a;r(t[o],s)<0;)++o;for(;r(t[a],s)>0;)--a}0===r(t[n],s)?ct(t,n,a):(++a,ct(t,a,i)),a<=e&&(n=a+1),e<=a&&(i=a-1)}return t}function ct(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}function ht(t,n=e){let i,r=!1;if(1===n.length){let s;for(const o of t){const t=n(o);(r?e(t,s)>0:0===e(t,t))&&(i=o,s=t,r=!0)}}else for(const e of t)(r?n(e,i)>0:0===n(e,e))&&(i=e,r=!0);return i}function ut(t,e,n){if((i=(t=Float64Array.from(o(t,n))).length)&&!isNaN(e=+e)){if(e<=0||i<2)return ot(t);if(e>=1)return rt(t);var i,r=(i-1)*e,s=Math.floor(r),a=rt(lt(t,s).subarray(0,s+1));return a+(ot(t.subarray(s+1))-a)*(r-s)}}function ft(t,e,n=s){if((i=t.length)&&!isNaN(e=+e)){if(e<=0||i<2)return+n(t[0],0,t);if(e>=1)return+n(t[i-1],i-1,t);var i,r=(i-1)*e,o=Math.floor(r),a=+n(t[o],o,t);return a+(+n(t[o+1],o+1,t)-a)*(r-o)}}function dt(t,e,n){if((i=(t=Float64Array.from(o(t,n))).length)&&!isNaN(e=+e)){if(e<=0||i<2)return at(t);if(e>=1)return st(t);var i,r=Math.floor((i-1)*e),s=lt(Uint32Array.from(t,((t,e)=>e)),r,0,i-1,((e,n)=>U(t[e],t[n])));return ht(s.subarray(0,r+1),(e=>t[e]))}}function gt(t,e){let n=0,i=0;if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&(++n,i+=e);else{let r=-1;for(let s of t)null!=(s=e(s,++r,t))&&(s=+s)>=s&&(++n,i+=s)}if(n)return i/n}function pt(t){return Array.from(function*(t){for(const e of t)yield*e}(t))}function _t(t,e){return[t,e]}function yt(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=0|Math.max(0,Math.ceil((e-t)/n)),s=new Array(r);++i<r;)s[i]=t+i*n;return s}function mt(t,n=e){if(1===n.length)return at(t,n);let i,r=-1,s=-1;for(const e of t)++s,(r<0?0===n(e,e):n(e,i)<0)&&(i=e,r=s);return r}var xt=vt(Math.random);function vt(t){return function(e,n=0,i=e.length){let r=i-(n=+n);for(;r;){const i=t()*r--|0,s=e[r+n];e[r+n]=e[i+n],e[i+n]=s}return e}}function bt(t,e){let n=0;if(void 0===e)for(let e of t)(e=+e)&&(n+=e);else{let i=-1;for(let r of t)(r=+e(r,++i,t))&&(n+=r)}return n}function Mt(t){if(!(r=t.length))return[];for(var e=-1,n=ot(t,wt),i=new Array(n);++e<n;)for(var r,s=-1,o=i[e]=new Array(r);++s<r;)o[s]=t[s][e];return i}function wt(t){return t.length}function Et(t){if("function"!=typeof t[Symbol.iterator])throw new TypeError("values is not iterable");return Array.from(t).reverse()}function St(t){return t instanceof I?t:new I(t)}function Nt(t,e){const n=t[Symbol.iterator](),i=new Set;for(const t of e){const e=It(t);if(i.has(e))continue;let r,s;for(;({value:r,done:s}=n.next());){if(s)return!1;const t=It(r);if(i.add(t),Object.is(e,t))break}}return!0}function It(t){return null!==t&&"object"==typeof t?t.valueOf():t}var kt=Object.freeze({__proto__:null,bisect:u,bisectRight:l,bisectLeft:c,bisectCenter:h,ascending:e,bisector:i,blur:function(t,e){if(!((e=+e)>=0))throw new RangeError("invalid r");let n=t.length;if(!((n=Math.floor(n))>=0))throw new RangeError("invalid length");if(!n||!e)return t;const i=y(e),r=t.slice();return i(t,r,0,n,1),i(r,t,0,n,1),i(t,r,0,n,1),t},blur2:f,blurImage:d,count:m,cross:function(...t){const e="function"==typeof t[t.length-1]&&function(t){return e=>t(...e)}(t.pop()),n=(t=t.map(b)).map(x),i=t.length-1,r=new Array(i+1).fill(0),s=[];if(i<0||n.some(v))return s;for(;;){s.push(r.map(((e,n)=>t[n][e])));let o=i;for(;++r[o]===n[o];){if(0===o)return e?s.map(e):s;r[o--]=0}}},cumsum:function(t,e){var n=0,i=0;return Float64Array.from(t,void 0===e?t=>n+=+t||0:r=>n+=+e(r,i++,t)||0)},descending:n,deviation:w,extent:E,Adder:S,fsum:function(t,e){const n=new S;if(void 0===e)for(let e of t)(e=+e)&&n.add(e);else{let i=-1;for(let r of t)(r=+e(r,++i,t))&&n.add(r)}return+n},fcumsum:function(t,e){const n=new S;let i=-1;return Float64Array.from(t,void 0===e?t=>n.add(+t||0):r=>n.add(+e(r,++i,t)||0))},group:R,flatGroup:D,flatRollup:function(t,e,...n){return P(F(t,e,...n),n)},groups:L,index:G,indexes:function(t,...e){return q(t,Array.from,j,e)},rollup:z,rollups:F,groupSort:function(t,n,i){return(2!==n.length?Y(z(t,n,i),(([t,n],[i,r])=>e(n,r)||e(t,i))):Y(R(t,i),(([t,i],[r,s])=>n(i,s)||e(t,r)))).map((([t])=>t))},bin:it,histogram:it,thresholdFreedmanDiaconis:function(t,e,n){return Math.ceil((n-e)/(2*(ut(t,.75)-ut(t,.25))*Math.pow(m(t),-1/3)))},thresholdScott:function(t,e,n){return Math.ceil((n-e)*Math.cbrt(m(t))/(3.49*w(t)))},thresholdSturges:nt,max:rt,maxIndex:st,mean:gt,median:function(t,e){return ut(t,.5,e)},medianIndex:function(t,e){return dt(t,.5,e)},merge:pt,min:ot,minIndex:at,mode:function(t,e){const n=new N;if(void 0===e)for(let e of t)null!=e&&e>=e&&n.set(e,(n.get(e)||0)+1);else{let i=-1;for(let r of t)null!=(r=e(r,++i,t))&&r>=r&&n.set(r,(n.get(r)||0)+1)}let i,r=0;for(const[t,e]of n)e>r&&(r=e,i=t);return i},nice:et,pairs:function(t,e=_t){const n=[];let i,r=!1;for(const s of t)r&&n.push(e(i,s)),i=s,r=!0;return n},permute:B,quantile:ut,quantileIndex:dt,quantileSorted:ft,quickselect:lt,range:yt,rank:function(t,n=e){if("function"!=typeof t[Symbol.iterator])throw new TypeError("values is not iterable");let i=Array.from(t);const r=new Float64Array(i.length);2!==n.length&&(i=i.map(n),n=e);const s=(t,e)=>n(i[t],i[e]);let o,a;return Uint32Array.from(i,((t,e)=>e)).sort(n===e?(t,e)=>U(i[t],i[e]):$(s)).forEach(((t,e)=>{const n=s(t,void 0===o?t:o);n>=0?((void 0===o||n>0)&&(o=t,a=e),r[t]=a):r[t]=NaN})),r},least:function(t,n=e){let i,r=!1;if(1===n.length){let s;for(const o of t){const t=n(o);(r?e(t,s)<0:0===e(t,t))&&(i=o,s=t,r=!0)}}else for(const e of t)(r?n(e,i)<0:0===n(e,e))&&(i=e,r=!0);return i},leastIndex:mt,greatest:ht,greatestIndex:function(t,n=e){if(1===n.length)return st(t,n);let i,r=-1,s=-1;for(const e of t)++s,(r<0?0===n(e,e):n(e,i)>0)&&(i=e,r=s);return r},scan:function(t,e){const n=mt(t,e);return n<0?void 0:n},shuffle:xt,shuffler:vt,sum:bt,ticks:Q,tickIncrement:K,tickStep:tt,transpose:Mt,variance:M,zip:function(){return Mt(arguments)},every:function(t,e){if("function"!=typeof e)throw new TypeError("test is not a function");let n=-1;for(const i of t)if(!e(i,++n,t))return!1;return!0},some:function(t,e){if("function"!=typeof e)throw new TypeError("test is not a function");let n=-1;for(const i of t)if(e(i,++n,t))return!0;return!1},filter:function(t,e){if("function"!=typeof e)throw new TypeError("test is not a function");const n=[];let i=-1;for(const r of t)e(r,++i,t)&&n.push(r);return n},map:function(t,e){if("function"!=typeof t[Symbol.iterator])throw new TypeError("values is not iterable");if("function"!=typeof e)throw new TypeError("mapper is not a function");return Array.from(t,((n,i)=>e(n,i,t)))},reduce:function(t,e,n){if("function"!=typeof e)throw new TypeError("reducer is not a function");const i=t[Symbol.iterator]();let r,s,o=-1;if(arguments.length<3){if(({done:r,value:n}=i.next()),r)return;++o}for(;({done:r,value:s}=i.next()),!r;)n=e(n,s,++o,t);return n},reverse:Et,sort:Y,difference:function(t,...e){t=new I(t);for(const n of e)for(const e of n)t.delete(e);return t},disjoint:function(t,e){const n=e[Symbol.iterator](),i=new I;for(const e of t){if(i.has(e))return!1;let t,r;for(;({value:t,done:r}=n.next())&&!r;){if(Object.is(e,t))return!1;i.add(t)}}return!0},intersection:function(t,...e){t=new I(t),e=e.map(St);t:for(const n of t)for(const i of e)if(!i.has(n)){t.delete(n);continue t}return t},subset:function(t,e){return Nt(e,t)},superset:Nt,union:function(...t){const e=new I;for(const n of t)for(const t of n)e.add(t);return e},InternMap:N,InternSet:I}),Ot=1e-6,Ct=1e-12,At=Math.PI,Tt=At/2,Rt=At/4,Lt=2*At,Pt=180/At,Dt=At/180,zt=Math.abs,Ft=Math.atan,Gt=Math.atan2,jt=Math.cos,qt=Math.ceil,Bt=Math.exp,Yt=Math.hypot,$t=Math.log,Ut=Math.pow,Wt=Math.sin,Xt=Math.sign||function(t){return t>0?1:t<0?-1:0},Vt=Math.sqrt,Ht=Math.tan;function Jt(t){return t>1?0:t<-1?At:Math.acos(t)}function Zt(t){return t>1?Tt:t<-1?-Tt:Math.asin(t)}function Qt(t){return(t=Wt(t/2))*t}function Kt(){}function te(t,e){t&&ne.hasOwnProperty(t.type)&&ne[t.type](t,e)}var ee={Feature:function(t,e){te(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)te(n[i].geometry,e)}},ne={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){ie(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)ie(n[i],e,0)},Polygon:function(t,e){re(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)re(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)te(n[i],e)}};function ie(t,e,n){var i,r=-1,s=t.length-n;for(e.lineStart();++r<s;)i=t[r],e.point(i[0],i[1],i[2]);e.lineEnd()}function re(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)ie(t[n],e,1);e.polygonEnd()}function se(t,e){t&&ee.hasOwnProperty(t.type)?ee[t.type](t,e):te(t,e)}var oe,ae,le,ce,he,ue,fe,de,ge,pe,_e,ye,me,xe,ve,be,Me=new S,we=new S,Ee={point:Kt,lineStart:Kt,lineEnd:Kt,polygonStart:function(){Me=new S,Ee.lineStart=Se,Ee.lineEnd=Ne},polygonEnd:function(){var t=+Me;we.add(t<0?Lt+t:t),this.lineStart=this.lineEnd=this.point=Kt},sphere:function(){we.add(Lt)}};function Se(){Ee.point=Ie}function Ne(){ke(oe,ae)}function Ie(t,e){Ee.point=ke,oe=t,ae=e,le=t*=Dt,ce=jt(e=(e*=Dt)/2+Rt),he=Wt(e)}function ke(t,e){var n=(t*=Dt)-le,i=n>=0?1:-1,r=i*n,s=jt(e=(e*=Dt)/2+Rt),o=Wt(e),a=he*o,l=ce*s+a*jt(r),c=a*i*Wt(r);Me.add(Gt(c,l)),le=t,ce=s,he=o}function Oe(t){return we=new S,se(t,Ee),2*we}function Ce(t){return[Gt(t[1],t[0]),Zt(t[2])]}function Ae(t){var e=t[0],n=t[1],i=jt(n);return[i*jt(e),i*Wt(e),Wt(n)]}function Te(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Re(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Le(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Pe(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function De(t){var e=Vt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}var ze,Fe,Ge,je,qe,Be,Ye,$e,Ue,We,Xe,Ve,He,Je,Ze,Qe,Ke={point:tn,lineStart:nn,lineEnd:rn,polygonStart:function(){Ke.point=sn,Ke.lineStart=on,Ke.lineEnd=an,xe=new S,Ee.polygonStart()},polygonEnd:function(){Ee.polygonEnd(),Ke.point=tn,Ke.lineStart=nn,Ke.lineEnd=rn,Me<0?(ue=-(de=180),fe=-(ge=90)):xe>Ot?ge=90:xe<-1e-6&&(fe=-90),be[0]=ue,be[1]=de},sphere:function(){ue=-(de=180),fe=-(ge=90)}};function tn(t,e){ve.push(be=[ue=t,de=t]),e<fe&&(fe=e),e>ge&&(ge=e)}function en(t,e){var n=Ae([t*Dt,e*Dt]);if(me){var i=Re(me,n),r=Re([i[1],-i[0],0],i);De(r),r=Ce(r);var s,o=t-pe,a=o>0?1:-1,l=r[0]*Pt*a,c=zt(o)>180;c^(a*pe<l&&l<a*t)?(s=r[1]*Pt)>ge&&(ge=s):c^(a*pe<(l=(l+360)%360-180)&&l<a*t)?(s=-r[1]*Pt)<fe&&(fe=s):(e<fe&&(fe=e),e>ge&&(ge=e)),c?t<pe?ln(ue,t)>ln(ue,de)&&(de=t):ln(t,de)>ln(ue,de)&&(ue=t):de>=ue?(t<ue&&(ue=t),t>de&&(de=t)):t>pe?ln(ue,t)>ln(ue,de)&&(de=t):ln(t,de)>ln(ue,de)&&(ue=t)}else ve.push(be=[ue=t,de=t]);e<fe&&(fe=e),e>ge&&(ge=e),me=n,pe=t}function nn(){Ke.point=en}function rn(){be[0]=ue,be[1]=de,Ke.point=tn,me=null}function sn(t,e){if(me){var n=t-pe;xe.add(zt(n)>180?n+(n>0?360:-360):n)}else _e=t,ye=e;Ee.point(t,e),en(t,e)}function on(){Ee.lineStart()}function an(){sn(_e,ye),Ee.lineEnd(),zt(xe)>Ot&&(ue=-(de=180)),be[0]=ue,be[1]=de,me=null}function ln(t,e){return(e-=t)<0?e+360:e}function cn(t,e){return t[0]-e[0]}function hn(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}function un(t){var e,n,i,r,s,o,a;if(ge=de=-(ue=fe=1/0),ve=[],se(t,Ke),n=ve.length){for(ve.sort(cn),e=1,s=[i=ve[0]];e<n;++e)hn(i,(r=ve[e])[0])||hn(i,r[1])?(ln(i[0],r[1])>ln(i[0],i[1])&&(i[1]=r[1]),ln(r[0],i[1])>ln(i[0],i[1])&&(i[0]=r[0])):s.push(i=r);for(o=-1/0,e=0,i=s[n=s.length-1];e<=n;i=r,++e)r=s[e],(a=ln(i[1],r[0]))>o&&(o=a,ue=r[0],de=i[1])}return ve=be=null,ue===1/0||fe===1/0?[[NaN,NaN],[NaN,NaN]]:[[ue,fe],[de,ge]]}var fn={sphere:Kt,point:dn,lineStart:pn,lineEnd:mn,polygonStart:function(){fn.lineStart=xn,fn.lineEnd=vn},polygonEnd:function(){fn.lineStart=pn,fn.lineEnd=mn}};function dn(t,e){t*=Dt;var n=jt(e*=Dt);gn(n*jt(t),n*Wt(t),Wt(e))}function gn(t,e,n){++ze,Ge+=(t-Ge)/ze,je+=(e-je)/ze,qe+=(n-qe)/ze}function pn(){fn.point=_n}function _n(t,e){t*=Dt;var n=jt(e*=Dt);Je=n*jt(t),Ze=n*Wt(t),Qe=Wt(e),fn.point=yn,gn(Je,Ze,Qe)}function yn(t,e){t*=Dt;var n=jt(e*=Dt),i=n*jt(t),r=n*Wt(t),s=Wt(e),o=Gt(Vt((o=Ze*s-Qe*r)*o+(o=Qe*i-Je*s)*o+(o=Je*r-Ze*i)*o),Je*i+Ze*r+Qe*s);Fe+=o,Be+=o*(Je+(Je=i)),Ye+=o*(Ze+(Ze=r)),$e+=o*(Qe+(Qe=s)),gn(Je,Ze,Qe)}function mn(){fn.point=dn}function xn(){fn.point=bn}function vn(){Mn(Ve,He),fn.point=dn}function bn(t,e){Ve=t,He=e,t*=Dt,e*=Dt,fn.point=Mn;var n=jt(e);Je=n*jt(t),Ze=n*Wt(t),Qe=Wt(e),gn(Je,Ze,Qe)}function Mn(t,e){t*=Dt;var n=jt(e*=Dt),i=n*jt(t),r=n*Wt(t),s=Wt(e),o=Ze*s-Qe*r,a=Qe*i-Je*s,l=Je*r-Ze*i,c=Yt(o,a,l),h=Zt(c),u=c&&-h/c;Ue.add(u*o),We.add(u*a),Xe.add(u*l),Fe+=h,Be+=h*(Je+(Je=i)),Ye+=h*(Ze+(Ze=r)),$e+=h*(Qe+(Qe=s)),gn(Je,Ze,Qe)}function wn(t){ze=Fe=Ge=je=qe=Be=Ye=$e=0,Ue=new S,We=new S,Xe=new S,se(t,fn);var e=+Ue,n=+We,i=+Xe,r=Yt(e,n,i);return r<Ct&&(e=Be,n=Ye,i=$e,Fe<Ot&&(e=Ge,n=je,i=qe),(r=Yt(e,n,i))<Ct)?[NaN,NaN]:[Gt(n,e)*Pt,Zt(i/r)*Pt]}function En(t){return function(){return t}}function Sn(t,e){function n(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,i){return(n=e.invert(n,i))&&t.invert(n[0],n[1])}),n}function Nn(t,e){return[zt(t)>At?t+Math.round(-t/Lt)*Lt:t,e]}function In(t,e,n){return(t%=Lt)?e||n?Sn(On(t),Cn(e,n)):On(t):e||n?Cn(e,n):Nn}function kn(t){return function(e,n){return[(e+=t)>At?e-Lt:e<-At?e+Lt:e,n]}}function On(t){var e=kn(t);return e.invert=kn(-t),e}function Cn(t,e){var n=jt(t),i=Wt(t),r=jt(e),s=Wt(e);function o(t,e){var o=jt(e),a=jt(t)*o,l=Wt(t)*o,c=Wt(e),h=c*n+a*i;return[Gt(l*r-h*s,a*n-c*i),Zt(h*r+l*s)]}return o.invert=function(t,e){var o=jt(e),a=jt(t)*o,l=Wt(t)*o,c=Wt(e),h=c*r-l*s;return[Gt(l*r+c*s,a*n+h*i),Zt(h*n-a*i)]},o}function An(t){function e(e){return(e=t(e[0]*Dt,e[1]*Dt))[0]*=Pt,e[1]*=Pt,e}return t=In(t[0]*Dt,t[1]*Dt,t.length>2?t[2]*Dt:0),e.invert=function(e){return(e=t.invert(e[0]*Dt,e[1]*Dt))[0]*=Pt,e[1]*=Pt,e},e}function Tn(t,e,n,i,r,s){if(n){var o=jt(e),a=Wt(e),l=i*n;null==r?(r=e+i*Lt,s=e-l/2):(r=Rn(o,r),s=Rn(o,s),(i>0?r<s:r>s)&&(r+=i*Lt));for(var c,h=r;i>0?h>s:h<s;h-=l)c=Ce([o,-a*jt(h),-a*Wt(h)]),t.point(c[0],c[1])}}function Rn(t,e){(e=Ae(e))[0]-=t,De(e);var n=Jt(-e[1]);return((-e[2]<0?-n:n)+Lt-Ot)%Lt}function Ln(){var t,e,n=En([0,0]),i=En(90),r=En(6),s={point:function(n,i){t.push(n=e(n,i)),n[0]*=Pt,n[1]*=Pt}};function o(){var o=n.apply(this,arguments),a=i.apply(this,arguments)*Dt,l=r.apply(this,arguments)*Dt;return t=[],e=In(-o[0]*Dt,-o[1]*Dt,0).invert,Tn(s,a,l,1),o={type:"Polygon",coordinates:[t]},t=e=null,o}return o.center=function(t){return arguments.length?(n="function"==typeof t?t:En([+t[0],+t[1]]),o):n},o.radius=function(t){return arguments.length?(i="function"==typeof t?t:En(+t),o):i},o.precision=function(t){return arguments.length?(r="function"==typeof t?t:En(+t),o):r},o}function Pn(){var t,e=[];return{point:function(e,n,i){t.push([e,n,i])},lineStart:function(){e.push(t=[])},lineEnd:Kt,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function Dn(t,e){return zt(t[0]-e[0])<Ot&&zt(t[1]-e[1])<Ot}function zn(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function Fn(t,e,n,i,r){var s,o,a=[],l=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,i=t[0],o=t[e];if(Dn(i,o)){if(!i[2]&&!o[2]){for(r.lineStart(),s=0;s<e;++s)r.point((i=t[s])[0],i[1]);return void r.lineEnd()}o[0]+=2e-6}a.push(n=new zn(i,t,null,!0)),l.push(n.o=new zn(i,null,n,!1)),a.push(n=new zn(o,t,null,!1)),l.push(n.o=new zn(o,null,n,!0))}})),a.length){for(l.sort(e),Gn(a),Gn(l),s=0,o=l.length;s<o;++s)l[s].e=n=!n;for(var c,h,u=a[0];;){for(var f=u,d=!0;f.v;)if((f=f.n)===u)return;c=f.z,r.lineStart();do{if(f.v=f.o.v=!0,f.e){if(d)for(s=0,o=c.length;s<o;++s)r.point((h=c[s])[0],h[1]);else i(f.x,f.n.x,1,r);f=f.n}else{if(d)for(c=f.p.z,s=c.length-1;s>=0;--s)r.point((h=c[s])[0],h[1]);else i(f.x,f.p.x,-1,r);f=f.p}c=(f=f.o).z,d=!d}while(!f.v);r.lineEnd()}}}function Gn(t){if(e=t.length){for(var e,n,i=0,r=t[0];++i<e;)r.n=n=t[i],n.p=r,r=n;r.n=n=t[0],n.p=r}}function jn(t){return zt(t[0])<=At?t[0]:Xt(t[0])*((zt(t[0])+At)%Lt-At)}function qn(t,e){var n=jn(e),i=e[1],r=Wt(i),s=[Wt(n),-jt(n),0],o=0,a=0,l=new S;1===r?i=Tt+Ot:-1===r&&(i=-Tt-Ot);for(var c=0,h=t.length;c<h;++c)if(f=(u=t[c]).length)for(var u,f,d=u[f-1],g=jn(d),p=d[1]/2+Rt,_=Wt(p),y=jt(p),m=0;m<f;++m,g=v,_=M,y=w,d=x){var x=u[m],v=jn(x),b=x[1]/2+Rt,M=Wt(b),w=jt(b),E=v-g,N=E>=0?1:-1,I=N*E,k=I>At,O=_*M;if(l.add(Gt(O*N*Wt(I),y*w+O*jt(I))),o+=k?E+N*Lt:E,k^g>=n^v>=n){var C=Re(Ae(d),Ae(x));De(C);var A=Re(s,C);De(A);var T=(k^E>=0?-1:1)*Zt(A[2]);(i>T||i===T&&(C[0]||C[1]))&&(a+=k^E>=0?1:-1)}}return(o<-1e-6||o<Ot&&l<-1e-12)^1&a}function Bn(t,e,n,i){return function(r){var s,o,a,l=e(r),c=Pn(),h=e(c),u=!1,f={point:d,lineStart:p,lineEnd:_,polygonStart:function(){f.point=y,f.lineStart=m,f.lineEnd=x,o=[],s=[]},polygonEnd:function(){f.point=d,f.lineStart=p,f.lineEnd=_,o=pt(o);var t=qn(s,i);o.length?(u||(r.polygonStart(),u=!0),Fn(o,$n,t,n,r)):t&&(u||(r.polygonStart(),u=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),u&&(r.polygonEnd(),u=!1),o=s=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function d(e,n){t(e,n)&&r.point(e,n)}function g(t,e){l.point(t,e)}function p(){f.point=g,l.lineStart()}function _(){f.point=d,l.lineEnd()}function y(t,e){a.push([t,e]),h.point(t,e)}function m(){h.lineStart(),a=[]}function x(){y(a[0][0],a[0][1]),h.lineEnd();var t,e,n,i,l=h.clean(),f=c.result(),d=f.length;if(a.pop(),s.push(a),a=null,d)if(1&l){if((e=(n=f[0]).length-1)>0){for(u||(r.polygonStart(),u=!0),r.lineStart(),t=0;t<e;++t)r.point((i=n[t])[0],i[1]);r.lineEnd()}}else d>1&&2&l&&f.push(f.pop().concat(f.shift())),o.push(f.filter(Yn))}return f}}function Yn(t){return t.length>1}function $n(t,e){return((t=t.x)[0]<0?t[1]-Tt-Ot:Tt-t[1])-((e=e.x)[0]<0?e[1]-Tt-Ot:Tt-e[1])}Nn.invert=Nn;var Un=Bn((function(){return!0}),(function(t){var e,n=NaN,i=NaN,r=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(s,o){var a=s>0?At:-At,l=zt(s-n);zt(l-At)<Ot?(t.point(n,i=(i+o)/2>0?Tt:-Tt),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(a,i),t.point(s,i),e=0):r!==a&&l>=At&&(zt(n-r)<Ot&&(n-=r*Ot),zt(s-a)<Ot&&(s-=a*Ot),i=function(t,e,n,i){var r,s,o=Wt(t-n);return zt(o)>Ot?Ft((Wt(e)*(s=jt(i))*Wt(n)-Wt(i)*(r=jt(e))*Wt(t))/(r*s*o)):(e+i)/2}(n,i,s,o),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(a,i),e=0),t.point(n=s,i=o),r=a},lineEnd:function(){t.lineEnd(),n=i=NaN},clean:function(){return 2-e}}}),(function(t,e,n,i){var r;if(null==t)r=n*Tt,i.point(-At,r),i.point(0,r),i.point(At,r),i.point(At,0),i.point(At,-r),i.point(0,-r),i.point(-At,-r),i.point(-At,0),i.point(-At,r);else if(zt(t[0]-e[0])>Ot){var s=t[0]<e[0]?At:-At;r=n*s/2,i.point(-s,r),i.point(0,r),i.point(s,r)}else i.point(e[0],e[1])}),[-At,-Tt]);function Wn(t){var e=jt(t),n=6*Dt,i=e>0,r=zt(e)>Ot;function s(t,n){return jt(t)*jt(n)>e}function o(t,n,i){var r=[1,0,0],s=Re(Ae(t),Ae(n)),o=Te(s,s),a=s[0],l=o-a*a;if(!l)return!i&&t;var c=e*o/l,h=-e*a/l,u=Re(r,s),f=Pe(r,c);Le(f,Pe(s,h));var d=u,g=Te(f,d),p=Te(d,d),_=g*g-p*(Te(f,f)-1);if(!(_<0)){var y=Vt(_),m=Pe(d,(-g-y)/p);if(Le(m,f),m=Ce(m),!i)return m;var x,v=t[0],b=n[0],M=t[1],w=n[1];b<v&&(x=v,v=b,b=x);var E=b-v,S=zt(E-At)<Ot;if(!S&&w<M&&(x=M,M=w,w=x),S||E<Ot?S?M+w>0^m[1]<(zt(m[0]-v)<Ot?M:w):M<=m[1]&&m[1]<=w:E>At^(v<=m[0]&&m[0]<=b)){var N=Pe(d,(-g+y)/p);return Le(N,f),[m,Ce(N)]}}}function a(e,n){var r=i?t:At-t,s=0;return e<-r?s|=1:e>r&&(s|=2),n<-r?s|=4:n>r&&(s|=8),s}return Bn(s,(function(t){var e,n,l,c,h;return{lineStart:function(){c=l=!1,h=1},point:function(u,f){var d,g=[u,f],p=s(u,f),_=i?p?0:a(u,f):p?a(u+(u<0?At:-At),f):0;if(!e&&(c=l=p)&&t.lineStart(),p!==l&&(!(d=o(e,g))||Dn(e,d)||Dn(g,d))&&(g[2]=1),p!==l)h=0,p?(t.lineStart(),d=o(g,e),t.point(d[0],d[1])):(d=o(e,g),t.point(d[0],d[1],2),t.lineEnd()),e=d;else if(r&&e&&i^p){var y;_&n||!(y=o(g,e,!0))||(h=0,i?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1],3)))}!p||e&&Dn(e,g)||t.point(g[0],g[1]),e=g,l=p,n=_},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return h|(c&&l)<<1}}}),(function(e,i,r,s){Tn(s,t,n,r,e,i)}),i?[0,-t]:[-At,t-At])}var Xn,Vn,Hn,Jn,Zn=1e9,Qn=-Zn;function Kn(t,e,n,i){function r(r,s){return t<=r&&r<=n&&e<=s&&s<=i}function s(r,s,a,c){var h=0,u=0;if(null==r||(h=o(r,a))!==(u=o(s,a))||l(r,s)<0^a>0)do{c.point(0===h||3===h?t:n,h>1?i:e)}while((h=(h+a+4)%4)!==u);else c.point(s[0],s[1])}function o(i,r){return zt(i[0]-t)<Ot?r>0?0:3:zt(i[0]-n)<Ot?r>0?2:1:zt(i[1]-e)<Ot?r>0?1:0:r>0?3:2}function a(t,e){return l(t.x,e.x)}function l(t,e){var n=o(t,1),i=o(e,1);return n!==i?n-i:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(o){var l,c,h,u,f,d,g,p,_,y,m,x=o,v=Pn(),b={point:M,lineStart:function(){b.point=w,c&&c.push(h=[]);y=!0,_=!1,g=p=NaN},lineEnd:function(){l&&(w(u,f),d&&_&&v.rejoin(),l.push(v.result()));b.point=M,_&&x.lineEnd()},polygonStart:function(){x=v,l=[],c=[],m=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,r=c.length;n<r;++n)for(var s,o,a=c[n],l=1,h=a.length,u=a[0],f=u[0],d=u[1];l<h;++l)s=f,o=d,f=(u=a[l])[0],d=u[1],o<=i?d>i&&(f-s)*(i-o)>(d-o)*(t-s)&&++e:d<=i&&(f-s)*(i-o)<(d-o)*(t-s)&&--e;return e}(),n=m&&e,r=(l=pt(l)).length;(n||r)&&(o.polygonStart(),n&&(o.lineStart(),s(null,null,1,o),o.lineEnd()),r&&Fn(l,a,e,s,o),o.polygonEnd());x=o,l=c=h=null}};function M(t,e){r(t,e)&&x.point(t,e)}function w(s,o){var a=r(s,o);if(c&&h.push([s,o]),y)u=s,f=o,d=a,y=!1,a&&(x.lineStart(),x.point(s,o));else if(a&&_)x.point(s,o);else{var l=[g=Math.max(Qn,Math.min(Zn,g)),p=Math.max(Qn,Math.min(Zn,p))],v=[s=Math.max(Qn,Math.min(Zn,s)),o=Math.max(Qn,Math.min(Zn,o))];!function(t,e,n,i,r,s){var o,a=t[0],l=t[1],c=0,h=1,u=e[0]-a,f=e[1]-l;if(o=n-a,u||!(o>0)){if(o/=u,u<0){if(o<c)return;o<h&&(h=o)}else if(u>0){if(o>h)return;o>c&&(c=o)}if(o=r-a,u||!(o<0)){if(o/=u,u<0){if(o>h)return;o>c&&(c=o)}else if(u>0){if(o<c)return;o<h&&(h=o)}if(o=i-l,f||!(o>0)){if(o/=f,f<0){if(o<c)return;o<h&&(h=o)}else if(f>0){if(o>h)return;o>c&&(c=o)}if(o=s-l,f||!(o<0)){if(o/=f,f<0){if(o>h)return;o>c&&(c=o)}else if(f>0){if(o<c)return;o<h&&(h=o)}return c>0&&(t[0]=a+c*u,t[1]=l+c*f),h<1&&(e[0]=a+h*u,e[1]=l+h*f),!0}}}}}(l,v,t,e,n,i)?a&&(x.lineStart(),x.point(s,o),m=!1):(_||(x.lineStart(),x.point(l[0],l[1])),x.point(v[0],v[1]),a||x.lineEnd(),m=!1)}g=s,p=o,_=a}return b}}var ti={sphere:Kt,point:Kt,lineStart:function(){ti.point=ni,ti.lineEnd=ei},lineEnd:Kt,polygonStart:Kt,polygonEnd:Kt};function ei(){ti.point=ti.lineEnd=Kt}function ni(t,e){Vn=t*=Dt,Hn=Wt(e*=Dt),Jn=jt(e),ti.point=ii}function ii(t,e){t*=Dt;var n=Wt(e*=Dt),i=jt(e),r=zt(t-Vn),s=jt(r),o=i*Wt(r),a=Jn*n-Hn*i*s,l=Hn*n+Jn*i*s;Xn.add(Gt(Vt(o*o+a*a),l)),Vn=t,Hn=n,Jn=i}function ri(t){return Xn=new S,se(t,ti),+Xn}var si=[null,null],oi={type:"LineString",coordinates:si};function ai(t,e){return si[0]=t,si[1]=e,ri(oi)}var li={Feature:function(t,e){return hi(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)if(hi(n[i].geometry,e))return!0;return!1}},ci={Sphere:function(){return!0},Point:function(t,e){return ui(t.coordinates,e)},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)if(ui(n[i],e))return!0;return!1},LineString:function(t,e){return fi(t.coordinates,e)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)if(fi(n[i],e))return!0;return!1},Polygon:function(t,e){return di(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)if(di(n[i],e))return!0;return!1},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)if(hi(n[i],e))return!0;return!1}};function hi(t,e){return!(!t||!ci.hasOwnProperty(t.type))&&ci[t.type](t,e)}function ui(t,e){return 0===ai(t,e)}function fi(t,e){for(var n,i,r,s=0,o=t.length;s<o;s++){if(0===(i=ai(t[s],e)))return!0;if(s>0&&(r=ai(t[s],t[s-1]))>0&&n<=r&&i<=r&&(n+i-r)*(1-Math.pow((n-i)/r,2))<Ct*r)return!0;n=i}return!1}function di(t,e){return!!qn(t.map(gi),pi(e))}function gi(t){return(t=t.map(pi)).pop(),t}function pi(t){return[t[0]*Dt,t[1]*Dt]}function _i(t,e,n){var i=yt(t,e-Ot,n).concat(e);return function(t){return i.map((function(e){return[t,e]}))}}function yi(t,e,n){var i=yt(t,e-Ot,n).concat(e);return function(t){return i.map((function(e){return[e,t]}))}}function mi(){var t,e,n,i,r,s,o,a,l,c,h,u,f=10,d=f,g=90,p=360,_=2.5;function y(){return{type:"MultiLineString",coordinates:m()}}function m(){return yt(qt(i/g)*g,n,g).map(h).concat(yt(qt(a/p)*p,o,p).map(u)).concat(yt(qt(e/f)*f,t,f).filter((function(t){return zt(t%g)>Ot})).map(l)).concat(yt(qt(s/d)*d,r,d).filter((function(t){return zt(t%p)>Ot})).map(c))}return y.lines=function(){return m().map((function(t){return{type:"LineString",coordinates:t}}))},y.outline=function(){return{type:"Polygon",coordinates:[h(i).concat(u(o).slice(1),h(n).reverse().slice(1),u(a).reverse().slice(1))]}},y.extent=function(t){return arguments.length?y.extentMajor(t).extentMinor(t):y.extentMinor()},y.extentMajor=function(t){return arguments.length?(i=+t[0][0],n=+t[1][0],a=+t[0][1],o=+t[1][1],i>n&&(t=i,i=n,n=t),a>o&&(t=a,a=o,o=t),y.precision(_)):[[i,a],[n,o]]},y.extentMinor=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],s=+n[0][1],r=+n[1][1],e>t&&(n=e,e=t,t=n),s>r&&(n=s,s=r,r=n),y.precision(_)):[[e,s],[t,r]]},y.step=function(t){return arguments.length?y.stepMajor(t).stepMinor(t):y.stepMinor()},y.stepMajor=function(t){return arguments.length?(g=+t[0],p=+t[1],y):[g,p]},y.stepMinor=function(t){return arguments.length?(f=+t[0],d=+t[1],y):[f,d]},y.precision=function(f){return arguments.length?(_=+f,l=_i(s,r,90),c=yi(e,t,_),h=_i(a,o,90),u=yi(i,n,_),y):_},y.extentMajor([[-180,-89.999999],[180,89.999999]]).extentMinor([[-180,-80.000001],[180,80.000001]])}function xi(t,e){var n=t[0]*Dt,i=t[1]*Dt,r=e[0]*Dt,s=e[1]*Dt,o=jt(i),a=Wt(i),l=jt(s),c=Wt(s),h=o*jt(n),u=o*Wt(n),f=l*jt(r),d=l*Wt(r),g=2*Zt(Vt(Qt(s-i)+o*l*Qt(r-n))),p=Wt(g),_=g?function(t){var e=Wt(t*=g)/p,n=Wt(g-t)/p,i=n*h+e*f,r=n*u+e*d,s=n*a+e*c;return[Gt(r,i)*Pt,Gt(s,Vt(i*i+r*r))*Pt]}:function(){return[n*Pt,i*Pt]};return _.distance=g,_}var vi,bi,Mi,wi,Ei=t=>t,Si=new S,Ni=new S,Ii={point:Kt,lineStart:Kt,lineEnd:Kt,polygonStart:function(){Ii.lineStart=ki,Ii.lineEnd=Ai},polygonEnd:function(){Ii.lineStart=Ii.lineEnd=Ii.point=Kt,Si.add(zt(Ni)),Ni=new S},result:function(){var t=Si/2;return Si=new S,t}};function ki(){Ii.point=Oi}function Oi(t,e){Ii.point=Ci,vi=Mi=t,bi=wi=e}function Ci(t,e){Ni.add(wi*t-Mi*e),Mi=t,wi=e}function Ai(){Ci(vi,bi)}var Ti=Ii,Ri=1/0,Li=Ri,Pi=-Ri,Di=Pi,zi={point:function(t,e){t<Ri&&(Ri=t);t>Pi&&(Pi=t);e<Li&&(Li=e);e>Di&&(Di=e)},lineStart:Kt,lineEnd:Kt,polygonStart:Kt,polygonEnd:Kt,result:function(){var t=[[Ri,Li],[Pi,Di]];return Pi=Di=-(Li=Ri=1/0),t}};var Fi,Gi,ji,qi,Bi=zi,Yi=0,$i=0,Ui=0,Wi=0,Xi=0,Vi=0,Hi=0,Ji=0,Zi=0,Qi={point:Ki,lineStart:tr,lineEnd:ir,polygonStart:function(){Qi.lineStart=rr,Qi.lineEnd=sr},polygonEnd:function(){Qi.point=Ki,Qi.lineStart=tr,Qi.lineEnd=ir},result:function(){var t=Zi?[Hi/Zi,Ji/Zi]:Vi?[Wi/Vi,Xi/Vi]:Ui?[Yi/Ui,$i/Ui]:[NaN,NaN];return Yi=$i=Ui=Wi=Xi=Vi=Hi=Ji=Zi=0,t}};function Ki(t,e){Yi+=t,$i+=e,++Ui}function tr(){Qi.point=er}function er(t,e){Qi.point=nr,Ki(ji=t,qi=e)}function nr(t,e){var n=t-ji,i=e-qi,r=Vt(n*n+i*i);Wi+=r*(ji+t)/2,Xi+=r*(qi+e)/2,Vi+=r,Ki(ji=t,qi=e)}function ir(){Qi.point=Ki}function rr(){Qi.point=or}function sr(){ar(Fi,Gi)}function or(t,e){Qi.point=ar,Ki(Fi=ji=t,Gi=qi=e)}function ar(t,e){var n=t-ji,i=e-qi,r=Vt(n*n+i*i);Wi+=r*(ji+t)/2,Xi+=r*(qi+e)/2,Vi+=r,Hi+=(r=qi*t-ji*e)*(ji+t),Ji+=r*(qi+e),Zi+=3*r,Ki(ji=t,qi=e)}var lr=Qi;function cr(t){this._context=t}cr.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,Lt)}},result:Kt};var hr,ur,fr,dr,gr,pr=new S,_r={point:Kt,lineStart:function(){_r.point=yr},lineEnd:function(){hr&&mr(ur,fr),_r.point=Kt},polygonStart:function(){hr=!0},polygonEnd:function(){hr=null},result:function(){var t=+pr;return pr=new S,t}};function yr(t,e){_r.point=mr,ur=dr=t,fr=gr=e}function mr(t,e){dr-=t,gr-=e,pr.add(Vt(dr*dr+gr*gr)),dr=t,gr=e}var xr=_r;function vr(){this._string=[]}function br(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function Mr(t,e){var n,i,r=4.5;function s(t){return t&&("function"==typeof r&&i.pointRadius(+r.apply(this,arguments)),se(t,n(i))),i.result()}return s.area=function(t){return se(t,n(Ti)),Ti.result()},s.measure=function(t){return se(t,n(xr)),xr.result()},s.bounds=function(t){return se(t,n(Bi)),Bi.result()},s.centroid=function(t){return se(t,n(lr)),lr.result()},s.projection=function(e){return arguments.length?(n=null==e?(t=null,Ei):(t=e).stream,s):t},s.context=function(t){return arguments.length?(i=null==t?(e=null,new vr):new cr(e=t),"function"!=typeof r&&i.pointRadius(r),s):e},s.pointRadius=function(t){return arguments.length?(r="function"==typeof t?t:(i.pointRadius(+t),+t),s):r},s.projection(t).context(e)}function wr(t){return function(e){var n=new Er;for(var i in t)n[i]=t[i];return n.stream=e,n}}function Er(){}function Sr(t,e,n){var i=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=i&&t.clipExtent(null),se(n,t.stream(Bi)),e(Bi.result()),null!=i&&t.clipExtent(i),t}function Nr(t,e,n){return Sr(t,(function(n){var i=e[1][0]-e[0][0],r=e[1][1]-e[0][1],s=Math.min(i/(n[1][0]-n[0][0]),r/(n[1][1]-n[0][1])),o=+e[0][0]+(i-s*(n[1][0]+n[0][0]))/2,a=+e[0][1]+(r-s*(n[1][1]+n[0][1]))/2;t.scale(150*s).translate([o,a])}),n)}function Ir(t,e,n){return Nr(t,[[0,0],e],n)}function kr(t,e,n){return Sr(t,(function(n){var i=+e,r=i/(n[1][0]-n[0][0]),s=(i-r*(n[1][0]+n[0][0]))/2,o=-r*n[0][1];t.scale(150*r).translate([s,o])}),n)}function Or(t,e,n){return Sr(t,(function(n){var i=+e,r=i/(n[1][1]-n[0][1]),s=-r*n[0][0],o=(i-r*(n[1][1]+n[0][1]))/2;t.scale(150*r).translate([s,o])}),n)}vr.prototype={_radius:4.5,_circle:br(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=br(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}},Er.prototype={constructor:Er,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Cr=jt(30*Dt);function Ar(t,e){return+e?function(t,e){function n(i,r,s,o,a,l,c,h,u,f,d,g,p,_){var y=c-i,m=h-r,x=y*y+m*m;if(x>4*e&&p--){var v=o+f,b=a+d,M=l+g,w=Vt(v*v+b*b+M*M),E=Zt(M/=w),S=zt(zt(M)-1)<Ot||zt(s-u)<Ot?(s+u)/2:Gt(b,v),N=t(S,E),I=N[0],k=N[1],O=I-i,C=k-r,A=m*O-y*C;(A*A/x>e||zt((y*O+m*C)/x-.5)>.3||o*f+a*d+l*g<Cr)&&(n(i,r,s,o,a,l,I,k,S,v/=w,b/=w,M,p,_),_.point(I,k),n(I,k,S,v,b,M,c,h,u,f,d,g,p,_))}}return function(e){var i,r,s,o,a,l,c,h,u,f,d,g,p={point:_,lineStart:y,lineEnd:x,polygonStart:function(){e.polygonStart(),p.lineStart=v},polygonEnd:function(){e.polygonEnd(),p.lineStart=y}};function _(n,i){n=t(n,i),e.point(n[0],n[1])}function y(){h=NaN,p.point=m,e.lineStart()}function m(i,r){var s=Ae([i,r]),o=t(i,r);n(h,u,c,f,d,g,h=o[0],u=o[1],c=i,f=s[0],d=s[1],g=s[2],16,e),e.point(h,u)}function x(){p.point=_,e.lineEnd()}function v(){y(),p.point=b,p.lineEnd=M}function b(t,e){m(i=t,e),r=h,s=u,o=f,a=d,l=g,p.point=m}function M(){n(h,u,c,f,d,g,r,s,i,o,a,l,16,e),p.lineEnd=x,x()}return p}}(t,e):function(t){return wr({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)}var Tr=wr({point:function(t,e){this.stream.point(t*Dt,e*Dt)}});function Rr(t,e,n,i,r,s){if(!s)return function(t,e,n,i,r){function s(s,o){return[e+t*(s*=i),n-t*(o*=r)]}return s.invert=function(s,o){return[(s-e)/t*i,(n-o)/t*r]},s}(t,e,n,i,r);var o=jt(s),a=Wt(s),l=o*t,c=a*t,h=o/t,u=a/t,f=(a*n-o*e)/t,d=(a*e+o*n)/t;function g(t,s){return[l*(t*=i)-c*(s*=r)+e,n-c*t-l*s]}return g.invert=function(t,e){return[i*(h*t-u*e+f),r*(d-u*t-h*e)]},g}function Lr(t){return Pr((function(){return t}))()}function Pr(t){var e,n,i,r,s,o,a,l,c,h,u=150,f=480,d=250,g=0,p=0,_=0,y=0,m=0,x=0,v=1,b=1,M=null,w=Un,E=null,S=Ei,N=.5;function I(t){return l(t[0]*Dt,t[1]*Dt)}function k(t){return(t=l.invert(t[0],t[1]))&&[t[0]*Pt,t[1]*Pt]}function O(){var t=Rr(u,0,0,v,b,x).apply(null,e(g,p)),i=Rr(u,f-t[0],d-t[1],v,b,x);return n=In(_,y,m),a=Sn(e,i),l=Sn(n,a),o=Ar(a,N),C()}function C(){return c=h=null,I}return I.stream=function(t){return c&&h===t?c:c=Tr(function(t){return wr({point:function(e,n){var i=t(e,n);return this.stream.point(i[0],i[1])}})}(n)(w(o(S(h=t)))))},I.preclip=function(t){return arguments.length?(w=t,M=void 0,C()):w},I.postclip=function(t){return arguments.length?(S=t,E=i=r=s=null,C()):S},I.clipAngle=function(t){return arguments.length?(w=+t?Wn(M=t*Dt):(M=null,Un),C()):M*Pt},I.clipExtent=function(t){return arguments.length?(S=null==t?(E=i=r=s=null,Ei):Kn(E=+t[0][0],i=+t[0][1],r=+t[1][0],s=+t[1][1]),C()):null==E?null:[[E,i],[r,s]]},I.scale=function(t){return arguments.length?(u=+t,O()):u},I.translate=function(t){return arguments.length?(f=+t[0],d=+t[1],O()):[f,d]},I.center=function(t){return arguments.length?(g=t[0]%360*Dt,p=t[1]%360*Dt,O()):[g*Pt,p*Pt]},I.rotate=function(t){return arguments.length?(_=t[0]%360*Dt,y=t[1]%360*Dt,m=t.length>2?t[2]%360*Dt:0,O()):[_*Pt,y*Pt,m*Pt]},I.angle=function(t){return arguments.length?(x=t%360*Dt,O()):x*Pt},I.reflectX=function(t){return arguments.length?(v=t?-1:1,O()):v<0},I.reflectY=function(t){return arguments.length?(b=t?-1:1,O()):b<0},I.precision=function(t){return arguments.length?(o=Ar(a,N=t*t),C()):Vt(N)},I.fitExtent=function(t,e){return Nr(I,t,e)},I.fitSize=function(t,e){return Ir(I,t,e)},I.fitWidth=function(t,e){return kr(I,t,e)},I.fitHeight=function(t,e){return Or(I,t,e)},function(){return e=t.apply(this,arguments),I.invert=e.invert&&k,O()}}function Dr(t){var e=0,n=At/3,i=Pr(t),r=i(e,n);return r.parallels=function(t){return arguments.length?i(e=t[0]*Dt,n=t[1]*Dt):[e*Pt,n*Pt]},r}function zr(t,e){var n=Wt(t),i=(n+Wt(e))/2;if(zt(i)<Ot)return function(t){var e=jt(t);function n(t,n){return[t*e,Wt(n)/e]}return n.invert=function(t,n){return[t/e,Zt(n*e)]},n}(t);var r=1+n*(2*i-n),s=Vt(r)/i;function o(t,e){var n=Vt(r-2*i*Wt(e))/i;return[n*Wt(t*=i),s-n*jt(t)]}return o.invert=function(t,e){var n=s-e,o=Gt(t,zt(n))*Xt(n);return n*i<0&&(o-=At*Xt(t)*Xt(n)),[o/i,Zt((r-(t*t+n*n)*i*i)/(2*i))]},o}function Fr(){return Dr(zr).scale(155.424).center([0,33.6442])}function Gr(){return Fr().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function jr(t){return function(e,n){var i=jt(e),r=jt(n),s=t(i*r);return s===1/0?[2,0]:[s*r*Wt(e),s*Wt(n)]}}function qr(t){return function(e,n){var i=Vt(e*e+n*n),r=t(i),s=Wt(r),o=jt(r);return[Gt(e*s,i*o),Zt(i&&n*s/i)]}}var Br=jr((function(t){return Vt(2/(1+t))}));Br.invert=qr((function(t){return 2*Zt(t/2)}));var Yr=jr((function(t){return(t=Jt(t))&&t/Wt(t)}));function $r(){return Lr(Yr).scale(79.4188).clipAngle(179.999)}function Ur(t,e){return[t,$t(Ht((Tt+e)/2))]}function Wr(){return Xr(Ur).scale(961/Lt)}function Xr(t){var e,n,i,r=Lr(t),s=r.center,o=r.scale,a=r.translate,l=r.clipExtent,c=null;function h(){var s=At*o(),a=r(An(r.rotate()).invert([0,0]));return l(null==c?[[a[0]-s,a[1]-s],[a[0]+s,a[1]+s]]:t===Ur?[[Math.max(a[0]-s,c),e],[Math.min(a[0]+s,n),i]]:[[c,Math.max(a[1]-s,e)],[n,Math.min(a[1]+s,i)]])}return r.scale=function(t){return arguments.length?(o(t),h()):o()},r.translate=function(t){return arguments.length?(a(t),h()):a()},r.center=function(t){return arguments.length?(s(t),h()):s()},r.clipExtent=function(t){return arguments.length?(null==t?c=e=n=i=null:(c=+t[0][0],e=+t[0][1],n=+t[1][0],i=+t[1][1]),h()):null==c?null:[[c,e],[n,i]]},h()}function Vr(t){return Ht((Tt+t)/2)}function Hr(t,e){var n=jt(t),i=t===e?Wt(t):$t(n/jt(e))/$t(Vr(e)/Vr(t)),r=n*Ut(Vr(t),i)/i;if(!i)return Ur;function s(t,e){r>0?e<-Tt+Ot&&(e=-Tt+Ot):e>Tt-Ot&&(e=Tt-Ot);var n=r/Ut(Vr(e),i);return[n*Wt(i*t),r-n*jt(i*t)]}return s.invert=function(t,e){var n=r-e,s=Xt(i)*Vt(t*t+n*n),o=Gt(t,zt(n))*Xt(n);return n*i<0&&(o-=At*Xt(t)*Xt(n)),[o/i,2*Ft(Ut(r/s,1/i))-Tt]},s}function Jr(t,e){return[t,e]}function Zr(){return Lr(Jr).scale(152.63)}function Qr(t,e){var n=jt(t),i=t===e?Wt(t):(n-jt(e))/(e-t),r=n/i+t;if(zt(i)<Ot)return Jr;function s(t,e){var n=r-e,s=i*t;return[n*Wt(s),r-n*jt(s)]}return s.invert=function(t,e){var n=r-e,s=Gt(t,zt(n))*Xt(n);return n*i<0&&(s-=At*Xt(t)*Xt(n)),[s/i,r-Xt(i)*Vt(t*t+n*n)]},s}Yr.invert=qr((function(t){return t})),Ur.invert=function(t,e){return[t,2*Ft(Bt(e))-Tt]},Jr.invert=Jr;var Kr=1.340264,ts=-.081106,es=893e-6,ns=.003796,is=Vt(3)/2;function rs(t,e){var n=Zt(is*Wt(e)),i=n*n,r=i*i*i;return[t*jt(n)/(is*(Kr+3*ts*i+r*(7*es+9*ns*i))),n*(Kr+ts*i+r*(es+ns*i))]}function ss(t,e){var n=jt(e),i=jt(t)*n;return[n*Wt(t)/i,Wt(e)/i]}function os(){return Lr(ss).scale(144.049).clipAngle(60)}function as(){var t,e,n,i,r,s,o,a=1,l=0,c=0,h=1,u=1,f=0,d=null,g=1,p=1,_=wr({point:function(t,e){var n=x([t,e]);this.stream.point(n[0],n[1])}}),y=Ei;function m(){return g=a*h,p=a*u,s=o=null,x}function x(n){var i=n[0]*g,r=n[1]*p;if(f){var s=r*t-i*e;i=i*t+r*e,r=s}return[i+l,r+c]}return x.invert=function(n){var i=n[0]-l,r=n[1]-c;if(f){var s=r*t+i*e;i=i*t-r*e,r=s}return[i/g,r/p]},x.stream=function(t){return s&&o===t?s:s=_(y(o=t))},x.postclip=function(t){return arguments.length?(y=t,d=n=i=r=null,m()):y},x.clipExtent=function(t){return arguments.length?(y=null==t?(d=n=i=r=null,Ei):Kn(d=+t[0][0],n=+t[0][1],i=+t[1][0],r=+t[1][1]),m()):null==d?null:[[d,n],[i,r]]},x.scale=function(t){return arguments.length?(a=+t,m()):a},x.translate=function(t){return arguments.length?(l=+t[0],c=+t[1],m()):[l,c]},x.angle=function(n){return arguments.length?(e=Wt(f=n%360*Dt),t=jt(f),m()):f*Pt},x.reflectX=function(t){return arguments.length?(h=t?-1:1,m()):h<0},x.reflectY=function(t){return arguments.length?(u=t?-1:1,m()):u<0},x.fitExtent=function(t,e){return Nr(x,t,e)},x.fitSize=function(t,e){return Ir(x,t,e)},x.fitWidth=function(t,e){return kr(x,t,e)},x.fitHeight=function(t,e){return Or(x,t,e)},x}function ls(t,e){var n=e*e,i=n*n;return[t*(.8707-.131979*n+i*(i*(.003971*n-.001529*i)-.013791)),e*(1.007226+n*(.015085+i*(.028874*n-.044475-.005916*i)))]}function cs(t,e){return[jt(e)*Wt(t),Wt(e)]}function hs(){return Lr(cs).scale(249.5).clipAngle(90.000001)}function us(t,e){var n=jt(e),i=1+jt(t)*n;return[n*Wt(t)/i,Wt(e)/i]}function fs(t,e){return[$t(Ht((Tt+e)/2)),-t]}rs.invert=function(t,e){for(var n,i=e,r=i*i,s=r*r*r,o=0;o<12&&(s=(r=(i-=n=(i*(Kr+ts*r+s*(es+ns*r))-e)/(Kr+3*ts*r+s*(7*es+9*ns*r)))*i)*r*r,!(zt(n)<Ct));++o);return[is*t*(Kr+3*ts*r+s*(7*es+9*ns*r))/jt(i),Zt(Wt(i)/is)]},ss.invert=qr(Ft),ls.invert=function(t,e){var n,i=e,r=25;do{var s=i*i,o=s*s;i-=n=(i*(1.007226+s*(.015085+o*(.028874*s-.044475-.005916*o)))-e)/(1.007226+s*(.045255+o*(.259866*s-.311325-.005916*11*o)))}while(zt(n)>Ot&&--r>0);return[t/(.8707+(s=i*i)*(s*(s*s*s*(.003971-.001529*s)-.013791)-.131979)),i]},cs.invert=qr(Zt),us.invert=qr((function(t){return 2*Ft(t)})),fs.invert=function(t,e){return[-e,2*Ft(Bt(t))-Tt]};var ds=Object.freeze({__proto__:null,geoArea:Oe,geoBounds:un,geoCentroid:wn,geoCircle:Ln,geoClipAntimeridian:Un,geoClipCircle:Wn,geoClipExtent:function(){var t,e,n,i=0,r=0,s=960,o=500;return n={stream:function(n){return t&&e===n?t:t=Kn(i,r,s,o)(e=n)},extent:function(a){return arguments.length?(i=+a[0][0],r=+a[0][1],s=+a[1][0],o=+a[1][1],t=e=null,n):[[i,r],[s,o]]}}},geoClipRectangle:Kn,geoContains:function(t,e){return(t&&li.hasOwnProperty(t.type)?li[t.type]:hi)(t,e)},geoDistance:ai,geoGraticule:mi,geoGraticule10:function(){return mi()()},geoInterpolate:xi,geoLength:ri,geoPath:Mr,geoAlbers:Gr,geoAlbersUsa:function(){var t,e,n,i,r,s,o=Gr(),a=Fr().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=Fr().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(t,e){s=[t,e]}};function h(t){var e=t[0],o=t[1];return s=null,n.point(e,o),s||(i.point(e,o),s)||(r.point(e,o),s)}function u(){return t=e=null,h}return h.invert=function(t){var e=o.scale(),n=o.translate(),i=(t[0]-n[0])/e,r=(t[1]-n[1])/e;return(r>=.12&&r<.234&&i>=-.425&&i<-.214?a:r>=.166&&r<.234&&i>=-.214&&i<-.115?l:o).invert(t)},h.stream=function(n){return t&&e===n?t:(i=[o.stream(e=n),a.stream(n),l.stream(n)],r=i.length,t={point:function(t,e){for(var n=-1;++n<r;)i[n].point(t,e)},sphere:function(){for(var t=-1;++t<r;)i[t].sphere()},lineStart:function(){for(var t=-1;++t<r;)i[t].lineStart()},lineEnd:function(){for(var t=-1;++t<r;)i[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<r;)i[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<r;)i[t].polygonEnd()}});var i,r},h.precision=function(t){return arguments.length?(o.precision(t),a.precision(t),l.precision(t),u()):o.precision()},h.scale=function(t){return arguments.length?(o.scale(t),a.scale(.35*t),l.scale(t),h.translate(o.translate())):o.scale()},h.translate=function(t){if(!arguments.length)return o.translate();var e=o.scale(),s=+t[0],h=+t[1];return n=o.translate(t).clipExtent([[s-.455*e,h-.238*e],[s+.455*e,h+.238*e]]).stream(c),i=a.translate([s-.307*e,h+.201*e]).clipExtent([[s-.425*e+Ot,h+.12*e+Ot],[s-.214*e-Ot,h+.234*e-Ot]]).stream(c),r=l.translate([s-.205*e,h+.212*e]).clipExtent([[s-.214*e+Ot,h+.166*e+Ot],[s-.115*e-Ot,h+.234*e-Ot]]).stream(c),u()},h.fitExtent=function(t,e){return Nr(h,t,e)},h.fitSize=function(t,e){return Ir(h,t,e)},h.fitWidth=function(t,e){return kr(h,t,e)},h.fitHeight=function(t,e){return Or(h,t,e)},h.scale(1070)},geoAzimuthalEqualArea:function(){return Lr(Br).scale(124.75).clipAngle(179.999)},geoAzimuthalEqualAreaRaw:Br,geoAzimuthalEquidistant:$r,geoAzimuthalEquidistantRaw:Yr,geoConicConformal:function(){return Dr(Hr).scale(109.5).parallels([30,30])},geoConicConformalRaw:Hr,geoConicEqualArea:Fr,geoConicEqualAreaRaw:zr,geoConicEquidistant:function(){return Dr(Qr).scale(131.154).center([0,13.9389])},geoConicEquidistantRaw:Qr,geoEqualEarth:function(){return Lr(rs).scale(177.158)},geoEqualEarthRaw:rs,geoEquirectangular:Zr,geoEquirectangularRaw:Jr,geoGnomonic:os,geoGnomonicRaw:ss,geoIdentity:as,geoProjection:Lr,geoProjectionMutator:Pr,geoMercator:Wr,geoMercatorRaw:Ur,geoNaturalEarth1:function(){return Lr(ls).scale(175.295)},geoNaturalEarth1Raw:ls,geoOrthographic:hs,geoOrthographicRaw:cs,geoStereographic:function(){return Lr(us).scale(250).clipAngle(142)},geoStereographicRaw:us,geoTransverseMercator:function(){var t=Xr(fs),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)},geoTransverseMercatorRaw:fs,geoRotation:An,geoStream:se,geoTransform:function(t){return{stream:wr(t)}}}),gs="http://www.w3.org/1999/xhtml",ps={svg:"http://www.w3.org/2000/svg",xhtml:gs,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function _s(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),ps.hasOwnProperty(e)?{space:ps[e],local:t}:t}function ys(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===gs&&e.documentElement.namespaceURI===gs?e.createElement(t):e.createElementNS(n,t)}}function ms(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function xs(t){var e=_s(t);return(e.local?ms:ys)(e)}function vs(){}function bs(t){return null==t?vs:function(){return this.querySelector(t)}}function Ms(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function ws(){return[]}function Es(t){return null==t?ws:function(){return this.querySelectorAll(t)}}function Ss(t){return function(){return this.matches(t)}}function Ns(t){return function(e){return e.matches(t)}}var Is=Array.prototype.find;function ks(){return this.firstElementChild}var Os=Array.prototype.filter;function Cs(){return Array.from(this.children)}function As(t){return new Array(t.length)}function Ts(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function Rs(t){return function(){return t}}function Ls(t,e,n,i,r,s){for(var o,a=0,l=e.length,c=s.length;a<c;++a)(o=e[a])?(o.__data__=s[a],i[a]=o):n[a]=new Ts(t,s[a]);for(;a<l;++a)(o=e[a])&&(r[a]=o)}function Ps(t,e,n,i,r,s,o){var a,l,c,h=new Map,u=e.length,f=s.length,d=new Array(u);for(a=0;a<u;++a)(l=e[a])&&(d[a]=c=o.call(l,l.__data__,a,e)+"",h.has(c)?r[a]=l:h.set(c,l));for(a=0;a<f;++a)c=o.call(t,s[a],a,s)+"",(l=h.get(c))?(i[a]=l,l.__data__=s[a],h.delete(c)):n[a]=new Ts(t,s[a]);for(a=0;a<u;++a)(l=e[a])&&h.get(d[a])===l&&(r[a]=l)}function Ds(t){return t.__data__}function zs(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function Fs(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Gs(t){return function(){this.removeAttribute(t)}}function js(t){return function(){this.removeAttributeNS(t.space,t.local)}}function qs(t,e){return function(){this.setAttribute(t,e)}}function Bs(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Ys(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function $s(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Us(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Ws(t){return function(){this.style.removeProperty(t)}}function Xs(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Vs(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function Hs(t,e){return t.style.getPropertyValue(e)||Us(t).getComputedStyle(t,null).getPropertyValue(e)}function Js(t){return function(){delete this[t]}}function Zs(t,e){return function(){this[t]=e}}function Qs(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function Ks(t){return t.trim().split(/^|\s+/)}function to(t){return t.classList||new eo(t)}function eo(t){this._node=t,this._names=Ks(t.getAttribute("class")||"")}function no(t,e){for(var n=to(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function io(t,e){for(var n=to(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function ro(t){return function(){no(this,t)}}function so(t){return function(){io(this,t)}}function oo(t,e){return function(){(e.apply(this,arguments)?no:io)(this,t)}}function ao(){this.textContent=""}function lo(t){return function(){this.textContent=t}}function co(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function ho(){this.innerHTML=""}function uo(t){return function(){this.innerHTML=t}}function fo(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function go(){this.nextSibling&&this.parentNode.appendChild(this)}function po(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function _o(){return null}function yo(){var t=this.parentNode;t&&t.removeChild(this)}function mo(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function xo(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function vo(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function bo(t){return function(){var e=this.__on;if(e){for(var n,i=0,r=-1,s=e.length;i<s;++i)n=e[i],t.type&&n.type!==t.type||n.name!==t.name?e[++r]=n:this.removeEventListener(n.type,n.listener,n.options);++r?e.length=r:delete this.__on}}}function Mo(t,e,n){return function(){var i,r=this.__on,s=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(r)for(var o=0,a=r.length;o<a;++o)if((i=r[o]).type===t.type&&i.name===t.name)return this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),void(i.value=e);this.addEventListener(t.type,s,n),i={type:t.type,name:t.name,value:e,listener:s,options:n},r?r.push(i):this.__on=[i]}}function wo(t,e,n){var i=Us(t),r=i.CustomEvent;"function"==typeof r?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function Eo(t,e){return function(){return wo(this,t,e)}}function So(t,e){return function(){return wo(this,t,e.apply(this,arguments))}}Ts.prototype={constructor:Ts,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},eo.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var No=[null];function Io(t,e){this._groups=t,this._parents=e}function ko(){return new Io([[document.documentElement]],No)}function Oo(t){return"string"==typeof t?new Io([[document.querySelector(t)]],[document.documentElement]):new Io([[t]],No)}function Co(t){return Oo(xs(t).call(document.documentElement))}Io.prototype=ko.prototype={constructor:Io,select:function(t){"function"!=typeof t&&(t=bs(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s,o,a=e[r],l=a.length,c=i[r]=new Array(l),h=0;h<l;++h)(s=a[h])&&(o=t.call(s,s.__data__,h,a))&&("__data__"in s&&(o.__data__=s.__data__),c[h]=o);return new Io(i,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return Ms(t.apply(this,arguments))}}(t):Es(t);for(var e=this._groups,n=e.length,i=[],r=[],s=0;s<n;++s)for(var o,a=e[s],l=a.length,c=0;c<l;++c)(o=a[c])&&(i.push(t.call(o,o.__data__,c,a)),r.push(o));return new Io(i,r)},selectChild:function(t){return this.select(null==t?ks:function(t){return function(){return Is.call(this.children,t)}}("function"==typeof t?t:Ns(t)))},selectChildren:function(t){return this.selectAll(null==t?Cs:function(t){return function(){return Os.call(this.children,t)}}("function"==typeof t?t:Ns(t)))},filter:function(t){"function"!=typeof t&&(t=Ss(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s,o=e[r],a=o.length,l=i[r]=[],c=0;c<a;++c)(s=o[c])&&t.call(s,s.__data__,c,o)&&l.push(s);return new Io(i,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,Ds);var n=e?Ps:Ls,i=this._parents,r=this._groups;"function"!=typeof t&&(t=Rs(t));for(var s=r.length,o=new Array(s),a=new Array(s),l=new Array(s),c=0;c<s;++c){var h=i[c],u=r[c],f=u.length,d=zs(t.call(h,h&&h.__data__,c,i)),g=d.length,p=a[c]=new Array(g),_=o[c]=new Array(g),y=l[c]=new Array(f);n(h,u,p,_,y,d,e);for(var m,x,v=0,b=0;v<g;++v)if(m=p[v]){for(v>=b&&(b=v+1);!(x=_[b])&&++b<g;);m._next=x||null}}return(o=new Io(o,i))._enter=a,o._exit=l,o},enter:function(){return new Io(this._enter||this._groups.map(As),this._parents)},exit:function(){return new Io(this._exit||this._groups.map(As),this._parents)},join:function(t,e,n){var i=this.enter(),r=this,s=this.exit();return"function"==typeof t?(i=t(i))&&(i=i.selection()):i=i.append(t+""),null!=e&&(r=e(r))&&(r=r.selection()),null==n?s.remove():n(s),i&&r?i.merge(r).order():r},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,r=n.length,s=i.length,o=Math.min(r,s),a=new Array(r),l=0;l<o;++l)for(var c,h=n[l],u=i[l],f=h.length,d=a[l]=new Array(f),g=0;g<f;++g)(c=h[g]||u[g])&&(d[g]=c);for(;l<r;++l)a[l]=n[l];return new Io(a,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,r=t[e],s=r.length-1,o=r[s];--s>=0;)(i=r[s])&&(o&&4^i.compareDocumentPosition(o)&&o.parentNode.insertBefore(i,o),o=i);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=Fs);for(var n=this._groups,i=n.length,r=new Array(i),s=0;s<i;++s){for(var o,a=n[s],l=a.length,c=r[s]=new Array(l),h=0;h<l;++h)(o=a[h])&&(c[h]=o);c.sort(e)}return new Io(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,s=i.length;r<s;++r){var o=i[r];if(o)return o}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r,s=e[n],o=0,a=s.length;o<a;++o)(r=s[o])&&t.call(r,r.__data__,o,s);return this},attr:function(t,e){var n=_s(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==e?n.local?js:Gs:"function"==typeof e?n.local?$s:Ys:n.local?Bs:qs)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?Ws:"function"==typeof e?Vs:Xs)(t,e,null==n?"":n)):Hs(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?Js:"function"==typeof e?Qs:Zs)(t,e)):this.node()[t]},classed:function(t,e){var n=Ks(t+"");if(arguments.length<2){for(var i=to(this.node()),r=-1,s=n.length;++r<s;)if(!i.contains(n[r]))return!1;return!0}return this.each(("function"==typeof e?oo:e?ro:so)(n,e))},text:function(t){return arguments.length?this.each(null==t?ao:("function"==typeof t?co:lo)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?ho:("function"==typeof t?fo:uo)(t)):this.node().innerHTML},raise:function(){return this.each(go)},lower:function(){return this.each(po)},append:function(t){var e="function"==typeof t?t:xs(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:xs(t),i=null==e?_o:"function"==typeof e?e:bs(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)}))},remove:function(){return this.each(yo)},clone:function(t){return this.select(t?xo:mo)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var i,r,s=vo(t+""),o=s.length;if(!(arguments.length<2)){for(a=e?Mo:bo,i=0;i<o;++i)this.each(a(s[i],e,n));return this}var a=this.node().__on;if(a)for(var l,c=0,h=a.length;c<h;++c)for(i=0,l=a[c];i<o;++i)if((r=s[i]).type===l.type&&r.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?So:Eo)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i,r=t[e],s=0,o=r.length;s<o;++s)(i=r[s])&&(yield i)}};var Ao=0;function To(){return new Ro}function Ro(){this._="@"+(++Ao).toString(36)}function Lo(t){let e;for(;e=t.sourceEvent;)t=e;return t}function Po(t,e){if(t=Lo(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,[(i=i.matrixTransform(e.getScreenCTM().inverse())).x,i.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]}Ro.prototype=To.prototype={constructor:Ro,get:function(t){for(var e=this._;!(e in t);)if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};var Do=Object.freeze({__proto__:null,create:Co,creator:xs,local:To,matcher:Ss,namespace:_s,namespaces:ps,pointer:Po,pointers:function(t,e){return t.target&&(t=Lo(t),void 0===e&&(e=t.currentTarget),t=t.touches||[t]),Array.from(t,(t=>Po(t,e)))},select:Oo,selectAll:function(t){return"string"==typeof t?new Io([document.querySelectorAll(t)],[document.documentElement]):new Io([Ms(t)],No)},selection:ko,selector:bs,selectorAll:Es,style:Hs,window:Us}),zo={value:()=>{}};function Fo(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new Go(i)}function Go(t){this._=t}function jo(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function qo(t,e){for(var n,i=0,r=t.length;i<r;++i)if((n=t[i]).name===e)return n.value}function Bo(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=zo,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}Go.prototype=Fo.prototype={constructor:Go,on:function(t,e){var n,i=this._,r=jo(t+"",i),s=-1,o=r.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++s<o;)if(n=(t=r[s]).type)i[n]=Bo(i[n],t.name,e);else if(null==e)for(n in i)i[n]=Bo(i[n],t.name,null);return this}for(;++s<o;)if((n=(t=r[s]).type)&&(n=qo(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Go(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,r=new Array(n),s=0;s<n;++s)r[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=0,n=(i=this._[t]).length;s<n;++s)i[s].value.apply(e,r)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,s=i.length;r<s;++r)i[r].value.apply(e,n)}};var Yo,$o,Uo=0,Wo=0,Xo=0,Vo=0,Ho=0,Jo=0,Zo="object"==typeof performance&&performance.now?performance:Date,Qo="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Ko(){return Ho||(Qo(ta),Ho=Zo.now()+Jo)}function ta(){Ho=0}function ea(){this._call=this._time=this._next=null}function na(t,e,n){var i=new ea;return i.restart(t,e,n),i}function ia(){Ho=(Vo=Zo.now())+Jo,Uo=Wo=0;try{!function(){Ko(),++Uo;for(var t,e=Yo;e;)(t=Ho-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Uo}()}finally{Uo=0,function(){var t,e,n=Yo,i=1/0;for(;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Yo=e);$o=t,sa(i)}(),Ho=0}}function ra(){var t=Zo.now(),e=t-Vo;e>1e3&&(Jo-=e,Vo=t)}function sa(t){Uo||(Wo&&(Wo=clearTimeout(Wo)),t-Ho>24?(t<1/0&&(Wo=setTimeout(ia,t-Zo.now()-Jo)),Xo&&(Xo=clearInterval(Xo))):(Xo||(Vo=Zo.now(),Xo=setInterval(ra,1e3)),Uo=1,Qo(ia)))}function oa(t,e,n){var i=new ea;return e=null==e?0:+e,i.restart((n=>{i.stop(),t(n+e)}),e,n),i}ea.prototype=na.prototype={constructor:ea,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Ko():+n)+(null==e?0:+e),this._next||$o===this||($o?$o._next=this:Yo=this,$o=this),this._call=t,this._time=n,sa()},stop:function(){this._call&&(this._call=null,this._time=1/0,sa())}};var aa=Fo("start","end","cancel","interrupt"),la=[];function ca(t,e,n,i,r,s){var o=t.__transition;if(o){if(n in o)return}else t.__transition={};!function(t,e,n){var i,r=t.__transition;function s(t){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=t&&o(t-n.delay)}function o(s){var c,h,u,f;if(1!==n.state)return l();for(c in r)if((f=r[c]).name===n.name){if(3===f.state)return oa(o);4===f.state?(f.state=6,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete r[c]):+c<e&&(f.state=6,f.timer.stop(),f.on.call("cancel",t,t.__data__,f.index,f.group),delete r[c])}if(oa((function(){3===n.state&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(s))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,i=new Array(u=n.tween.length),c=0,h=-1;c<u;++c)(f=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(i[++h]=f);i.length=h+1}}function a(e){for(var r=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(l),n.state=5,1),s=-1,o=i.length;++s<o;)i[s].call(t,r);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){for(var i in n.state=6,n.timer.stop(),delete r[e],r)return;delete t.__transition}r[e]=n,n.timer=na(s,0,n.time)}(t,n,{name:e,index:i,group:r,on:aa,tween:la,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:0})}function ha(t,e){var n=fa(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function ua(t,e){var n=fa(t,e);if(n.state>3)throw new Error("too late; already running");return n}function fa(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function da(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function ga(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function pa(){}var _a=.7,ya=1/_a,ma="\\s*([+-]?\\d+)\\s*",xa="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",va="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ba=/^#([0-9a-f]{3,8})$/,Ma=new RegExp(`^rgb\\(${ma},${ma},${ma}\\)$`),wa=new RegExp(`^rgb\\(${va},${va},${va}\\)$`),Ea=new RegExp(`^rgba\\(${ma},${ma},${ma},${xa}\\)$`),Sa=new RegExp(`^rgba\\(${va},${va},${va},${xa}\\)$`),Na=new RegExp(`^hsl\\(${xa},${va},${va}\\)$`),Ia=new RegExp(`^hsla\\(${xa},${va},${va},${xa}\\)$`),ka={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Oa(){return this.rgb().formatHex()}function Ca(){return this.rgb().formatRgb()}function Aa(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=ba.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Ta(e):3===n?new Da(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Ra(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Ra(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Ma.exec(t))?new Da(e[1],e[2],e[3],1):(e=wa.exec(t))?new Da(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Ea.exec(t))?Ra(e[1],e[2],e[3],e[4]):(e=Sa.exec(t))?Ra(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Na.exec(t))?Ba(e[1],e[2]/100,e[3]/100,1):(e=Ia.exec(t))?Ba(e[1],e[2]/100,e[3]/100,e[4]):ka.hasOwnProperty(t)?Ta(ka[t]):"transparent"===t?new Da(NaN,NaN,NaN,0):null}function Ta(t){return new Da(t>>16&255,t>>8&255,255&t,1)}function Ra(t,e,n,i){return i<=0&&(t=e=n=NaN),new Da(t,e,n,i)}function La(t){return t instanceof pa||(t=Aa(t)),t?new Da((t=t.rgb()).r,t.g,t.b,t.opacity):new Da}function Pa(t,e,n,i){return 1===arguments.length?La(t):new Da(t,e,n,null==i?1:i)}function Da(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function za(){return`#${qa(this.r)}${qa(this.g)}${qa(this.b)}`}function Fa(){const t=Ga(this.opacity);return`${1===t?"rgb(":"rgba("}${ja(this.r)}, ${ja(this.g)}, ${ja(this.b)}${1===t?")":`, ${t})`}`}function Ga(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ja(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function qa(t){return((t=ja(t))<16?"0":"")+t.toString(16)}function Ba(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new $a(t,e,n,i)}function Ya(t){if(t instanceof $a)return new $a(t.h,t.s,t.l,t.opacity);if(t instanceof pa||(t=Aa(t)),!t)return new $a;if(t instanceof $a)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),s=Math.max(e,n,i),o=NaN,a=s-r,l=(s+r)/2;return a?(o=e===s?(n-i)/a+6*(n<i):n===s?(i-e)/a+2:(e-n)/a+4,a/=l<.5?s+r:2-s-r,o*=60):a=l>0&&l<1?0:o,new $a(o,a,l,t.opacity)}function $a(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function Ua(t){return(t=(t||0)%360)<0?t+360:t}function Wa(t){return Math.max(0,Math.min(1,t||0))}function Xa(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}da(pa,Aa,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Oa,formatHex:Oa,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Ya(this).formatHsl()},formatRgb:Ca,toString:Ca}),da(Da,Pa,ga(pa,{brighter(t){return t=null==t?ya:Math.pow(ya,t),new Da(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?_a:Math.pow(_a,t),new Da(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Da(ja(this.r),ja(this.g),ja(this.b),Ga(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:za,formatHex:za,formatHex8:function(){return`#${qa(this.r)}${qa(this.g)}${qa(this.b)}${qa(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Fa,toString:Fa})),da($a,(function(t,e,n,i){return 1===arguments.length?Ya(t):new $a(t,e,n,null==i?1:i)}),ga(pa,{brighter(t){return t=null==t?ya:Math.pow(ya,t),new $a(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?_a:Math.pow(_a,t),new $a(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new Da(Xa(t>=240?t-240:t+120,r,i),Xa(t,r,i),Xa(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new $a(Ua(this.h),Wa(this.s),Wa(this.l),Ga(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Ga(this.opacity);return`${1===t?"hsl(":"hsla("}${Ua(this.h)}, ${100*Wa(this.s)}%, ${100*Wa(this.l)}%${1===t?")":`, ${t})`}`}}));const Va=Math.PI/180,Ha=180/Math.PI;var Ja=-.14861,Za=1.78277,Qa=-.29227,Ka=-.90649,tl=1.97294,el=tl*Ka,nl=tl*Za,il=Za*Qa-Ka*Ja;function rl(t){if(t instanceof ol)return new ol(t.h,t.s,t.l,t.opacity);t instanceof Da||(t=La(t));var e=t.r/255,n=t.g/255,i=t.b/255,r=(il*i+el*e-nl*n)/(il+el-nl),s=i-r,o=(tl*(n-r)-Qa*s)/Ka,a=Math.sqrt(o*o+s*s)/(tl*r*(1-r)),l=a?Math.atan2(o,s)*Ha-120:NaN;return new ol(l<0?l+360:l,a,r,t.opacity)}function sl(t,e,n,i){return 1===arguments.length?rl(t):new ol(t,e,n,null==i?1:i)}function ol(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}da(ol,sl,ga(pa,{brighter(t){return t=null==t?ya:Math.pow(ya,t),new ol(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?_a:Math.pow(_a,t),new ol(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=isNaN(this.h)?0:(this.h+120)*Va,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),i=Math.cos(t),r=Math.sin(t);return new Da(255*(e+n*(Ja*i+Za*r)),255*(e+n*(Qa*i+Ka*r)),255*(e+n*(tl*i)),this.opacity)}}));var al=t=>()=>t;function ll(t,e){return function(n){return t+n*e}}function cl(t){return 1==(t=+t)?hl:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}(e,n,t):al(isNaN(e)?n:e)}}function hl(t,e){var n=e-t;return n?ll(t,n):al(isNaN(t)?e:t)}var ul=function t(e){var n=cl(e);function i(t,e){var i=n((t=Pa(t)).r,(e=Pa(e)).r),r=n(t.g,e.g),s=n(t.b,e.b),o=hl(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=r(e),t.b=s(e),t.opacity=o(e),t+""}}return i.gamma=t,i}(1);var fl,dl=(fl=function(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],s=t[i+1],o=i>0?t[i-1]:2*r-s,a=i<e-1?t[i+2]:2*s-r;return function(t,e,n,i,r){var s=t*t,o=s*t;return((1-3*t+3*s-o)*e+(4-6*s+3*o)*n+(1+3*t+3*s-3*o)*i+o*r)/6}((n-i/e)*e,o,r,s,a)}},function(t){var e,n,i=t.length,r=new Array(i),s=new Array(i),o=new Array(i);for(e=0;e<i;++e)n=Pa(t[e]),r[e]=n.r||0,s[e]=n.g||0,o[e]=n.b||0;return r=fl(r),s=fl(s),o=fl(o),n.opacity=1,function(t){return n.r=r(t),n.g=s(t),n.b=o(t),n+""}});function gl(t,e){e||(e=[]);var n,i=t?Math.min(e.length,t.length):0,r=e.slice();return function(s){for(n=0;n<i;++n)r[n]=t[n]*(1-s)+e[n]*s;return r}}function pl(t,e){var n,i=e?e.length:0,r=t?Math.min(i,t.length):0,s=new Array(r),o=new Array(i);for(n=0;n<r;++n)s[n]=Ml(t[n],e[n]);for(;n<i;++n)o[n]=e[n];return function(t){for(n=0;n<r;++n)o[n]=s[n](t);return o}}function _l(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function yl(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function ml(t,e){var n,i={},r={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?i[n]=Ml(t[n],e[n]):r[n]=e[n];return function(t){for(n in i)r[n]=i[n](t);return r}}var xl=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,vl=new RegExp(xl.source,"g");function bl(t,e){var n,i,r,s=xl.lastIndex=vl.lastIndex=0,o=-1,a=[],l=[];for(t+="",e+="";(n=xl.exec(t))&&(i=vl.exec(e));)(r=i.index)>s&&(r=e.slice(s,r),a[o]?a[o]+=r:a[++o]=r),(n=n[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,l.push({i:o,x:yl(n,i)})),s=vl.lastIndex;return s<e.length&&(r=e.slice(s),a[o]?a[o]+=r:a[++o]=r),a.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,i=0;i<e;++i)a[(n=l[i]).i]=n.x(t);return a.join("")})}function Ml(t,e){var n,i=typeof e;return null==e||"boolean"===i?al(e):("number"===i?yl:"string"===i?(n=Aa(e))?(e=n,ul):bl:e instanceof Aa?ul:e instanceof Date?_l:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}(e)?gl:Array.isArray(e)?pl:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?ml:yl)(t,e)}function wl(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var El,Sl=180/Math.PI,Nl={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Il(t,e,n,i,r,s){var o,a,l;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(l=t*n+e*i)&&(n-=t*l,i-=e*l),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,l/=a),t*i<e*n&&(t=-t,e=-e,l=-l,o=-o),{translateX:r,translateY:s,rotate:Math.atan2(e,t)*Sl,skewX:Math.atan(l)*Sl,scaleX:o,scaleY:a}}function kl(t,e,n,i){function r(t){return t.length?t.pop()+" ":""}return function(s,o){var a=[],l=[];return s=t(s),o=t(o),function(t,i,r,s,o,a){if(t!==r||i!==s){var l=o.push("translate(",null,e,null,n);a.push({i:l-4,x:yl(t,r)},{i:l-2,x:yl(i,s)})}else(r||s)&&o.push("translate("+r+e+s+n)}(s.translateX,s.translateY,o.translateX,o.translateY,a,l),function(t,e,n,s){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),s.push({i:n.push(r(n)+"rotate(",null,i)-2,x:yl(t,e)})):e&&n.push(r(n)+"rotate("+e+i)}(s.rotate,o.rotate,a,l),function(t,e,n,s){t!==e?s.push({i:n.push(r(n)+"skewX(",null,i)-2,x:yl(t,e)}):e&&n.push(r(n)+"skewX("+e+i)}(s.skewX,o.skewX,a,l),function(t,e,n,i,s,o){if(t!==n||e!==i){var a=s.push(r(s)+"scale(",null,",",null,")");o.push({i:a-4,x:yl(t,n)},{i:a-2,x:yl(e,i)})}else 1===n&&1===i||s.push(r(s)+"scale("+n+","+i+")")}(s.scaleX,s.scaleY,o.scaleX,o.scaleY,a,l),s=o=null,function(t){for(var e,n=-1,i=l.length;++n<i;)a[(e=l[n]).i]=e.x(t);return a.join("")}}}var Ol=kl((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Nl:Il(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),Cl=kl((function(t){return null==t?Nl:(El||(El=document.createElementNS("http://www.w3.org/2000/svg","g")),El.setAttribute("transform",t),(t=El.transform.baseVal.consolidate())?Il((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Nl)}),", ",")",")");function Al(t){return function e(n){function i(e,i){var r=t((e=sl(e)).h,(i=sl(i)).h),s=hl(e.s,i.s),o=hl(e.l,i.l),a=hl(e.opacity,i.opacity);return function(t){return e.h=r(t),e.s=s(t),e.l=o(Math.pow(t,n)),e.opacity=a(t),e+""}}return n=+n,i.gamma=e,i}(1)}Al((function(t,e){var n=e-t;return n?ll(t,n>180||n<-180?n-360*Math.round(n/360):n):al(isNaN(t)?e:t)}));var Tl=Al(hl);function Rl(t,e){void 0===e&&(e=t,t=Ml);for(var n=0,i=e.length-1,r=e[0],s=new Array(i<0?0:i);n<i;)s[n]=t(r,r=e[++n]);return function(t){var e=Math.max(0,Math.min(i-1,Math.floor(t*=i)));return s[e](t-e)}}function Ll(t,e){var n,i;return function(){var r=ua(this,t),s=r.tween;if(s!==n)for(var o=0,a=(i=n=s).length;o<a;++o)if(i[o].name===e){(i=i.slice()).splice(o,1);break}r.tween=i}}function Pl(t,e,n){var i,r;if("function"!=typeof n)throw new Error;return function(){var s=ua(this,t),o=s.tween;if(o!==i){r=(i=o).slice();for(var a={name:e,value:n},l=0,c=r.length;l<c;++l)if(r[l].name===e){r[l]=a;break}l===c&&r.push(a)}s.tween=r}}function Dl(t,e,n){var i=t._id;return t.each((function(){var t=ua(this,i);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return fa(t,i).value[e]}}function zl(t,e){var n;return("number"==typeof e?yl:e instanceof Aa?ul:(n=Aa(e))?(e=n,ul):bl)(t,e)}function Fl(t){return function(){this.removeAttribute(t)}}function Gl(t){return function(){this.removeAttributeNS(t.space,t.local)}}function jl(t,e,n){var i,r,s=n+"";return function(){var o=this.getAttribute(t);return o===s?null:o===i?r:r=e(i=o,n)}}function ql(t,e,n){var i,r,s=n+"";return function(){var o=this.getAttributeNS(t.space,t.local);return o===s?null:o===i?r:r=e(i=o,n)}}function Bl(t,e,n){var i,r,s;return function(){var o,a,l=n(this);if(null!=l)return(o=this.getAttribute(t))===(a=l+"")?null:o===i&&a===r?s:(r=a,s=e(i=o,l));this.removeAttribute(t)}}function Yl(t,e,n){var i,r,s;return function(){var o,a,l=n(this);if(null!=l)return(o=this.getAttributeNS(t.space,t.local))===(a=l+"")?null:o===i&&a===r?s:(r=a,s=e(i=o,l));this.removeAttributeNS(t.space,t.local)}}function $l(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Ul(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Wl(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&Ul(t,r)),n}return r._value=e,r}function Xl(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&$l(t,r)),n}return r._value=e,r}function Vl(t,e){return function(){ha(this,t).delay=+e.apply(this,arguments)}}function Hl(t,e){return e=+e,function(){ha(this,t).delay=e}}function Jl(t,e){return function(){ua(this,t).duration=+e.apply(this,arguments)}}function Zl(t,e){return e=+e,function(){ua(this,t).duration=e}}function Ql(t,e){if("function"!=typeof e)throw new Error;return function(){ua(this,t).ease=e}}function Kl(t,e,n){var i,r,s=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?ha:ua;return function(){var o=s(this,t),a=o.on;a!==i&&(r=(i=a).copy()).on(e,n),o.on=r}}var tc=ko.prototype.constructor;function ec(t){return function(){this.style.removeProperty(t)}}function nc(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function ic(t,e,n){var i,r;function s(){var s=e.apply(this,arguments);return s!==r&&(i=(r=s)&&nc(t,s,n)),i}return s._value=e,s}function rc(t){return function(e){this.textContent=t.call(this,e)}}function sc(t){var e,n;function i(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&rc(i)),e}return i._value=t,i}var oc=0;function ac(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function lc(t){return ko().transition(t)}function cc(){return++oc}var hc=ko.prototype;ac.prototype=lc.prototype={constructor:ac,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=bs(t));for(var i=this._groups,r=i.length,s=new Array(r),o=0;o<r;++o)for(var a,l,c=i[o],h=c.length,u=s[o]=new Array(h),f=0;f<h;++f)(a=c[f])&&(l=t.call(a,a.__data__,f,c))&&("__data__"in a&&(l.__data__=a.__data__),u[f]=l,ca(u[f],e,n,f,u,fa(a,n)));return new ac(s,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Es(t));for(var i=this._groups,r=i.length,s=[],o=[],a=0;a<r;++a)for(var l,c=i[a],h=c.length,u=0;u<h;++u)if(l=c[u]){for(var f,d=t.call(l,l.__data__,u,c),g=fa(l,n),p=0,_=d.length;p<_;++p)(f=d[p])&&ca(f,e,n,p,d,g);s.push(d),o.push(l)}return new ac(s,o,e,n)},selectChild:hc.selectChild,selectChildren:hc.selectChildren,filter:function(t){"function"!=typeof t&&(t=Ss(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s,o=e[r],a=o.length,l=i[r]=[],c=0;c<a;++c)(s=o[c])&&t.call(s,s.__data__,c,o)&&l.push(s);return new ac(i,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,s=Math.min(i,r),o=new Array(i),a=0;a<s;++a)for(var l,c=e[a],h=n[a],u=c.length,f=o[a]=new Array(u),d=0;d<u;++d)(l=c[d]||h[d])&&(f[d]=l);for(;a<i;++a)o[a]=e[a];return new ac(o,this._parents,this._name,this._id)},selection:function(){return new tc(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=cc(),i=this._groups,r=i.length,s=0;s<r;++s)for(var o,a=i[s],l=a.length,c=0;c<l;++c)if(o=a[c]){var h=fa(o,e);ca(o,t,n,c,a,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new ac(i,this._parents,t,n)},call:hc.call,nodes:hc.nodes,node:hc.node,size:hc.size,empty:hc.empty,each:hc.each,on:function(t,e){var n=this._id;return arguments.length<2?fa(this.node(),n).on.on(t):this.each(Kl(n,t,e))},attr:function(t,e){var n=_s(t),i="transform"===n?Cl:zl;return this.attrTween(t,"function"==typeof e?(n.local?Yl:Bl)(n,i,Dl(this,"attr."+t,e)):null==e?(n.local?Gl:Fl)(n):(n.local?ql:jl)(n,i,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var i=_s(t);return this.tween(n,(i.local?Wl:Xl)(i,e))},style:function(t,e,n){var i="transform"==(t+="")?Ol:zl;return null==e?this.styleTween(t,function(t,e){var n,i,r;return function(){var s=Hs(this,t),o=(this.style.removeProperty(t),Hs(this,t));return s===o?null:s===n&&o===i?r:r=e(n=s,i=o)}}(t,i)).on("end.style."+t,ec(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var i,r,s;return function(){var o=Hs(this,t),a=n(this),l=a+"";return null==a&&(this.style.removeProperty(t),l=a=Hs(this,t)),o===l?null:o===i&&l===r?s:(r=l,s=e(i=o,a))}}(t,i,Dl(this,"style."+t,e))).each(function(t,e){var n,i,r,s,o="style."+e,a="end."+o;return function(){var l=ua(this,t),c=l.on,h=null==l.value[o]?s||(s=ec(e)):void 0;c===n&&r===h||(i=(n=c).copy()).on(a,r=h),l.on=i}}(this._id,t)):this.styleTween(t,function(t,e,n){var i,r,s=n+"";return function(){var o=Hs(this,t);return o===s?null:o===i?r:r=e(i=o,n)}}(t,i,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;return this.tween(i,ic(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(Dl(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,sc(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i,r=fa(this.node(),n).tween,s=0,o=r.length;s<o;++s)if((i=r[s]).name===t)return i.value;return null}return this.each((null==e?Ll:Pl)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Vl:Hl)(e,t)):fa(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Jl:Zl)(e,t)):fa(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(Ql(e,t)):fa(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;ua(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,i=n._id,r=n.size();return new Promise((function(s,o){var a={value:o},l={value:function(){0==--r&&s()}};n.each((function(){var n=ua(this,i),r=n.on;r!==t&&((e=(t=r).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),n.on=e})),0===r&&s()}))},[Symbol.iterator]:hc[Symbol.iterator]};var uc={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function fc(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}ko.prototype.interrupt=function(t){return this.each((function(){!function(t,e){var n,i,r,s=t.__transition,o=!0;if(s){for(r in e=null==e?null:e+"",s)(n=s[r]).name===e?(i=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete s[r]):o=!1;o&&delete t.__transition}}(this,t)}))},ko.prototype.transition=function(t){var e,n;t instanceof ac?(e=t._id,t=t._name):(e=cc(),(n=uc).time=Ko(),t=null==t?null:t+"");for(var i=this._groups,r=i.length,s=0;s<r;++s)for(var o,a=i[s],l=a.length,c=0;c<l;++c)(o=a[c])&&ca(o,t,e,c,a,n||fc(o,e));return new ac(i,this._parents,t,e)};const dc=Object.assign({},{geoPath:Mr,geoBounds:un});function gc(t){return t}function pc(t,e){var n=e.id,i=e.bbox,r=null==e.properties?{}:e.properties,s=_c(t,e);return null==n&&null==i?{type:"Feature",properties:r,geometry:s}:null==i?{type:"Feature",id:n,properties:r,geometry:s}:{type:"Feature",id:n,bbox:i,properties:r,geometry:s}}function _c(t,e){var n=function(t){if(null==t)return gc;var e,n,i=t.scale[0],r=t.scale[1],s=t.translate[0],o=t.translate[1];return function(t,a){a||(e=n=0);var l=2,c=t.length,h=new Array(c);for(h[0]=(e+=t[0])*i+s,h[1]=(n+=t[1])*r+o;l<c;)h[l]=t[l],++l;return h}}(t.transform),i=t.arcs;function r(t,e){e.length&&e.pop();for(var r=i[t<0?~t:t],s=0,o=r.length;s<o;++s)e.push(n(r[s],s));t<0&&function(t,e){for(var n,i=t.length,r=i-e;r<--i;)n=t[r],t[r++]=t[i],t[i]=n}(e,o)}function s(t){return n(t)}function o(t){for(var e=[],n=0,i=t.length;n<i;++n)r(t[n],e);return e.length<2&&e.push(e[0]),e}function a(t){for(var e=o(t);e.length<4;)e.push(e[0]);return e}function l(t){return t.map(a)}return function t(e){var n,i=e.type;switch(i){case"GeometryCollection":return{type:i,geometries:e.geometries.map(t)};case"Point":n=s(e.coordinates);break;case"MultiPoint":n=e.coordinates.map(s);break;case"LineString":n=o(e.arcs);break;case"MultiLineString":n=e.arcs.map(o);break;case"Polygon":n=l(e.arcs);break;case"MultiPolygon":n=e.arcs.map(l);break;default:return null}return{type:i,coordinates:n}}(e)}function yc(t,e){var n={},i={},r={},s=[],o=-1;function a(t,e){for(var i in t){var r=t[i];delete e[r.start],delete r.start,delete r.end,r.forEach((function(t){n[t<0?~t:t]=1})),s.push(r)}}return e.forEach((function(n,i){var r,s=t.arcs[n<0?~n:n];s.length<3&&!s[1][0]&&!s[1][1]&&(r=e[++o],e[o]=n,e[i]=r)})),e.forEach((function(e){var n,s,o=function(e){var n,i=t.arcs[e<0?~e:e],r=i[0];t.transform?(n=[0,0],i.forEach((function(t){n[0]+=t[0],n[1]+=t[1]}))):n=i[i.length-1];return e<0?[n,r]:[r,n]}(e),a=o[0],l=o[1];if(n=r[a])if(delete r[n.end],n.push(e),n.end=l,s=i[l]){delete i[s.start];var c=s===n?n:n.concat(s);i[c.start=n.start]=r[c.end=s.end]=c}else i[n.start]=r[n.end]=n;else if(n=i[l])if(delete i[n.start],n.unshift(e),n.start=a,s=r[a]){delete r[s.end];var h=s===n?n:s.concat(n);i[h.start=s.start]=r[h.end=n.end]=h}else i[n.start]=r[n.end]=n;else i[(n=[e]).start=a]=r[n.end=l]=n})),a(r,i),a(i,r),e.forEach((function(t){n[t<0?~t:t]||s.push([t])})),s}function mc(t,e,n){var i,r,s;if(arguments.length>1)i=xc(t,e,n);else for(r=0,i=new Array(s=t.arcs.length);r<s;++r)i[r]=r;return{type:"MultiLineString",arcs:yc(t,i)}}function xc(t,e,n){var i,r=[],s=[];function o(t){var e=t<0?~t:t;(s[e]||(s[e]=[])).push({i:t,g:i})}function a(t){t.forEach(o)}function l(t){t.forEach(a)}return function t(e){switch(i=e,e.type){case"GeometryCollection":e.geometries.forEach(t);break;case"LineString":a(e.arcs);break;case"MultiLineString":case"Polygon":l(e.arcs);break;case"MultiPolygon":!function(t){t.forEach(l)}(e.arcs)}}(e),s.forEach(null==n?function(t){r.push(t[0].i)}:function(t){n(t[0].g,t[t.length-1].g)&&r.push(t[0].i)}),r}function vc(t,e){for(var n=0,i=t.length;n<i;){var r=n+i>>>1;t[r]<e?n=r+1:i=r}return n}const bc=Object.assign({},{feature:function(t,e){return"string"==typeof e&&(e=t.objects[e]),"GeometryCollection"===e.type?{type:"FeatureCollection",features:e.geometries.map((function(e){return pc(t,e)}))}:pc(t,e)}});function Mc(t){return"Topology"!=(t=JSON.parse(JSON.stringify(t))).type||Array.isArray(t)?"FeatureCollection"!=t.type||Array.isArray(t)?Array.isArray(t)&&null!=t[0].type&&null!=t[0].properties&&null!=t[0].geometry?{type:"FeatureCollection",features:t}:Array.isArray(t)&&null!=t[0].type&&null!=t[0].coordinates?{type:"FeatureCollection",features:t.map((t=>({type:"Feature",properties:{},geometry:t})))}:"object"==typeof t&&["Point","LineString","Polygon","MultiPoint","MultiLineString","MultiPolygon"].includes(t.type)?{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:t}]}:"object"==typeof t&&"Feature"==t.type?{type:"FeatureCollection",features:[t]}:t:t:bc.feature(t,Object.keys(t.objects)[0])}const wc=Object.assign({},{geoEquirectangularRaw:Jr,geoBounds:un});function Ec(t){let e;e=Array.isArray(t)?t:wc.geoBounds(Mc(t));let n=e[0][0],i=e[0][1],r=e[1][0],s=e[1][1];const o={type:"FeatureCollection",features:[{type:"Feature",properties:{id:1},geometry:{type:"Polygon",coordinates:-90===i?[[[n,s],[r,s]]]:[[[n,i],[n,s],[r+=360*(r<n),s],[r,i],[n,i]]]}}]};return Sc(wc.geoEquirectangularRaw,.02)(o)}const Sc=(t,e)=>{const n=Math.PI/180,i=Math.tan(n*e/2)**2,r=function(e,n,s,o,a,l,c){if(l--){var h=Ic(e,s),u=t.invert(...h),f=Oc(u),d=Cc(f,n),g=Cc(f,o);Nc(f,n,o)*(1+.25*a)*(1+.25*a)/(i*a)+(d-g)/a*2*((d-g)/a)>1&d+g>i|d+g>.25&&(r(e,n,h,f,d,l,c),c.push(u),r(h,f,s,o,g,l,c))}},s=e=>{let n=[],i=e[0],s=t.invert(...i),o=Oc(s);n.push(s);for(var a=1,l=e.length;a<l;a++){let s=e[a],l=t.invert(...s),c=Oc(l);r(i,o,s,c,Cc(o,c),16,n),n.push(l),i=s,o=c}return n};let o,a=e=>t.invert(...e),l=t=>e=>e.forEach(((n,i)=>e[i]=t(n))),c={Point:t=>t.coordinates=a(t.coordinates),MultiPoint:t=>l(a)(t.coordinates),LineString:t=>t.coordinates=s(t.coordinates),Polygon:t=>l(s)(t.coordinates),MultiLineString:t=>l(s)(t.coordinates),MultiPolygon:t=>t.coordinates.forEach(l(s)),Feature:t=>o(t.geometry),GeometryCollection:t=>t.geometries.forEach(o),FeatureCollection:t=>t.features.forEach(o)};return o=t=>(c[t.type](t),t),function(t){return t=JSON.parse(JSON.stringify(t)),o(t)}},Nc=([t,e,n],[i,r,s],[o,a,l])=>{var c=t*((r-e)*(l-n)-(a-e)*(s-n))+e*((s-n)*(o-t)-(l-n)*(i-t))+n*((i-t)*(a-e)-(o-t)*(r-e)),h=(t+o)*(t+i)+(e+a)*(e+r)+(n+l)*(n+s);return(c*c+!(h*h))/(h*h)},Ic=([t,e],[n,i])=>[.5*(t+n),.5*(e+i)],kc=Math.PI/180,Oc=([t,e])=>[Math.cos(kc*e)*Math.cos(kc*t),Math.cos(kc*e)*Math.sin(kc*t),Math.sin(kc*e)],Cc=([t,e,n],[i,r,s])=>{var o=t*(r-e)-(i-t)*e,a=e*(s-n)-(r-e)*n,l=n*(i-t)-(s-n)*t,c=t*(i+t)+e*(r+e)+n*(s+n);return(o*o+a*a+l*l+!(c*c))/(c*c)};var Ac=Math.abs,Tc=Math.atan,Rc=Math.atan2,Lc=Math.cos,Pc=Math.exp,Dc=Math.floor,zc=Math.log,Fc=Math.max,Gc=Math.min,jc=Math.pow,qc=Math.round,Bc=Math.sign||function(t){return t>0?1:t<0?-1:0},Yc=Math.sin,$c=Math.tan,Uc=1e-6,Wc=1e-12,Xc=Math.PI,Vc=Xc/2,Hc=Xc/4,Jc=Math.SQRT1_2,Zc=rh(2),Qc=rh(Xc),Kc=2*Xc,th=180/Xc,eh=Xc/180;function nh(t){return t>1?Vc:t<-1?-Vc:Math.asin(t)}function ih(t){return t>1?0:t<-1?Xc:Math.acos(t)}function rh(t){return t>0?Math.sqrt(t):0}function sh(t){return(Pc(t)-Pc(-t))/2}function oh(t){return(Pc(t)+Pc(-t))/2}function ah(t){var e=$c(t/2),n=2*zc(Lc(t/2))/(e*e);function i(t,e){var i=Lc(t),r=Lc(e),s=Yc(e),o=r*i,a=-((1-o?zc((1+o)/2)/(1-o):-.5)+n/(1+o));return[a*r*Yc(t),a*s]}return i.invert=function(e,i){var r,s=rh(e*e+i*i),o=-t/2,a=50;if(!s)return[0,0];do{var l=o/2,c=Lc(l),h=Yc(l),u=h/c,f=-zc(Ac(c));o-=r=(2/u*f-n*u-s)/(-f/(h*h)+1-n/(2*c*c))*(c<0?.7:1)}while(Ac(r)>Uc&&--a>0);var d=Yc(o);return[Rc(e*d,s*Lc(o)),nh(i*d/s)]},i}function lh(t,e){var n=Lc(e),i=function(t){return t?t/Math.sin(t):1}(ih(n*Lc(t/=2)));return[2*n*Yc(t)*i,Yc(e)*i]}function ch(t){var e=Yc(t),n=Lc(t),i=t>=0?1:-1,r=$c(i*t),s=(1+e-n)/2;function o(t,o){var a=Lc(o),l=Lc(t/=2);return[(1+a)*Yc(t),(i*o>-Rc(l,r)-.001?0:10*-i)+s+Yc(o)*n-(1+a)*e*l]}return o.invert=function(t,o){var a=0,l=0,c=50;do{var h=Lc(a),u=Yc(a),f=Lc(l),d=Yc(l),g=1+f,p=g*u-t,_=s+d*n-g*e*h-o,y=g*h/2,m=-u*d,x=e*g*u/2,v=n*f+e*h*d,b=m*x-v*y,M=(_*m-p*v)/b/2,w=(p*x-_*y)/b;Ac(w)>2&&(w/=2),a-=M,l-=w}while((Ac(M)>Uc||Ac(w)>Uc)&&--c>0);return i*l>-Rc(Lc(a),r)-.001?[2*a,l]:null},o}function hh(t,e){var n=$c(e/2),i=rh(1-n*n),r=1+i*Lc(t/=2),s=Yc(t)*i/r,o=n/r,a=s*s,l=o*o;return[4/3*s*(3+a-3*l),4/3*o*(3+3*a-l)]}lh.invert=function(t,e){if(!(t*t+4*e*e>Xc*Xc+Uc)){var n=t,i=e,r=25;do{var s,o=Yc(n),a=Yc(n/2),l=Lc(n/2),c=Yc(i),h=Lc(i),u=Yc(2*i),f=c*c,d=h*h,g=a*a,p=1-d*l*l,_=p?ih(h*l)*rh(s=1/p):s=0,y=2*_*h*a-t,m=_*c-e,x=s*(d*g+_*h*l*f),v=s*(.5*o*u-2*_*c*a),b=.25*s*(u*a-_*c*d*o),M=s*(f*l+_*g*h),w=v*b-M*x;if(!w)break;var E=(m*v-y*M)/w,S=(y*b-m*x)/w;n-=E,i-=S}while((Ac(E)>Uc||Ac(S)>Uc)&&--r>0);return[n,i]}},hh.invert=function(t,e){if(e*=3/8,!(t*=3/8)&&Ac(e)>1)return null;var n=1+t*t+e*e,i=rh((n-rh(n*n-4*e*e))/2),r=nh(i)/3,s=i?function(t){return zc(t+rh(t*t-1))}(Ac(e/i))/3:function(t){return zc(t+rh(t*t+1))}(Ac(t))/3,o=Lc(r),a=oh(s),l=a*a-o*o;return[2*Bc(t)*Rc(sh(s)*o,.25-l),2*Bc(e)*Rc(a*Yc(r),.25+l)]};var uh=rh(8),fh=zc(1+Zc);function dh(t,e){var n=Ac(e);return n<Hc?[t,zc($c(Hc+e/2))]:[t*Lc(n)*(2*Zc-1/Yc(n)),Bc(e)*(2*Zc*(n-Hc)-zc($c(n/2)))]}function gh(t){var e=2*Xc/t;function n(t,n){var i=Yr(t,n);if(Ac(t)>Vc){var r=Rc(i[1],i[0]),s=rh(i[0]*i[0]+i[1]*i[1]),o=e*qc((r-Vc)/e)+Vc,a=Rc(Yc(r-=o),2-Lc(r));r=o+nh(Xc/s*Yc(a))-a,i[0]=s*Lc(r),i[1]=s*Yc(r)}return i}return n.invert=function(t,n){var i=rh(t*t+n*n);if(i>Vc){var r=Rc(n,t),s=e*qc((r-Vc)/e)+Vc,o=r>s?-1:1,a=i*Lc(s-r),l=1/$c(o*ih((a-Xc)/rh(Xc*(Xc-2*a)+i*i)));r=s+2*Tc((l+o*rh(l*l-3))/3),t=i*Lc(r),n=i*Yc(r)}return Yr.invert(t,n)},n}function ph(t,e){if(arguments.length<2&&(e=t),1===e)return Br;if(e===1/0)return _h;function n(n,i){var r=Br(n/e,i);return r[0]*=t,r}return n.invert=function(n,i){var r=Br.invert(n/t,i);return r[0]*=e,r},n}function _h(t,e){return[t*Lc(e)/Lc(e/=2),2*Yc(e)]}function yh(t,e,n){var i,r,s,o=100;n=void 0===n?0:+n,e=+e;do{(r=t(n))===(s=t(n+Uc))&&(s=r+Uc),n-=i=-1e-6*(r-e)/(r-s)}while(o-- >0&&Ac(i)>Uc);return o<0?NaN:n}function mh(t,e,n){return void 0===e&&(e=40),void 0===n&&(n=Wc),function(i,r,s,o){var a,l,c;s=void 0===s?0:+s,o=void 0===o?0:+o;for(var h=0;h<e;h++){var u=t(s,o),f=u[0]-i,d=u[1]-r;if(Ac(f)<n&&Ac(d)<n)break;var g=f*f+d*d;if(g>a)s-=l/=2,o-=c/=2;else{a=g;var p=(s>0?-1:1)*n,_=(o>0?-1:1)*n,y=t(s+p,o),m=t(s,o+_),x=(y[0]-u[0])/p,v=(y[1]-u[1])/p,b=(m[0]-u[0])/_,M=(m[1]-u[1])/_,w=M*x-v*b,E=(Ac(w)<.5?.5:1)/w;if(s+=l=(d*b-f*M)*E,o+=c=(f*v-d*x)*E,Ac(l)<n&&Ac(c)<n)break}}return[s,o]}}function xh(){var t=ph(1.68,2);function e(e,n){if(e+n<-1.4){var i=(e-n+1.6)*(e+n+1.4)/8;e+=i,n-=.8*i*Yc(n+Xc/2)}var r=t(e,n),s=(1-Lc(e*n))/12;return r[1]<0&&(r[0]*=1+s),r[1]>0&&(r[1]*=1+s/1.5*r[0]*r[0]),r}return e.invert=mh(e),e}function vh(t,e){var n,i=t*Yc(e),r=30;do{e-=n=(e+Yc(e)-i)/(1+Lc(e))}while(Ac(n)>Uc&&--r>0);return e/2}function bh(t,e,n){function i(i,r){return[t*i*Lc(r=vh(n,r)),e*Yc(r)]}return i.invert=function(i,r){return r=nh(r/e),[i/(t*Lc(r)),nh((2*r+Yc(2*r))/n)]},i}dh.invert=function(t,e){if((i=Ac(e))<fh)return[t,2*Tc(Pc(e))-Vc];var n,i,r=Hc,s=25;do{var o=Lc(r/2),a=$c(r/2);r-=n=(uh*(r-Hc)-zc(a)-i)/(uh-o*o/(2*a))}while(Ac(n)>Wc&&--s>0);return[t/(Lc(r)*(uh-1/Yc(r))),Bc(e)*r]},_h.invert=function(t,e){var n=2*nh(e/2);return[t*Lc(n/2)/Lc(n),n]};var Mh=bh(Zc/Vc,Zc,Xc);var wh=2.00276,Eh=1.11072;function Sh(t,e){var n=vh(Xc,e);return[wh*t/(1/Lc(e)+Eh/Lc(n)),(e+Zc*Yc(n))/wh]}function Nh(t){var e=0,n=Pr(t),i=n(e);return i.parallel=function(t){return arguments.length?n(e=t*eh):e*th},i}function Ih(t,e){return[t*Lc(e),e]}function kh(t){if(!t)return Ih;var e=1/$c(t);function n(n,i){var r=e+t-i,s=r?n*Lc(i)/r:r;return[r*Yc(s),e-r*Lc(s)]}return n.invert=function(n,i){var r=rh(n*n+(i=e-i)*i),s=e+t-r;return[r/Lc(s)*Rc(n,i),s]},n}function Oh(t){function e(e,n){var i=Vc-n,r=i?e*t*Yc(i)/i:i;return[i*Yc(r)/t,Vc-i*Lc(r)]}return e.invert=function(e,n){var i=e*t,r=Vc-n,s=rh(i*i+r*r),o=Rc(i,r);return[(s?s/Yc(s):1)*o/t,Vc-s]},e}Sh.invert=function(t,e){var n,i,r=wh*e,s=e<0?-Hc:Hc,o=25;do{i=r-Zc*Yc(s),s-=n=(Yc(2*s)+2*s-Xc*Yc(i))/(2*Lc(2*s)+2+Xc*Lc(i)*Zc*Lc(s))}while(Ac(n)>Uc&&--o>0);return i=r-Zc*Yc(s),[t*(1/Lc(i)+Eh/Lc(s))/wh,i]},Ih.invert=function(t,e){return[t/Lc(e),e]};var Ch=bh(1,4/Xc,Xc);function Ah(t,e,n,i,r,s){var o,a=Lc(s);if(Ac(t)>1||Ac(s)>1)o=ih(n*r+e*i*a);else{var l=Yc(t/2),c=Yc(s/2);o=2*nh(rh(l*l+e*i*c*c))}return Ac(o)>Uc?[o,Rc(i*Yc(s),e*r-n*i*a)]:[0,0]}function Th(t,e,n){return ih((t*t+e*e-n*n)/(2*t*e))}function Rh(t){return t-2*Xc*Dc((t+Xc)/(2*Xc))}function Lh(t,e,n){for(var i,r=[[t[0],t[1],Yc(t[1]),Lc(t[1])],[e[0],e[1],Yc(e[1]),Lc(e[1])],[n[0],n[1],Yc(n[1]),Lc(n[1])]],s=r[2],o=0;o<3;++o,s=i)i=r[o],s.v=Ah(i[1]-s[1],s[3],s[2],i[3],i[2],i[0]-s[0]),s.point=[0,0];var a=Th(r[0].v[0],r[2].v[0],r[1].v[0]),l=Th(r[0].v[0],r[1].v[0],r[2].v[0]),c=Xc-a;r[2].point[1]=0,r[0].point[0]=-(r[1].point[0]=r[0].v[0]/2);var h=[r[2].point[0]=r[0].point[0]+r[2].v[0]*Lc(a),2*(r[0].point[1]=r[1].point[1]=r[2].v[0]*Yc(a))];return function(t,e){var n,i=Yc(e),s=Lc(e),o=new Array(3);for(n=0;n<3;++n){var a=r[n];if(o[n]=Ah(e-a[1],a[3],a[2],s,i,t-a[0]),!o[n][0])return a.point;o[n][1]=Rh(o[n][1]-a.v[1])}var u=h.slice();for(n=0;n<3;++n){var f=2==n?0:n+1,d=Th(r[n].v[0],o[n][0],o[f][0]);o[n][1]<0&&(d=-d),n?1==n?(d=l-d,u[0]-=o[n][0]*Lc(d),u[1]-=o[n][0]*Yc(d)):(d=c-d,u[0]+=o[n][0]*Lc(d),u[1]+=o[n][0]*Yc(d)):(u[0]+=o[n][0]*Lc(d),u[1]-=o[n][0]*Yc(d))}return u[0]/=3,u[1]/=3,u}}function Ph(t){return t[0]*=eh,t[1]*=eh,t}function Dh(t,e,n){var i=wn({type:"MultiPoint",coordinates:[t,e,n]}),r=[-i[0],-i[1]],s=An(r),o=Lh(Ph(s(t)),Ph(s(e)),Ph(s(n)));o.invert=mh(o);var a=Lr(o).rotate(r),l=a.center;return delete a.rotate,a.center=function(t){return arguments.length?l(s(t)):s.invert(l())},a.clipAngle(90)}function zh(t,e){var n=rh(1-Yc(e));return[2/Qc*t*n,Qc*(1-n)]}function Fh(t){var e=$c(t);function n(t,n){return[t,(t?t/Yc(t):1)*(Yc(n)*Lc(t)-e*Lc(n))]}return n.invert=e?function(t,n){t&&(n*=Yc(t)/t);var i=Lc(t);return[t,2*Rc(rh(i*i+e*e-n*n)-i,e-n)]}:function(t,e){return[t,nh(t?e*$c(t)/t:e)]},n}zh.invert=function(t,e){var n=(n=e/Qc-1)*n;return[n>0?t*rh(Xc/n)/2:0,nh(1-n)]};var Gh=rh(3);function jh(t,e){return[Gh*t*(2*Lc(2*e/3)-1)/Qc,Gh*Qc*Yc(e/3)]}function qh(t){var e=Lc(t);function n(t,n){return[t*e,Yc(n)/e]}return n.invert=function(t,n){return[t/e,nh(n*e)]},n}function Bh(t){var e=Lc(t);function n(t,n){return[t*e,(1+e)*$c(n/2)]}return n.invert=function(t,n){return[t/e,2*Tc(n/(1+e))]},n}function Yh(t,e){var n=rh(8/(3*Xc));return[n*t*(1-Ac(e)/Xc),n*e]}function $h(t,e){var n=rh(4-3*Yc(Ac(e)));return[2/rh(6*Xc)*t*n,Bc(e)*rh(2*Xc/3)*(2-n)]}function Uh(t,e){var n=rh(Xc*(4+Xc));return[2/n*t*(1+rh(1-4*e*e/(Xc*Xc))),4/n*e]}function Wh(t,e){var n=(2+Vc)*Yc(e);e/=2;for(var i=0,r=1/0;i<10&&Ac(r)>Uc;i++){var s=Lc(e);e-=r=(e+Yc(e)*(s+2)-n)/(2*s*(1+s))}return[2/rh(Xc*(4+Xc))*t*(1+Lc(e)),2*rh(Xc/(4+Xc))*Yc(e)]}function Xh(t,e){return[t*(1+Lc(e))/rh(2+Xc),2*e/rh(2+Xc)]}function Vh(t,e){for(var n=(1+Vc)*Yc(e),i=0,r=1/0;i<10&&Ac(r)>Uc;i++)e-=r=(e+Yc(e)-n)/(1+Lc(e));return n=rh(2+Xc),[t*(1+Lc(e))/n,2*e/n]}jh.invert=function(t,e){var n=3*nh(e/(Gh*Qc));return[Qc*t/(Gh*(2*Lc(2*n/3)-1)),n]},Yh.invert=function(t,e){var n=rh(8/(3*Xc)),i=e/n;return[t/(n*(1-Ac(i)/Xc)),i]},$h.invert=function(t,e){var n=2-Ac(e)/rh(2*Xc/3);return[t*rh(6*Xc)/(2*n),Bc(e)*nh((4-n*n)/3)]},Uh.invert=function(t,e){var n=rh(Xc*(4+Xc))/2;return[t*n/(1+rh(1-e*e*(4+Xc)/(4*Xc))),e*n/2]},Wh.invert=function(t,e){var n=e*rh((4+Xc)/Xc)/2,i=nh(n),r=Lc(i);return[t/(2/rh(Xc*(4+Xc))*(1+r)),nh((i+n*(r+2))/(2+Vc))]},Xh.invert=function(t,e){var n=rh(2+Xc),i=e*n/2;return[n*t/(1+Lc(i)),i]},Vh.invert=function(t,e){var n=1+Vc,i=rh(n/2);return[2*t*i/(1+Lc(e*=i)),nh((e+Yc(e))/n)]};var Hh=3+2*Zc;function Jh(t,e){var n=Yc(t/=2),i=Lc(t),r=rh(Lc(e)),s=Lc(e/=2),o=Yc(e)/(s+Zc*i*r),a=rh(2/(1+o*o)),l=rh((Zc*s+(i+n)*r)/(Zc*s+(i-n)*r));return[Hh*(a*(l-1/l)-2*zc(l)),Hh*(a*o*(l+1/l)-2*Tc(o))]}Jh.invert=function(t,e){if(!(n=hh.invert(t/1.2,1.065*e)))return null;var n,i=n[0],r=n[1],s=20;t/=Hh,e/=Hh;do{var o=i/2,a=r/2,l=Yc(o),c=Lc(o),h=Yc(a),u=Lc(a),f=Lc(r),d=rh(f),g=h/(u+Zc*c*d),p=g*g,_=rh(2/(1+p)),y=(Zc*u+(c+l)*d)/(Zc*u+(c-l)*d),m=rh(y),x=m-1/m,v=m+1/m,b=_*x-2*zc(m)-t,M=_*g*v-2*Tc(g)-e,w=h&&Jc*d*l*p/h,E=(Zc*c*u+d)/(2*(u+Zc*c*d)*(u+Zc*c*d)*d),S=-.5*g*_*_*_,N=S*w,I=S*E,k=(k=2*u+Zc*d*(c-l))*k*m,O=(Zc*c*u*d+f)/k,C=-Zc*l*h/(d*k),A=x*N-2*O/m+_*(O+O/y),T=x*I-2*C/m+_*(C+C/y),R=g*v*N-2*w/(1+p)+_*v*w+_*g*(O-O/y),L=g*v*I-2*E/(1+p)+_*v*E+_*g*(C-C/y),P=T*R-L*A;if(!P)break;var D=(M*T-b*L)/P,z=(b*R-M*A)/P;i-=D,r=Fc(-Vc,Gc(Vc,r-z))}while((Ac(D)>Uc||Ac(z)>Uc)&&--s>0);return Ac(Ac(r)-Vc)<Uc?[0,r]:s&&[i,r]};var Zh=Lc(35*eh);function Qh(t,e){var n=$c(e/2);return[t*Zh*rh(1-n*n),(1+Zh)*n]}function Kh(t,e){var n=e/2,i=Lc(n);return[2*t/Qc*Lc(e)*i*i,Qc*$c(n)]}function tu(t){var e=1-t,n=r(Xc,0)[0]-r(-Xc,0)[0],i=rh(2*(r(0,Vc)[1]-r(0,-Vc)[1])/n);function r(n,i){var r=Lc(i),s=Yc(i);return[r/(e+t*r)*n,e*i+t*s]}function s(t,e){var n=r(t,e);return[n[0]*i,n[1]/i]}function o(t){return s(0,t)[1]}return s.invert=function(n,r){var s=yh(o,r);return[n/i*(t+e/Lc(s)),s]},s}function eu(t){return[t[0]/2,nh($c(t[1]/2*eh))*th]}function nu(t){return[2*t[0],2*Tc(Yc(t[1]*eh))*th]}function iu(t,e){var n=2*Xc/e,i=t*t;function r(e,r){var s=Yr(e,r),o=s[0],a=s[1],l=o*o+a*a;if(l>i){var c=rh(l),h=Rc(a,o),u=n*qc(h/n),f=h-u,d=t*Lc(f),g=(t*Yc(f)-f*Yc(d))/(Vc-d),p=ru(f,g),_=(Xc-t)/su(p,d,Xc);o=c;var y,m=50;do{o-=y=(t+su(p,d,o)*_-c)/(p(o)*_)}while(Ac(y)>Uc&&--m>0);a=f*Yc(o),o<Vc&&(a-=g*(o-Vc));var x=Yc(u),v=Lc(u);s[0]=o*v-a*x,s[1]=o*x+a*v}return s}return r.invert=function(e,r){var s=e*e+r*r;if(s>i){var o=rh(s),a=Rc(r,e),l=n*qc(a/n),c=a-l;e=o*Lc(c),r=o*Yc(c);for(var h=e-Vc,u=Yc(e),f=r/u,d=e<Vc?1/0:0,g=10;;){var p=t*Yc(f),_=t*Lc(f),y=Yc(_),m=Vc-_,x=(p-f*y)/m,v=ru(f,x);if(Ac(d)<Wc||!--g)break;f-=d=(f*u-x*h-r)/(u-2*h*(m*(_+f*p*Lc(_)-y)-p*(p-f*y))/(m*m))}e=(o=t+su(v,_,e)*(Xc-t)/su(v,_,Xc))*Lc(a=l+f),r=o*Yc(a)}return Yr.invert(e,r)},r}function ru(t,e){return function(n){var i=t*Lc(n);return n<Vc&&(i-=e),rh(1+i*i)}}function su(t,e,n){for(var i=(n-e)/50,r=t(e)+t(n),s=1,o=e;s<50;++s)r+=2*t(o+=i);return.5*r*i}function ou(t,e,n,i,r,s,o,a){function l(l,c){if(!c)return[t*l/Xc,0];var h=c*c,u=t+h*(e+h*(n+h*i)),f=c*(r-1+h*(s-a+h*o)),d=(u*u+f*f)/(2*f),g=l*nh(u/d)/Xc;return[d*Yc(g),c*(1+h*a)+d*(1-Lc(g))]}return arguments.length<8&&(a=0),l.invert=function(l,c){var h,u,f=Xc*l/t,d=c,g=50;do{var p=d*d,_=t+p*(e+p*(n+p*i)),y=d*(r-1+p*(s-a+p*o)),m=_*_+y*y,x=2*y,v=m/x,b=v*v,M=nh(_/v)/Xc,w=f*M,E=_*_,S=(2*e+p*(4*n+6*p*i))*d,N=r+p*(3*s+5*p*o),I=(2*(_*S+y*(N-1))*x-m*(2*(N-1)))/(x*x),k=Lc(w),O=Yc(w),C=v*k,A=v*O,T=f/Xc*(1/rh(1-E/b))*(S*v-_*I)/b,R=A-l,L=d*(1+p*a)+v-C-c,P=I*O+C*T,D=C*M,z=1+I-(I*k-A*T),F=A*M,G=P*F-z*D;if(!G)break;f-=h=(L*P-R*z)/G,d-=u=(R*F-L*D)/G}while((Ac(h)>Uc||Ac(u)>Uc)&&--g>0);return[f,d]},l}Qh.invert=function(t,e){var n=e/(1+Zh);return[t&&t/(Zh*rh(1-n*n)),2*Tc(n)]},Kh.invert=function(t,e){var n=Tc(e/Qc),i=Lc(n),r=2*n;return[t*Qc/2/(Lc(r)*i*i),r]};var au=ou(2.8284,-1.6988,.75432,-.18071,1.76003,-.38914,.042555);var lu=ou(2.583819,-.835827,.170354,-.038094,1.543313,-.411435,.082742);var cu=ou(5/6*Xc,-.62636,-.0344,0,1.3493,-.05524,0,.045);function hu(t,e){var n=t*t,i=e*e;return[t*(1-.162388*i)*(.87-952426e-9*n*n),e*(1+i/12)]}hu.invert=function(t,e){var n,i=t,r=e,s=50;do{var o=r*r;r-=n=(r*(1+o/12)-e)/(1+o/4)}while(Ac(n)>Uc&&--s>0);s=50,t/=1-.162388*o;do{var a=(a=i*i)*a;i-=n=(i*(.87-952426e-9*a)-t)/(.87-.00476213*a)}while(Ac(n)>Uc&&--s>0);return[i,r]};var uu=ou(2.6516,-.76534,.19123,-.047094,1.36289,-.13965,.031762);function fu(t){var e=t(Vc,0)[0]-t(-Vc,0)[0];function n(n,i){var r=n>0?-.5:.5,s=t(n+r*Xc,i);return s[0]-=r*e,s}return t.invert&&(n.invert=function(n,i){var r=n>0?-.5:.5,s=t.invert(n+r*e,i),o=s[0]-r*Xc;return o<-Xc?o+=2*Xc:o>Xc&&(o-=2*Xc),s[0]=o,s}),n}function du(t,e){var n=Bc(t),i=Bc(e),r=Lc(e),s=Lc(t)*r,o=Yc(t)*r,a=Yc(i*e);t=Ac(Rc(o,a)),e=nh(s),Ac(t-Vc)>Uc&&(t%=Vc);var l=function(t,e){if(e===Vc)return[0,0];var n,i,r=Yc(e),s=r*r,o=s*s,a=1+o,l=1+3*o,c=1-o,h=nh(1/rh(a)),u=c+s*a*h,f=(1-r)/u,d=rh(f),g=f*a,p=rh(g),_=d*c;if(0===t)return[0,-(_+s*p)];var y,m=Lc(e),x=1/m,v=2*r*m,b=(-u*m-(-3*s+h*l)*v*(1-r))/(u*u),M=-x*v,w=-x*(s*a*b+f*l*v),E=-2*x*(c*(.5*b/d)-2*s*d*v),S=4*t/Xc;if(t>.222*Xc||e<Xc/4&&t>.175*Xc){if(n=(_+s*rh(g*(1+o)-_*_))/(1+o),t>Xc/4)return[n,n];var N=n,I=.5*n;n=.5*(I+N),i=50;do{var k=n*(E+M*rh(g-n*n))+w*nh(n/p)-S;if(!k)break;k<0?I=n:N=n,n=.5*(I+N)}while(Ac(N-I)>Uc&&--i>0)}else{n=Uc,i=25;do{var O=n*n,C=rh(g-O),A=E+M*C,T=n*A+w*nh(n/p)-S;n-=y=C?T/(A+(w-M*O)/C):0}while(Ac(y)>Uc&&--i>0)}return[n,-_-s*rh(g-n*n)]}(t>Xc/4?Vc-t:t,e);return t>Xc/4&&(a=l[0],l[0]=-l[1],l[1]=-a),l[0]*=n,l[1]*=-i,l}function gu(t,e){var n,i,r,s,o;if(e<Uc)return[(s=Yc(t))-(n=e*(t-s*(i=Lc(t)))/4)*i,i+n*s,1-e*s*s/2,t-n];if(e>=.999999)return n=(1-e)/4,i=oh(t),s=function(t){return((t=Pc(2*t))-1)/(t+1)}(t),r=1/i,[s+n*((o=i*sh(t))-t)/(i*i),r-n*s*r*(o-t),r+n*s*r*(o+t),2*Tc(Pc(t))-Vc+n*(o-t)/i];var a=[1,0,0,0,0,0,0,0,0],l=[rh(e),0,0,0,0,0,0,0,0],c=0;for(i=rh(1-e),o=1;Ac(l[c]/a[c])>Uc&&c<8;)n=a[c++],l[c]=(n-i)/2,a[c]=(n+i)/2,i=rh(n*i),o*=2;r=o*a[c]*t;do{r=(nh(s=l[c]*Yc(i=r)/a[c])+r)/2}while(--c);return[Yc(r),s=Lc(r),s/Lc(r-i),r]}function pu(t,e){if(!e)return t;if(1===e)return zc($c(t/2+Hc));for(var n=1,i=rh(1-e),r=rh(e),s=0;Ac(r)>Uc;s++){if(t%Xc){var o=Tc(i*$c(t)/n);o<0&&(o+=Xc),t+=o+~~(t/Xc)*Xc}else t+=t;r=(n+i)/2,i=rh(n*i),r=((n=r)-i)/2}return t/(jc(2,s)*n)}function _u(t,e){var n=(Zc-1)/(Zc+1),i=rh(1-n*n),r=pu(Vc,i*i),s=zc($c(Xc/4+Ac(e)/2)),o=Pc(-1*s)/rh(n),a=function(t,e){var n=t*t,i=e+1,r=1-n-e*e;return[.5*((t>=0?Vc:-Vc)-Rc(r,2*t)),-.25*zc(r*r+4*n)+.5*zc(i*i+n)]}(o*Lc(-1*t),o*Yc(-1*t)),l=function(t,e,n){var i=Ac(t),r=sh(Ac(e));if(i){var s=1/Yc(i),o=1/($c(i)*$c(i)),a=-(o+n*(r*r*s*s)-1+n),l=(-a+rh(a*a-(n-1)*o*4))/2;return[pu(Tc(1/rh(l)),n)*Bc(t),pu(Tc(rh((l/o-1)/n)),1-n)*Bc(e)]}return[0,pu(Tc(r),1-n)*Bc(e)]}(a[0],a[1],i*i);return[-l[1],(e>=0?1:-1)*(.5*r-l[0])]}function yu(t){var e=Yc(t),n=Lc(t),i=mu(t);function r(t,r){var s=i(t,r);t=s[0],r=s[1];var o=Yc(r),a=Lc(r),l=Lc(t),c=ih(e*o+n*a*l),h=Yc(c),u=Ac(h)>Uc?c/h:1;return[u*n*Yc(t),(Ac(t)>Vc?u:-u)*(e*a-n*o*l)]}return i.invert=mu(-t),r.invert=function(t,n){var r=rh(t*t+n*n),s=-Yc(r),o=Lc(r),a=r*o,l=-n*s,c=r*e,h=rh(a*a+l*l-c*c),u=Rc(a*c+l*h,l*c-a*h),f=(r>Vc?-1:1)*Rc(t*s,r*Lc(u)*o+n*Yc(u)*s);return i.invert(f,u)},r}function mu(t){var e=Yc(t),n=Lc(t);return function(t,i){var r=Lc(i),s=Lc(t)*r,o=Yc(t)*r,a=Yc(i);return[Rc(o,s*n-a*e),nh(a*n+s*e)]}}du.invert=function(t,e){Ac(t)>1&&(t=2*Bc(t)-t),Ac(e)>1&&(e=2*Bc(e)-e);var n=Bc(t),i=Bc(e),r=-n*t,s=-i*e,o=s/r<1,a=function(t,e){var n=0,i=1,r=.5,s=50;for(;;){var o=r*r,a=rh(r),l=nh(1/rh(1+o)),c=1-o+r*(1+o)*l,h=(1-a)/c,u=rh(h),f=h*(1+o),d=u*(1-o),g=rh(f-t*t),p=e+d+r*g;if(Ac(i-n)<Wc||0==--s||0===p)break;p>0?n=r:i=r,r=.5*(n+i)}if(!s)return null;var _=nh(a),y=Lc(_),m=1/y,x=2*a*y,v=(-c*y-(-3*r+l*(1+3*o))*x*(1-a))/(c*c);return[Xc/4*(t*(-2*m*(.5*v/u*(1-o)-2*r*u*x)+-m*x*g)+-m*(r*(1+o)*v+h*(1+3*o)*x)*nh(t/rh(f))),_]}(o?s:r,o?r:s),l=a[0],c=a[1],h=Lc(c);return o&&(l=-Vc-l),[n*(Rc(Yc(l)*h,-Yc(c))+Xc),i*nh(Lc(l)*h)]},_u.invert=function(t,e){var n=(Zc-1)/(Zc+1),i=rh(1-n*n),r=function(t,e,n){var i,r,s;return t?(i=gu(t,n),e?(s=(r=gu(e,1-n))[1]*r[1]+n*i[0]*i[0]*r[0]*r[0],[[i[0]*r[2]/s,i[1]*i[2]*r[0]*r[1]/s],[i[1]*r[1]/s,-i[0]*i[2]*r[0]*r[2]/s],[i[2]*r[1]*r[2]/s,-n*i[0]*i[1]*r[0]/s]]):[[i[0],0],[i[1],0],[i[2],0]]):[[0,(r=gu(e,1-n))[0]/r[1]],[1/r[1],0],[r[2]/r[1],0]]}(.5*pu(Vc,i*i)-e,-t,i*i),s=function(t,e){var n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}(r[0],r[1]);return[Rc(s[1],s[0])/-1,2*Tc(Pc(-.5*zc(n*s[0]*s[0]+n*s[1]*s[1])))-Vc]};var xu=nh(1-1/3)*th,vu=qh(0);function bu(t){var e=xu*eh,n=zh(Xc,e)[0]-zh(-Xc,e)[0],i=vu(0,e)[1],r=zh(0,e)[1],s=Qc-r,o=Kc/t,a=4/Kc,l=i+s*s*4/Kc;function c(c,h){var u,f=Ac(h);if(f>e){var d=Gc(t-1,Fc(0,Dc((c+Xc)/o)));(u=zh(c+=Xc*(t-1)/t-d*o,f))[0]=u[0]*Kc/n-Kc*(t-1)/(2*t)+d*Kc/t,u[1]=i+4*(u[1]-r)*s/Kc,h<0&&(u[1]=-u[1])}else u=vu(c,h);return u[0]*=a,u[1]/=l,u}return c.invert=function(e,c){e/=a;var h=Ac(c*=l);if(h>i){var u=Gc(t-1,Fc(0,Dc((e+Xc)/o)));e=(e+Xc*(t-1)/t-u*o)*n/Kc;var f=zh.invert(e,.25*(h-i)*Kc/s+r);return f[0]-=Xc*(t-1)/t-u*o,c<0&&(f[1]=-f[1]),f}return vu.invert(e,c)},c}function Mu(t,e){return[t,1&e?89.999999:xu]}function wu(t,e){return[t,1&e?-89.999999:-xu]}function Eu(t){return[.999999*t[0],t[1]]}function Su(t){var e,n=1+t,i=nh(Yc(1/n)),r=2*rh(Xc/(e=Xc+4*i*n)),s=.5*r*(n+rh(t*(2+t))),o=t*t,a=n*n;function l(l,c){var h,u,f=1-Yc(c);if(f&&f<2){var d,g=Vc-c,p=25;do{var _=Yc(g),y=Lc(g),m=i+Rc(_,n-y),x=1+a-2*n*y;g-=d=(g-o*i-n*_+x*m-.5*f*e)/(2*n*_*m)}while(Ac(d)>Wc&&--p>0);h=r*rh(x),u=l*m/Xc}else h=r*(t+f),u=l*i/Xc;return[h*Yc(u),s-h*Lc(u)]}return l.invert=function(t,l){var c=t*t+(l-=s)*l,h=(1+a-c/(r*r))/(2*n),u=ih(h),f=Yc(u),d=i+Rc(f,n-h);return[nh(t/rh(c))*Xc/d,nh(1-2*(u-o*i-n*f+(1+a-2*n*h)*d)/e)]},l}var Nu=.7109889596207567,Iu=.0528035274542;function ku(t,e){return e>-Nu?((t=Mh(t,e))[1]+=Iu,t):Ih(t,e)}function Ou(t,e){return Ac(e)>Nu?((t=Mh(t,e))[1]-=e>0?Iu:-Iu,t):Ih(t,e)}function Cu(t,e,n,i){var r=rh(4*Xc/(2*n+(1+t-e/2)*Yc(2*n)+(t+e)/2*Yc(4*n)+e/2*Yc(6*n))),s=rh(i*Yc(n)*rh((1+t*Lc(2*n)+e*Lc(4*n))/(1+t+e))),o=n*l(1);function a(n){return rh(1+t*Lc(2*n)+e*Lc(4*n))}function l(i){var r=i*n;return(2*r+(1+t-e/2)*Yc(2*r)+(t+e)/2*Yc(4*r)+e/2*Yc(6*r))/n}function c(t){return a(t)*Yc(t)}var h=function(t,e){var i=n*yh(l,o*Yc(e)/n,e/Xc);isNaN(i)&&(i=n*Bc(e));var c=r*a(i);return[c*s*t/Xc*Lc(i),c/s*Yc(i)]};return h.invert=function(t,e){var i=yh(c,e*s/r);return[t*Xc/(Lc(i)*r*s*a(i)),nh(n*l(i/n)/o)]},0===n&&(r=rh(i/Xc),(h=function(t,e){return[t*r,Yc(e)/r]}).invert=function(t,e){return[t/r,nh(e*r)]}),h}function Au(){var t=1,e=0,n=45*eh,i=2,r=Pr(Cu),s=r(t,e,n,i);return s.a=function(s){return arguments.length?r(t=+s,e,n,i):t},s.b=function(s){return arguments.length?r(t,e=+s,n,i):e},s.psiMax=function(s){return arguments.length?r(t,e,n=+s*eh,i):n*th},s.ratio=function(s){return arguments.length?r(t,e,n,i=+s):i},s.scale(180.739)}function Tu(t,e,n,i,r,s,o,a,l,c,h){if(h.nanEncountered)return NaN;var u,f,d,g,p,_,y,m,x,v;if(f=t(e+.25*(u=n-e)),d=t(n-.25*u),isNaN(f))h.nanEncountered=!0;else{if(!isNaN(d))return v=((_=(g=u*(i+4*f+r)/12)+(p=u*(r+4*d+s)/12))-o)/15,c>l?(h.maxDepthCount++,_+v):Math.abs(v)<a?_+v:(m=Tu(t,e,y=e+.5*u,i,f,r,g,.5*a,l,c+1,h),isNaN(m)?(h.nanEncountered=!0,NaN):(x=Tu(t,y,n,r,d,s,p,.5*a,l,c+1,h),isNaN(x)?(h.nanEncountered=!0,NaN):m+x));h.nanEncountered=!0}}function Ru(t,e,n,i,r){void 0===i&&(i=1e-8),void 0===r&&(r=20);var s=t(e),o=t(.5*(e+n)),a=t(n);return Tu(t,e,n,s,o,a,(s+4*o+a)*(n-e)/6,i,r,1,{maxDepthCount:0,nanEncountered:!1})}function Lu(t,e,n){function i(n){return t+(1-t)*jc(1-jc(n,e),1/e)}function r(t){return Ru(i,0,t,1e-4)}for(var s=1/r(1),o=1e3,a=(1+1e-8)*s,l=[],c=0;c<=o;c++)l.push(r(c/o)*a);function h(t){var e=0,n=o,i=500;do{l[i]>t?n=i:e=i,i=e+n>>1}while(i>e);var r=l[i+1]-l[i];return r&&(r=(t-l[i+1])/r),(i+1+r)/o}var u=2*h(1)/Xc*s/n,f=function(t,e){var n=h(Ac(Yc(e))),r=i(n)*t;return n/=u,[r,e>=0?n:-n]};return f.invert=function(t,e){var n;return Ac(e*=u)<1&&(n=Bc(e)*nh(r(Ac(e))*s)),[t/i(Ac(e)),n]},f}function Pu(t,e){return Ac(t[0]-e[0])<Uc&&Ac(t[1]-e[1])<Uc}function Du(t,e){for(var n,i,r,s=-1,o=t.length,a=t[0],l=[];++s<o;){i=((n=t[s])[0]-a[0])/e,r=(n[1]-a[1])/e;for(var c=0;c<e;++c)l.push([a[0]+c*i,a[1]+c*r]);a=n}return l.push(n),l}function zu(t){var e,n,i,r,s,o,a,l=[],c=t[0].length;for(a=0;a<c;++a)n=(e=t[0][a])[0][0],i=e[0][1],r=e[1][1],s=e[2][0],o=e[2][1],l.push(Du([[n+Uc,i+Uc],[n+Uc,r-Uc],[s-Uc,r-Uc],[s-Uc,o+Uc]],30));for(a=t[1].length-1;a>=0;--a)n=(e=t[1][a])[0][0],i=e[0][1],r=e[1][1],s=e[2][0],o=e[2][1],l.push(Du([[s-Uc,o-Uc],[s-Uc,r+Uc],[n+Uc,r+Uc],[n+Uc,i-Uc]],30));return{type:"Polygon",coordinates:[pt(l)]}}function Fu(t,e,n){var i,r;function s(n,i){for(var r=i<0?-1:1,s=e[+(i<0)],o=0,a=s.length-1;o<a&&n>s[o][2][0];++o);var l=t(n-s[o][1][0],i);return l[0]+=t(s[o][1][0],r*i>r*s[o][0][1]?s[o][0][1]:i)[0],l}n?s.invert=n(s):t.invert&&(s.invert=function(n,i){for(var o=r[+(i<0)],a=e[+(i<0)],l=0,c=o.length;l<c;++l){var h=o[l];if(h[0][0]<=n&&n<h[1][0]&&h[0][1]<=i&&i<h[1][1]){var u=t.invert(n-t(a[l][1][0],0)[0],i);return u[0]+=a[l][1][0],Pu(s(u[0],u[1]),[n,i])?u:null}}});var o=Lr(s),a=o.stream;return o.stream=function(t){var e=o.rotate(),n=a(t),r=(o.rotate([0,0]),a(t));return o.rotate(e),n.sphere=function(){se(i,r)},n},o.lobes=function(n){return arguments.length?(i=zu(n),e=n.map((function(t){return t.map((function(t){return[[t[0][0]*eh,t[0][1]*eh],[t[1][0]*eh,t[1][1]*eh],[t[2][0]*eh,t[2][1]*eh]]}))})),r=e.map((function(e){return e.map((function(e){var n,i=t(e[0][0],e[0][1])[0],r=t(e[2][0],e[2][1])[0],s=t(e[1][0],e[0][1])[1],o=t(e[1][0],e[1][1])[1];return s>o&&(n=s,s=o,o=n),[[i,s],[r,o]]}))})),o):e.map((function(t){return t.map((function(t){return[[t[0][0]*th,t[0][1]*th],[t[1][0]*th,t[1][1]*th],[t[2][0]*th,t[2][1]*th]]}))}))},null!=e&&o.lobes(e),o}ku.invert=function(t,e){return e>-Nu?Mh.invert(t,e-Iu):Ih.invert(t,e)},Ou.invert=function(t,e){return Ac(e)>Nu?Mh.invert(t,e+(e>0?Iu:-Iu)):Ih.invert(t,e)};var Gu=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]];var ju=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]];var qu=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]];var Bu=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];var Yu=[[[[-180,35],[-30,90],[0,35]],[[0,35],[30,90],[180,35]]],[[[-180,-10],[-102,-90],[-65,-10]],[[-65,-10],[5,-90],[77,-10]],[[77,-10],[103,-90],[180,-10]]]];var $u=[[[[-180,0],[-110,90],[-40,0]],[[-40,0],[0,90],[40,0]],[[40,0],[110,90],[180,0]]],[[[-180,0],[-110,-90],[-40,0]],[[-40,0],[0,-90],[40,0]],[[40,0],[110,-90],[180,0]]]];function Uu(t,e){return[3/Kc*t*rh(Xc*Xc/3-e*e),e]}function Wu(t){function e(e,n){if(Ac(Ac(n)-Vc)<Uc)return[0,n<0?-2:2];var i=Yc(n),r=jc((1+i)/(1-i),t/2),s=.5*(r+1/r)+Lc(e*=t);return[2*Yc(e)/s,(r-1/r)/s]}return e.invert=function(e,n){var i=Ac(n);if(Ac(i-2)<Uc)return e?null:[0,Bc(n)*Vc];if(i>2)return null;var r=(e/=2)*e,s=(n/=2)*n,o=2*n/(1+r+s);return o=jc((1+o)/(1-o),1/t),[Rc(2*e,1-r-s)/t,nh((o-1)/(o+1))]},e}Uu.invert=function(t,e){return[Kc/3*t/rh(Xc*Xc/3-e*e),e]};var Xu=Xc/Zc;function Vu(t,e){return[t*(1+rh(Lc(e)))/2,e/(Lc(e/2)*Lc(t/6))]}function Hu(t,e){var n=t*t,i=e*e;return[t*(.975534+i*(-.0143059*n-.119161+-.0547009*i)),e*(1.00384+n*(.0802894+-.02855*i+199025e-9*n)+i*(.0998909+-.0491032*i))]}function Ju(t,e){return[Yc(t)/Lc(e),$c(e)*Lc(t)]}function Zu(t){var e=Lc(t),n=$c(Hc+t/2);function i(i,r){var s=r-t,o=Ac(s)<Uc?i*e:Ac(o=Hc+r/2)<Uc||Ac(Ac(o)-Vc)<Uc?0:i*s/zc($c(o)/n);return[o,s]}return i.invert=function(i,r){var s,o=r+t;return[Ac(r)<Uc?i/e:Ac(s=Hc+o/2)<Uc||Ac(Ac(s)-Vc)<Uc?0:i*zc($c(s)/n)/r,o]},i}function Qu(t,e){return[t,1.25*zc($c(Hc+.4*e))]}function Ku(t){var e=t.length-1;function n(n,i){for(var r,s=Lc(i),o=2/(1+s*Lc(n)),a=o*s*Yc(n),l=o*Yc(i),c=e,h=t[c],u=h[0],f=h[1];--c>=0;)u=(h=t[c])[0]+a*(r=u)-l*f,f=h[1]+a*f+l*r;return[u=a*(r=u)-l*f,f=a*f+l*r]}return n.invert=function(n,i){var r=20,s=n,o=i;do{for(var a,l=e,c=t[l],h=c[0],u=c[1],f=0,d=0;--l>=0;)f=h+s*(a=f)-o*d,d=u+s*d+o*a,h=(c=t[l])[0]+s*(a=h)-o*u,u=c[1]+s*u+o*a;var g,p,_=(f=h+s*(a=f)-o*d)*f+(d=u+s*d+o*a)*d;s-=g=((h=s*(a=h)-o*u-n)*f+(u=s*u+o*a-i)*d)/_,o-=p=(u*f-h*d)/_}while(Ac(g)+Ac(p)>1e-12&&--r>0);if(r){var y=rh(s*s+o*o),m=2*Tc(.5*y),x=Yc(m);return[Rc(s*x,y*Lc(m)),y?nh(o*x/y):0]}},n}Vu.invert=function(t,e){var n=Ac(t),i=Ac(e),r=Uc,s=Vc;i<Xu?s*=i/Xu:r+=6*ih(Xu/i);for(var o=0;o<25;o++){var a=Yc(s),l=rh(Lc(s)),c=Yc(s/2),h=Lc(s/2),u=Yc(r/6),f=Lc(r/6),d=.5*r*(1+l)-n,g=s/(h*f)-i,p=l?-.25*r*a/l:0,_=.5*(1+l),y=(1+.5*s*c/h)/(h*f),m=s/h*(u/6)/(f*f),x=p*m-y*_,v=(d*m-g*_)/x,b=(g*p-d*y)/x;if(s-=v,r-=b,Ac(v)<Uc&&Ac(b)<Uc)break}return[t<0?-r:r,e<0?-s:s]},Hu.invert=function(t,e){var n=Bc(t)*Xc,i=e/2,r=50;do{var s=n*n,o=i*i,a=n*i,l=n*(.975534+o*(-.0143059*s-.119161+-.0547009*o))-t,c=i*(1.00384+s*(.0802894+-.02855*o+199025e-9*s)+o*(.0998909+-.0491032*o))-e,h=.975534-o*(.119161+3*s*.0143059+.0547009*o),u=-a*(.238322+.2188036*o+.0286118*s),f=a*(.1605788+7961e-7*s+-.0571*o),d=1.00384+s*(.0802894+199025e-9*s)+o*(3*(.0998909-.02855*s)-.245516*o),g=u*f-d*h,p=(c*u-l*d)/g,_=(l*f-c*h)/g;n-=p,i-=_}while((Ac(p)>Uc||Ac(_)>Uc)&&--r>0);return r&&[n,i]},Ju.invert=function(t,e){var n=t*t,i=e*e+1,r=n+i,s=t?Jc*rh((r-rh(r*r-4*n))/n):1/rh(i);return[nh(t*s),Bc(e)*ih(s)]},Qu.invert=function(t,e){return[t,2.5*Tc(Pc(.8*e))-.625*Xc]};var tf=[[.9972523,0],[.0052513,-.0041175],[.0074606,.0048125],[-.0153783,-.1968253],[.0636871,-.1408027],[.3660976,-.2937382]],ef=[[.98879,0],[0,0],[-.050909,0],[0,0],[.075528,0]],nf=[[.984299,0],[.0211642,.0037608],[-.1036018,-.0575102],[-.0329095,-.0320119],[.0499471,.1223335],[.026046,.0899805],[7388e-7,-.1435792],[.0075848,-.1334108],[-.0216473,.0776645],[-.0225161,.0853673]],rf=[[.9245,0],[0,0],[.01943,0]],sf=[[.721316,0],[0,0],[-.00881625,-.00617325]];function of(t,e){var n=Lr(Ku(t)).rotate(e).clipAngle(90),i=An(e),r=n.center;return delete n.rotate,n.center=function(t){return arguments.length?r(i(t)):i.invert(r())},n}var af=rh(6),lf=rh(7);function cf(t,e){var n=nh(7*Yc(e)/(3*af));return[af*t*(2*Lc(2*n/3)-1)/lf,9*Yc(n/3)/lf]}function hf(t,e){for(var n,i=(1+Jc)*Yc(e),r=e,s=0;s<25&&(r-=n=(Yc(r/2)+Yc(r)-i)/(.5*Lc(r/2)+Lc(r)),!(Ac(n)<Uc));s++);return[t*(1+2*Lc(r)/Lc(r/2))/(3*Zc),2*rh(3)*Yc(r/2)/rh(2+Zc)]}function uf(t,e){for(var n,i=rh(6/(4+Xc)),r=(1+Xc/4)*Yc(e),s=e/2,o=0;o<25&&(s-=n=(s/2+Yc(s)-r)/(.5+Lc(s)),!(Ac(n)<Uc));o++);return[i*(.5+Lc(s))*t/1.5,i*s]}function ff(t,e){var n=e*e,i=n*n,r=n*i;return[t*(.84719-.13063*n+r*r*(.05494*n-.04515-.02326*i+.00331*r)),e*(1.01183+i*i*(.01926*n-.02625-.00396*i))]}function df(t,e){return[t*(1+Lc(e))/2,2*(e-$c(e/2))]}cf.invert=function(t,e){var n=3*nh(e*lf/9);return[t*lf/(af*(2*Lc(2*n/3)-1)),nh(3*Yc(n)*af/7)]},hf.invert=function(t,e){var n=e*rh(2+Zc)/(2*rh(3)),i=2*nh(n);return[3*Zc*t/(1+2*Lc(i)/Lc(i/2)),nh((n+Yc(i))/(1+Jc))]},uf.invert=function(t,e){var n=rh(6/(4+Xc)),i=e/n;return Ac(Ac(i)-Vc)<Uc&&(i=i<0?-Vc:Vc),[1.5*t/(n*(.5+Lc(i))),nh((i/2+Yc(i))/(1+Xc/4))]},ff.invert=function(t,e){var n,i,r,s,o=e,a=25;do{o-=n=(o*(1.01183+(r=(i=o*o)*i)*r*(.01926*i-.02625-.00396*r))-e)/(1.01183+r*r*(.21186*i-.23625+-.05148*r))}while(Ac(n)>Wc&&--a>0);return[t/(.84719-.13063*(i=o*o)+(s=i*(r=i*i))*s*(.05494*i-.04515-.02326*r+.00331*s)),o]},df.invert=function(t,e){for(var n=e/2,i=0,r=1/0;i<10&&Ac(r)>Uc;++i){var s=Lc(e/2);e-=r=(e-$c(e/2)-n)/(1-.5/(s*s))}return[2*t/(1+Lc(e)),e]};var gf=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];function pf(t,e){var n=Yc(e),i=Lc(e),r=Bc(t);if(0===t||Ac(e)===Vc)return[0,e];if(0===e)return[t,0];if(Ac(t)===Vc)return[t*i,Vc*n];var s=Xc/(2*t)-2*t/Xc,o=2*e/Xc,a=(1-o*o)/(n-o),l=s*s,c=a*a,h=1+l/c,u=1+c/l,f=(s*n/a-s/2)/h,d=(c*n/l+a/2)/u,g=d*d-(c*n*n/l+a*n-1)/u;return[Vc*(f+rh(f*f+i*i/h)*r),Vc*(d+rh(g<0?0:g)*Bc(-e*s)*r)]}pf.invert=function(t,e){var n=(t/=Vc)*t,i=n+(e/=Vc)*e,r=Xc*Xc;return[t?(i-1+rh((1-i)*(1-i)+4*n))/(2*t)*Vc:0,yh((function(t){return i*(Xc*Yc(t)-2*t)*Xc+4*t*t*(e-Yc(t))+2*Xc*t-r*e}),0)]};var _f=1.0148,yf=.23185,mf=-.14499,xf=.02406,vf=1.790857183;function bf(t,e){var n=e*e;return[t,e*(_f+n*n*(yf+n*(mf+xf*n)))]}function Mf(t,e){if(Ac(e)<Uc)return[t,0];var n=$c(e),i=t*Yc(e);return[Yc(i)/n,e+(1-Lc(i))/n]}function wf(t,e){var n=Sf(t[1],t[0]),i=Sf(e[1],e[0]),r=function(t,e){return Rc(t[0]*e[1]-t[1]*e[0],t[0]*e[0]+t[1]*e[1])}(n,i),s=Nf(n)/Nf(i);return Ef([1,0,t[0][0],0,1,t[0][1]],Ef([s,0,0,0,s,0],Ef([Lc(r),Yc(r),0,-Yc(r),Lc(r),0],[1,0,-e[0][0],0,1,-e[0][1]])))}function Ef(t,e){return[t[0]*e[0]+t[1]*e[3],t[0]*e[1]+t[1]*e[4],t[0]*e[2]+t[1]*e[5]+t[2],t[3]*e[0]+t[4]*e[3],t[3]*e[1]+t[4]*e[4],t[3]*e[2]+t[4]*e[5]+t[5]]}function Sf(t,e){return[t[0]-e[0],t[1]-e[1]]}function Nf(t){return rh(t[0]*t[0]+t[1]*t[1])}function If(t,e){function n(t,n){var i,r=e(t,n),s=r.project([t*th,n*th]);return(i=r.transform)?[i[0]*s[0]+i[1]*s[1]+i[2],-(i[3]*s[0]+i[4]*s[1]+i[5])]:(s[1]=-s[1],s)}function i(t,n){var r=t.project.invert,s=t.transform,o=n;if(s&&(s=function(t){var e=1/(t[0]*t[4]-t[1]*t[3]);return[e*t[4],-e*t[1],e*(t[1]*t[5]-t[2]*t[4]),-e*t[3],e*t[0],e*(t[2]*t[3]-t[0]*t[5])]}(s),o=[s[0]*o[0]+s[1]*o[1]+s[2],s[3]*o[0]+s[4]*o[1]+s[5]]),r&&t===function(t){return e(t[0]*eh,t[1]*eh)}(a=r(o)))return a;for(var a,l=t.children,c=0,h=l&&l.length;c<h;++c)if(a=i(l[c],n))return a}!function t(e,n){if(e.edges=function(t){for(var e=t.length,n=[],i=t[e-1],r=0;r<e;++r)n.push([i,i=t[r]]);return n}(e.face),n.face){var i=e.shared=function(t,e){for(var n,i,r=t.length,s=null,o=0;o<r;++o){n=t[o];for(var a=e.length;--a>=0;)if(i=e[a],n[0]===i[0]&&n[1]===i[1]){if(s)return[s,n];s=n}}}(e.face,n.face),r=wf(i.map(n.project),i.map(e.project));e.transform=n.transform?Ef(n.transform,r):r;for(var s=n.edges,o=0,a=s.length;o<a;++o)Of(i[0],s[o][1])&&Of(i[1],s[o][0])&&(s[o]=e),Of(i[0],s[o][0])&&Of(i[1],s[o][1])&&(s[o]=e);for(s=e.edges,o=0,a=s.length;o<a;++o)Of(i[0],s[o][0])&&Of(i[1],s[o][1])&&(s[o]=n),Of(i[0],s[o][1])&&Of(i[1],s[o][0])&&(s[o]=n)}else e.transform=n.transform;e.children&&e.children.forEach((function(n){t(n,e)}));return e}(t,{transform:null}),Cf(t)&&(n.invert=function(e,n){var r=i(t,[e,-n]);return r&&(r[0]*=eh,r[1]*=eh,r)});var r=Lr(n),s=r.stream;return r.stream=function(e){var n=r.rotate(),i=s(e),o=(r.rotate([0,0]),s(e));return r.rotate(n),i.sphere=function(){o.polygonStart(),o.lineStart(),kf(o,t),o.lineEnd(),o.polygonEnd()},i},r.angle(-30)}function kf(t,e,n){var i,r,s=e.edges,o=s.length,a={type:"MultiPoint",coordinates:e.face},l=un({type:"MultiPoint",coordinates:e.face.filter((function(t){return 90!==Ac(t[1])}))}),c=!1,h=-1,u=l[1][0]-l[0][0],f=180===u||360===u?[(l[0][0]+l[1][0])/2,(l[0][1]+l[1][1])/2]:wn(a);if(n)for(;++h<o&&s[h]!==n;);++h;for(var d=0;d<o;++d)r=s[(d+h)%o],Array.isArray(r)?(c||(t.point((i=xi(r[0],f)(Uc))[0],i[1]),c=!0),t.point((i=xi(r[1],f)(Uc))[0],i[1])):(c=!1,r!==n&&kf(t,r,e))}function Of(t,e){return t&&e&&t[0]===e[0]&&t[1]===e[1]}function Cf(t){return t.project.invert||t.children&&t.children.some(Cf)}bf.invert=function(t,e){e>vf?e=vf:e<-1.790857183&&(e=-1.790857183);var n,i=e;do{var r=i*i;i-=n=(i*(_f+r*r*(yf+r*(mf+xf*r)))-e)/(1.0148+r*r*(1.1592500000000001+r*(.21654*r-1.01493)))}while(Ac(n)>Uc);return[t,i]},Mf.invert=function(t,e){if(Ac(e)<Uc)return[t,0];var n,i=t*t+e*e,r=.5*e,s=10;do{var o=$c(r),a=1/Lc(r),l=i-2*e*r+r*r;r-=n=(o*l+2*(r-e))/(2+l*a*a+2*(r-e)*o)}while(Ac(n)>Uc&&--s>0);return o=$c(r),[(Ac(e)<Ac(r+1/o)?nh(t*o):Bc(e)*Bc(t)*(ih(Ac(t*o))+Vc))/Yc(r),r]};var Af=[[0,90],[-90,0],[0,0],[90,0],[180,0],[0,-90]],Tf=[[0,2,1],[0,3,2],[5,1,2],[5,2,3],[0,1,4],[0,4,3],[5,4,1],[5,3,4]].map((function(t){return t.map((function(t){return Af[t]}))}));var Rf=2/rh(3);function Lf(t,e){var n=zh(t,e);return[n[0]*Rf,n[1]]}function Pf(t,e){for(var n=0,i=t.length,r=0;n<i;++n)r+=t[n]*e[n];return r}function Df(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function zf(t){return[Rc(t[1],t[0])*th,nh(Fc(-1,Gc(1,t[2])))*th]}function Ff(t){var e=t[0]*eh,n=t[1]*eh,i=Lc(n);return[i*Lc(e),i*Yc(e),Yc(n)]}Lf.invert=function(t,e){return zh.invert(t/Rf,e)};var Gf=()=>{};function jf(t,e){var n,i=e.stream;if(!i)throw new Error("invalid projection");switch(t&&t.type){case"Feature":n=Bf;break;case"FeatureCollection":n=qf;break;default:n=Yf}return n(t,i)}function qf(t,e){return{type:"FeatureCollection",features:t.features.map((function(t){return Bf(t,e)}))}}function Bf(t,e){return{type:"Feature",id:t.id,properties:t.properties,geometry:Yf(t.geometry,e)}}function Yf(t,e){if(!t)return null;if("GeometryCollection"===t.type)return function(t,e){return{type:"GeometryCollection",geometries:t.geometries.map((function(t){return Yf(t,e)}))}}(t,e);var n;switch(t.type){case"Point":case"MultiPoint":n=Wf;break;case"LineString":case"MultiLineString":n=Xf;break;case"Polygon":case"MultiPolygon":case"Sphere":n=Vf;break;default:return null}return se(t,e(n)),n.result()}var $f=[],Uf=[],Wf={point:function(t,e){$f.push([t,e])},result:function(){var t=$f.length?$f.length<2?{type:"Point",coordinates:$f[0]}:{type:"MultiPoint",coordinates:$f}:null;return $f=[],t}},Xf={lineStart:Gf,point:function(t,e){$f.push([t,e])},lineEnd:function(){$f.length&&(Uf.push($f),$f=[])},result:function(){var t=Uf.length?Uf.length<2?{type:"LineString",coordinates:Uf[0]}:{type:"MultiLineString",coordinates:Uf}:null;return Uf=[],t}},Vf={polygonStart:Gf,lineStart:Gf,point:function(t,e){$f.push([t,e])},lineEnd:function(){var t=$f.length;if(t){do{$f.push($f[0].slice())}while(++t<4);Uf.push($f),$f=[]}},polygonEnd:Gf,result:function(){if(!Uf.length)return null;var t=[],e=[];return Uf.forEach((function(n){!function(t){if((e=t.length)<4)return!1;for(var e,n=0,i=t[e-1][1]*t[0][0]-t[e-1][0]*t[0][1];++n<e;)i+=t[n-1][1]*t[n][0]-t[n-1][0]*t[n][1];return i<=0}(n)?e.push(n):t.push([n])})),e.forEach((function(e){var n=e[0];t.some((function(t){if(function(t,e){for(var n=e[0],i=e[1],r=!1,s=0,o=t.length,a=o-1;s<o;a=s++){var l=t[s],c=l[0],h=l[1],u=t[a],f=u[0],d=u[1];h>i^d>i&&n<(f-c)*(i-h)/(d-h)+c&&(r=!r)}return r}(t[0],n))return t.push(e),!0}))||t.push([e])})),Uf=[],t.length?t.length>1?{type:"MultiPolygon",coordinates:t}:{type:"Polygon",coordinates:t[0]}:null}};function Hf(t){var e=t(Vc,0)[0]-t(-Vc,0)[0];function n(n,i){var r=Ac(n)<Vc,s=t(r?n:n>0?n-Xc:n+Xc,i),o=(s[0]-s[1])*Jc,a=(s[0]+s[1])*Jc;if(r)return[o,a];var l=e*Jc,c=o>0^a>0?-1:1;return[c*o-Bc(a)*l,c*a-Bc(o)*l]}return t.invert&&(n.invert=function(n,i){var r=(n+i)*Jc,s=(i-n)*Jc,o=Ac(r)<.5*e&&Ac(s)<.5*e;if(!o){var a=e*Jc,l=r>0^s>0?-1:1,c=-l*n+(s>0?1:-1)*a,h=-l*i+(r>0?1:-1)*a;r=(-c-h)*Jc,s=(c-h)*Jc}var u=t.invert(r,s);return o||(u[0]+=r>0?Xc:-Xc),u}),Lr(n).rotate([-90,-90,45]).clipAngle(179.999)}function Jf(t){var e=Yc(t);function n(n,i){var r=e?$c(n*e/2)/e:n/2;if(!i)return[2*r,-t];var s=2*Tc(r*Yc(i)),o=1/$c(i);return[Yc(s)*o,i+(1-Lc(s))*o-t]}return n.invert=function(n,i){if(Ac(i+=t)<Uc)return[e?2*Tc(e*n/2)/e:n,0];var r,s=n*n+i*i,o=0,a=10;do{var l=$c(o),c=1/Lc(o),h=s-2*i*o+o*o;o-=r=(l*h+2*(o-i))/(2+h*c*c+2*(o-i)*l)}while(Ac(r)>Uc&&--a>0);var u=n*(l=$c(o)),f=$c(Ac(i)<Ac(o+1/l)?.5*nh(u):.5*ih(u)+Xc/4)/Yc(o);return[e?2*Tc(e*f)/e:2*f,o]},n}var Zf=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];function Qf(t,e){var n,i=Gc(18,36*Ac(e)/Xc),r=Dc(i),s=i-r,o=(n=Zf[r])[0],a=n[1],l=(n=Zf[++r])[0],c=n[1],h=(n=Zf[Gc(19,++r)])[0],u=n[1];return[t*(l+s*(h-o)/2+s*s*(h-2*l+o)/2),Bc(e)*(c+s*(u-a)/2+s*s*(u-2*c+a)/2)]}function Kf(t,e){var n=function(t){function e(e,n){var i=Lc(n),r=(t-1)/(t-i*Lc(e));return[r*i*Yc(e),r*Yc(n)]}return e.invert=function(e,n){var i=e*e+n*n,r=rh(i),s=(t-rh(1-i*(t+1)/(t-1)))/((t-1)/r+r/(t-1));return[Rc(e*s,r*rh(1-s*s)),r?nh(n*s/r):0]},e}(t);if(!e)return n;var i=Lc(e),r=Yc(e);function s(e,s){var o=n(e,s),a=o[1],l=a*r/(t-1)+i;return[o[0]*i/l,a/l]}return s.invert=function(e,s){var o=(t-1)/(t-1-s*r);return n.invert(o*e,o*s*i)},s}Zf.forEach((function(t){t[1]*=1.593415793900743})),Qf.invert=function(t,e){var n=90*e,i=Gc(18,Ac(n/5)),r=Fc(0,Dc(i));do{var s=Zf[r][1],o=Zf[r+1][1],a=Zf[Gc(19,r+2)][1],l=a-s,c=a-2*o+s,h=2*(Ac(e)-o)/l,u=c/l,f=h*(1-u*h*(1-2*u*h));if(f>=0||1===r){n=(e>=0?5:-5)*(f+i);var d,g=50;do{f=(i=Gc(18,Ac(n)/5))-(r=Dc(i)),s=Zf[r][1],o=Zf[r+1][1],a=Zf[Gc(19,r+2)][1],n-=(d=Bc(e)*(o+f*(a-s)/2+f*f*(a-2*o+s)/2)-e)*th}while(Ac(d)>Wc&&--g>0);break}}while(--r>=0);var p=Zf[r][0],_=Zf[r+1][0],y=Zf[Gc(19,r+2)][0];return[t/(_+f*(y-p)/2+f*f*(y-2*_+p)/2),n*eh]};var td=-180,ed=-179.9999,nd=179.9999,id=-89.9999,rd=89.9999;function sd(t){return t.length>0}function od(t){return Math.floor(1e4*t)/1e4}function ad(t){return-90===t||90===t?[0,t]:[td,od(t)]}function ld(t){var e=t[0],n=t[1],i=!1;return e<=ed?(e=td,i=!0):e>=nd&&(e=180,i=!0),n<=id?(n=-90,i=!0):n>=rd&&(n=90,i=!0),i?[e,n]:t}function cd(t){return t.map(ld)}function hd(t,e,n){for(var i=0,r=t.length;i<r;++i){var s=t[i].slice();n.push({index:-1,polygon:e,ring:s});for(var o=0,a=s.length;o<a;++o){var l=s[o],c=l[0],h=l[1];if(c<=ed||c>=nd||h<=id||h>=rd){s[o]=ld(l);for(var u=o+1;u<a;++u){var f=s[u],d=f[0],g=f[1];if(d>ed&&d<nd&&g>id&&g<rd)break}if(u===o+1)continue;if(o){var p={index:-1,polygon:e,ring:s.slice(0,o+1)};p.ring[p.ring.length-1]=ad(h),n[n.length-1]=p}else n.pop();if(u>=a)break;n.push({index:-1,polygon:e,ring:s=s.slice(u-1)}),s[0]=ad(s[0][1]),o=-1,a=s.length}}}}function ud(t){var e,n,i,r,s,o,a=t.length,l={},c={};for(e=0;e<a;++e)i=(n=t[e]).ring[0],s=n.ring[n.ring.length-1],i[0]!==s[0]||i[1]!==s[1]?(n.index=e,l[i]=c[s]=n):(n.polygon.push(n.ring),t[e]=null);for(e=0;e<a;++e)if(n=t[e]){if(i=n.ring[0],s=n.ring[n.ring.length-1],r=c[i],o=l[s],delete l[i],delete c[s],i[0]===s[0]&&i[1]===s[1]){n.polygon.push(n.ring);continue}r?(delete c[i],delete l[r.ring[0]],r.ring.pop(),t[r.index]=null,n={index:-1,polygon:r.polygon,ring:r.ring.concat(n.ring)},r===o?n.polygon.push(n.ring):(n.index=a++,t.push(l[n.ring[0]]=c[n.ring[n.ring.length-1]]=n))):o?(delete l[s],delete c[o.ring[o.ring.length-1]],n.ring.pop(),n={index:a++,polygon:o.polygon,ring:n.ring.concat(o.ring)},t[o.index]=null,t.push(l[n.ring[0]]=c[n.ring[n.ring.length-1]]=n)):(n.ring.push(n.ring[0]),n.polygon.push(n.ring))}}function fd(t){var e={type:"Feature",geometry:dd(t.geometry)};return null!=t.id&&(e.id=t.id),null!=t.bbox&&(e.bbox=t.bbox),null!=t.properties&&(e.properties=t.properties),e}function dd(t){if(null==t)return t;var e,n,i,r;switch(t.type){case"GeometryCollection":e={type:"GeometryCollection",geometries:t.geometries.map(dd)};break;case"Point":e={type:"Point",coordinates:ld(t.coordinates)};break;case"MultiPoint":case"LineString":e={type:t.type,coordinates:cd(t.coordinates)};break;case"MultiLineString":e={type:"MultiLineString",coordinates:t.coordinates.map(cd)};break;case"Polygon":var s=[];hd(t.coordinates,s,n=[]),ud(n),e={type:"Polygon",coordinates:s};break;case"MultiPolygon":n=[],i=-1,r=t.coordinates.length;for(var o=new Array(r);++i<r;)hd(t.coordinates[i],o[i]=[],n);ud(n),e={type:"MultiPolygon",coordinates:o.filter(sd)};break;default:return t}return null!=t.bbox&&(e.bbox=t.bbox),e}function gd(t,e){var n=$c(e/2),i=Yc(Hc*n);return[t*(.74482-.34588*i*i),1.70711*n]}function pd(t,e,n){var i=xi(e,n),r=i(.5),s=An([-r[0],-r[1]])(e),o=i.distance/2,a=-nh(Yc(s[1]*eh)/Yc(o)),l=[-r[0],-r[1],-(s[0]>0?Xc-a:a)*th],c=Lr(t(o)).rotate(l),h=An(l),u=c.center;return delete c.rotate,c.center=function(t){return arguments.length?u(h(t)):h.invert(u())},c.clipAngle(90)}function _d(t){var e=Lc(t);function n(t,n){var i=ss(t,n);return i[0]*=e,i}return n.invert=function(t,n){return ss.invert(t/e,n)},n}function yd(t,e){return pd(_d,t,e)}function md(t){if(!(t*=2))return Yr;var e=-t/2,n=-e,i=t*t,r=$c(n),s=.5/Yc(n);function o(r,s){var o=ih(Lc(s)*Lc(r-e)),a=ih(Lc(s)*Lc(r-n));return[((o*=o)-(a*=a))/(2*t),(s<0?-1:1)*rh(4*i*a-(i-o+a)*(i-o+a))/(2*t)]}return o.invert=function(t,i){var o,a,l=i*i,c=Lc(rh(l+(o=t+e)*o)),h=Lc(rh(l+(o=t+n)*o));return[Rc(a=c-h,o=(c+h)*r),(i<0?-1:1)*ih(rh(o*o+a*a)*s)]},o}function xd(t,e){return pd(md,t,e)}function vd(t,e){if(Ac(e)<Uc)return[t,0];var n=Ac(e/Vc),i=nh(n);if(Ac(t)<Uc||Ac(Ac(e)-Vc)<Uc)return[0,Bc(e)*Xc*$c(i/2)];var r=Lc(i),s=Ac(Xc/t-t/Xc)/2,o=s*s,a=r/(n+r-1),l=a*(2/n-1),c=l*l,h=c+o,u=a-c,f=o+a;return[Bc(t)*Xc*(s*u+rh(o*u*u-h*(a*a-c)))/h,Bc(e)*Xc*(l*f-s*rh((o+1)*h-f*f))/h]}function bd(t,e){if(Ac(e)<Uc)return[t,0];var n=Ac(e/Vc),i=nh(n);if(Ac(t)<Uc||Ac(Ac(e)-Vc)<Uc)return[0,Bc(e)*Xc*$c(i/2)];var r=Lc(i),s=Ac(Xc/t-t/Xc)/2,o=s*s,a=r*(rh(1+o)-s*r)/(1+o*n*n);return[Bc(t)*Xc*a,Bc(e)*Xc*rh(1-a*(2*s+a))]}function Md(t,e){if(Ac(e)<Uc)return[t,0];var n=e/Vc,i=nh(n);if(Ac(t)<Uc||Ac(Ac(e)-Vc)<Uc)return[0,Xc*$c(i/2)];var r=(Xc/t-t/Xc)/2,s=n/(1+Lc(i));return[Xc*(Bc(t)*rh(r*r+1-s*s)-r),Xc*s]}function wd(t,e){if(!e)return[t,0];var n=Ac(e);if(!t||n===Vc)return[0,e];var i=n/Vc,r=i*i,s=(8*i-r*(r+2)-5)/(2*r*(i-1)),o=s*s,a=i*s,l=r+o+2*a,c=i+3*s,h=t/Vc,u=h+1/h,f=Bc(Ac(t)-Vc)*rh(u*u-4),d=f*f,g=(f*(l+o-1)+2*rh(l*(r+o*d-1)+(1-r)*(r*(c*c+4*o)+12*a*o+4*o*o)))/(4*l+d);return[Bc(t)*Vc*g,Bc(e)*Vc*rh(1+f*Ac(g)-g*g)]}function Ed(t,e,n,i){var r=Xc/3;t=Fc(t,Uc),e=Fc(e,Uc),t=Gc(t,Vc),e=Gc(e,Xc-Uc),n=Fc(n,0),n=Gc(n,99.999999);var s=(i=Fc(i,Uc))/100,o=ih((n/100+1)*Lc(r))/r,a=Yc(t)/Yc(o*Vc),l=e/Xc,c=rh(s*Yc(t/2)/Yc(e/2));return function(t,e,n,i,r){function s(s,o){var a=n*Yc(i*o),l=rh(1-a*a),c=rh(2/(1+l*Lc(s*=r)));return[t*l*c*Yc(s),e*a*c]}return s.invert=function(s,o){var a=s/t,l=o/e,c=rh(a*a+l*l),h=2*nh(c/2);return[Rc(s*$c(h),t*c)/r,c&&nh(o*Yc(h)/(e*n*c))/i]},s}(c/rh(l*a*o),1/(c*rh(l*a*o)),a,o,l)}function Sd(){var t=65*eh,e=60*eh,n=20,i=200,r=Pr(Ed),s=r(t,e,n,i);return s.poleline=function(s){return arguments.length?r(t=+s*eh,e,n,i):t*th},s.parallels=function(s){return arguments.length?r(t,e=+s*eh,n,i):e*th},s.inflation=function(s){return arguments.length?r(t,e,n=+s,i):n},s.ratio=function(s){return arguments.length?r(t,e,n,i=+s):i},s.scale(163.775)}gd.invert=function(t,e){var n=e/1.70711,i=Yc(Hc*n);return[t/(.74482-.34588*i*i),2*Tc(n)]},vd.invert=function(t,e){if(Ac(e)<Uc)return[t,0];if(Ac(t)<Uc)return[0,Vc*Yc(2*Tc(e/Xc))];var n=(t/=Xc)*t,i=(e/=Xc)*e,r=n+i,s=r*r,o=-Ac(e)*(1+r),a=o-2*i+n,l=-2*o+1+2*i+s,c=i/l+(2*a*a*a/(l*l*l)-9*o*a/(l*l))/27,h=(o-a*a/(3*l))/l,u=2*rh(-h/3),f=ih(3*c/(h*u))/3;return[Xc*(r-1+rh(1+2*(n-i)+s))/(2*t),Bc(e)*Xc*(-u*Lc(f+Xc/3)-a/(3*l))]},bd.invert=function(t,e){if(!t)return[0,Vc*Yc(2*Tc(e/Xc))];var n=Ac(t/Xc),i=(1-n*n-(e/=Xc)*e)/(2*n),r=rh(i*i+1);return[Bc(t)*Xc*(r-i),Bc(e)*Vc*Yc(2*Rc(rh((1-2*i*n)*(i+r)-n),rh(r+i+n)))]},Md.invert=function(t,e){if(!e)return[t,0];var n=e/Xc,i=(Xc*Xc*(1-n*n)-t*t)/(2*Xc*t);return[t?Xc*(Bc(t)*rh(i*i+1)-i):0,Vc*Yc(2*Tc(n))]},wd.invert=function(t,e){var n;if(!t||!e)return[t,e];var i=Bc(e);e=Ac(e)/Xc;var r=Bc(t)*t/Vc,s=(r*r-1+4*e*e)/Ac(r),o=s*s,a=e*(2-(e>.5?Gc(e,Ac(t)):0)),l=t*t+e*e,c=50;do{var h=a*a,u=(8*a-h*(h+2)-5)/(2*h*(a-1)),f=(3*a-h*a-10)/(2*h*a),d=u*u,g=a*u,p=a+u,_=p*p,y=a+3*u,m=-2*p*(4*g*d+(1-4*h+3*h*h)*(1+f)+d*(14*h-6-o+(8*h-8-2*o)*f)+g*(12*h-8+(10*h-10-o)*f)),x=rh(_*(h+d*o-1)+(1-h)*(h*(y*y+4*d)+d*(12*g+4*d)));a-=n=(s*(_+d-1)+2*x-r*(4*_+o))/(s*(2*u*f+2*p*(1+f))+m/x-8*p*(s*(-1+d+_)+2*x)*(1+f)/(o+4*_))}while(n*l*l>Uc&&--c>0);return[Bc(t)*(rh(s*s+4)+s)*Xc/4,i*Vc*a]};var Nd=4*Xc+3*rh(3),Id=2*rh(2*Xc*rh(3)/Nd),kd=bh(Id*rh(3)/Xc,Id,Nd/6);function Od(t,e){return[t*rh(1-3*e*e/(Xc*Xc)),e]}function Cd(t,e){var n=Lc(e),i=Lc(t)*n,r=1-i,s=Lc(t=Rc(Yc(t)*n,-Yc(e))),o=Yc(t);return[o*(n=rh(1-i*i))-s*r,-s*n-o*r]}function Ad(t,e){var n=lh(t,e);return[(n[0]+t/Vc)/2,(n[1]+e)/2]}Od.invert=function(t,e){return[t/rh(1-3*e*e/(Xc*Xc)),e]},Cd.invert=function(t,e){var n=(t*t+e*e)/-2,i=rh(-n*(2+n)),r=e*n+t*i,s=t*n-e*i,o=rh(s*s+r*r);return[Rc(i*r,o*(1+n)),o?-nh(i*s/o):0]},Ad.invert=function(t,e){var n=t,i=e,r=25;do{var s,o=Lc(i),a=Yc(i),l=Yc(2*i),c=a*a,h=o*o,u=Yc(n),f=Lc(n/2),d=Yc(n/2),g=d*d,p=1-h*f*f,_=p?ih(o*f)*rh(s=1/p):s=0,y=.5*(2*_*o*d+n/Vc)-t,m=.5*(_*a+i)-e,x=.5*s*(h*g+_*o*f*c)+.5/Vc,v=s*(u*l/4-_*a*d),b=.125*s*(l*d-_*a*h*u),M=.5*s*(c*f+_*g*o)+.5,w=v*b-M*x,E=(m*v-y*M)/w,S=(y*b-m*x)/w;n-=E,i-=S}while((Ac(E)>Uc||Ac(S)>Uc)&&--r>0);return[n,i]};var Td=Object.freeze({__proto__:null,geoAiry:function(){var t=Vc,e=Pr(ah),n=e(t);return n.radius=function(n){return arguments.length?e(t=n*eh):t*th},n.scale(179.976).clipAngle(147)},geoAiryRaw:ah,geoAitoff:function(){return Lr(lh).scale(152.63)},geoAitoffRaw:lh,geoArmadillo:function(){var t=20*eh,e=t>=0?1:-1,n=$c(e*t),i=Pr(ch),r=i(t),s=r.stream;return r.parallel=function(r){return arguments.length?(n=$c((e=(t=r*eh)>=0?1:-1)*t),i(t)):t*th},r.stream=function(i){var o=r.rotate(),a=s(i),l=(r.rotate([0,0]),s(i)),c=r.precision();return r.rotate(o),a.sphere=function(){l.polygonStart(),l.lineStart();for(var i=-180*e;e*i<180;i+=90*e)l.point(i,90*e);if(t)for(;e*(i-=3*e*c)>=-180;)l.point(i,e*-Rc(Lc(i*eh/2),n)*th);l.lineEnd(),l.polygonEnd()},a},r.scale(218.695).center([0,28.0974])},geoArmadilloRaw:ch,geoAugust:function(){return Lr(hh).scale(66.1603)},geoAugustRaw:hh,geoBaker:function(){return Lr(dh).scale(112.314)},geoBakerRaw:dh,geoBerghaus:function(){var t=5,e=Pr(gh),n=e(t),i=n.stream,r=.01,s=-Lc(r*eh),o=Yc(r*eh);return n.lobes=function(n){return arguments.length?e(t=+n):t},n.stream=function(e){var a=n.rotate(),l=i(e),c=(n.rotate([0,0]),i(e));return n.rotate(a),l.sphere=function(){c.polygonStart(),c.lineStart();for(var e=0,n=360/t,i=2*Xc/t,a=90-180/t,l=Vc;e<t;++e,a-=n,l-=i)c.point(Rc(o*Lc(l),s)*th,nh(o*Yc(l))*th),a<-90?(c.point(-90,-180-a-r),c.point(-90,-180-a+r)):(c.point(90,a+r),c.point(90,a-r));c.lineEnd(),c.polygonEnd()},l},n.scale(87.8076).center([0,17.1875]).clipAngle(179.999)},geoBerghausRaw:gh,geoBertin1953:function(){return Lr(xh()).rotate([-16.5,-42]).scale(176.57).center([7.93,.09])},geoBertin1953Raw:xh,geoBoggs:function(){return Lr(Sh).scale(160.857)},geoBoggsRaw:Sh,geoBonne:function(){return Nh(kh).scale(123.082).center([0,26.1441]).parallel(45)},geoBonneRaw:kh,geoBottomley:function(){var t=.5,e=Pr(Oh),n=e(t);return n.fraction=function(n){return arguments.length?e(t=+n):t},n.scale(158.837)},geoBottomleyRaw:Oh,geoBromley:function(){return Lr(Ch).scale(152.63)},geoBromleyRaw:Ch,geoChamberlin:Dh,geoChamberlinRaw:Lh,geoChamberlinAfrica:function(){return Dh([0,22],[45,22],[22.5,-22]).scale(380).center([22.5,2])},geoCollignon:function(){return Lr(zh).scale(95.6464).center([0,30])},geoCollignonRaw:zh,geoCraig:function(){return Nh(Fh).scale(249.828).clipAngle(90)},geoCraigRaw:Fh,geoCraster:function(){return Lr(jh).scale(156.19)},geoCrasterRaw:jh,geoCylindricalEqualArea:function(){return Nh(qh).parallel(38.58).scale(195.044)},geoCylindricalEqualAreaRaw:qh,geoCylindricalStereographic:function(){return Nh(Bh).scale(124.75)},geoCylindricalStereographicRaw:Bh,geoEckert1:function(){return Lr(Yh).scale(165.664)},geoEckert1Raw:Yh,geoEckert2:function(){return Lr($h).scale(165.664)},geoEckert2Raw:$h,geoEckert3:function(){return Lr(Uh).scale(180.739)},geoEckert3Raw:Uh,geoEckert4:function(){return Lr(Wh).scale(180.739)},geoEckert4Raw:Wh,geoEckert5:function(){return Lr(Xh).scale(173.044)},geoEckert5Raw:Xh,geoEckert6:function(){return Lr(Vh).scale(173.044)},geoEckert6Raw:Vh,geoEisenlohr:function(){return Lr(Jh).scale(62.5271)},geoEisenlohrRaw:Jh,geoFahey:function(){return Lr(Qh).scale(137.152)},geoFaheyRaw:Qh,geoFoucaut:function(){return Lr(Kh).scale(135.264)},geoFoucautRaw:Kh,geoFoucautSinusoidal:function(){var t=.5,e=Pr(tu),n=e(t);return n.alpha=function(n){return arguments.length?e(t=+n):t},n.scale(168.725)},geoFoucautSinusoidalRaw:tu,geoGilbert:function(t){null==t&&(t=hs);var e=t(),n=Zr().scale(th).precision(0).clipAngle(null).translate([0,0]);function i(t){return e(eu(t))}function r(t){i[t]=function(){return arguments.length?(e[t].apply(e,arguments),i):e[t]()}}return e.invert&&(i.invert=function(t){return nu(e.invert(t))}),i.stream=function(t){var i=e.stream(t),r=n.stream({point:function(t,e){i.point(t/2,nh($c(-e/2*eh))*th)},lineStart:function(){i.lineStart()},lineEnd:function(){i.lineEnd()},polygonStart:function(){i.polygonStart()},polygonEnd:function(){i.polygonEnd()}});return r.sphere=i.sphere,r},i.rotate=function(t){return arguments.length?(n.rotate(t),i):n.rotate()},i.center=function(t){return arguments.length?(e.center(eu(t)),i):nu(e.center())},r("angle"),r("clipAngle"),r("clipExtent"),r("fitExtent"),r("fitHeight"),r("fitSize"),r("fitWidth"),r("scale"),r("translate"),r("precision"),i.scale(249.5)},geoGingery:function(){var t=6,e=30*eh,n=Lc(e),i=Yc(e),r=Pr(iu),s=r(e,t),o=s.stream,a=-Lc(.01*eh),l=Yc(.01*eh);return s.radius=function(s){return arguments.length?(n=Lc(e=s*eh),i=Yc(e),r(e,t)):e*th},s.lobes=function(n){return arguments.length?r(e,t=+n):t},s.stream=function(e){var r=s.rotate(),c=o(e),h=(s.rotate([0,0]),o(e));return s.rotate(r),c.sphere=function(){h.polygonStart(),h.lineStart();for(var e=0,r=2*Xc/t,s=0;e<t;++e,s-=r)h.point(Rc(l*Lc(s),a)*th,nh(l*Yc(s))*th),h.point(Rc(i*Lc(s-r/2),n)*th,nh(i*Yc(s-r/2))*th);h.lineEnd(),h.polygonEnd()},c},s.rotate([90,-40]).scale(91.7095).clipAngle(179.999)},geoGingeryRaw:iu,geoGinzburg4:function(){return Lr(au).scale(149.995)},geoGinzburg4Raw:au,geoGinzburg5:function(){return Lr(lu).scale(153.93)},geoGinzburg5Raw:lu,geoGinzburg6:function(){return Lr(cu).scale(130.945)},geoGinzburg6Raw:cu,geoGinzburg8:function(){return Lr(hu).scale(131.747)},geoGinzburg8Raw:hu,geoGinzburg9:function(){return Lr(uu).scale(131.087)},geoGinzburg9Raw:uu,geoGringorten:function(){return Lr(fu(du)).scale(239.75)},geoGringortenRaw:du,geoGuyou:function(){return Lr(fu(_u)).scale(151.496)},geoGuyouRaw:_u,geoHammer:function(){var t=2,e=Pr(ph),n=e(t);return n.coefficient=function(n){return arguments.length?e(t=+n):t},n.scale(169.529)},geoHammerRaw:ph,geoHammerRetroazimuthal:function(){var t=0,e=Pr(yu),n=e(t),i=n.rotate,r=n.stream,s=Ln();return n.parallel=function(i){if(!arguments.length)return t*th;var r=n.rotate();return e(t=i*eh).rotate(r)},n.rotate=function(e){return arguments.length?(i.call(n,[e[0],e[1]-t*th]),s.center([-e[0],-e[1]]),n):((e=i.call(n))[1]+=t*th,e)},n.stream=function(t){return(t=r(t)).sphere=function(){t.polygonStart();var e,n=s.radius(89.99)().coordinates[0],i=n.length-1,r=-1;for(t.lineStart();++r<i;)t.point((e=n[r])[0],e[1]);for(t.lineEnd(),i=(n=s.radius(90.01)().coordinates[0]).length-1,t.lineStart();--r>=0;)t.point((e=n[r])[0],e[1]);t.lineEnd(),t.polygonEnd()},t},n.scale(79.4187).parallel(45).clipAngle(179.999)},geoHammerRetroazimuthalRaw:yu,geoHealpix:function(){var t=4,e=Pr(bu),n=e(t),i=n.stream;return n.lobes=function(n){return arguments.length?e(t=+n):t},n.stream=function(e){var r=n.rotate(),s=i(e),o=(n.rotate([0,0]),i(e));return n.rotate(r),s.sphere=function(){se(function(t){var e=[].concat(yt(-180,180+t/2,t).map(Mu),yt(180,-180-t/2,-t).map(wu));return{type:"Polygon",coordinates:[180===t?e.map(Eu):e]}}(180/t),o)},s},n.scale(239.75)},geoHealpixRaw:bu,geoHill:function(){var t=1,e=Pr(Su),n=e(t);return n.ratio=function(n){return arguments.length?e(t=+n):t},n.scale(167.774).center([0,18.67])},geoHillRaw:Su,geoHomolosine:function(){return Lr(Ou).scale(152.63)},geoHomolosineRaw:Ou,geoHufnagel:Au,geoHufnagelRaw:Cu,geoHyperelliptical:function(){var t=0,e=2.5,n=1.183136,i=Pr(Lu),r=i(t,e,n);return r.alpha=function(r){return arguments.length?i(t=+r,e,n):t},r.k=function(r){return arguments.length?i(t,e=+r,n):e},r.gamma=function(r){return arguments.length?i(t,e,n=+r):n},r.scale(152.63)},geoHyperellipticalRaw:Lu,geoInterrupt:Fu,geoInterruptedBoggs:function(){return Fu(Sh,Gu).scale(160.857)},geoInterruptedHomolosine:function(){return Fu(Ou,ju).scale(152.63)},geoInterruptedMollweide:function(){return Fu(Mh,qu).scale(169.529)},geoInterruptedMollweideHemispheres:function(){return Fu(Mh,Bu).scale(169.529).rotate([20,0])},geoInterruptedSinuMollweide:function(){return Fu(ku,Yu,mh).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},geoInterruptedSinusoidal:function(){return Fu(Ih,$u).scale(152.63).rotate([-20,0])},geoKavrayskiy7:function(){return Lr(Uu).scale(158.837)},geoKavrayskiy7Raw:Uu,geoLagrange:function(){var t=.5,e=Pr(Wu),n=e(t);return n.spacing=function(n){return arguments.length?e(t=+n):t},n.scale(124.75)},geoLagrangeRaw:Wu,geoLarrivee:function(){return Lr(Vu).scale(97.2672)},geoLarriveeRaw:Vu,geoLaskowski:function(){return Lr(Hu).scale(139.98)},geoLaskowskiRaw:Hu,geoLittrow:function(){return Lr(Ju).scale(144.049).clipAngle(89.999)},geoLittrowRaw:Ju,geoLoximuthal:function(){return Nh(Zu).parallel(40).scale(158.837)},geoLoximuthalRaw:Zu,geoMiller:function(){return Lr(Qu).scale(108.318)},geoMillerRaw:Qu,geoModifiedStereographic:of,geoModifiedStereographicRaw:Ku,geoModifiedStereographicAlaska:function(){return of(tf,[152,-64]).scale(1400).center([-160.908,62.4864]).clipAngle(30).angle(7.8)},geoModifiedStereographicGs48:function(){return of(ef,[95,-38]).scale(1e3).clipAngle(55).center([-96.5563,38.8675])},geoModifiedStereographicGs50:function(){return of(nf,[120,-45]).scale(359.513).clipAngle(55).center([-117.474,53.0628])},geoModifiedStereographicMiller:function(){return of(rf,[-20,-18]).scale(209.091).center([20,16.7214]).clipAngle(82)},geoModifiedStereographicLee:function(){return of(sf,[165,10]).scale(250).clipAngle(130).center([-165,-10])},geoMollweide:function(){return Lr(Mh).scale(169.529)},geoMollweideRaw:Mh,geoMtFlatPolarParabolic:function(){return Lr(cf).scale(164.859)},geoMtFlatPolarParabolicRaw:cf,geoMtFlatPolarQuartic:function(){return Lr(hf).scale(188.209)},geoMtFlatPolarQuarticRaw:hf,geoMtFlatPolarSinusoidal:function(){return Lr(uf).scale(166.518)},geoMtFlatPolarSinusoidalRaw:uf,geoNaturalEarth2:function(){return Lr(ff).scale(175.295)},geoNaturalEarth2Raw:ff,geoNellHammer:function(){return Lr(df).scale(152.63)},geoNellHammerRaw:df,geoInterruptedQuarticAuthalic:function(){return Fu(ph(1/0),gf).rotate([20,0]).scale(152.63)},geoNicolosi:function(){return Lr(pf).scale(127.267)},geoNicolosiRaw:pf,geoPatterson:function(){return Lr(bf).scale(139.319)},geoPattersonRaw:bf,geoPolyconic:function(){return Lr(Mf).scale(103.74)},geoPolyconicRaw:Mf,geoPolyhedral:If,geoPolyhedralButterfly:function(t){t=t||function(t){var e=wn({type:"MultiPoint",coordinates:t});return os().scale(1).translate([0,0]).rotate([-e[0],-e[1]])};var e=Tf.map((function(e){return{face:e,project:t(e)}}));return[-1,0,0,1,0,1,4,5].forEach((function(t,n){var i=e[t];i&&(i.children||(i.children=[])).push(e[n])})),If(e[0],(function(t,n){return e[t<-Xc/2?n<0?6:4:t<0?n<0?2:0:t<Xc/2?n<0?3:1:n<0?7:5]})).angle(-30).scale(101.858).center([0,45])},geoPolyhedralCollignon:function(t){t=t||function(t){var e=wn({type:"MultiPoint",coordinates:t});return Lr(Lf).translate([0,0]).scale(1).rotate(e[1]>0?[-e[0],0]:[180-e[0],180])};var e=Tf.map((function(e){return{face:e,project:t(e)}}));return[-1,0,0,1,0,1,4,5].forEach((function(t,n){var i=e[t];i&&(i.children||(i.children=[])).push(e[n])})),If(e[0],(function(t,n){return e[t<-Xc/2?n<0?6:4:t<0?n<0?2:0:t<Xc/2?n<0?3:1:n<0?7:5]})).angle(-30).scale(121.906).center([0,48.5904])},geoPolyhedralWaterman:function(t){t=t||function(t){var e=6===t.length?wn({type:"MultiPoint",coordinates:t}):t[0];return os().scale(1).translate([0,0]).rotate([-e[0],-e[1]])};var e=Tf.map((function(t){for(var e,n=t.map(Ff),i=n.length,r=n[i-1],s=[],o=0;o<i;++o)e=n[o],s.push(zf([.9486832980505138*r[0]+.31622776601683794*e[0],.9486832980505138*r[1]+.31622776601683794*e[1],.9486832980505138*r[2]+.31622776601683794*e[2]]),zf([.9486832980505138*e[0]+.31622776601683794*r[0],.9486832980505138*e[1]+.31622776601683794*r[1],.9486832980505138*e[2]+.31622776601683794*r[2]])),r=e;return s})),n=[],i=[-1,0,0,1,0,1,4,5];e.forEach((function(t,r){for(var s=Tf[r],o=s.length,a=n[r]=[],l=0;l<o;++l)e.push([s[l],t[(2*l+2)%(2*o)],t[(2*l+1)%(2*o)]]),i.push(r),a.push(Df(Ff(t[(2*l+2)%(2*o)]),Ff(t[(2*l+1)%(2*o)])))}));var r=e.map((function(e){return{project:t(e),face:e}}));return i.forEach((function(t,e){var n=r[t];n&&(n.children||(n.children=[])).push(r[e])})),If(r[0],(function(t,e){var i=Lc(e),s=[i*Lc(t),i*Yc(t),Yc(e)],o=t<-Xc/2?e<0?6:4:t<0?e<0?2:0:t<Xc/2?e<0?3:1:e<0?7:5,a=n[o];return r[Pf(a[0],s)<0?8+3*o:Pf(a[1],s)<0?8+3*o+1:Pf(a[2],s)<0?8+3*o+2:o]})).angle(-30).scale(110.625).center([0,45])},geoProject:jf,geoGringortenQuincuncial:function(){return Hf(du).scale(176.423)},geoPeirceQuincuncial:function(){return Hf(_u).scale(111.48)},geoQuantize:function(t,e){if(!(0<=(e=+e)&&e<=20))throw new Error("invalid digits");function n(t){var n=t.length,i=2,r=new Array(n);for(r[0]=+t[0].toFixed(e),r[1]=+t[1].toFixed(e);i<n;)r[i]=t[i],++i;return r}function i(t){return t.map(n)}function r(t){for(var e=n(t[0]),i=[e],r=1;r<t.length;r++){var s=n(t[r]);(s.length>2||s[0]!=e[0]||s[1]!=e[1])&&(i.push(s),e=s)}return 1===i.length&&t.length>1&&i.push(n(t[t.length-1])),i}function s(t){return t.map(r)}function o(t){if(null==t)return t;var e;switch(t.type){case"GeometryCollection":e={type:"GeometryCollection",geometries:t.geometries.map(o)};break;case"Point":e={type:"Point",coordinates:n(t.coordinates)};break;case"MultiPoint":e={type:t.type,coordinates:i(t.coordinates)};break;case"LineString":e={type:t.type,coordinates:r(t.coordinates)};break;case"MultiLineString":case"Polygon":e={type:t.type,coordinates:s(t.coordinates)};break;case"MultiPolygon":e={type:"MultiPolygon",coordinates:t.coordinates.map(s)};break;default:return t}return null!=t.bbox&&(e.bbox=t.bbox),e}function a(t){var e={type:"Feature",properties:t.properties,geometry:o(t.geometry)};return null!=t.id&&(e.id=t.id),null!=t.bbox&&(e.bbox=t.bbox),e}if(null!=t)switch(t.type){case"Feature":return a(t);case"FeatureCollection":var l={type:"FeatureCollection",features:t.features.map(a)};return null!=t.bbox&&(l.bbox=t.bbox),l;default:return o(t)}return t},geoQuincuncial:Hf,geoRectangularPolyconic:function(){return Nh(Jf).scale(131.215)},geoRectangularPolyconicRaw:Jf,geoRobinson:function(){return Lr(Qf).scale(152.63)},geoRobinsonRaw:Qf,geoSatellite:function(){var t=2,e=0,n=Pr(Kf),i=n(t,e);return i.distance=function(i){return arguments.length?n(t=+i,e):t},i.tilt=function(i){return arguments.length?n(t,e=i*eh):e*th},i.scale(432.147).clipAngle(ih(1/t)*th-1e-6)},geoSatelliteRaw:Kf,geoSinuMollweide:function(){return Lr(ku).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},geoSinuMollweideRaw:ku,geoSinusoidal:function(){return Lr(Ih).scale(152.63)},geoSinusoidalRaw:Ih,geoStitch:function(t){if(null==t)return t;switch(t.type){case"Feature":return fd(t);case"FeatureCollection":var e={type:"FeatureCollection",features:t.features.map(fd)};return null!=t.bbox&&(e.bbox=t.bbox),e;default:return dd(t)}},geoTimes:function(){return Lr(gd).scale(146.153)},geoTimesRaw:gd,geoTwoPointAzimuthal:yd,geoTwoPointAzimuthalRaw:_d,geoTwoPointAzimuthalUsa:function(){return yd([-158,21.5],[-77,39]).clipAngle(60).scale(400)},geoTwoPointEquidistant:xd,geoTwoPointEquidistantRaw:md,geoTwoPointEquidistantUsa:function(){return xd([-158,21.5],[-77,39]).clipAngle(130).scale(122.571)},geoVanDerGrinten:function(){return Lr(vd).scale(79.4183)},geoVanDerGrintenRaw:vd,geoVanDerGrinten2:function(){return Lr(bd).scale(79.4183)},geoVanDerGrinten2Raw:bd,geoVanDerGrinten3:function(){return Lr(Md).scale(79.4183)},geoVanDerGrinten3Raw:Md,geoVanDerGrinten4:function(){return Lr(wd).scale(127.16)},geoVanDerGrinten4Raw:wd,geoWagner:Sd,geoWagner7:function(){return Sd().poleline(65).parallels(60).inflation(0).ratio(200).scale(172.633)},geoWagnerRaw:Ed,geoWagner4:function(){return Lr(kd).scale(176.84)},geoWagner4Raw:kd,geoWagner6:function(){return Lr(Od).scale(152.63)},geoWagner6Raw:Od,geoWiechel:function(){return Lr(Cd).rotate([0,-90,45]).scale(124.75).clipAngle(179.999)},geoWiechelRaw:Cd,geoWinkel3:function(){return Lr(Ad).scale(158.837)},geoWinkel3Raw:Ad});const Rd=Object.assign({},ds,Td);const Ld=Object.assign({},{geoAzimuthalEquidistant:$r});const Pd=Object.assign({},{geoHufnagel:Au});const Dd=Object.assign({},{geoProjection:Lr});function zd(t,e){const{abs:n,atan:i,ln:r,PI:s,sin:o,sqrt:a}=Math,l=1e-5,c=o(t);let h=a(1-e),u=c*c;if(u>=1||n(t)===s/2){if(h<=l)return c<0?-1/0:1/0;for(u=e=1,e+=h;n(u-h)>.001*e;)h=a(u*h),u=e/=2,e+=h;return c<0?-s/e:s/e}{if(h<=l)return r((1+c)/(1-c))/2;let t,o,f,d,g;for(o=0,t=e=1,f=e*h,e+=h,g=a((1-u)/u),n(g-=f/g)<=0&&(g=1e-9*a(f));n(t-h)>.001*t;)h=2*a(f),o+=o,g<0&&(o+=1),f=e*h,t=e,e+=h,n(g-=f/g)<=0&&(g=1e-9*a(f));return g<0&&(o+=1),d=(i(e/g)+s*o)/e,c<0?-d:d}}const{abs:Fd,max:Gd,min:jd,sin:qd,cos:Bd,asin:Yd,acos:$d,tan:Ud}=Math;function Wd(t,e){let n,i,r,s;const o=Ud(.5*e);return n=Bd(Yd(o))*qd(.5*t),r=o+n<0,s=o-n<0,i=$d(o),n=$d(n),function(t,e,n,i){let r=Math.asin(Math.sqrt(1+Math.min(0,Math.cos(t+e))));n&&(r=-r);let s=Math.asin(Math.sqrt(Math.abs(1-Math.max(0,Math.cos(t-e)))));return i&&(s=-s),[zd(r,.5),zd(s,.5)]}(n,i,r,s)}const Xd=Object.assign({},{geoOrthographic:hs});var Vd=6378137,Hd=.0066943799901413165,Jd=484813681109536e-20,Zd=Math.PI/2,Qd=1e-10,Kd=.017453292519943295,tg=57.29577951308232,eg=Math.PI/4,ng=2*Math.PI,ig=3.14159265359,rg={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667},sg={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},og=/[\s_\-\/\(\)]/g;function ag(t,e){if(t[e])return t[e];for(var n,i=Object.keys(t),r=e.toLowerCase().replace(og,""),s=-1;++s<i.length;)if((n=i[s]).toLowerCase().replace(og,"")===r)return t[n]}function lg(t){var e,n,i,r={},s=t.split("+").map((function(t){return t.trim()})).filter((function(t){return t})).reduce((function(t,e){var n=e.split("=");return n.push(!0),t[n[0].toLowerCase()]=n[1],t}),{}),o={proj:"projName",datum:"datumCode",rf:function(t){r.rf=parseFloat(t)},lat_0:function(t){r.lat0=t*Kd},lat_1:function(t){r.lat1=t*Kd},lat_2:function(t){r.lat2=t*Kd},lat_ts:function(t){r.lat_ts=t*Kd},lon_0:function(t){r.long0=t*Kd},lon_1:function(t){r.long1=t*Kd},lon_2:function(t){r.long2=t*Kd},alpha:function(t){r.alpha=parseFloat(t)*Kd},gamma:function(t){r.rectified_grid_angle=parseFloat(t)},lonc:function(t){r.longc=t*Kd},x_0:function(t){r.x0=parseFloat(t)},y_0:function(t){r.y0=parseFloat(t)},k_0:function(t){r.k0=parseFloat(t)},k:function(t){r.k0=parseFloat(t)},a:function(t){r.a=parseFloat(t)},b:function(t){r.b=parseFloat(t)},r_a:function(){r.R_A=!0},zone:function(t){r.zone=parseInt(t,10)},south:function(){r.utmSouth=!0},towgs84:function(t){r.datum_params=t.split(",").map((function(t){return parseFloat(t)}))},to_meter:function(t){r.to_meter=parseFloat(t)},units:function(t){r.units=t;var e=ag(sg,t);e&&(r.to_meter=e.to_meter)},from_greenwich:function(t){r.from_greenwich=t*Kd},pm:function(t){var e=ag(rg,t);r.from_greenwich=(e||parseFloat(t))*Kd},nadgrids:function(t){"@null"===t?r.datumCode="none":r.nadgrids=t},axis:function(t){var e="ewnsud";3===t.length&&-1!==e.indexOf(t.substr(0,1))&&-1!==e.indexOf(t.substr(1,1))&&-1!==e.indexOf(t.substr(2,1))&&(r.axis=t)},approx:function(){r.approx=!0}};for(e in s)n=s[e],e in o?"function"==typeof(i=o[e])?i(n):r[i]=n:r[e]=n;return"string"==typeof r.datumCode&&"WGS84"!==r.datumCode&&(r.datumCode=r.datumCode.toLowerCase()),r}var cg=/\s/,hg=/[A-Za-z]/,ug=/[A-Za-z84_]/,fg=/[,\]]/,dg=/[\d\.E\-\+]/;function gg(t){if("string"!=typeof t)throw new Error("not a string");this.text=t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=1}function pg(t,e,n){Array.isArray(e)&&(n.unshift(e),e=null);var i=e?{}:t,r=n.reduce((function(t,e){return _g(e,t),t}),i);e&&(t[e]=r)}function _g(t,e){if(Array.isArray(t)){var n=t.shift();if("PARAMETER"===n&&(n=t.shift()),1===t.length)return Array.isArray(t[0])?(e[n]={},void _g(t[0],e[n])):void(e[n]=t[0]);if(t.length)if("TOWGS84"!==n){if("AXIS"===n)return n in e||(e[n]=[]),void e[n].push(t);var i;switch(Array.isArray(n)||(e[n]={}),n){case"UNIT":case"PRIMEM":case"VERT_DATUM":return e[n]={name:t[0].toLowerCase(),convert:t[1]},void(3===t.length&&_g(t[2],e[n]));case"SPHEROID":case"ELLIPSOID":return e[n]={name:t[0],a:t[1],rf:t[2]},void(4===t.length&&_g(t[3],e[n]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return t[0]=["name",t[0]],void pg(e,n,t);default:for(i=-1;++i<t.length;)if(!Array.isArray(t[i]))return _g(t,e[n]);return pg(e,n,t)}}else e[n]=t;else e[n]=!0}else e[t]=!0}gg.prototype.readCharicter=function(){var t=this.text[this.place++];if(4!==this.state)for(;cg.test(t);){if(this.place>=this.text.length)return;t=this.text[this.place++]}switch(this.state){case 1:return this.neutral(t);case 2:return this.keyword(t);case 4:return this.quoted(t);case 5:return this.afterquote(t);case 3:return this.number(t);case-1:return}},gg.prototype.afterquote=function(t){if('"'===t)return this.word+='"',void(this.state=4);if(fg.test(t))return this.word=this.word.trim(),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in afterquote yet, index '+this.place)},gg.prototype.afterItem=function(t){return","===t?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=1)):"]"===t?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=1,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},gg.prototype.number=function(t){if(!dg.test(t)){if(fg.test(t))return this.word=parseFloat(this.word),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in number yet, index '+this.place)}this.word+=t},gg.prototype.quoted=function(t){'"'!==t?this.word+=t:this.state=5},gg.prototype.keyword=function(t){if(ug.test(t))this.word+=t;else{if("["===t){var e=[];return e.push(this.word),this.level++,null===this.root?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,void(this.state=1)}if(!fg.test(t))throw new Error("havn't handled \""+t+'" in keyword yet, index '+this.place);this.afterItem(t)}},gg.prototype.neutral=function(t){if(hg.test(t))return this.word=t,void(this.state=2);if('"'===t)return this.word="",void(this.state=4);if(dg.test(t))return this.word=t,void(this.state=3);if(!fg.test(t))throw new Error("havn't handled \""+t+'" in neutral yet, index '+this.place);this.afterItem(t)},gg.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function yg(t){return.017453292519943295*t}function mg(t){var e=new gg(t).output(),n=e.shift(),i=e.shift();e.unshift(["name",i]),e.unshift(["type",n]);var r={};return _g(e,r),function(t){if("GEOGCS"===t.type?t.projName="longlat":"LOCAL_CS"===t.type?(t.projName="identity",t.local=!0):"object"==typeof t.PROJECTION?t.projName=Object.keys(t.PROJECTION)[0]:t.projName=t.PROJECTION,t.AXIS){for(var e="",n=0,i=t.AXIS.length;n<i;++n){var r=[t.AXIS[n][0].toLowerCase(),t.AXIS[n][1].toLowerCase()];-1!==r[0].indexOf("north")||("y"===r[0]||"lat"===r[0])&&"north"===r[1]?e+="n":-1!==r[0].indexOf("south")||("y"===r[0]||"lat"===r[0])&&"south"===r[1]?e+="s":-1!==r[0].indexOf("east")||("x"===r[0]||"lon"===r[0])&&"east"===r[1]?e+="e":-1===r[0].indexOf("west")&&("x"!==r[0]&&"lon"!==r[0]||"west"!==r[1])||(e+="w")}2===e.length&&(e+="u"),3===e.length&&(t.axis=e)}t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),"metre"===t.units&&(t.units="meter"),t.UNIT.convert&&("GEOGCS"===t.type?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a):t.to_meter=t.UNIT.convert));var s=t.GEOGCS;function o(e){return e*(t.to_meter||1)}"GEOGCS"===t.type&&(s=t),s&&(s.DATUM?t.datumCode=s.DATUM.name.toLowerCase():t.datumCode=s.name.toLowerCase(),"d_"===t.datumCode.slice(0,2)&&(t.datumCode=t.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==t.datumCode&&"new_zealand_1949"!==t.datumCode||(t.datumCode="nzgd49"),"wgs_1984"!==t.datumCode&&"world_geodetic_system_1984"!==t.datumCode||("Mercator_Auxiliary_Sphere"===t.PROJECTION&&(t.sphere=!0),t.datumCode="wgs84"),"_ferro"===t.datumCode.slice(-6)&&(t.datumCode=t.datumCode.slice(0,-6)),"_jakarta"===t.datumCode.slice(-8)&&(t.datumCode=t.datumCode.slice(0,-8)),~t.datumCode.indexOf("belge")&&(t.datumCode="rnb72"),s.DATUM&&s.DATUM.SPHEROID&&(t.ellps=s.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===t.ellps.toLowerCase().slice(0,13)&&(t.ellps="intl"),t.a=s.DATUM.SPHEROID.a,t.rf=parseFloat(s.DATUM.SPHEROID.rf,10)),s.DATUM&&s.DATUM.TOWGS84&&(t.datum_params=s.DATUM.TOWGS84),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36"),~t.datumCode.indexOf("osni_1952")&&(t.datumCode="osni52"),(~t.datumCode.indexOf("tm65")||~t.datumCode.indexOf("geodetic_datum_of_1965"))&&(t.datumCode="ire65"),"ch1903+"===t.datumCode&&(t.datumCode="ch1903"),~t.datumCode.indexOf("israel")&&(t.datumCode="isr93")),t.b&&!isFinite(t.b)&&(t.b=t.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",yg],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",yg],["x0","false_easting",o],["y0","false_northing",o],["long0","central_meridian",yg],["lat0","latitude_of_origin",yg],["lat0","standard_parallel_1",yg],["lat1","standard_parallel_1",yg],["lat2","standard_parallel_2",yg],["azimuth","Azimuth"],["alpha","azimuth",yg],["srsCode","name"]].forEach((function(e){return function(t,e){var n=e[0],i=e[1];!(n in t)&&i in t&&(t[n]=t[i],3===e.length&&(t[n]=e[2](t[n])))}(t,e)})),t.long0||!t.longc||"Albers_Conic_Equal_Area"!==t.projName&&"Lambert_Azimuthal_Equal_Area"!==t.projName||(t.long0=t.longc),t.lat_ts||!t.lat1||"Stereographic_South_Pole"!==t.projName&&"Polar Stereographic (variant B)"!==t.projName||(t.lat0=yg(t.lat1>0?90:-90),t.lat_ts=t.lat1)}(r),r}function xg(t){var e=this;if(2===arguments.length){var n=arguments[1];"string"==typeof n?"+"===n.charAt(0)?xg[t]=lg(arguments[1]):xg[t]=mg(arguments[1]):xg[t]=n}else if(1===arguments.length){if(Array.isArray(t))return t.map((function(t){Array.isArray(t)?xg.apply(e,t):xg(t)}));if("string"==typeof t){if(t in xg)return xg[t]}else"EPSG"in t?xg["EPSG:"+t.EPSG]=t:"ESRI"in t?xg["ESRI:"+t.ESRI]=t:"IAU2000"in t?xg["IAU2000:"+t.IAU2000]=t:console.log(t);return}}!function(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}(xg);var vg=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];var bg=["3857","900913","3785","102113"];function Mg(t){if(!function(t){return"string"==typeof t}(t))return t;if(function(t){return t in xg}(t))return xg[t];if(function(t){return vg.some((function(e){return t.indexOf(e)>-1}))}(t)){var e=mg(t);if(function(t){var e=ag(t,"authority");if(e){var n=ag(e,"epsg");return n&&bg.indexOf(n)>-1}}(e))return xg["EPSG:3857"];var n=function(t){var e=ag(t,"extension");if(e)return ag(e,"proj4")}(e);return n?lg(n):e}return function(t){return"+"===t[0]}(t)?lg(t):void 0}function wg(t,e){var n,i;if(t=t||{},!e)return t;for(i in e)void 0!==(n=e[i])&&(t[i]=n);return t}function Eg(t,e,n){var i=t*e;return n/Math.sqrt(1-i*i)}function Sg(t){return t<0?-1:1}function Ng(t){return Math.abs(t)<=ig?t:t-Sg(t)*ng}function Ig(t,e,n){var i=t*n,r=.5*t;return i=Math.pow((1-i)/(1+i),r),Math.tan(.5*(Zd-e))/i}function kg(t,e){for(var n,i,r=.5*t,s=Zd-2*Math.atan(e),o=0;o<=15;o++)if(n=t*Math.sin(s),s+=i=Zd-2*Math.atan(e*Math.pow((1-n)/(1+n),r))-s,Math.abs(i)<=1e-10)return s;return-9999}var Og={init:function(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Eg(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},forward:function(t){var e,n,i=t.x,r=t.y;if(r*tg>90&&r*tg<-90&&i*tg>180&&i*tg<-180)return null;if(Math.abs(Math.abs(r)-Zd)<=Qd)return null;if(this.sphere)e=this.x0+this.a*this.k0*Ng(i-this.long0),n=this.y0+this.a*this.k0*Math.log(Math.tan(eg+.5*r));else{var s=Math.sin(r),o=Ig(this.e,r,s);e=this.x0+this.a*this.k0*Ng(i-this.long0),n=this.y0-this.a*this.k0*Math.log(o)}return t.x=e,t.y=n,t},inverse:function(t){var e,n,i=t.x-this.x0,r=t.y-this.y0;if(this.sphere)n=Zd-2*Math.atan(Math.exp(-r/(this.a*this.k0)));else{var s=Math.exp(-r/(this.a*this.k0));if(-9999===(n=kg(this.e,s)))return null}return e=Ng(this.long0+i/(this.a*this.k0)),t.x=e,t.y=n,t},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]};function Cg(t){return t}var Ag=[Og,{init:function(){},forward:Cg,inverse:Cg,names:["longlat","identity"]}],Tg={},Rg=[];function Lg(t,e){var n=Rg.length;return t.names?(Rg[n]=t,t.names.forEach((function(t){Tg[t.toLowerCase()]=n})),this):(console.log(e),!0)}var Pg={start:function(){Ag.forEach(Lg)},add:Lg,get:function(t){if(!t)return!1;var e=t.toLowerCase();return void 0!==Tg[e]&&Rg[Tg[e]]?Rg[Tg[e]]:void 0}},Dg={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},zg=Dg.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};Dg.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var Fg={};Fg.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},Fg.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},Fg.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},Fg.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},Fg.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},Fg.potsdam={towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},Fg.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},Fg.hermannskogel={towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},Fg.osni52={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},Fg.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},Fg.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},Fg.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},Fg.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},Fg.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},Fg.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},Fg.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},Fg.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"};var Gg={};function jg(t){if(0===t.length)return null;var e="@"===t[0];return e&&(t=t.slice(1)),"null"===t?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:t,mandatory:!e,grid:Gg[t]||null,isNull:!1}}function qg(t){return t/3600*Math.PI/180}function Bg(t,e,n){return String.fromCharCode.apply(null,new Uint8Array(t.buffer.slice(e,n)))}function Yg(t){return t.map((function(t){return[qg(t.longitudeShift),qg(t.latitudeShift)]}))}function $g(t,e,n){return{name:Bg(t,e+8,e+16).trim(),parent:Bg(t,e+24,e+24+8).trim(),lowerLatitude:t.getFloat64(e+72,n),upperLatitude:t.getFloat64(e+88,n),lowerLongitude:t.getFloat64(e+104,n),upperLongitude:t.getFloat64(e+120,n),latitudeInterval:t.getFloat64(e+136,n),longitudeInterval:t.getFloat64(e+152,n),gridNodeCount:t.getInt32(e+168,n)}}function Ug(t,e,n,i){for(var r=e+176,s=[],o=0;o<n.gridNodeCount;o++){var a={latitudeShift:t.getFloat32(r+16*o,i),longitudeShift:t.getFloat32(r+16*o+4,i),latitudeAccuracy:t.getFloat32(r+16*o+8,i),longitudeAccuracy:t.getFloat32(r+16*o+12,i)};s.push(a)}return s}function Wg(t,e){if(!(this instanceof Wg))return new Wg(t);e=e||function(t){if(t)throw t};var n=Mg(t);if("object"==typeof n){var i=Wg.projections.get(n.projName);if(i){if(n.datumCode&&"none"!==n.datumCode){var r=ag(Fg,n.datumCode);r&&(n.datum_params=n.datum_params||(r.towgs84?r.towgs84.split(","):null),n.ellps=r.ellipse,n.datumName=r.datumName?r.datumName:n.datumCode)}n.k0=n.k0||1,n.axis=n.axis||"enu",n.ellps=n.ellps||"wgs84",n.lat1=n.lat1||n.lat0;var s=function(t,e,n,i,r){if(!t){var s=ag(Dg,i);s||(s=zg),t=s.a,e=s.b,n=s.rf}return n&&!e&&(e=(1-1/n)*t),(0===n||Math.abs(t-e)<Qd)&&(r=!0,e=t),{a:t,b:e,rf:n,sphere:r}}(n.a,n.b,n.rf,n.ellps,n.sphere),o=function(t,e,n,i){var r=t*t,s=e*e,o=(r-s)/r,a=0;return i?(r=(t*=1-o*(.16666666666666666+o*(.04722222222222222+.022156084656084655*o)))*t,o=0):a=Math.sqrt(o),{es:o,e:a,ep2:(r-s)/s}}(s.a,s.b,s.rf,n.R_A),a=function(t){return void 0===t?null:t.split(",").map(jg)}(n.nadgrids),l=n.datum||function(t,e,n,i,r,s,o){var a={};return a.datum_type=void 0===t||"none"===t?5:4,e&&(a.datum_params=e.map(parseFloat),0===a.datum_params[0]&&0===a.datum_params[1]&&0===a.datum_params[2]||(a.datum_type=1),a.datum_params.length>3&&(0===a.datum_params[3]&&0===a.datum_params[4]&&0===a.datum_params[5]&&0===a.datum_params[6]||(a.datum_type=2,a.datum_params[3]*=Jd,a.datum_params[4]*=Jd,a.datum_params[5]*=Jd,a.datum_params[6]=a.datum_params[6]/1e6+1))),o&&(a.datum_type=3,a.grids=o),a.a=n,a.b=i,a.es=r,a.ep2=s,a}(n.datumCode,n.datum_params,s.a,s.b,o.es,o.ep2,a);wg(this,n),wg(this,i),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=o.es,this.e=o.e,this.ep2=o.ep2,this.datum=l,this.init(),e(null,this)}else e(t)}else e(t)}function Xg(t,e,n){var i,r,s,o,a=t.x,l=t.y,c=t.z?t.z:0;if(l<-Zd&&l>-1.001*Zd)l=-Zd;else if(l>Zd&&l<1.001*Zd)l=Zd;else{if(l<-Zd)return{x:-1/0,y:-1/0,z:t.z};if(l>Zd)return{x:1/0,y:1/0,z:t.z}}return a>Math.PI&&(a-=2*Math.PI),r=Math.sin(l),o=Math.cos(l),s=r*r,{x:((i=n/Math.sqrt(1-e*s))+c)*o*Math.cos(a),y:(i+c)*o*Math.sin(a),z:(i*(1-e)+c)*r}}function Vg(t,e,n,i){var r,s,o,a,l,c,h,u,f,d,g,p,_,y,m,x=1e-12,v=t.x,b=t.y,M=t.z?t.z:0;if(r=Math.sqrt(v*v+b*b),s=Math.sqrt(v*v+b*b+M*M),r/n<x){if(y=0,s/n<x)return Zd,m=-i,{x:t.x,y:t.y,z:t.z}}else y=Math.atan2(b,v);o=M/s,u=(a=r/s)*(1-e)*(l=1/Math.sqrt(1-e*(2-e)*a*a)),f=o*l,_=0;do{_++,c=e*(h=n/Math.sqrt(1-e*f*f))/(h+(m=r*u+M*f-h*(1-e*f*f))),p=(g=o*(l=1/Math.sqrt(1-c*(2-c)*a*a)))*u-(d=a*(1-c)*l)*f,u=d,f=g}while(p*p>1e-24&&_<30);return{x:y,y:Math.atan(g/Math.abs(d)),z:m}}function Hg(t){return 1===t||2===t}function Jg(t,e,n){if(function(t,e){return t.datum_type===e.datum_type&&!(t.a!==e.a||Math.abs(t.es-e.es)>5e-11)&&(1===t.datum_type?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]:2!==t.datum_type||t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]&&t.datum_params[3]===e.datum_params[3]&&t.datum_params[4]===e.datum_params[4]&&t.datum_params[5]===e.datum_params[5]&&t.datum_params[6]===e.datum_params[6])}(t,e))return n;if(5===t.datum_type||5===e.datum_type)return n;var i=t.a,r=t.es;if(3===t.datum_type){if(0!==Zg(t,!1,n))return;i=Vd,r=Hd}var s=e.a,o=e.b,a=e.es;if(3===e.datum_type&&(s=Vd,o=6356752.314,a=Hd),r===a&&i===s&&!Hg(t.datum_type)&&!Hg(e.datum_type))return n;if((n=Xg(n,r,i),Hg(t.datum_type)&&(n=function(t,e,n){if(1===e)return{x:t.x+n[0],y:t.y+n[1],z:t.z+n[2]};if(2===e){var i=n[0],r=n[1],s=n[2],o=n[3],a=n[4],l=n[5],c=n[6];return{x:c*(t.x-l*t.y+a*t.z)+i,y:c*(l*t.x+t.y-o*t.z)+r,z:c*(-a*t.x+o*t.y+t.z)+s}}}(n,t.datum_type,t.datum_params)),Hg(e.datum_type)&&(n=function(t,e,n){if(1===e)return{x:t.x-n[0],y:t.y-n[1],z:t.z-n[2]};if(2===e){var i=n[0],r=n[1],s=n[2],o=n[3],a=n[4],l=n[5],c=n[6],h=(t.x-i)/c,u=(t.y-r)/c,f=(t.z-s)/c;return{x:h+l*u-a*f,y:-l*h+u+o*f,z:a*h-o*u+f}}}(n,e.datum_type,e.datum_params)),n=Vg(n,a,s,o),3===e.datum_type)&&0!==Zg(e,!0,n))return;return n}function Zg(t,e,n){if(null===t.grids||0===t.grids.length)return console.log("Grid shift grids not found"),-1;for(var i={x:-n.x,y:n.y},r={x:Number.NaN,y:Number.NaN},s=[],o=0;o<t.grids.length;o++){var a=t.grids[o];if(s.push(a.name),a.isNull){r=i;break}if(a.mandatory,null!==a.grid){var l=a.grid.subgrids[0],c=(Math.abs(l.del[1])+Math.abs(l.del[0]))/1e4,h=l.ll[0]-c,u=l.ll[1]-c,f=l.ll[0]+(l.lim[0]-1)*l.del[0]+c,d=l.ll[1]+(l.lim[1]-1)*l.del[1]+c;if(!(u>i.y||h>i.x||d<i.y||f<i.x||(r=Qg(i,e,l),isNaN(r.x))))break}else if(a.mandatory)return console.log("Unable to find mandatory grid '"+a.name+"'"),-1}return isNaN(r.x)?(console.log("Failed to find a grid shift table for location '"+-i.x*tg+" "+i.y*tg+" tried: '"+s+"'"),-1):(n.x=-r.x,n.y=r.y,0)}function Qg(t,e,n){var i={x:Number.NaN,y:Number.NaN};if(isNaN(t.x))return i;var r={x:t.x,y:t.y};r.x-=n.ll[0],r.y-=n.ll[1],r.x=Ng(r.x-Math.PI)+Math.PI;var s=Kg(r,n);if(e){if(isNaN(s.x))return i;s.x=r.x-s.x,s.y=r.y-s.y;var o,a,l=9;do{if(a=Kg(s,n),isNaN(a.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}o={x:r.x-(a.x+s.x),y:r.y-(a.y+s.y)},s.x+=o.x,s.y+=o.y}while(l--&&Math.abs(o.x)>1e-12&&Math.abs(o.y)>1e-12);if(l<0)return console.log("Inverse grid shift iterator failed to converge."),i;i.x=Ng(s.x+n.ll[0]),i.y=s.y+n.ll[1]}else isNaN(s.x)||(i.x=t.x+s.x,i.y=t.y+s.y);return i}function Kg(t,e){var n,i={x:t.x/e.del[0],y:t.y/e.del[1]},r=Math.floor(i.x),s=Math.floor(i.y),o=i.x-1*r,a=i.y-1*s,l={x:Number.NaN,y:Number.NaN};if(r<0||r>=e.lim[0])return l;if(s<0||s>=e.lim[1])return l;n=s*e.lim[0]+r;var c=e.cvs[n][0],h=e.cvs[n][1];n++;var u=e.cvs[n][0],f=e.cvs[n][1];n+=e.lim[0];var d=e.cvs[n][0],g=e.cvs[n][1];n--;var p=e.cvs[n][0],_=e.cvs[n][1],y=o*a,m=o*(1-a),x=(1-o)*(1-a),v=(1-o)*a;return l.x=x*c+m*u+v*p+y*d,l.y=x*h+m*f+v*_+y*g,l}function tp(t,e,n){var i,r,s,o=n.x,a=n.y,l=n.z||0,c={};for(s=0;s<3;s++)if(!e||2!==s||void 0!==n.z)switch(0===s?(i=o,r=-1!=="ew".indexOf(t.axis[s])?"x":"y"):1===s?(i=a,r=-1!=="ns".indexOf(t.axis[s])?"y":"x"):(i=l,r="z"),t.axis[s]){case"e":case"n":c[r]=i;break;case"w":case"s":c[r]=-i;break;case"u":void 0!==n[r]&&(c.z=i);break;case"d":void 0!==n[r]&&(c.z=-i);break;default:return null}return c}function ep(t){var e={x:t[0],y:t[1]};return t.length>2&&(e.z=t[2]),t.length>3&&(e.m=t[3]),e}function np(t){if("function"==typeof Number.isFinite){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof t||t!=t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}function ip(t,e,n,i){var r;if(Array.isArray(n)&&(n=ep(n)),function(t){np(t.x),np(t.y)}(n),t.datum&&e.datum&&function(t,e){return(1===t.datum.datum_type||2===t.datum.datum_type)&&"WGS84"!==e.datumCode||(1===e.datum.datum_type||2===e.datum.datum_type)&&"WGS84"!==t.datumCode}(t,e)&&(n=ip(t,r=new Wg("WGS84"),n,i),t=r),i&&"enu"!==t.axis&&(n=tp(t,!1,n)),"longlat"===t.projName)n={x:n.x*Kd,y:n.y*Kd,z:n.z||0};else if(t.to_meter&&(n={x:n.x*t.to_meter,y:n.y*t.to_meter,z:n.z||0}),!(n=t.inverse(n)))return;if(t.from_greenwich&&(n.x+=t.from_greenwich),n=Jg(t.datum,e.datum,n))return e.from_greenwich&&(n={x:n.x-e.from_greenwich,y:n.y,z:n.z||0}),"longlat"===e.projName?n={x:n.x*tg,y:n.y*tg,z:n.z||0}:(n=e.forward(n),e.to_meter&&(n={x:n.x/e.to_meter,y:n.y/e.to_meter,z:n.z||0})),i&&"enu"!==e.axis?tp(e,!0,n):n}Wg.projections=Pg,Wg.projections.start();var rp=Wg("WGS84");function sp(t,e,n,i){var r,s,o;return Array.isArray(n)?(r=ip(t,e,n,i)||{x:NaN,y:NaN},n.length>2?void 0!==t.name&&"geocent"===t.name||void 0!==e.name&&"geocent"===e.name?"number"==typeof r.z?[r.x,r.y,r.z].concat(n.splice(3)):[r.x,r.y,n[2]].concat(n.splice(3)):[r.x,r.y].concat(n.splice(2)):[r.x,r.y]):(s=ip(t,e,n,i),2===(o=Object.keys(n)).length||o.forEach((function(i){if(void 0!==t.name&&"geocent"===t.name||void 0!==e.name&&"geocent"===e.name){if("x"===i||"y"===i||"z"===i)return}else if("x"===i||"y"===i)return;s[i]=n[i]})),s)}function op(t){return t instanceof Wg?t:t.oProj?t.oProj:Wg(t)}function ap(t,e,n){t=op(t);var i,r=!1;return void 0===e?(e=t,t=rp,r=!0):(void 0!==e.x||Array.isArray(e))&&(n=e,e=t,t=rp,r=!0),e=op(e),n?sp(t,e,n):(i={forward:function(n,i){return sp(t,e,n,i)},inverse:function(n,i){return sp(e,t,n,i)}},r&&(i.oProj=e),i)}var lp="AJSAJS",cp="AFAFAF",hp=65,up=73,fp=79,dp=86,gp=90,pp={forward:_p,inverse:function(t){var e=vp(wp(t.toUpperCase()));if(e.lat&&e.lon)return[e.lon,e.lat,e.lon,e.lat];return[e.left,e.bottom,e.right,e.top]},toPoint:yp};function _p(t,e){return e=e||5,function(t,e){var n="00000"+t.easting,i="00000"+t.northing;return t.zoneNumber+t.zoneLetter+(r=t.easting,s=t.northing,o=t.zoneNumber,a=Mp(o),l=Math.floor(r/1e5),c=Math.floor(s/1e5)%20,function(t,e,n){var i=n-1,r=lp.charCodeAt(i),s=cp.charCodeAt(i),o=r+t-1,a=s+e,l=!1;return o>gp&&(o=o-gp+hp-1,l=!0),(o===up||r<up&&o>up||(o>up||r<up)&&l)&&o++,(o===fp||r<fp&&o>fp||(o>fp||r<fp)&&l)&&++o===up&&o++,o>gp&&(o=o-gp+hp-1),a>dp?(a=a-dp+hp-1,l=!0):l=!1,(a===up||s<up&&a>up||(a>up||s<up)&&l)&&a++,(a===fp||s<fp&&a>fp||(a>fp||s<fp)&&l)&&++a===up&&a++,a>dp&&(a=a-dp+hp-1),String.fromCharCode(o)+String.fromCharCode(a)}(l,c,a))+n.substr(n.length-5,e)+i.substr(i.length-5,e);var r,s,o,a,l,c}(function(t){var e,n,i,r,s,o,a,l,c=t.lat,h=t.lon,u=6378137,f=.00669438,d=.9996,g=mp(c),p=mp(h);l=Math.floor((h+180)/6)+1,180===h&&(l=60);c>=56&&c<64&&h>=3&&h<12&&(l=32);c>=72&&c<84&&(h>=0&&h<9?l=31:h>=9&&h<21?l=33:h>=21&&h<33?l=35:h>=33&&h<42&&(l=37));a=mp(6*(l-1)-180+3),e=f/(1-f),n=u/Math.sqrt(1-f*Math.sin(g)*Math.sin(g)),i=Math.tan(g)*Math.tan(g),r=e*Math.cos(g)*Math.cos(g),s=Math.cos(g)*(p-a),o=u*((1-f/4-3*f*f/64-5*f*f*f/256)*g-(3*f/8+3*f*f/32+45*f*f*f/1024)*Math.sin(2*g)+(15*f*f/256+45*f*f*f/1024)*Math.sin(4*g)-35*f*f*f/3072*Math.sin(6*g));var _=d*n*(s+(1-i+r)*s*s*s/6+(5-18*i+i*i+72*r-58*e)*s*s*s*s*s/120)+5e5,y=d*(o+n*Math.tan(g)*(s*s/2+(5-i+9*r+4*r*r)*s*s*s*s/24+(61-58*i+i*i+600*r-330*e)*s*s*s*s*s*s/720));c<0&&(y+=1e7);return{northing:Math.round(y),easting:Math.round(_),zoneNumber:l,zoneLetter:bp(c)}}({lat:t[1],lon:t[0]}),e)}function yp(t){var e=vp(wp(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function mp(t){return t*(Math.PI/180)}function xp(t){return t/Math.PI*180}function vp(t){var e=t.northing,n=t.easting,i=t.zoneLetter,r=t.zoneNumber;if(r<0||r>60)return null;var s,o,a,l,c,h,u,f,d,g=.9996,p=6378137,_=.00669438,y=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),m=n-5e5,x=e;i<"N"&&(x-=1e7),u=6*(r-1)-180+3,s=.006739496752268451,d=(f=x/g/6367449.145945056)+(3*y/2-27*y*y*y/32)*Math.sin(2*f)+(21*y*y/16-55*y*y*y*y/32)*Math.sin(4*f)+151*y*y*y/96*Math.sin(6*f),o=p/Math.sqrt(1-_*Math.sin(d)*Math.sin(d)),a=Math.tan(d)*Math.tan(d),l=s*Math.cos(d)*Math.cos(d),c=.99330562*p/Math.pow(1-_*Math.sin(d)*Math.sin(d),1.5),h=m/(o*g);var v=d-o*Math.tan(d)/c*(h*h/2-(5+3*a+10*l-4*l*l-9*s)*h*h*h*h/24+(61+90*a+298*l+45*a*a-1.6983531815716497-3*l*l)*h*h*h*h*h*h/720);v=xp(v);var b,M=(h-(1+2*a+l)*h*h*h/6+(5-2*l+28*a-3*l*l+8*s+24*a*a)*h*h*h*h*h/120)/Math.cos(d);if(M=u+xp(M),t.accuracy){var w=vp({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});b={top:w.lat,right:w.lon,bottom:v,left:M}}else b={lat:v,lon:M};return b}function bp(t){var e="Z";return 84>=t&&t>=72?e="X":72>t&&t>=64?e="W":64>t&&t>=56?e="V":56>t&&t>=48?e="U":48>t&&t>=40?e="T":40>t&&t>=32?e="S":32>t&&t>=24?e="R":24>t&&t>=16?e="Q":16>t&&t>=8?e="P":8>t&&t>=0?e="N":0>t&&t>=-8?e="M":-8>t&&t>=-16?e="L":-16>t&&t>=-24?e="K":-24>t&&t>=-32?e="J":-32>t&&t>=-40?e="H":-40>t&&t>=-48?e="G":-48>t&&t>=-56?e="F":-56>t&&t>=-64?e="E":-64>t&&t>=-72?e="D":-72>t&&t>=-80&&(e="C"),e}function Mp(t){var e=t%6;return 0===e&&(e=6),e}function wp(t){if(t&&0===t.length)throw"MGRSPoint coverting from nothing";for(var e,n=t.length,i=null,r="",s=0;!/[A-Z]/.test(e=t.charAt(s));){if(s>=2)throw"MGRSPoint bad conversion from: "+t;r+=e,s++}var o=parseInt(r,10);if(0===s||s+3>n)throw"MGRSPoint bad conversion from: "+t;var a=t.charAt(s++);if(a<="A"||"B"===a||"Y"===a||a>="Z"||"I"===a||"O"===a)throw"MGRSPoint zone letter "+a+" not handled: "+t;i=t.substring(s,s+=2);for(var l=Mp(o),c=function(t,e){var n=lp.charCodeAt(e-1),i=1e5,r=!1;for(;n!==t.charCodeAt(0);){if(++n===up&&n++,n===fp&&n++,n>gp){if(r)throw"Bad character: "+t;n=hp,r=!0}i+=1e5}return i}(i.charAt(0),l),h=function(t,e){if(t>"V")throw"MGRSPoint given invalid Northing "+t;var n=cp.charCodeAt(e-1),i=0,r=!1;for(;n!==t.charCodeAt(0);){if(++n===up&&n++,n===fp&&n++,n>dp){if(r)throw"Bad character: "+t;n=hp,r=!0}i+=1e5}return i}(i.charAt(1),l);h<Ep(a);)h+=2e6;var u=n-s;if(u%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+t;var f,d,g,p=u/2,_=0,y=0;return p>0&&(f=1e5/Math.pow(10,p),d=t.substring(s,s+p),_=parseFloat(d)*f,g=t.substring(s+p),y=parseFloat(g)*f),{easting:_+c,northing:y+h,zoneLetter:a,zoneNumber:o,accuracy:f}}function Ep(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+t}function Sp(t,e,n){if(!(this instanceof Sp))return new Sp(t,e,n);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if("object"==typeof t)this.x=t.x,this.y=t.y,this.z=t.z||0;else if("string"==typeof t&&void 0===e){var i=t.split(",");this.x=parseFloat(i[0],10),this.y=parseFloat(i[1],10),this.z=parseFloat(i[2],10)||0}else this.x=t,this.y=e,this.z=n||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}Sp.fromMGRS=function(t){return new Sp(yp(t))},Sp.prototype.toMGRS=function(t){return _p([this.x,this.y],t)};var Np=.046875,Ip=.01953125,kp=.01068115234375;function Op(t){var e=[];e[0]=1-t*(.25+t*(Np+t*(Ip+t*kp))),e[1]=t*(.75-t*(Np+t*(Ip+t*kp)));var n=t*t;return e[2]=n*(.46875-t*(.013020833333333334+.007120768229166667*t)),n*=t,e[3]=n*(.3645833333333333-.005696614583333333*t),e[4]=n*t*.3076171875,e}function Cp(t,e,n,i){return n*=e,e*=e,i[0]*t-n*(i[1]+e*(i[2]+e*(i[3]+e*i[4])))}function Ap(t,e,n){for(var i=1/(1-e),r=t,s=20;s;--s){var o=Math.sin(r),a=1-e*o*o;if(r-=a=(Cp(r,o,Math.cos(r),n)-t)*(a*Math.sqrt(a))*i,Math.abs(a)<Qd)return r}return r}var Tp={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=Op(this.es),this.ml0=Cp(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(t){var e,n,i,r=t.x,s=t.y,o=Ng(r-this.long0),a=Math.sin(s),l=Math.cos(s);if(this.es){var c=l*o,h=Math.pow(c,2),u=this.ep2*Math.pow(l,2),f=Math.pow(u,2),d=Math.abs(l)>Qd?Math.tan(s):0,g=Math.pow(d,2),p=Math.pow(g,2);e=1-this.es*Math.pow(a,2),c/=Math.sqrt(e);var _=Cp(s,a,l,this.en);n=this.a*(this.k0*c*(1+h/6*(1-g+u+h/20*(5-18*g+p+14*u-58*g*u+h/42*(61+179*p-p*g-479*g)))))+this.x0,i=this.a*(this.k0*(_-this.ml0+a*o*c/2*(1+h/12*(5-g+9*u+4*f+h/30*(61+p-58*g+270*u-330*g*u+h/56*(1385+543*p-p*g-3111*g))))))+this.y0}else{var y=l*Math.sin(o);if(Math.abs(Math.abs(y)-1)<Qd)return 93;if(n=.5*this.a*this.k0*Math.log((1+y)/(1-y))+this.x0,i=l*Math.cos(o)/Math.sqrt(1-Math.pow(y,2)),(y=Math.abs(i))>=1){if(y-1>Qd)return 93;i=0}else i=Math.acos(i);s<0&&(i=-i),i=this.a*this.k0*(i-this.lat0)+this.y0}return t.x=n,t.y=i,t},inverse:function(t){var e,n,i,r,s=(t.x-this.x0)*(1/this.a),o=(t.y-this.y0)*(1/this.a);if(this.es)if(n=Ap(e=this.ml0+o/this.k0,this.es,this.en),Math.abs(n)<Zd){var a=Math.sin(n),l=Math.cos(n),c=Math.abs(l)>Qd?Math.tan(n):0,h=this.ep2*Math.pow(l,2),u=Math.pow(h,2),f=Math.pow(c,2),d=Math.pow(f,2);e=1-this.es*Math.pow(a,2);var g=s*Math.sqrt(e)/this.k0,p=Math.pow(g,2);i=n-(e*=c)*p/(1-this.es)*.5*(1-p/12*(5+3*f-9*h*f+h-4*u-p/30*(61+90*f-252*h*f+45*d+46*h-p/56*(1385+3633*f+4095*d+1574*d*f)))),r=Ng(this.long0+g*(1-p/6*(1+2*f+h-p/20*(5+28*f+24*d+8*h*f+6*h-p/42*(61+662*f+1320*d+720*d*f))))/l)}else i=Zd*Sg(o),r=0;else{var _=Math.exp(s/this.k0),y=.5*(_-1/_),m=this.lat0+o/this.k0,x=Math.cos(m);e=Math.sqrt((1-Math.pow(x,2))/(1+Math.pow(y,2))),i=Math.asin(e),o<0&&(i=-i),r=0===y&&0===x?0:Ng(Math.atan2(y,x)+this.long0)}return t.x=r,t.y=i,t},names:["Fast_Transverse_Mercator","Fast Transverse Mercator"]};function Rp(t){var e=Math.exp(t);return e=(e-1/e)/2}function Lp(t,e){t=Math.abs(t),e=Math.abs(e);var n=Math.max(t,e),i=Math.min(t,e)/(n||1);return n*Math.sqrt(1+Math.pow(i,2))}function Pp(t){var e=Math.abs(t);return e=function(t){var e=1+t,n=e-1;return 0===n?t:t*Math.log(e)/n}(e*(1+e/(Lp(1,e)+1))),t<0?-e:e}function Dp(t,e){for(var n,i=2*Math.cos(2*e),r=t.length-1,s=t[r],o=0;--r>=0;)n=i*s-o+t[r],o=s,s=n;return e+n*Math.sin(2*e)}function zp(t,e,n){for(var i,r,s=Math.sin(e),o=Math.cos(e),a=Rp(n),l=function(t){var e=Math.exp(t);return(e+1/e)/2}(n),c=2*o*l,h=-2*s*a,u=t.length-1,f=t[u],d=0,g=0,p=0;--u>=0;)i=g,r=d,f=c*(g=f)-i-h*(d=p)+t[u],p=h*g-r+c*d;return[(c=s*l)*f-(h=o*a)*p,c*p+h*f]}var Fp={init:function(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(Tp.init.apply(this),this.forward=Tp.forward,this.inverse=Tp.inverse),this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),e=t/(2-t),n=e;this.cgb[0]=e*(2+e*(-2/3+e*(e*(116/45+e*(26/45+e*(-2854/675)))-2))),this.cbg[0]=e*(e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))-2),n*=e,this.cgb[1]=n*(7/3+e*(e*(-227/45+e*(2704/315+e*(2323/945)))-1.6)),this.cbg[1]=n*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),n*=e,this.cgb[2]=n*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=n*(-26/15+e*(34/21+e*(1.6+e*(-12686/2835)))),n*=e,this.cgb[3]=n*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=n*(1237/630+e*(e*(-24832/14175)-2.4)),n*=e,this.cgb[4]=n*(4174/315+e*(-144838/6237)),this.cbg[4]=n*(-734/315+e*(109598/31185)),n*=e,this.cgb[5]=n*(601676/22275),this.cbg[5]=n*(444337/155925),n=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+n*(1/4+n*(1/64+n/256))),this.utg[0]=e*(e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))-.5),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=n*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=n*(13/48+e*(e*(557/1440+e*(281/630+e*(-1983433/1935360)))-.6)),n*=e,this.utg[2]=n*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=n*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),n*=e,this.utg[3]=n*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=n*(49561/161280+e*(-179/168+e*(6601661/7257600))),n*=e,this.utg[4]=n*(-4583/161280+e*(108847/3991680)),this.gtu[4]=n*(34729/80640+e*(-3418889/1995840)),n*=e,this.utg[5]=n*(-20648693/638668800),this.gtu[5]=.6650675310896665*n;var i=Dp(this.cbg,this.lat0);this.Zb=-this.Qn*(i+function(t,e){for(var n,i=2*Math.cos(e),r=t.length-1,s=t[r],o=0;--r>=0;)n=i*s-o+t[r],o=s,s=n;return Math.sin(e)*n}(this.gtu,2*i))},forward:function(t){var e=Ng(t.x-this.long0),n=t.y;n=Dp(this.cbg,n);var i=Math.sin(n),r=Math.cos(n),s=Math.sin(e),o=Math.cos(e);n=Math.atan2(i,o*r),e=Math.atan2(s*r,Lp(i,r*o)),e=Pp(Math.tan(e));var a,l,c=zp(this.gtu,2*n,2*e);return n+=c[0],e+=c[1],Math.abs(e)<=2.623395162778?(a=this.a*(this.Qn*e)+this.x0,l=this.a*(this.Qn*n+this.Zb)+this.y0):(a=1/0,l=1/0),t.x=a,t.y=l,t},inverse:function(t){var e,n,i=(t.x-this.x0)*(1/this.a),r=(t.y-this.y0)*(1/this.a);if(r=(r-this.Zb)/this.Qn,i/=this.Qn,Math.abs(i)<=2.623395162778){var s=zp(this.utg,2*r,2*i);r+=s[0],i+=s[1],i=Math.atan(Rp(i));var o=Math.sin(r),a=Math.cos(r),l=Math.sin(i),c=Math.cos(i);r=Math.atan2(o*c,Lp(l,c*a)),e=Ng((i=Math.atan2(l,c*a))+this.long0),n=Dp(this.cgb,r)}else e=1/0,n=1/0;return t.x=e,t.y=n,t},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","tmerc"]};var Gp={init:function(){var t=function(t,e){if(void 0===t){if((t=Math.floor(30*(Ng(e)+Math.PI)/Math.PI)+1)<0)return 0;if(t>60)return 60}return t}(this.zone,this.long0);if(void 0===t)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*Kd,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,Fp.init.apply(this),this.forward=Fp.forward,this.inverse=Fp.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"};function jp(t,e){return Math.pow((1-t)/(1+t),e)}var qp={init:function(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+eg)/(Math.pow(Math.tan(.5*this.lat0+eg),this.C)*jp(this.e*t,this.ratexp))},forward:function(t){var e=t.x,n=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*n+eg),this.C)*jp(this.e*Math.sin(n),this.ratexp))-Zd,t.x=this.C*e,t},inverse:function(t){for(var e=t.x/this.C,n=t.y,i=Math.pow(Math.tan(.5*n+eg)/this.K,1/this.C),r=20;r>0&&(n=2*Math.atan(i*jp(this.e*Math.sin(t.y),-.5*this.e))-Zd,!(Math.abs(n-t.y)<1e-14));--r)t.y=n;return r?(t.x=e,t.y=n,t):null},names:["gauss"]};var Bp={init:function(){qp.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(t){var e,n,i,r;return t.x=Ng(t.x-this.long0),qp.forward.apply(this,[t]),e=Math.sin(t.y),n=Math.cos(t.y),i=Math.cos(t.x),r=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*n*i),t.x=r*n*Math.sin(t.x),t.y=r*(this.cosc0*e-this.sinc0*n*i),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},inverse:function(t){var e,n,i,r,s;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,s=Math.sqrt(t.x*t.x+t.y*t.y)){var o=2*Math.atan2(s,this.R2);e=Math.sin(o),n=Math.cos(o),r=Math.asin(n*this.sinc0+t.y*e*this.cosc0/s),i=Math.atan2(t.x*e,s*this.cosc0*n-t.y*this.sinc0*e)}else r=this.phic0,i=0;return t.x=i,t.y=r,qp.inverse.apply(this,[t]),t.x=Ng(t.x+this.long0),t},names:["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]};var Yp={init:function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Qd&&(this.k0=.5*(1+Sg(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=Qd&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Qd&&(this.k0=.5*this.cons*Eg(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Ig(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Eg(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-Zd,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(t){var e,n,i,r,s,o,a=t.x,l=t.y,c=Math.sin(l),h=Math.cos(l),u=Ng(a-this.long0);return Math.abs(Math.abs(a-this.long0)-Math.PI)<=Qd&&Math.abs(l+this.lat0)<=Qd?(t.x=NaN,t.y=NaN,t):this.sphere?(e=2*this.k0/(1+this.sinlat0*c+this.coslat0*h*Math.cos(u)),t.x=this.a*e*h*Math.sin(u)+this.x0,t.y=this.a*e*(this.coslat0*c-this.sinlat0*h*Math.cos(u))+this.y0,t):(n=2*Math.atan(this.ssfn_(l,c,this.e))-Zd,r=Math.cos(n),i=Math.sin(n),Math.abs(this.coslat0)<=Qd?(s=Ig(this.e,l*this.con,this.con*c),o=2*this.a*this.k0*s/this.cons,t.x=this.x0+o*Math.sin(a-this.long0),t.y=this.y0-this.con*o*Math.cos(a-this.long0),t):(Math.abs(this.sinlat0)<Qd?(e=2*this.a*this.k0/(1+r*Math.cos(u)),t.y=e*i):(e=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*i+this.cosX0*r*Math.cos(u))),t.y=e*(this.cosX0*i-this.sinX0*r*Math.cos(u))+this.y0),t.x=e*r*Math.sin(u)+this.x0,t))},inverse:function(t){var e,n,i,r,s;t.x-=this.x0,t.y-=this.y0;var o=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var a=2*Math.atan(o/(2*this.a*this.k0));return e=this.long0,n=this.lat0,o<=Qd?(t.x=e,t.y=n,t):(n=Math.asin(Math.cos(a)*this.sinlat0+t.y*Math.sin(a)*this.coslat0/o),e=Math.abs(this.coslat0)<Qd?this.lat0>0?Ng(this.long0+Math.atan2(t.x,-1*t.y)):Ng(this.long0+Math.atan2(t.x,t.y)):Ng(this.long0+Math.atan2(t.x*Math.sin(a),o*this.coslat0*Math.cos(a)-t.y*this.sinlat0*Math.sin(a))),t.x=e,t.y=n,t)}if(Math.abs(this.coslat0)<=Qd){if(o<=Qd)return n=this.lat0,e=this.long0,t.x=e,t.y=n,t;t.x*=this.con,t.y*=this.con,i=o*this.cons/(2*this.a*this.k0),n=this.con*kg(this.e,i),e=this.con*Ng(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else r=2*Math.atan(o*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,o<=Qd?s=this.X0:(s=Math.asin(Math.cos(r)*this.sinX0+t.y*Math.sin(r)*this.cosX0/o),e=Ng(this.long0+Math.atan2(t.x*Math.sin(r),o*this.cosX0*Math.cos(r)-t.y*this.sinX0*Math.sin(r)))),n=-1*kg(this.e,Math.tan(.5*(Zd+s)));return t.x=e,t.y=n,t},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],ssfn_:function(t,e,n){return e*=n,Math.tan(.5*(Zd+t))*Math.pow((1-e)/(1+e),.5*n)}};var $p={init:function(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),n=this.a,i=1/this.rf,r=2*i-Math.pow(i,2),s=this.e=Math.sqrt(r);this.R=this.k0*n*Math.sqrt(1-r)/(1-r*Math.pow(e,2)),this.alpha=Math.sqrt(1+r/(1-r)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var o=Math.log(Math.tan(Math.PI/4+this.b0/2)),a=Math.log(Math.tan(Math.PI/4+t/2)),l=Math.log((1+s*e)/(1-s*e));this.K=o-this.alpha*a+this.alpha*s/2*l},forward:function(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),n=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),i=-this.alpha*(e+n)+this.K,r=2*(Math.atan(Math.exp(i))-Math.PI/4),s=this.alpha*(t.x-this.lambda0),o=Math.atan(Math.sin(s)/(Math.sin(this.b0)*Math.tan(r)+Math.cos(this.b0)*Math.cos(s))),a=Math.asin(Math.cos(this.b0)*Math.sin(r)-Math.sin(this.b0)*Math.cos(r)*Math.cos(s));return t.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0,t.x=this.R*o+this.x0,t},inverse:function(t){for(var e=t.x-this.x0,n=t.y-this.y0,i=e/this.R,r=2*(Math.atan(Math.exp(n/this.R))-Math.PI/4),s=Math.asin(Math.cos(this.b0)*Math.sin(r)+Math.sin(this.b0)*Math.cos(r)*Math.cos(i)),o=Math.atan(Math.sin(i)/(Math.cos(this.b0)*Math.cos(i)-Math.sin(this.b0)*Math.tan(r))),a=this.lambda0+o/this.alpha,l=0,c=s,h=-1e3,u=0;Math.abs(c-h)>1e-7;){if(++u>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+s/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(c))/2)),h=c,c=2*Math.atan(Math.exp(l))-Math.PI/2}return t.x=a,t.y=c,t},names:["somerc"]},Up=1e-7;var Wp={init:function(){var t,e,n,i,r,s,o,a,l,c,h,u,f,d=0,g=0,p=0,_=0,y=0,m=0,x=0;this.no_off=(f="object"==typeof(u=this).PROJECTION?Object.keys(u.PROJECTION)[0]:u.PROJECTION,"no_uoff"in u||"no_off"in u||-1!==["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"].indexOf(f)),this.no_rot="no_rot"in this;var v=!1;"alpha"in this&&(v=!0);var b=!1;if("rectified_grid_angle"in this&&(b=!0),v&&(x=this.alpha),b&&(d=this.rectified_grid_angle*Kd),v||b)g=this.longc;else if(p=this.long1,y=this.lat1,_=this.long2,m=this.lat2,Math.abs(y-m)<=Up||(t=Math.abs(y))<=Up||Math.abs(t-Zd)<=Up||Math.abs(Math.abs(this.lat0)-Zd)<=Up||Math.abs(Math.abs(m)-Zd)<=Up)throw new Error;var M=1-this.es;e=Math.sqrt(M),Math.abs(this.lat0)>Qd?(a=Math.sin(this.lat0),n=Math.cos(this.lat0),t=1-this.es*a*a,this.B=n*n,this.B=Math.sqrt(1+this.es*this.B*this.B/M),this.A=this.B*this.k0*e/t,(r=(i=this.B*e/(n*Math.sqrt(t)))*i-1)<=0?r=0:(r=Math.sqrt(r),this.lat0<0&&(r=-r)),this.E=r+=i,this.E*=Math.pow(Ig(this.e,this.lat0,a),this.B)):(this.B=1/e,this.A=this.k0,this.E=i=r=1),v||b?(v?(h=Math.asin(Math.sin(x)/i),b||(d=x)):(h=d,x=Math.asin(i*Math.sin(h))),this.lam0=g-Math.asin(.5*(r-1/r)*Math.tan(h))/this.B):(s=Math.pow(Ig(this.e,y,Math.sin(y)),this.B),o=Math.pow(Ig(this.e,m,Math.sin(m)),this.B),r=this.E/s,l=(o-s)/(o+s),c=((c=this.E*this.E)-o*s)/(c+o*s),(t=p-_)<-Math.pi?_-=ng:t>Math.pi&&(_+=ng),this.lam0=Ng(.5*(p+_)-Math.atan(c*Math.tan(.5*this.B*(p-_))/l)/this.B),h=Math.atan(2*Math.sin(this.B*Ng(p-this.lam0))/(r-1/r)),d=x=Math.asin(i*Math.sin(h))),this.singam=Math.sin(h),this.cosgam=Math.cos(h),this.sinrot=Math.sin(d),this.cosrot=Math.cos(d),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.A,this.B,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(i*i-1)/Math.cos(x))),this.lat0<0&&(this.u_0=-this.u_0)),r=.5*h,this.v_pole_n=this.ArB*Math.log(Math.tan(eg-r)),this.v_pole_s=this.ArB*Math.log(Math.tan(eg+r))},forward:function(t){var e,n,i,r,s,o,a,l,c={};if(t.x=t.x-this.lam0,Math.abs(Math.abs(t.y)-Zd)>Qd){if(e=.5*((s=this.E/Math.pow(Ig(this.e,t.y,Math.sin(t.y)),this.B))-(o=1/s)),n=.5*(s+o),r=Math.sin(this.B*t.x),i=(e*this.singam-r*this.cosgam)/n,Math.abs(Math.abs(i)-1)<Qd)throw new Error;l=.5*this.ArB*Math.log((1-i)/(1+i)),o=Math.cos(this.B*t.x),a=Math.abs(o)<Up?this.A*t.x:this.ArB*Math.atan2(e*this.cosgam+r*this.singam,o)}else l=t.y>0?this.v_pole_n:this.v_pole_s,a=this.ArB*t.y;return this.no_rot?(c.x=a,c.y=l):(a-=this.u_0,c.x=l*this.cosrot+a*this.sinrot,c.y=a*this.cosrot-l*this.sinrot),c.x=this.a*c.x+this.x0,c.y=this.a*c.y+this.y0,c},inverse:function(t){var e,n,i,r,s,o,a,l={};if(t.x=(t.x-this.x0)*(1/this.a),t.y=(t.y-this.y0)*(1/this.a),this.no_rot?(n=t.y,e=t.x):(n=t.x*this.cosrot-t.y*this.sinrot,e=t.y*this.cosrot+t.x*this.sinrot+this.u_0),r=.5*((i=Math.exp(-this.BrA*n))-1/i),s=.5*(i+1/i),a=((o=Math.sin(this.BrA*e))*this.cosgam+r*this.singam)/s,Math.abs(Math.abs(a)-1)<Qd)l.x=0,l.y=a<0?-Zd:Zd;else{if(l.y=this.E/Math.sqrt((1+a)/(1-a)),l.y=kg(this.e,Math.pow(l.y,1/this.B)),l.y===1/0)throw new Error;l.x=-this.rB*Math.atan2(r*this.cosgam-o*this.singam,Math.cos(this.BrA*e))}return l.x+=this.lam0,l},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"]};var Xp={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<Qd)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),n=Math.cos(this.lat1),i=Eg(this.e,e,n),r=Ig(this.e,this.lat1,e),s=Math.sin(this.lat2),o=Math.cos(this.lat2),a=Eg(this.e,s,o),l=Ig(this.e,this.lat2,s),c=Ig(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>Qd?this.ns=Math.log(i/a)/Math.log(r/l):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=i/(this.ns*Math.pow(r,this.ns)),this.rh=this.a*this.f0*Math.pow(c,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(t){var e=t.x,n=t.y;Math.abs(2*Math.abs(n)-Math.PI)<=Qd&&(n=Sg(n)*(Zd-2e-10));var i,r,s=Math.abs(Math.abs(n)-Zd);if(s>Qd)i=Ig(this.e,n,Math.sin(n)),r=this.a*this.f0*Math.pow(i,this.ns);else{if((s=n*this.ns)<=0)return null;r=0}var o=this.ns*Ng(e-this.long0);return t.x=this.k0*(r*Math.sin(o))+this.x0,t.y=this.k0*(this.rh-r*Math.cos(o))+this.y0,t},inverse:function(t){var e,n,i,r,s,o=(t.x-this.x0)/this.k0,a=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(o*o+a*a),n=1):(e=-Math.sqrt(o*o+a*a),n=-1);var l=0;if(0!==e&&(l=Math.atan2(n*o,n*a)),0!==e||this.ns>0){if(n=1/this.ns,i=Math.pow(e/(this.a*this.f0),n),-9999===(r=kg(this.e,i)))return null}else r=-Zd;return s=Ng(l/this.ns+this.long0),t.x=s,t.y=r,t},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"]};var Vp={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(t){var e,n,i,r,s,o,a,l=t.x,c=t.y,h=Ng(l-this.long0);return e=Math.pow((1+this.e*Math.sin(c))/(1-this.e*Math.sin(c)),this.alfa*this.e/2),n=2*(Math.atan(this.k*Math.pow(Math.tan(c/2+this.s45),this.alfa)/e)-this.s45),i=-h*this.alfa,r=Math.asin(Math.cos(this.ad)*Math.sin(n)+Math.sin(this.ad)*Math.cos(n)*Math.cos(i)),s=Math.asin(Math.cos(n)*Math.sin(i)/Math.cos(r)),o=this.n*s,a=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(r/2+this.s45),this.n),t.y=a*Math.cos(o)/1,t.x=a*Math.sin(o)/1,this.czech||(t.y*=-1,t.x*=-1),t},inverse:function(t){var e,n,i,r,s,o,a,l=t.x;t.x=t.y,t.y=l,this.czech||(t.y*=-1,t.x*=-1),s=Math.sqrt(t.x*t.x+t.y*t.y),r=Math.atan2(t.y,t.x)/Math.sin(this.s0),i=2*(Math.atan(Math.pow(this.ro0/s,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(i)-Math.sin(this.ad)*Math.cos(i)*Math.cos(r)),n=Math.asin(Math.cos(i)*Math.sin(r)/Math.cos(e)),t.x=this.long0-n/this.alfa,o=e,a=0;var c=0;do{t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(o))/(1-this.e*Math.sin(o)),this.e/2))-this.s45),Math.abs(o-t.y)<1e-10&&(a=1),o=t.y,c+=1}while(0===a&&c<15);return c>=15?null:t},names:["Krovak","krovak"]};function Hp(t,e,n,i,r){return t*r-e*Math.sin(2*r)+n*Math.sin(4*r)-i*Math.sin(6*r)}function Jp(t){return 1-.25*t*(1+t/16*(3+1.25*t))}function Zp(t){return.375*t*(1+.25*t*(1+.46875*t))}function Qp(t){return.05859375*t*t*(1+.75*t)}function Kp(t){return t*t*t*(35/3072)}function t_(t,e,n){var i=e*n;return t/Math.sqrt(1-i*i)}function e_(t){return Math.abs(t)<Zd?t:t-Sg(t)*Math.PI}function n_(t,e,n,i,r){var s,o;s=t/e;for(var a=0;a<15;a++)if(s+=o=(t-(e*s-n*Math.sin(2*s)+i*Math.sin(4*s)-r*Math.sin(6*s)))/(e-2*n*Math.cos(2*s)+4*i*Math.cos(4*s)-6*r*Math.cos(6*s)),Math.abs(o)<=1e-10)return s;return NaN}var i_={init:function(){this.sphere||(this.e0=Jp(this.es),this.e1=Zp(this.es),this.e2=Qp(this.es),this.e3=Kp(this.es),this.ml0=this.a*Hp(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(t){var e,n,i=t.x,r=t.y;if(i=Ng(i-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(r)*Math.sin(i)),n=this.a*(Math.atan2(Math.tan(r),Math.cos(i))-this.lat0);else{var s=Math.sin(r),o=Math.cos(r),a=t_(this.a,this.e,s),l=Math.tan(r)*Math.tan(r),c=i*Math.cos(r),h=c*c,u=this.es*o*o/(1-this.es);e=a*c*(1-h*l*(1/6-(8-l+8*u)*h/120)),n=this.a*Hp(this.e0,this.e1,this.e2,this.e3,r)-this.ml0+a*s/o*h*(.5+(5-l+6*u)*h/24)}return t.x=e+this.x0,t.y=n+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,n,i=t.x/this.a,r=t.y/this.a;if(this.sphere){var s=r+this.lat0;e=Math.asin(Math.sin(s)*Math.cos(i)),n=Math.atan2(Math.tan(i),Math.cos(s))}else{var o=n_(this.ml0/this.a+r,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(o)-Zd)<=Qd)return t.x=this.long0,t.y=Zd,r<0&&(t.y*=-1),t;var a=t_(this.a,this.e,Math.sin(o)),l=a*a*a/this.a/this.a*(1-this.es),c=Math.pow(Math.tan(o),2),h=i*this.a/a,u=h*h;e=o-a*Math.tan(o)/l*h*h*(.5-(1+3*c)*h*h/24),n=h*(1-u*(c/3+(1+3*c)*c*u/15))/Math.cos(o)}return t.x=Ng(n+this.long0),t.y=e_(e),t},names:["Cassini","Cassini_Soldner","cass"]};function r_(t,e){var n;return t>1e-7?(1-t*t)*(e/(1-(n=t*e)*n)-.5/t*Math.log((1-n)/(1+n))):2*e}var s_=.3333333333333333,o_=.17222222222222222,a_=.10257936507936508,l_=.06388888888888888,c_=.0664021164021164,h_=.016415012942191543;var u_={init:function(){var t,e=Math.abs(this.lat0);if(Math.abs(e-Zd)<Qd?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(e)<Qd?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0)switch(this.qp=r_(this.e,1),this.mmf=.5/(1-this.es),this.apa=function(t){var e,n=[];return n[0]=t*s_,e=t*t,n[0]+=e*o_,n[1]=e*l_,e*=t,n[0]+=e*a_,n[1]+=e*c_,n[2]=e*h_,n}(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=r_(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(t){var e,n,i,r,s,o,a,l,c,h,u=t.x,f=t.y;if(u=Ng(u-this.long0),this.sphere){if(s=Math.sin(f),h=Math.cos(f),i=Math.cos(u),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((n=this.mode===this.EQUIT?1+h*i:1+this.sinph0*s+this.cosph0*h*i)<=Qd)return null;e=(n=Math.sqrt(2/n))*h*Math.sin(u),n*=this.mode===this.EQUIT?s:this.cosph0*s-this.sinph0*h*i}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(i=-i),Math.abs(f+this.lat0)<Qd)return null;n=eg-.5*f,e=(n=2*(this.mode===this.S_POLE?Math.cos(n):Math.sin(n)))*Math.sin(u),n*=i}}else{switch(a=0,l=0,c=0,i=Math.cos(u),r=Math.sin(u),s=Math.sin(f),o=r_(this.e,s),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(a=o/this.qp,l=Math.sqrt(1-a*a)),this.mode){case this.OBLIQ:c=1+this.sinb1*a+this.cosb1*l*i;break;case this.EQUIT:c=1+l*i;break;case this.N_POLE:c=Zd+f,o=this.qp-o;break;case this.S_POLE:c=f-Zd,o=this.qp+o}if(Math.abs(c)<Qd)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:c=Math.sqrt(2/c),n=this.mode===this.OBLIQ?this.ymf*c*(this.cosb1*a-this.sinb1*l*i):(c=Math.sqrt(2/(1+l*i)))*a*this.ymf,e=this.xmf*c*l*r;break;case this.N_POLE:case this.S_POLE:o>=0?(e=(c=Math.sqrt(o))*r,n=i*(this.mode===this.S_POLE?c:-c)):e=n=0}}return t.x=this.a*e+this.x0,t.y=this.a*n+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,n,i,r,s,o,a,l,c,h,u=t.x/this.a,f=t.y/this.a;if(this.sphere){var d,g=0,p=0;if((n=.5*(d=Math.sqrt(u*u+f*f)))>1)return null;switch(n=2*Math.asin(n),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(p=Math.sin(n),g=Math.cos(n)),this.mode){case this.EQUIT:n=Math.abs(d)<=Qd?0:Math.asin(f*p/d),u*=p,f=g*d;break;case this.OBLIQ:n=Math.abs(d)<=Qd?this.lat0:Math.asin(g*this.sinph0+f*p*this.cosph0/d),u*=p*this.cosph0,f=(g-Math.sin(n)*this.sinph0)*d;break;case this.N_POLE:f=-f,n=Zd-n;break;case this.S_POLE:n-=Zd}e=0!==f||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(u,f):0}else{if(a=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(u/=this.dd,f*=this.dd,(o=Math.sqrt(u*u+f*f))<Qd)return t.x=this.long0,t.y=this.lat0,t;r=2*Math.asin(.5*o/this.rq),i=Math.cos(r),u*=r=Math.sin(r),this.mode===this.OBLIQ?(a=i*this.sinb1+f*r*this.cosb1/o,s=this.qp*a,f=o*this.cosb1*i-f*this.sinb1*r):(a=f*r/o,s=this.qp*a,f=o*i)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(f=-f),!(s=u*u+f*f))return t.x=this.long0,t.y=this.lat0,t;a=1-s/this.qp,this.mode===this.S_POLE&&(a=-a)}e=Math.atan2(u,f),l=Math.asin(a),c=this.apa,h=l+l,n=l+c[0]*Math.sin(h)+c[1]*Math.sin(h+h)+c[2]*Math.sin(h+h+h)}return t.x=Ng(this.long0+e),t.y=n,t},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4};function f_(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)}var d_={init:function(){Math.abs(this.lat1+this.lat2)<Qd||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Eg(this.e3,this.sin_po,this.cos_po),this.qs1=r_(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Eg(this.e3,this.sin_po,this.cos_po),this.qs2=r_(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=r_(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>Qd?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(t){var e=t.x,n=t.y;this.sin_phi=Math.sin(n),this.cos_phi=Math.cos(n);var i=r_(this.e3,this.sin_phi,this.cos_phi),r=this.a*Math.sqrt(this.c-this.ns0*i)/this.ns0,s=this.ns0*Ng(e-this.long0),o=r*Math.sin(s)+this.x0,a=this.rh-r*Math.cos(s)+this.y0;return t.x=o,t.y=a,t},inverse:function(t){var e,n,i,r,s,o;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),i=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),i=-1),r=0,0!==e&&(r=Math.atan2(i*t.x,i*t.y)),i=e*this.ns0/this.a,this.sphere?o=Math.asin((this.c-i*i)/(2*this.ns0)):(n=(this.c-i*i)/this.ns0,o=this.phi1z(this.e3,n)),s=Ng(r/this.ns0+this.long0),t.x=s,t.y=o,t},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(t,e){var n,i,r,s,o=f_(.5*e);if(t<Qd)return o;for(var a=t*t,l=1;l<=25;l++)if(o+=s=.5*(r=1-(i=t*(n=Math.sin(o)))*i)*r/Math.cos(o)*(e/(1-a)-n/r+.5/t*Math.log((1-i)/(1+i))),Math.abs(s)<=1e-7)return o;return null}};var g_={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(t){var e,n,i,r,s,o,a,l=t.x,c=t.y;return i=Ng(l-this.long0),e=Math.sin(c),n=Math.cos(c),r=Math.cos(i),1,(s=this.sin_p14*e+this.cos_p14*n*r)>0||Math.abs(s)<=Qd?(o=this.x0+1*this.a*n*Math.sin(i)/s,a=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*n*r)/s):(o=this.x0+this.infinity_dist*n*Math.sin(i),a=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*n*r)),t.x=o,t.y=a,t},inverse:function(t){var e,n,i,r,s,o;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(r=Math.atan2(e,this.rc),n=Math.sin(r),o=f_((i=Math.cos(r))*this.sin_p14+t.y*n*this.cos_p14/e),s=Math.atan2(t.x*n,e*this.cos_p14*i-t.y*this.sin_p14*n),s=Ng(this.long0+s)):(o=this.phic0,s=0),t.x=s,t.y=o,t},names:["gnom"]};var p_={init:function(){this.sphere||(this.k0=Eg(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(t){var e,n,i=t.x,r=t.y,s=Ng(i-this.long0);if(this.sphere)e=this.x0+this.a*s*Math.cos(this.lat_ts),n=this.y0+this.a*Math.sin(r)/Math.cos(this.lat_ts);else{var o=r_(this.e,Math.sin(r));e=this.x0+this.a*this.k0*s,n=this.y0+this.a*o*.5/this.k0}return t.x=e,t.y=n,t},inverse:function(t){var e,n;return t.x-=this.x0,t.y-=this.y0,this.sphere?(e=Ng(this.long0+t.x/this.a/Math.cos(this.lat_ts)),n=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(n=function(t,e){var n=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-n)<1e-6)return e<0?-1*Zd:Zd;for(var i,r,s,o,a=Math.asin(.5*e),l=0;l<30;l++)if(r=Math.sin(a),s=Math.cos(a),o=t*r,a+=i=Math.pow(1-o*o,2)/(2*s)*(e/(1-t*t)-r/(1-o*o)+.5/t*Math.log((1-o)/(1+o))),Math.abs(i)<=1e-10)return a;return NaN}(this.e,2*t.y*this.k0/this.a),e=Ng(this.long0+t.x/(this.a*this.k0))),t.x=e,t.y=n,t},names:["cea"]};var __={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(t){var e=t.x,n=t.y,i=Ng(e-this.long0),r=e_(n-this.lat0);return t.x=this.x0+this.a*i*this.rc,t.y=this.y0+this.a*r,t},inverse:function(t){var e=t.x,n=t.y;return t.x=Ng(this.long0+(e-this.x0)/(this.a*this.rc)),t.y=e_(this.lat0+(n-this.y0)/this.a),t},names:["Equirectangular","Equidistant_Cylindrical","eqc"]};var y_={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Jp(this.es),this.e1=Zp(this.es),this.e2=Qp(this.es),this.e3=Kp(this.es),this.ml0=this.a*Hp(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(t){var e,n,i,r=t.x,s=t.y,o=Ng(r-this.long0);if(i=o*Math.sin(s),this.sphere)Math.abs(s)<=Qd?(e=this.a*o,n=-1*this.a*this.lat0):(e=this.a*Math.sin(i)/Math.tan(s),n=this.a*(e_(s-this.lat0)+(1-Math.cos(i))/Math.tan(s)));else if(Math.abs(s)<=Qd)e=this.a*o,n=-1*this.ml0;else{var a=t_(this.a,this.e,Math.sin(s))/Math.tan(s);e=a*Math.sin(i),n=this.a*Hp(this.e0,this.e1,this.e2,this.e3,s)-this.ml0+a*(1-Math.cos(i))}return t.x=e+this.x0,t.y=n+this.y0,t},inverse:function(t){var e,n,i,r,s,o,a,l,c;if(i=t.x-this.x0,r=t.y-this.y0,this.sphere)if(Math.abs(r+this.a*this.lat0)<=Qd)e=Ng(i/this.a+this.long0),n=0;else{var h;for(o=this.lat0+r/this.a,a=i*i/this.a/this.a+o*o,l=o,s=20;s;--s)if(l+=c=-1*(o*(l*(h=Math.tan(l))+1)-l-.5*(l*l+a)*h)/((l-o)/h-1),Math.abs(c)<=Qd){n=l;break}e=Ng(this.long0+Math.asin(i*Math.tan(l)/this.a)/Math.sin(n))}else if(Math.abs(r+this.ml0)<=Qd)n=0,e=Ng(this.long0+i/this.a);else{var u,f,d,g,p;for(o=(this.ml0+r)/this.a,a=i*i/this.a/this.a+o*o,l=o,s=20;s;--s)if(p=this.e*Math.sin(l),u=Math.sqrt(1-p*p)*Math.tan(l),f=this.a*Hp(this.e0,this.e1,this.e2,this.e3,l),d=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),l-=c=(o*(u*(g=f/this.a)+1)-g-.5*u*(g*g+a))/(this.es*Math.sin(2*l)*(g*g+a-2*o*g)/(4*u)+(o-g)*(u*d-2/Math.sin(2*l))-d),Math.abs(c)<=Qd){n=l;break}u=Math.sqrt(1-this.es*Math.pow(Math.sin(n),2))*Math.tan(n),e=Ng(this.long0+Math.asin(i*u/this.a)/Math.sin(n))}return t.x=e,t.y=n,t},names:["Polyconic","poly"]};var m_={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(t){var e,n=t.x,i=t.y-this.lat0,r=n-this.long0,s=i/Jd*1e-5,o=r,a=1,l=0;for(e=1;e<=10;e++)a*=s,l+=this.A[e]*a;var c,h=l,u=o,f=1,d=0,g=0,p=0;for(e=1;e<=6;e++)c=d*h+f*u,f=f*h-d*u,d=c,g=g+this.B_re[e]*f-this.B_im[e]*d,p=p+this.B_im[e]*f+this.B_re[e]*d;return t.x=p*this.a+this.x0,t.y=g*this.a+this.y0,t},inverse:function(t){var e,n,i=t.x,r=t.y,s=i-this.x0,o=(r-this.y0)/this.a,a=s/this.a,l=1,c=0,h=0,u=0;for(e=1;e<=6;e++)n=c*o+l*a,l=l*o-c*a,c=n,h=h+this.C_re[e]*l-this.C_im[e]*c,u=u+this.C_im[e]*l+this.C_re[e]*c;for(var f=0;f<this.iterations;f++){var d,g=h,p=u,_=o,y=a;for(e=2;e<=6;e++)d=p*h+g*u,g=g*h-p*u,p=d,_+=(e-1)*(this.B_re[e]*g-this.B_im[e]*p),y+=(e-1)*(this.B_im[e]*g+this.B_re[e]*p);g=1,p=0;var m=this.B_re[1],x=this.B_im[1];for(e=2;e<=6;e++)d=p*h+g*u,g=g*h-p*u,p=d,m+=e*(this.B_re[e]*g-this.B_im[e]*p),x+=e*(this.B_im[e]*g+this.B_re[e]*p);var v=m*m+x*x;h=(_*m+y*x)/v,u=(y*m-_*x)/v}var b=h,M=u,w=1,E=0;for(e=1;e<=9;e++)w*=b,E+=this.D[e]*w;var S=this.lat0+E*Jd*1e5,N=this.long0+M;return t.x=N,t.y=S,t},names:["New_Zealand_Map_Grid","nzmg"]};var x_={init:function(){},forward:function(t){var e=t.x,n=t.y,i=Ng(e-this.long0),r=this.x0+this.a*i,s=this.y0+this.a*Math.log(Math.tan(Math.PI/4+n/2.5))*1.25;return t.x=r,t.y=s,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e=Ng(this.long0+t.x/this.a),n=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=n,t},names:["Miller_Cylindrical","mill"]};var v_={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=Op(this.es)},forward:function(t){var e,n,i=t.x,r=t.y;if(i=Ng(i-this.long0),this.sphere){if(this.m)for(var s=this.n*Math.sin(r),o=20;o;--o){var a=(this.m*r+Math.sin(r)-s)/(this.m+Math.cos(r));if(r-=a,Math.abs(a)<Qd)break}else r=1!==this.n?Math.asin(this.n*Math.sin(r)):r;e=this.a*this.C_x*i*(this.m+Math.cos(r)),n=this.a*this.C_y*r}else{var l=Math.sin(r),c=Math.cos(r);n=this.a*Cp(r,l,c,this.en),e=this.a*i*c/Math.sqrt(1-this.es*l*l)}return t.x=e,t.y=n,t},inverse:function(t){var e,n,i;return t.x-=this.x0,n=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,n/=this.C_x*(this.m+Math.cos(e)),this.m?e=f_((this.m*e+Math.sin(e))/this.n):1!==this.n&&(e=f_(Math.sin(e)/this.n)),n=Ng(n+this.long0),e=e_(e)):(e=Ap(t.y/this.a,this.es,this.en),(i=Math.abs(e))<Zd?(i=Math.sin(e),n=Ng(this.long0+t.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(e)))):i-Qd<Zd&&(n=this.long0)),t.x=n,t.y=e,t},names:["Sinusoidal","sinu"]};var b_={init:function(){},forward:function(t){for(var e=t.x,n=t.y,i=Ng(e-this.long0),r=n,s=Math.PI*Math.sin(n);;){var o=-(r+Math.sin(r)-s)/(1+Math.cos(r));if(r+=o,Math.abs(o)<Qd)break}r/=2,Math.PI/2-Math.abs(n)<Qd&&(i=0);var a=.900316316158*this.a*i*Math.cos(r)+this.x0,l=1.4142135623731*this.a*Math.sin(r)+this.y0;return t.x=a,t.y=l,t},inverse:function(t){var e,n;t.x-=this.x0,t.y-=this.y0,n=t.y/(1.4142135623731*this.a),Math.abs(n)>.999999999999&&(n=.999999999999),e=Math.asin(n);var i=Ng(this.long0+t.x/(.900316316158*this.a*Math.cos(e)));i<-Math.PI&&(i=-Math.PI),i>Math.PI&&(i=Math.PI),n=(2*e+Math.sin(2*e))/Math.PI,Math.abs(n)>1&&(n=1);var r=Math.asin(n);return t.x=i,t.y=r,t},names:["Mollweide","moll"]};var M_={init:function(){Math.abs(this.lat1+this.lat2)<Qd||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Jp(this.es),this.e1=Zp(this.es),this.e2=Qp(this.es),this.e3=Kp(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=Eg(this.e,this.sinphi,this.cosphi),this.ml1=Hp(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<Qd?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=Eg(this.e,this.sinphi,this.cosphi),this.ml2=Hp(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Hp(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(t){var e,n=t.x,i=t.y;if(this.sphere)e=this.a*(this.g-i);else{var r=Hp(this.e0,this.e1,this.e2,this.e3,i);e=this.a*(this.g-r)}var s=this.ns*Ng(n-this.long0),o=this.x0+e*Math.sin(s),a=this.y0+this.rh-e*Math.cos(s);return t.x=o,t.y=a,t},inverse:function(t){var e,n,i,r;t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns>=0?(n=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(n=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var s=0;return 0!==n&&(s=Math.atan2(e*t.x,e*t.y)),this.sphere?(r=Ng(this.long0+s/this.ns),i=e_(this.g-n/this.a),t.x=r,t.y=i,t):(i=n_(this.g-n/this.a,this.e0,this.e1,this.e2,this.e3),r=Ng(this.long0+s/this.ns),t.x=r,t.y=i,t)},names:["Equidistant_Conic","eqdc"]};var w_={init:function(){this.R=this.a},forward:function(t){var e,n,i=t.x,r=t.y,s=Ng(i-this.long0);Math.abs(r)<=Qd&&(e=this.x0+this.R*s,n=this.y0);var o=f_(2*Math.abs(r/Math.PI));(Math.abs(s)<=Qd||Math.abs(Math.abs(r)-Zd)<=Qd)&&(e=this.x0,n=r>=0?this.y0+Math.PI*this.R*Math.tan(.5*o):this.y0+Math.PI*this.R*-Math.tan(.5*o));var a=.5*Math.abs(Math.PI/s-s/Math.PI),l=a*a,c=Math.sin(o),h=Math.cos(o),u=h/(c+h-1),f=u*u,d=u*(2/c-1),g=d*d,p=Math.PI*this.R*(a*(u-g)+Math.sqrt(l*(u-g)*(u-g)-(g+l)*(f-g)))/(g+l);s<0&&(p=-p),e=this.x0+p;var _=l+u;return p=Math.PI*this.R*(d*_-a*Math.sqrt((g+l)*(l+1)-_*_))/(g+l),n=r>=0?this.y0+p:this.y0-p,t.x=e,t.y=n,t},inverse:function(t){var e,n,i,r,s,o,a,l,c,h,u,f;return t.x-=this.x0,t.y-=this.y0,u=Math.PI*this.R,s=(i=t.x/u)*i+(r=t.y/u)*r,u=3*(r*r/(l=-2*(o=-Math.abs(r)*(1+s))+1+2*r*r+s*s)+(2*(a=o-2*r*r+i*i)*a*a/l/l/l-9*o*a/l/l)/27)/(c=(o-a*a/3/l)/l)/(h=2*Math.sqrt(-c/3)),Math.abs(u)>1&&(u=u>=0?1:-1),f=Math.acos(u)/3,n=t.y>=0?(-h*Math.cos(f+Math.PI/3)-a/3/l)*Math.PI:-(-h*Math.cos(f+Math.PI/3)-a/3/l)*Math.PI,e=Math.abs(i)<Qd?this.long0:Ng(this.long0+Math.PI*(s-1+Math.sqrt(1+2*(i*i-r*r)+s*s))/2/i),t.x=e,t.y=n,t},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]};var E_={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(t){var e,n,i,r,s,o,a,l,c,h,u,f,d,g,p,_,y,m,x,v,b,M,w=t.x,E=t.y,S=Math.sin(t.y),N=Math.cos(t.y),I=Ng(w-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=Qd?(t.x=this.x0+this.a*(Zd-E)*Math.sin(I),t.y=this.y0-this.a*(Zd-E)*Math.cos(I),t):Math.abs(this.sin_p12+1)<=Qd?(t.x=this.x0+this.a*(Zd+E)*Math.sin(I),t.y=this.y0+this.a*(Zd+E)*Math.cos(I),t):(m=this.sin_p12*S+this.cos_p12*N*Math.cos(I),y=(_=Math.acos(m))?_/Math.sin(_):1,t.x=this.x0+this.a*y*N*Math.sin(I),t.y=this.y0+this.a*y*(this.cos_p12*S-this.sin_p12*N*Math.cos(I)),t):(e=Jp(this.es),n=Zp(this.es),i=Qp(this.es),r=Kp(this.es),Math.abs(this.sin_p12-1)<=Qd?(s=this.a*Hp(e,n,i,r,Zd),o=this.a*Hp(e,n,i,r,E),t.x=this.x0+(s-o)*Math.sin(I),t.y=this.y0-(s-o)*Math.cos(I),t):Math.abs(this.sin_p12+1)<=Qd?(s=this.a*Hp(e,n,i,r,Zd),o=this.a*Hp(e,n,i,r,E),t.x=this.x0+(s+o)*Math.sin(I),t.y=this.y0+(s+o)*Math.cos(I),t):(a=S/N,l=t_(this.a,this.e,this.sin_p12),c=t_(this.a,this.e,S),h=Math.atan((1-this.es)*a+this.es*l*this.sin_p12/(c*N)),x=0===(u=Math.atan2(Math.sin(I),this.cos_p12*Math.tan(h)-this.sin_p12*Math.cos(I)))?Math.asin(this.cos_p12*Math.sin(h)-this.sin_p12*Math.cos(h)):Math.abs(Math.abs(u)-Math.PI)<=Qd?-Math.asin(this.cos_p12*Math.sin(h)-this.sin_p12*Math.cos(h)):Math.asin(Math.sin(I)*Math.cos(h)/Math.sin(u)),f=this.e*this.sin_p12/Math.sqrt(1-this.es),_=l*x*(1-(v=x*x)*(p=(d=this.e*this.cos_p12*Math.cos(u)/Math.sqrt(1-this.es))*d)*(1-p)/6+(b=v*x)/8*(g=f*d)*(1-2*p)+(M=b*x)/120*(p*(4-7*p)-3*f*f*(1-7*p))-M*x/48*g),t.x=this.x0+_*Math.sin(u),t.y=this.y0+_*Math.cos(u),t))},inverse:function(t){var e,n,i,r,s,o,a,l,c,h,u,f,d,g,p,_,y,m,x,v,b,M,w;if(t.x-=this.x0,t.y-=this.y0,this.sphere){if((e=Math.sqrt(t.x*t.x+t.y*t.y))>2*Zd*this.a)return;return n=e/this.a,i=Math.sin(n),r=Math.cos(n),s=this.long0,Math.abs(e)<=Qd?o=this.lat0:(o=f_(r*this.sin_p12+t.y*i*this.cos_p12/e),a=Math.abs(this.lat0)-Zd,s=Math.abs(a)<=Qd?this.lat0>=0?Ng(this.long0+Math.atan2(t.x,-t.y)):Ng(this.long0-Math.atan2(-t.x,t.y)):Ng(this.long0+Math.atan2(t.x*i,e*this.cos_p12*r-t.y*this.sin_p12*i))),t.x=s,t.y=o,t}return l=Jp(this.es),c=Zp(this.es),h=Qp(this.es),u=Kp(this.es),Math.abs(this.sin_p12-1)<=Qd?(o=n_(((f=this.a*Hp(l,c,h,u,Zd))-(e=Math.sqrt(t.x*t.x+t.y*t.y)))/this.a,l,c,h,u),s=Ng(this.long0+Math.atan2(t.x,-1*t.y)),t.x=s,t.y=o,t):Math.abs(this.sin_p12+1)<=Qd?(f=this.a*Hp(l,c,h,u,Zd),o=n_(((e=Math.sqrt(t.x*t.x+t.y*t.y))-f)/this.a,l,c,h,u),s=Ng(this.long0+Math.atan2(t.x,t.y)),t.x=s,t.y=o,t):(e=Math.sqrt(t.x*t.x+t.y*t.y),p=Math.atan2(t.x,t.y),d=t_(this.a,this.e,this.sin_p12),_=Math.cos(p),m=-(y=this.e*this.cos_p12*_)*y/(1-this.es),x=3*this.es*(1-m)*this.sin_p12*this.cos_p12*_/(1-this.es),M=1-m*(b=(v=e/d)-m*(1+m)*Math.pow(v,3)/6-x*(1+3*m)*Math.pow(v,4)/24)*b/2-v*b*b*b/6,g=Math.asin(this.sin_p12*Math.cos(b)+this.cos_p12*Math.sin(b)*_),s=Ng(this.long0+Math.asin(Math.sin(p)*Math.sin(b)/Math.cos(g))),w=Math.sin(g),o=Math.atan2((w-this.es*M*this.sin_p12)*Math.tan(g),w*(1-this.es)),t.x=s,t.y=o,t)},names:["Azimuthal_Equidistant","aeqd"]};var S_={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(t){var e,n,i,r,s,o,a,l=t.x,c=t.y;return i=Ng(l-this.long0),e=Math.sin(c),n=Math.cos(c),r=Math.cos(i),1,((s=this.sin_p14*e+this.cos_p14*n*r)>0||Math.abs(s)<=Qd)&&(o=1*this.a*n*Math.sin(i),a=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*n*r)),t.x=o,t.y=a,t},inverse:function(t){var e,n,i,r,s,o,a;return t.x-=this.x0,t.y-=this.y0,n=f_((e=Math.sqrt(t.x*t.x+t.y*t.y))/this.a),i=Math.sin(n),r=Math.cos(n),o=this.long0,Math.abs(e)<=Qd?(a=this.lat0,t.x=o,t.y=a,t):(a=f_(r*this.sin_p14+t.y*i*this.cos_p14/e),s=Math.abs(this.lat0)-Zd,Math.abs(s)<=Qd?(o=this.lat0>=0?Ng(this.long0+Math.atan2(t.x,-t.y)):Ng(this.long0-Math.atan2(-t.x,t.y)),t.x=o,t.y=a,t):(o=Ng(this.long0+Math.atan2(t.x*i,e*this.cos_p14*r-t.y*this.sin_p14*i)),t.x=o,t.y=a,t))},names:["ortho"]},N_=1,I_=2,k_=3,O_=4,C_=5,A_=6,T_=1,R_=2,L_=3,P_=4;function D_(t,e,n,i){var r;return t<Qd?(i.value=T_,r=0):(r=Math.atan2(e,n),Math.abs(r)<=eg?i.value=T_:r>eg&&r<=Zd+eg?(i.value=R_,r-=Zd):r>Zd+eg||r<=-(Zd+eg)?(i.value=L_,r=r>=0?r-ig:r+ig):(i.value=P_,r+=Zd)),r}function z_(t,e){var n=t+e;return n<-ig?n+=ng:n>+ig&&(n-=ng),n}var F_={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=Zd-eg/2?this.face=C_:this.lat0<=-(Zd-eg/2)?this.face=A_:Math.abs(this.long0)<=eg?this.face=N_:Math.abs(this.long0)<=Zd+eg?this.face=this.long0>0?I_:O_:this.face=k_,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(t){var e,n,i,r,s,o,a={x:0,y:0},l={value:0};if(t.x-=this.long0,e=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(t.y)):t.y,n=t.x,this.face===C_)r=Zd-e,n>=eg&&n<=Zd+eg?(l.value=T_,i=n-Zd):n>Zd+eg||n<=-(Zd+eg)?(l.value=R_,i=n>0?n-ig:n+ig):n>-(Zd+eg)&&n<=-eg?(l.value=L_,i=n+Zd):(l.value=P_,i=n);else if(this.face===A_)r=Zd+e,n>=eg&&n<=Zd+eg?(l.value=T_,i=-n+Zd):n<eg&&n>=-eg?(l.value=R_,i=-n):n<-eg&&n>=-(Zd+eg)?(l.value=L_,i=-n-Zd):(l.value=P_,i=n>0?-n+ig:-n-ig);else{var c,h,u,f,d,g;this.face===I_?n=z_(n,+Zd):this.face===k_?n=z_(n,+ig):this.face===O_&&(n=z_(n,-Zd)),f=Math.sin(e),d=Math.cos(e),g=Math.sin(n),c=d*Math.cos(n),h=d*g,u=f,this.face===N_?i=D_(r=Math.acos(c),u,h,l):this.face===I_?i=D_(r=Math.acos(h),u,-c,l):this.face===k_?i=D_(r=Math.acos(-c),u,-h,l):this.face===O_?i=D_(r=Math.acos(-h),u,c,l):(r=i=0,l.value=T_)}return o=Math.atan(12/ig*(i+Math.acos(Math.sin(i)*Math.cos(eg))-Zd)),s=Math.sqrt((1-Math.cos(r))/(Math.cos(o)*Math.cos(o))/(1-Math.cos(Math.atan(1/Math.cos(i))))),l.value===R_?o+=Zd:l.value===L_?o+=ig:l.value===P_&&(o+=1.5*ig),a.x=s*Math.cos(o),a.y=s*Math.sin(o),a.x=a.x*this.a+this.x0,a.y=a.y*this.a+this.y0,t.x=a.x,t.y=a.y,t},inverse:function(t){var e,n,i,r,s,o,a,l,c,h,u,f,d={lam:0,phi:0},g={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,n=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),e=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?g.value=T_:t.y>=0&&t.y>=Math.abs(t.x)?(g.value=R_,e-=Zd):t.x<0&&-t.x>=Math.abs(t.y)?(g.value=L_,e=e<0?e+ig:e-ig):(g.value=P_,e+=Zd),c=ig/12*Math.tan(e),s=Math.sin(c)/(Math.cos(c)-1/Math.sqrt(2)),o=Math.atan(s),(a=1-(i=Math.cos(e))*i*(r=Math.tan(n))*r*(1-Math.cos(Math.atan(1/Math.cos(o)))))<-1?a=-1:a>1&&(a=1),this.face===C_)l=Math.acos(a),d.phi=Zd-l,g.value===T_?d.lam=o+Zd:g.value===R_?d.lam=o<0?o+ig:o-ig:g.value===L_?d.lam=o-Zd:d.lam=o;else if(this.face===A_)l=Math.acos(a),d.phi=l-Zd,g.value===T_?d.lam=-o+Zd:g.value===R_?d.lam=-o:g.value===L_?d.lam=-o-Zd:d.lam=o<0?-o-ig:-o+ig;else{var p,_,y;c=(p=a)*p,_=(c+=(y=c>=1?0:Math.sqrt(1-c)*Math.sin(o))*y)>=1?0:Math.sqrt(1-c),g.value===R_?(c=_,_=-y,y=c):g.value===L_?(_=-_,y=-y):g.value===P_&&(c=_,_=y,y=-c),this.face===I_?(c=p,p=-_,_=c):this.face===k_?(p=-p,_=-_):this.face===O_&&(c=p,p=_,_=-c),d.phi=Math.acos(-y)-Zd,d.lam=Math.atan2(_,p),this.face===I_?d.lam=z_(d.lam,-Zd):this.face===k_?d.lam=z_(d.lam,-ig):this.face===O_&&(d.lam=z_(d.lam,+Zd))}return 0!==this.es&&(h=d.phi<0?1:0,u=Math.tan(d.phi),f=this.b/Math.sqrt(u*u+this.one_minus_f_squared),d.phi=Math.atan(Math.sqrt(this.a*this.a-f*f)/(this.one_minus_f*f)),h&&(d.phi=-d.phi)),d.lam+=this.long0,t.x=d.lam,t.y=d.phi,t},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]},G_=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],j_=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],q_=.8487,B_=1.3523,Y_=tg/5,$_=18,U_=function(t,e){return t[0]+e*(t[1]+e*(t[2]+e*t[3]))};var W_={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(t){var e=Ng(t.x-this.long0),n=Math.abs(t.y),i=Math.floor(n*Y_);i<0?i=0:i>=$_&&(i=17);var r={x:U_(G_[i],n=tg*(n-.08726646259971647*i))*e,y:U_(j_[i],n)};return t.y<0&&(r.y=-r.y),r.x=r.x*this.a*q_+this.x0,r.y=r.y*this.a*B_+this.y0,r},inverse:function(t){var e={x:(t.x-this.x0)/(this.a*q_),y:Math.abs(t.y-this.y0)/(this.a*B_)};if(e.y>=1)e.x/=G_[18][0],e.y=t.y<0?-Zd:Zd;else{var n=Math.floor(e.y*$_);for(n<0?n=0:n>=$_&&(n=17);;)if(j_[n][0]>e.y)--n;else{if(!(j_[n+1][0]<=e.y))break;++n}var i=j_[n],r=5*(e.y-i[0])/(j_[n+1][0]-i[0]);r=function(t,e,n,i){for(var r=e;i;--i){var s=t(r);if(r-=s,Math.abs(s)<n)break}return r}((function(t){return(U_(i,t)-e.y)/function(t,e){return t[1]+e*(2*t[2]+3*e*t[3])}(i,t)}),r,Qd,100),e.x/=U_(G_[n],r),e.y=(5*n+r)*Kd,t.y<0&&(e.y=-e.y)}return e.x=Ng(e.x+this.long0),e},names:["Robinson","robin"]};var X_={init:function(){this.name="geocent"},forward:function(t){return Xg(t,this.es,this.a)},inverse:function(t){return Vg(t,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]},V_=0,H_=1,J_=2,Z_=3,Q_={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};var K_={init:function(){if(Object.keys(Q_).forEach(function(t){if(void 0===this[t])this[t]=Q_[t].def;else{if(Q_[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);Q_[t].num&&(this[t]=parseFloat(this[t]))}Q_[t].degrees&&(this[t]=this[t]*Kd)}.bind(this)),Math.abs(Math.abs(this.lat0)-Zd)<Qd?this.mode=this.lat0<0?H_:V_:Math.abs(this.lat0)<Qd?this.mode=J_:(this.mode=Z_,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var t=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(t),this.sw=Math.sin(t)},forward:function(t){t.x-=this.long0;var e,n,i,r,s=Math.sin(t.y),o=Math.cos(t.y),a=Math.cos(t.x);switch(this.mode){case Z_:n=this.sinph0*s+this.cosph0*o*a;break;case J_:n=o*a;break;case H_:n=-s;break;case V_:n=s}switch(e=(n=this.pn1/(this.p-n))*o*Math.sin(t.x),this.mode){case Z_:n*=this.cosph0*s-this.sinph0*o*a;break;case J_:n*=s;break;case V_:n*=-o*a;break;case H_:n*=o*a}return r=1/((i=n*this.cg+e*this.sg)*this.sw*this.h1+this.cw),e=(e*this.cg-n*this.sg)*this.cw*r,n=i*r,t.x=e*this.a,t.y=n*this.a,t},inverse:function(t){t.x/=this.a,t.y/=this.a;var e,n,i,r={x:t.x,y:t.y};i=1/(this.pn1-t.y*this.sw),e=this.pn1*t.x*i,n=this.pn1*t.y*this.cw*i,t.x=e*this.cg+n*this.sg,t.y=n*this.cg-e*this.sg;var s=Lp(t.x,t.y);if(Math.abs(s)<Qd)r.x=0,r.y=t.y;else{var o,a;switch(a=1-s*s*this.pfact,a=(this.p-Math.sqrt(a))/(this.pn1/s+s/this.pn1),o=Math.sqrt(1-a*a),this.mode){case Z_:r.y=Math.asin(o*this.sinph0+t.y*a*this.cosph0/s),t.y=(o-this.sinph0*Math.sin(r.y))*s,t.x*=a*this.cosph0;break;case J_:r.y=Math.asin(t.y*a/s),t.y=o*s,t.x*=a;break;case V_:r.y=Math.asin(o),t.y=-t.y;break;case H_:r.y=-Math.asin(o)}r.x=Math.atan2(t.x,t.y)}return t.x=r.x+this.long0,t.y=r.y,t},names:["Tilted_Perspective","tpers"]};var ty={init:function(){if(this.flip_axis="x"===this.sweep?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,0!==this.es){var t=1-this.es,e=1/t;this.radius_p=Math.sqrt(t),this.radius_p2=t,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")},forward:function(t){var e,n,i,r,s=t.x,o=t.y;if(s-=this.long0,"ellipse"===this.shape){o=Math.atan(this.radius_p2*Math.tan(o));var a=this.radius_p/Lp(this.radius_p*Math.cos(o),Math.sin(o));if(n=a*Math.cos(s)*Math.cos(o),i=a*Math.sin(s)*Math.cos(o),r=a*Math.sin(o),(this.radius_g-n)*n-i*i-r*r*this.radius_p_inv2<0)return t.x=Number.NaN,t.y=Number.NaN,t;e=this.radius_g-n,this.flip_axis?(t.x=this.radius_g_1*Math.atan(i/Lp(r,e)),t.y=this.radius_g_1*Math.atan(r/e)):(t.x=this.radius_g_1*Math.atan(i/e),t.y=this.radius_g_1*Math.atan(r/Lp(i,e)))}else"sphere"===this.shape&&(e=Math.cos(o),n=Math.cos(s)*e,i=Math.sin(s)*e,r=Math.sin(o),e=this.radius_g-n,this.flip_axis?(t.x=this.radius_g_1*Math.atan(i/Lp(r,e)),t.y=this.radius_g_1*Math.atan(r/e)):(t.x=this.radius_g_1*Math.atan(i/e),t.y=this.radius_g_1*Math.atan(r/Lp(i,e))));return t.x=t.x*this.a,t.y=t.y*this.a,t},inverse:function(t){var e,n,i,r,s=-1,o=0,a=0;if(t.x=t.x/this.a,t.y=t.y/this.a,"ellipse"===this.shape){this.flip_axis?(a=Math.tan(t.y/this.radius_g_1),o=Math.tan(t.x/this.radius_g_1)*Lp(1,a)):(o=Math.tan(t.x/this.radius_g_1),a=Math.tan(t.y/this.radius_g_1)*Lp(1,o));var l=a/this.radius_p;if(e=o*o+l*l+s*s,(i=(n=2*this.radius_g*s)*n-4*e*this.C)<0)return t.x=Number.NaN,t.y=Number.NaN,t;r=(-n-Math.sqrt(i))/(2*e),s=this.radius_g+r*s,o*=r,a*=r,t.x=Math.atan2(o,s),t.y=Math.atan(a*Math.cos(t.x)/s),t.y=Math.atan(this.radius_p_inv2*Math.tan(t.y))}else if("sphere"===this.shape){if(this.flip_axis?(a=Math.tan(t.y/this.radius_g_1),o=Math.tan(t.x/this.radius_g_1)*Math.sqrt(1+a*a)):(o=Math.tan(t.x/this.radius_g_1),a=Math.tan(t.y/this.radius_g_1)*Math.sqrt(1+o*o)),e=o*o+a*a+s*s,(i=(n=2*this.radius_g*s)*n-4*e*this.C)<0)return t.x=Number.NaN,t.y=Number.NaN,t;r=(-n-Math.sqrt(i))/(2*e),s=this.radius_g+r*s,o*=r,a*=r,t.x=Math.atan2(o,s),t.y=Math.atan(a*Math.cos(t.x)/s)}return t.x=t.x+this.long0,t},names:["Geostationary Satellite View","Geostationary_Satellite","geos"]};ap.defaultDatum="WGS84",ap.Proj=Wg,ap.WGS84=new ap.Proj("WGS84"),ap.Point=Sp,ap.toPoint=ep,ap.defs=xg,ap.nadgrid=function(t,e){var n=new DataView(e),i=function(t){var e=t.getInt32(8,!1);if(11===e)return!1;11!==(e=t.getInt32(8,!0))&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian");return!0}(n),r=function(t,e){return{nFields:t.getInt32(8,e),nSubgridFields:t.getInt32(24,e),nSubgrids:t.getInt32(40,e),shiftType:Bg(t,56,64).trim(),fromSemiMajorAxis:t.getFloat64(120,e),fromSemiMinorAxis:t.getFloat64(136,e),toSemiMajorAxis:t.getFloat64(152,e),toSemiMinorAxis:t.getFloat64(168,e)}}(n,i);r.nSubgrids>1&&console.log("Only single NTv2 subgrids are currently supported, subsequent sub grids are ignored");var s=function(t,e,n){for(var i=176,r=[],s=0;s<e.nSubgrids;s++){var o=$g(t,i,n),a=Ug(t,i,o,n),l=Math.round(1+(o.upperLongitude-o.lowerLongitude)/o.longitudeInterval),c=Math.round(1+(o.upperLatitude-o.lowerLatitude)/o.latitudeInterval);r.push({ll:[qg(o.lowerLongitude),qg(o.lowerLatitude)],del:[qg(o.longitudeInterval),qg(o.latitudeInterval)],lim:[l,c],count:o.gridNodeCount,cvs:Yg(a)})}return r}(n,r,i),o={header:r,subgrids:s};return Gg[t]=o,o},ap.transform=ip,ap.mgrs=pp,ap.version="__VERSION__",function(t){t.Proj.projections.add(Tp),t.Proj.projections.add(Fp),t.Proj.projections.add(Gp),t.Proj.projections.add(Bp),t.Proj.projections.add(Yp),t.Proj.projections.add($p),t.Proj.projections.add(Wp),t.Proj.projections.add(Xp),t.Proj.projections.add(Vp),t.Proj.projections.add(i_),t.Proj.projections.add(u_),t.Proj.projections.add(d_),t.Proj.projections.add(g_),t.Proj.projections.add(p_),t.Proj.projections.add(__),t.Proj.projections.add(y_),t.Proj.projections.add(m_),t.Proj.projections.add(x_),t.Proj.projections.add(v_),t.Proj.projections.add(b_),t.Proj.projections.add(M_),t.Proj.projections.add(w_),t.Proj.projections.add(E_),t.Proj.projections.add(S_),t.Proj.projections.add(F_),t.Proj.projections.add(W_),t.Proj.projections.add(X_),t.Proj.projections.add(K_),t.Proj.projections.add(ty)}(ap);const ey=Object.assign({},{geoProjection:Lr});ap.defs([["epsg:2154","+title=France Lambert93 +proj=lcc +lat_1=49 +lat_2=44 +lat_0=46.5 +lon_0=3 +x_0=700000 +y_0=6600000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"]]),ap.defs([["epsg:3035","+title=Europa (ETRS89/LAEA) +proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs"]]),ap.defs([["epsg:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs"]]),ap.defs([["epsg:27700","+title=British National Grid -- United Kingdom +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy +towgs84=446.448,-125.157,542.06,0.15,0.247,0.842,-20.489 +units=m +no_defs"]]),ap.defs([["epsg:42304","+title=NAD83 / NRCan LCC Canada +proj=lcc +lat_1=49 +lat_2=77 +lat_0=49 +lon_0=-95 +x_0=0 +y_0=0 +datum=NAD83 +units=m +no_defs "]]);const ny=Object.assign({},{geoEquirectangular:Zr,geoIdentity:as});function iy(t){if(null==t||""===t)return ny.geoEquirectangular();if("function"==typeof t)return t;if("string"==typeof t){if("globe"==(t=t.replace(/\s/g,"")).substring(0,5).toLowerCase())return e=t,Xd.geoOrthographic().rotate(function(t){if(t&&"globe"==t.substring(0,5).toLowerCase())return(t=t.match(/\((.*)\)/))?t.pop().split(",").map((t=>+t)):[0,0]}(e));if("polar"==t.toLowerCase())return Ld.geoAzimuthalEquidistant().scale(190).rotate([0,-90]).clipAngle(150);if("hoaxiaoguang"==t.toLowerCase())return Pd.geoHufnagel().a(.8).b(.35).psiMax(50).ratio(1.6).angle(90).rotate([110,-200,90]);if("spilhaus"==t.toLowerCase())return Dd.geoProjection(Wd).rotate([-66.94970198,49.56371678,40.17823482]);if("user"===t)return ny.geoIdentity().reflectY(!0);if("+proj"===t.substring(0,5)||"epsg:"===t.substring(0,5))return function(t){let e;+t==t&&(e=ap("epsg:"+t)),e||(e=ap(t));const n=180/Math.PI,i=1/n,r=function(t,i){return e.forward([t*n,i*n])};r.invert=function(t,n){return e.inverse([t,n]).map((function(t){return t*i}))};const s=ey.geoProjection(r).scale(1);return s.raw=e,s}(t);if("user"!==t&&"+proj"!==t.substring(0,5)&&"epsg:"!==t.substring(0,5))return function(t){let e=t;return e=e.replace(/\s/g,""),"d3.geo"!==e.substring(0,6)&&(-1===e.indexOf(".")?e+="()":e=e.replace(".","()."),e="d3.geo"+e),new Function("d3",`return (${e})`)(Rd)}(t)}var e}function ry(t){let e=["z","l","p"],n=t.features.map((t=>t.geometry.type));n=Array.from(new Set(n));let i=(-1!==n.indexOf("Polygon")||-1!==n.indexOf("MultiPolygon")?e[0]:"")+(-1!==n.indexOf("LineString")||-1!==n.indexOf("MultiLineString")?e[1]:"")+(-1!==n.indexOf("Point")||-1!==n.indexOf("MultiPoint")?e[2]:"");return 1==i.length?i:"composite"}function sy(t,e,n){let i=JSON.parse(JSON.stringify(t)),r=e;if(null==e&&null==n&&null==r){let t=["coords","Coords","coord","Coords","Coordinates","coordinates","Coordinate","coordinate"],s=["lat","Lat","LAT","Latitude","latitude"],o=["lon","Lon","LON","lng","Lng","LNG","Longitude","longitude"],a=[];i.forEach((t=>a.push(Object.keys(t)))),a=Array.from(new Set(a.flat())),e=s.filter((t=>a.includes(t)))[0],n=o.filter((t=>a.includes(t)))[0],r=t.filter((t=>a.includes(t)))[0]}if(e&&n){let i=e,r=n;return{type:"FeatureCollection",features:t.map((t=>({type:"Feature",properties:t,geometry:{type:"Point",coordinates:[+t[r],+t[i]]}})))}}return r?{type:"FeatureCollection",features:t.map((t=>{return{type:"Feature",properties:t,geometry:{type:"Point",coordinates:(e=t[r],e?e.toLowerCase().includes("point")?ay(e):oy(e):null).reverse()}};var e}))}:r}function oy(t,e=","){let n=(t=t.replace(/[ ]+/g,"")).split(e).map((t=>t.replace(",","."))).map((t=>t.replace(/[^\d.-]/g,""))).map((t=>+t));return 2!=n.length&&(n=[void 0,void 0]),n}function ay(t){let e=t.match(/\(([^)]+)\)/g);return null===e?[void 0,void 0]:e[0].replace(/\s\s+/g," ").replace("(","").replace(")","").trimStart().trimEnd().split(" ").map((t=>t.replace(",","."))).map((t=>+t))}function ly(t,e){if(0!==t.length){cy(t[0],e);for(let n=1;n<t.length;n++)cy(t[n],!e)}}function cy(t,e){let n=0,i=0;for(let e=0,r=t.length,s=r-1;e<r;s=e++){const r=(t[e][0]-t[s][0])*(t[s][1]+t[e][1]),o=n+r;i+=Math.abs(n)>=Math.abs(r)?n-o+r:r-o+n,n=o}n+i>=0!=!!e&&t.reverse()}function hy(t){t=Mc(t);let e=[];t.features.forEach((t=>{e.push(function(t){let e=[];t.geometry.type.includes("Multi")?t.geometry.coordinates.forEach((n=>{e.push({type:"Feature",properties:t.properties,geometry:{type:t.geometry.type.replace("Multi",""),coordinates:n}})})):e.push({...t});const n=Oe(t);return e.forEach((t=>t.__share=Oe(t)/n)),JSON.parse(JSON.stringify(e))}(t))}));const n=Object.keys(t).filter((t=>"features"!=t)),i={};return n.forEach((e=>{i[e]=t[e]})),i.features=e.flat(),i}function uy(t,e={rewind:!1}){if(Array.isArray(t)&&"object"!=typeof t[0].geometry&&"object"!=typeof t[0].coordinates)return sy(t);let n=Mc(t),i=ry(n);return"z"==i&&!0===e.rewind&&function(t,e={}){let n=!1!==e.outer,i=!0==(!1!==e.mutate)?t:JSON.parse(JSON.stringify(t));for(let t=0;t<i.features.length;t++)if("Polygon"===i.features[t].geometry.type)ly(i.features[t].geometry.coordinates,n);else if("MultiPolygon"===i.features[t].geometry.type)for(let e=0;e<i.features[t].geometry.coordinates.length;e++)ly(i.features[t].geometry.coordinates[e],n)}(n,{mutate:!0}),"p"==i&&(n=hy(n)),n}function fy(t,e,n){let i=function(t,e){if(!t||!e)return;var n=t[0],i=t[1],r=t[2],s=t[3],o=e[0],a=e[1],l=e[2],c=e[3];return[n*o-i*a-r*l-s*c,i*o+n*a+r*c-s*l,n*l-i*c+r*o+s*a,n*c+i*l-r*a+s*o]}(function(t){if(!t)return;let e=.5*t[0]*Math.PI/180,n=.5*t[1]*Math.PI/180,i=.5*t[2]*Math.PI/180,r=Math.sin(e),s=Math.cos(e),o=Math.sin(n),a=Math.cos(n),l=Math.sin(i),c=Math.cos(i);return[s*a*c+r*o*l,r*a*c-s*o*l,s*o*c+r*a*l,s*a*l-r*o*c]}(n),function(t,e){if(t&&e){let n=function(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}(t,e),i=Math.sqrt(gy(n,n));if(0==i)return;let r=.5*Math.acos(Math.max(-1,Math.min(1,gy(t,e)))),s=n[2]*Math.sin(r)/i,o=-n[1]*Math.sin(r)/i,a=n[0]*Math.sin(r)/i,l=Math.cos(r);return r&&[l,s,o,a]}}(dy(t),dy(e)));return function(t){if(!t)return;return[180*Math.atan2(2*(t[0]*t[1]+t[2]*t[3]),1-2*(t[1]*t[1]+t[2]*t[2]))/Math.PI,180*Math.asin(Math.max(-1,Math.min(1,2*(t[0]*t[2]-t[3]*t[1]))))/Math.PI,180*Math.atan2(2*(t[0]*t[3]+t[1]*t[2]),1-2*(t[2]*t[2]+t[3]*t[3]))/Math.PI]}(i)}function dy(t){let e=t[0]*Math.PI/180,n=t[1]*Math.PI/180;return[Math.cos(n)*Math.cos(e),Math.cos(n)*Math.sin(e),Math.sin(n)]}function gy(t,e){for(var n=0,i=0;t.length>n;++n)i+=t[n]*e[n];return i}const py={passive:!1},_y={capture:!0,passive:!1};function yy(t){t.stopImmediatePropagation()}function my(t){t.preventDefault(),t.stopImmediatePropagation()}var xy=t=>()=>t;function vy(t,{sourceEvent:e,subject:n,target:i,identifier:r,active:s,x:o,y:a,dx:l,dy:c,dispatch:h}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:h}})}function by(t){return!t.ctrlKey&&!t.button}function My(){return this.parentNode}function wy(t,e){return null==e?{x:t.x,y:t.y}:e}function Ey(){return navigator.maxTouchPoints||"ontouchstart"in this}vy.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};const Sy=Object.assign({},{geoPath:Mr,drag:function(){var t,e,n,i,r=by,s=My,o=wy,a=Ey,l={},c=Fo("start","drag","end"),h=0,u=0;function f(t){t.on("mousedown.drag",d).filter(a).on("touchstart.drag",_).on("touchmove.drag",y,py).on("touchend.drag touchcancel.drag",m).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(o,a){if(!i&&r.call(this,o,a)){var l=x(this,s.call(this,o,a),o,a,"mouse");l&&(Oo(o.view).on("mousemove.drag",g,_y).on("mouseup.drag",p,_y),function(t){var e=t.document.documentElement,n=Oo(t).on("dragstart.drag",my,_y);"onselectstart"in e?n.on("selectstart.drag",my,_y):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}(o.view),yy(o),n=!1,t=o.clientX,e=o.clientY,l("start",o))}}function g(i){if(my(i),!n){var r=i.clientX-t,s=i.clientY-e;n=r*r+s*s>u}l.mouse("drag",i)}function p(t){Oo(t.view).on("mousemove.drag mouseup.drag",null),function(t,e){var n=t.document.documentElement,i=Oo(t).on("dragstart.drag",null);e&&(i.on("click.drag",my,_y),setTimeout((function(){i.on("click.drag",null)}),0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}(t.view,n),my(t),l.mouse("end",t)}function _(t,e){if(r.call(this,t,e)){var n,i,o=t.changedTouches,a=s.call(this,t,e),l=o.length;for(n=0;n<l;++n)(i=x(this,a,t,e,o[n].identifier,o[n]))&&(yy(t),i("start",t,o[n]))}}function y(t){var e,n,i=t.changedTouches,r=i.length;for(e=0;e<r;++e)(n=l[i[e].identifier])&&(my(t),n("drag",t,i[e]))}function m(t){var e,n,r=t.changedTouches,s=r.length;for(i&&clearTimeout(i),i=setTimeout((function(){i=null}),500),e=0;e<s;++e)(n=l[r[e].identifier])&&(yy(t),n("end",t,r[e]))}function x(t,e,n,i,r,s){var a,u,d,g=c.copy(),p=Po(s||n,e);if(null!=(d=o.call(t,new vy("beforestart",{sourceEvent:n,target:f,identifier:r,active:h,x:p[0],y:p[1],dx:0,dy:0,dispatch:g}),i)))return a=d.x-p[0]||0,u=d.y-p[1]||0,function n(s,o,c){var _,y=p;switch(s){case"start":l[r]=n,_=h++;break;case"end":delete l[r],--h;case"drag":p=Po(c||o,e),_=h}g.call(s,t,new vy(s,{sourceEvent:o,subject:d,target:f,identifier:r,active:_,x:p[0]+a,y:p[1]+u,dx:p[0]-y[0],dy:p[1]-y[1],dispatch:g}),i)}}return f.filter=function(t){return arguments.length?(r="function"==typeof t?t:xy(!!t),f):r},f.container=function(t){return arguments.length?(s="function"==typeof t?t:xy(t),f):s},f.subject=function(t){return arguments.length?(o="function"==typeof t?t:xy(t),f):o},f.touchable=function(t){return arguments.length?(a="function"==typeof t?t:xy(!!t),f):a},f.on=function(){var t=c.on.apply(c,arguments);return t===c?f:t},f.clickDistance=function(t){return arguments.length?(u=(t=+t)*t,f):Math.sqrt(u)},f},pointer:Po});function Ny(t,e){let n,i;let r=Sy.drag().on("start",(function(t){n=e.invert(Sy.pointer(t,this)),i=e.rotate()})).on("drag",(function(r){i=e.rotate();var s=e.invert(Sy.pointer(r,this)),o=fy(n,s,i);e.rotate(o),t.selectAll(".onglobe").attr("d",Sy.geoPath(e)),t.selectAll(".onglobe_coords").attr("cx",(t=>Sy.geoPath(e).centroid(t.geometry)[0])).attr("cy",(t=>Sy.geoPath(e).centroid(t.geometry)[1])).attr("x",(t=>Sy.geoPath(e).centroid(t.geometry)[0])).attr("y",(t=>Sy.geoPath(e).centroid(t.geometry)[1])).attr("visibility",(t=>isNaN(Sy.geoPath(e).centroid(t.geometry)[0])?"hidden":"visible")),t.selectAll(".onglobe_translate").attr("transform",(t=>`translate(\n         ${Sy.geoPath(e).centroid(t.geometry)[0]},\n         ${Sy.geoPath(e).centroid(t.geometry)[1]})`)).attr("visibility",(t=>isNaN(Sy.geoPath(e).centroid(t.geometry)[0])?"hidden":"visible"))}));t.call(r)}function Iy(t){let e=new Map([["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["fillOpacity","fill-opacity"],["strokeDasharray","stroke-dasharray"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"]]).get(t);return e||t}function ky(t){const e=Ln().center((t=>t)).radius(t/4).precision(10),n=[];for(let i=-80;i<=80;i+=t)for(let r=-180;r<180;r+=t)n.push({type:"Feature",properties:{},geometry:{type:"MultiPolygon",coordinates:[e([r,i]).coordinates]}});return{type:"FeatureCollection",features:n}}function Oy(t){let e=[];for(let n=0;n<t;n++)e[n]=360/t*n*(Math.PI/180);return e}function Cy(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function Ay(t,e){switch(arguments.length){case 0:break;case 1:"function"==typeof t?this.interpolator(t):this.range(t);break;default:this.domain(t),"function"==typeof e?this.interpolator(e):this.range(e)}return this}const Ty=Symbol("implicit");function Ry(){var t=new N,e=[],n=[],i=Ty;function r(r){let s=t.get(r);if(void 0===s){if(i!==Ty)return i;t.set(r,s=e.push(r)-1)}return n[s%n.length]}return r.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new N;for(const i of n)t.has(i)||t.set(i,e.push(i)-1);return r},r.range=function(t){return arguments.length?(n=Array.from(t),r):n.slice()},r.unknown=function(t){return arguments.length?(i=t,r):i},r.copy=function(){return Ry(e,n).unknown(i)},Cy.apply(r,arguments),r}function Ly(){var t,e,n=Ry().unknown(void 0),i=n.domain,r=n.range,s=0,o=1,a=!1,l=0,c=0,h=.5;function u(){var n=i().length,u=o<s,f=u?o:s,d=u?s:o;t=(d-f)/Math.max(1,n-l+2*c),a&&(t=Math.floor(t)),f+=(d-f-t*(n-l))*h,e=t*(1-l),a&&(f=Math.round(f),e=Math.round(e));var g=yt(n).map((function(e){return f+t*e}));return r(u?g.reverse():g)}return delete n.unknown,n.domain=function(t){return arguments.length?(i(t),u()):i()},n.range=function(t){return arguments.length?([s,o]=t,s=+s,o=+o,u()):[s,o]},n.rangeRound=function(t){return[s,o]=t,s=+s,o=+o,a=!0,u()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(a=!!t,u()):a},n.padding=function(t){return arguments.length?(l=Math.min(1,c=+t),u()):l},n.paddingInner=function(t){return arguments.length?(l=Math.min(1,t),u()):l},n.paddingOuter=function(t){return arguments.length?(c=+t,u()):c},n.align=function(t){return arguments.length?(h=Math.max(0,Math.min(1,t)),u()):h},n.copy=function(){return Ly(i(),[s,o]).round(a).paddingInner(l).paddingOuter(c).align(h)},Cy.apply(u(),arguments)}function Py(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return Py(e())},t}function Dy(t){return+t}var zy=[0,1];function Fy(t){return t}function Gy(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:function(t){return function(){return t}}(isNaN(e)?NaN:.5)}function jy(t,e,n){var i=t[0],r=t[1],s=e[0],o=e[1];return r<i?(i=Gy(r,i),s=n(o,s)):(i=Gy(i,r),s=n(s,o)),function(t){return s(i(t))}}function qy(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),s=new Array(i),o=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<i;)r[o]=Gy(t[o],t[o+1]),s[o]=n(e[o],e[o+1]);return function(e){var n=u(t,e,1,i)-1;return s[n](r[n](e))}}function By(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Yy(){var t,e,n,i,r,s,o=zy,a=zy,l=Ml,c=Fy;function h(){var t=Math.min(o.length,a.length);return c!==Fy&&(c=function(t,e){var n;return t>e&&(n=t,t=e,e=n),function(n){return Math.max(t,Math.min(e,n))}}(o[0],o[t-1])),i=t>2?qy:jy,r=s=null,u}function u(e){return null==e||isNaN(e=+e)?n:(r||(r=i(o.map(t),a,l)))(t(c(e)))}return u.invert=function(n){return c(e((s||(s=i(a,o.map(t),yl)))(n)))},u.domain=function(t){return arguments.length?(o=Array.from(t,Dy),h()):o.slice()},u.range=function(t){return arguments.length?(a=Array.from(t),h()):a.slice()},u.rangeRound=function(t){return a=Array.from(t),l=wl,h()},u.clamp=function(t){return arguments.length?(c=!!t||Fy,h()):c!==Fy},u.interpolate=function(t){return arguments.length?(l=t,h()):l},u.unknown=function(t){return arguments.length?(n=t,u):n},function(n,i){return t=n,e=i,h()}}function $y(){return Yy()(Fy,Fy)}function Uy(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function Wy(t){return(t=Uy(Math.abs(t)))?t[1]:NaN}var Xy,Vy=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Hy(t){if(!(e=Vy.exec(t)))throw new Error("invalid format: "+t);var e;return new Jy({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Jy(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function Zy(t,e){var n=Uy(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}Hy.prototype=Jy.prototype,Jy.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Qy={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Zy(100*t,e),r:Zy,s:function(t,e){var n=Uy(t,e);if(!n)return t+"";var i=n[0],r=n[1],s=r-(Xy=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,o=i.length;return s===o?i:s>o?i+new Array(s-o+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+Uy(t,Math.max(0,e+s-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Ky(t){return t}var tm,em,nm,im=Array.prototype.map,rm=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function sm(t){var e,n,i=void 0===t.grouping||void 0===t.thousands?Ky:(e=im.call(t.grouping,Number),n=t.thousands+"",function(t,i){for(var r=t.length,s=[],o=0,a=e[0],l=0;r>0&&a>0&&(l+a+1>i&&(a=Math.max(1,i-l)),s.push(t.substring(r-=a,r+a)),!((l+=a+1)>i));)a=e[o=(o+1)%e.length];return s.reverse().join(n)}),r=void 0===t.currency?"":t.currency[0]+"",s=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",a=void 0===t.numerals?Ky:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(im.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",c=void 0===t.minus?"−":t.minus+"",h=void 0===t.nan?"NaN":t.nan+"";function u(t){var e=(t=Hy(t)).fill,n=t.align,u=t.sign,f=t.symbol,d=t.zero,g=t.width,p=t.comma,_=t.precision,y=t.trim,m=t.type;"n"===m?(p=!0,m="g"):Qy[m]||(void 0===_&&(_=12),y=!0,m="g"),(d||"0"===e&&"="===n)&&(d=!0,e="0",n="=");var x="$"===f?r:"#"===f&&/[boxX]/.test(m)?"0"+m.toLowerCase():"",v="$"===f?s:/[%p]/.test(m)?l:"",b=Qy[m],M=/[defgprs%]/.test(m);function w(t){var r,s,l,f=x,w=v;if("c"===m)w=b(t)+w,t="";else{var E=(t=+t)<0||1/t<0;if(t=isNaN(t)?h:b(Math.abs(t),_),y&&(t=function(t){t:for(var e,n=t.length,i=1,r=-1;i<n;++i)switch(t[i]){case".":r=e=i;break;case"0":0===r&&(r=i),e=i;break;default:if(!+t[i])break t;r>0&&(r=0)}return r>0?t.slice(0,r)+t.slice(e+1):t}(t)),E&&0==+t&&"+"!==u&&(E=!1),f=(E?"("===u?u:c:"-"===u||"("===u?"":u)+f,w=("s"===m?rm[8+Xy/3]:"")+w+(E&&"("===u?")":""),M)for(r=-1,s=t.length;++r<s;)if(48>(l=t.charCodeAt(r))||l>57){w=(46===l?o+t.slice(r+1):t.slice(r))+w,t=t.slice(0,r);break}}p&&!d&&(t=i(t,1/0));var S=f.length+t.length+w.length,N=S<g?new Array(g-S+1).join(e):"";switch(p&&d&&(t=i(N+t,N.length?g-w.length:1/0),N=""),n){case"<":t=f+t+w+N;break;case"=":t=f+N+t+w;break;case"^":t=N.slice(0,S=N.length>>1)+f+t+w+N.slice(S);break;default:t=N+f+t+w}return a(t)}return _=void 0===_?6:/[gprs]/.test(m)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_)),w.toString=function(){return t+""},w}return{format:u,formatPrefix:function(t,e){var n=u(((t=Hy(t)).type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(Wy(e)/3))),r=Math.pow(10,-i),s=rm[8+i/3];return function(t){return n(r*t)+s}}}}function om(t,e,n,i){var r,s=tt(t,e,n);switch((i=Hy(null==i?",f":i)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=i.precision||isNaN(r=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Wy(e)/3)))-Wy(Math.abs(t)))}(s,o))||(i.precision=r),nm(i,o);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(r=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Wy(e)-Wy(t))+1}(s,Math.max(Math.abs(t),Math.abs(e))))||(i.precision=r-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(r=function(t){return Math.max(0,-Wy(Math.abs(t)))}(s))||(i.precision=r-2*("%"===i.type))}return em(i)}function am(t){var e=t.domain;return t.ticks=function(t){var n=e();return Q(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var i=e();return om(i[0],i[i.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var i,r,s=e(),o=0,a=s.length-1,l=s[o],c=s[a],h=10;for(c<l&&(r=l,l=c,c=r,r=o,o=a,a=r);h-- >0;){if((r=K(l,c,n))===i)return s[o]=l,s[a]=c,e(s);if(r>0)l=Math.floor(l/r)*r,c=Math.ceil(c/r)*r;else{if(!(r<0))break;l=Math.ceil(l*r)/r,c=Math.floor(c*r)/r}i=r}return t},t}function lm(){var t=$y();return t.copy=function(){return By(t,lm())},Cy.apply(t,arguments),am(t)}function cm(t,e){var n,i=0,r=(t=t.slice()).length-1,s=t[i],o=t[r];return o<s&&(n=i,i=r,r=n,n=s,s=o,o=n),t[i]=e.floor(s),t[r]=e.ceil(o),t}function hm(t){return Math.log(t)}function um(t){return Math.exp(t)}function fm(t){return-Math.log(-t)}function dm(t){return-Math.exp(-t)}function gm(t){return isFinite(t)?+("1e"+t):t<0?0:t}function pm(t){return(e,n)=>-t(-e,n)}function _m(t){const e=t(hm,um),n=e.domain;let i,r,s=10;function o(){return i=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}(s),r=function(t){return 10===t?gm:t===Math.E?Math.exp:e=>Math.pow(t,e)}(s),n()[0]<0?(i=pm(i),r=pm(r),t(fm,dm)):t(hm,um),e}return e.base=function(t){return arguments.length?(s=+t,o()):s},e.domain=function(t){return arguments.length?(n(t),o()):n()},e.ticks=t=>{const e=n();let o=e[0],a=e[e.length-1];const l=a<o;l&&([o,a]=[a,o]);let c,h,u=i(o),f=i(a);const d=null==t?10:+t;let g=[];if(!(s%1)&&f-u<d){if(u=Math.floor(u),f=Math.ceil(f),o>0){for(;u<=f;++u)for(c=1;c<s;++c)if(h=u<0?c/r(-u):c*r(u),!(h<o)){if(h>a)break;g.push(h)}}else for(;u<=f;++u)for(c=s-1;c>=1;--c)if(h=u>0?c/r(-u):c*r(u),!(h<o)){if(h>a)break;g.push(h)}2*g.length<d&&(g=Q(o,a,d))}else g=Q(u,f,Math.min(f-u,d)).map(r);return l?g.reverse():g},e.tickFormat=(t,n)=>{if(null==t&&(t=10),null==n&&(n=10===s?"s":","),"function"!=typeof n&&(s%1||null!=(n=Hy(n)).precision||(n.trim=!0),n=em(n)),t===1/0)return n;const o=Math.max(1,s*t/e.ticks().length);return t=>{let e=t/r(Math.round(i(t)));return e*s<s-.5&&(e*=s),e<=o?n(t):""}},e.nice=()=>n(cm(n(),{floor:t=>r(Math.floor(i(t))),ceil:t=>r(Math.ceil(i(t)))})),e}function ym(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function mm(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function xm(t){var e=1,n=t(ym(e),mm(e));return n.constant=function(n){return arguments.length?t(ym(e=+n),mm(e)):e},am(n)}function vm(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function bm(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Mm(t){return t<0?-t*t:t*t}function wm(t){var e=t(Fy,Fy),n=1;function i(){return 1===n?t(Fy,Fy):.5===n?t(bm,Mm):t(vm(n),vm(1/n))}return e.exponent=function(t){return arguments.length?(n=+t,i()):n},am(e)}function Em(){var t=wm(Yy());return t.copy=function(){return By(t,Em()).exponent(t.exponent())},Cy.apply(t,arguments),t}function Sm(){return Em.apply(null,arguments).exponent(.5)}function Nm(t){return Math.sign(t)*t*t}function Im(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function km(){var t,e=[.5],n=[0,1],i=1;function r(r){return null!=r&&r<=r?n[u(e,r,0,i)]:t}return r.domain=function(t){return arguments.length?(e=Array.from(t),i=Math.min(e.length,n.length-1),r):e.slice()},r.range=function(t){return arguments.length?(n=Array.from(t),i=Math.min(e.length,n.length-1),r):n.slice()},r.invertExtent=function(t){var i=n.indexOf(t);return[e[i-1],e[i]]},r.unknown=function(e){return arguments.length?(t=e,r):t},r.copy=function(){return km().domain(e).range(n).unknown(t)},Cy.apply(r,arguments)}tm=sm({thousands:",",grouping:[3],currency:["$",""]}),em=tm.format,nm=tm.formatPrefix;var Om=new Date,Cm=new Date;function Am(t,e,n,i){function r(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return r.floor=function(e){return t(e=new Date(+e)),e},r.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},r.round=function(t){var e=r(t),n=r.ceil(t);return t-e<n-t?e:n},r.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},r.range=function(n,i,s){var o,a=[];if(n=r.ceil(n),s=null==s?1:Math.floor(s),!(n<i&&s>0))return a;do{a.push(o=new Date(+n)),e(n,s),t(n)}while(o<n&&n<i);return a},r.filter=function(n){return Am((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,i){if(t>=t)if(i<0)for(;++i<=0;)for(;e(t,-1),!n(t););else for(;--i>=0;)for(;e(t,1),!n(t););}))},n&&(r.count=function(e,i){return Om.setTime(+e),Cm.setTime(+i),t(Om),t(Cm),Math.floor(n(Om,Cm))},r.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?r.filter(i?function(e){return i(e)%t==0}:function(e){return r.count(0,e)%t==0}):r:null}),r}var Tm=Am((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t}));Tm.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?Am((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t})):Tm:null};var Rm=Tm;Tm.range;const Lm=1e3,Pm=6e4,Dm=36e5,zm=864e5,Fm=6048e5,Gm=2592e6,jm=31536e6;var qm=Am((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,e){t.setTime(+t+e*Lm)}),(function(t,e){return(e-t)/Lm}),(function(t){return t.getUTCSeconds()})),Bm=qm;qm.range;var Ym=Am((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*Lm)}),(function(t,e){t.setTime(+t+e*Pm)}),(function(t,e){return(e-t)/Pm}),(function(t){return t.getMinutes()})),$m=Ym;Ym.range;var Um=Am((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*Lm-t.getMinutes()*Pm)}),(function(t,e){t.setTime(+t+e*Dm)}),(function(t,e){return(e-t)/Dm}),(function(t){return t.getHours()})),Wm=Um;Um.range;var Xm=Am((t=>t.setHours(0,0,0,0)),((t,e)=>t.setDate(t.getDate()+e)),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Pm)/zm),(t=>t.getDate()-1)),Vm=Xm;function Hm(t){return Am((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Pm)/Fm}))}Xm.range;var Jm=Hm(0),Zm=Hm(1),Qm=Hm(2),Km=Hm(3),tx=Hm(4),ex=Hm(5),nx=Hm(6);Jm.range,Zm.range,Qm.range,Km.range,tx.range,ex.range,nx.range;var ix=Am((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()})),rx=ix;ix.range;var sx=Am((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));sx.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Am((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};var ox=sx;sx.range;var ax=Am((function(t){t.setUTCSeconds(0,0)}),(function(t,e){t.setTime(+t+e*Pm)}),(function(t,e){return(e-t)/Pm}),(function(t){return t.getUTCMinutes()})),lx=ax;ax.range;var cx=Am((function(t){t.setUTCMinutes(0,0,0)}),(function(t,e){t.setTime(+t+e*Dm)}),(function(t,e){return(e-t)/Dm}),(function(t){return t.getUTCHours()})),hx=cx;cx.range;var ux=Am((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/zm}),(function(t){return t.getUTCDate()-1})),fx=ux;function dx(t){return Am((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/Fm}))}ux.range;var gx=dx(0),px=dx(1),_x=dx(2),yx=dx(3),mx=dx(4),xx=dx(5),vx=dx(6);gx.range,px.range,_x.range,yx.range,mx.range,xx.range,vx.range;var bx=Am((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCMonth(t.getUTCMonth()+e)}),(function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()})),Mx=bx;bx.range;var wx=Am((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()}));wx.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Am((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};var Ex=wx;function Sx(t,e,n,r,s,o){const a=[[Bm,1,Lm],[Bm,5,5e3],[Bm,15,15e3],[Bm,30,3e4],[o,1,Pm],[o,5,3e5],[o,15,9e5],[o,30,18e5],[s,1,Dm],[s,3,108e5],[s,6,216e5],[s,12,432e5],[r,1,zm],[r,2,1728e5],[n,1,Fm],[e,1,Gm],[e,3,7776e6],[t,1,jm]];function l(e,n,r){const s=Math.abs(n-e)/r,o=i((([,,t])=>t)).right(a,s);if(o===a.length)return t.every(tt(e/jm,n/jm,r));if(0===o)return Rm.every(Math.max(tt(e,n,r),1));const[l,c]=a[s/a[o-1][2]<a[o][2]/s?o-1:o];return l.every(c)}return[function(t,e,n){const i=e<t;i&&([t,e]=[e,t]);const r=n&&"function"==typeof n.range?n:l(t,e,n),s=r?r.range(t,+e+1):[];return i?s.reverse():s},l]}wx.range;const[Nx,Ix]=Sx(Ex,Mx,gx,fx,hx,lx),[kx,Ox]=Sx(ox,rx,Jm,Vm,Wm,$m);function Cx(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Ax(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Tx(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}var Rx,Lx,Px,Dx={"-":"",_:" ",0:"0"},zx=/^\s*\d+/,Fx=/^%/,Gx=/[\\^$*+?|[\]().{}]/g;function jx(t,e,n){var i=t<0?"-":"",r=(i?-t:t)+"",s=r.length;return i+(s<n?new Array(n-s+1).join(e)+r:r)}function qx(t){return t.replace(Gx,"\\$&")}function Bx(t){return new RegExp("^(?:"+t.map(qx).join("|")+")","i")}function Yx(t){return new Map(t.map(((t,e)=>[t.toLowerCase(),e])))}function $x(t,e,n){var i=zx.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function Ux(t,e,n){var i=zx.exec(e.slice(n,n+1));return i?(t.u=+i[0],n+i[0].length):-1}function Wx(t,e,n){var i=zx.exec(e.slice(n,n+2));return i?(t.U=+i[0],n+i[0].length):-1}function Xx(t,e,n){var i=zx.exec(e.slice(n,n+2));return i?(t.V=+i[0],n+i[0].length):-1}function Vx(t,e,n){var i=zx.exec(e.slice(n,n+2));return i?(t.W=+i[0],n+i[0].length):-1}function Hx(t,e,n){var i=zx.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function Jx(t,e,n){var i=zx.exec(e.slice(n,n+2));return i?(t.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function Zx(t,e,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return i?(t.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function Qx(t,e,n){var i=zx.exec(e.slice(n,n+1));return i?(t.q=3*i[0]-3,n+i[0].length):-1}function Kx(t,e,n){var i=zx.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function tv(t,e,n){var i=zx.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function ev(t,e,n){var i=zx.exec(e.slice(n,n+3));return i?(t.m=0,t.d=+i[0],n+i[0].length):-1}function nv(t,e,n){var i=zx.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function iv(t,e,n){var i=zx.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function rv(t,e,n){var i=zx.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function sv(t,e,n){var i=zx.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function ov(t,e,n){var i=zx.exec(e.slice(n,n+6));return i?(t.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function av(t,e,n){var i=Fx.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function lv(t,e,n){var i=zx.exec(e.slice(n));return i?(t.Q=+i[0],n+i[0].length):-1}function cv(t,e,n){var i=zx.exec(e.slice(n));return i?(t.s=+i[0],n+i[0].length):-1}function hv(t,e){return jx(t.getDate(),e,2)}function uv(t,e){return jx(t.getHours(),e,2)}function fv(t,e){return jx(t.getHours()%12||12,e,2)}function dv(t,e){return jx(1+Vm.count(ox(t),t),e,3)}function gv(t,e){return jx(t.getMilliseconds(),e,3)}function pv(t,e){return gv(t,e)+"000"}function _v(t,e){return jx(t.getMonth()+1,e,2)}function yv(t,e){return jx(t.getMinutes(),e,2)}function mv(t,e){return jx(t.getSeconds(),e,2)}function xv(t){var e=t.getDay();return 0===e?7:e}function vv(t,e){return jx(Jm.count(ox(t)-1,t),e,2)}function bv(t){var e=t.getDay();return e>=4||0===e?tx(t):tx.ceil(t)}function Mv(t,e){return t=bv(t),jx(tx.count(ox(t),t)+(4===ox(t).getDay()),e,2)}function wv(t){return t.getDay()}function Ev(t,e){return jx(Zm.count(ox(t)-1,t),e,2)}function Sv(t,e){return jx(t.getFullYear()%100,e,2)}function Nv(t,e){return jx((t=bv(t)).getFullYear()%100,e,2)}function Iv(t,e){return jx(t.getFullYear()%1e4,e,4)}function kv(t,e){var n=t.getDay();return jx((t=n>=4||0===n?tx(t):tx.ceil(t)).getFullYear()%1e4,e,4)}function Ov(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+jx(e/60|0,"0",2)+jx(e%60,"0",2)}function Cv(t,e){return jx(t.getUTCDate(),e,2)}function Av(t,e){return jx(t.getUTCHours(),e,2)}function Tv(t,e){return jx(t.getUTCHours()%12||12,e,2)}function Rv(t,e){return jx(1+fx.count(Ex(t),t),e,3)}function Lv(t,e){return jx(t.getUTCMilliseconds(),e,3)}function Pv(t,e){return Lv(t,e)+"000"}function Dv(t,e){return jx(t.getUTCMonth()+1,e,2)}function zv(t,e){return jx(t.getUTCMinutes(),e,2)}function Fv(t,e){return jx(t.getUTCSeconds(),e,2)}function Gv(t){var e=t.getUTCDay();return 0===e?7:e}function jv(t,e){return jx(gx.count(Ex(t)-1,t),e,2)}function qv(t){var e=t.getUTCDay();return e>=4||0===e?mx(t):mx.ceil(t)}function Bv(t,e){return t=qv(t),jx(mx.count(Ex(t),t)+(4===Ex(t).getUTCDay()),e,2)}function Yv(t){return t.getUTCDay()}function $v(t,e){return jx(px.count(Ex(t)-1,t),e,2)}function Uv(t,e){return jx(t.getUTCFullYear()%100,e,2)}function Wv(t,e){return jx((t=qv(t)).getUTCFullYear()%100,e,2)}function Xv(t,e){return jx(t.getUTCFullYear()%1e4,e,4)}function Vv(t,e){var n=t.getUTCDay();return jx((t=n>=4||0===n?mx(t):mx.ceil(t)).getUTCFullYear()%1e4,e,4)}function Hv(){return"+0000"}function Jv(){return"%"}function Zv(t){return+t}function Qv(t){return Math.floor(+t/1e3)}function Kv(t){return new Date(t)}function tb(t){return t instanceof Date?+t:+new Date(+t)}function eb(t,e,n,i,r,s,o,a,l,c){var h=$y(),u=h.invert,f=h.domain,d=c(".%L"),g=c(":%S"),p=c("%I:%M"),_=c("%I %p"),y=c("%a %d"),m=c("%b %d"),x=c("%B"),v=c("%Y");function b(t){return(l(t)<t?d:a(t)<t?g:o(t)<t?p:s(t)<t?_:i(t)<t?r(t)<t?y:m:n(t)<t?x:v)(t)}return h.invert=function(t){return new Date(u(t))},h.domain=function(t){return arguments.length?f(Array.from(t,tb)):f().map(Kv)},h.ticks=function(e){var n=f();return t(n[0],n[n.length-1],null==e?10:e)},h.tickFormat=function(t,e){return null==e?b:c(e)},h.nice=function(t){var n=f();return t&&"function"==typeof t.range||(t=e(n[0],n[n.length-1],null==t?10:t)),t?f(cm(n,t)):h},h.copy=function(){return By(h,eb(t,e,n,i,r,s,o,a,l,c))},h}function nb(){var t,e,n,i,r,s=0,o=1,a=Fy,l=!1;function c(e){return null==e||isNaN(e=+e)?r:a(0===n?.5:(e=(i(e)-t)*n,l?Math.max(0,Math.min(1,e)):e))}function h(t){return function(e){var n,i;return arguments.length?([n,i]=e,a=t(n,i),c):[a(0),a(1)]}}return c.domain=function(r){return arguments.length?([s,o]=r,t=i(s=+s),e=i(o=+o),n=t===e?0:1/(e-t),c):[s,o]},c.clamp=function(t){return arguments.length?(l=!!t,c):l},c.interpolator=function(t){return arguments.length?(a=t,c):a},c.range=h(Ml),c.rangeRound=h(wl),c.unknown=function(t){return arguments.length?(r=t,c):r},function(r){return i=r,t=r(s),e=r(o),n=t===e?0:1/(e-t),c}}function ib(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function rb(){var t=wm(nb());return t.copy=function(){return ib(t,rb()).exponent(t.exponent())},Ay.apply(t,arguments)}function sb(){var t=[],n=Fy;function i(e){if(null!=e&&!isNaN(e=+e))return n((u(t,e,1)-1)/(t.length-1))}return i.domain=function(n){if(!arguments.length)return t.slice();t=[];for(let e of n)null==e||isNaN(e=+e)||t.push(e);return t.sort(e),i},i.interpolator=function(t){return arguments.length?(n=t,i):n},i.range=function(){return t.map(((e,i)=>n(i/(t.length-1))))},i.quantiles=function(e){return Array.from({length:e+1},((n,i)=>ut(t,i/e)))},i.copy=function(){return sb(n).domain(t)},Ay.apply(i,arguments)}function ob(){var t,e,n,i,r,s,o,a=0,l=.5,c=1,h=1,u=Fy,f=!1;function d(t){return isNaN(t=+t)?o:(t=.5+((t=+s(t))-e)*(h*t<h*e?i:r),u(f?Math.max(0,Math.min(1,t)):t))}function g(t){return function(e){var n,i,r;return arguments.length?([n,i,r]=e,u=Rl(t,[n,i,r]),d):[u(0),u(.5),u(1)]}}return d.domain=function(o){return arguments.length?([a,l,c]=o,t=s(a=+a),e=s(l=+l),n=s(c=+c),i=t===e?0:.5/(e-t),r=e===n?0:.5/(n-e),h=e<t?-1:1,d):[a,l,c]},d.clamp=function(t){return arguments.length?(f=!!t,d):f},d.interpolator=function(t){return arguments.length?(u=t,d):u},d.range=g(Ml),d.rangeRound=g(wl),d.unknown=function(t){return arguments.length?(o=t,d):o},function(o){return s=o,t=o(a),e=o(l),n=o(c),i=t===e?0:.5/(e-t),r=e===n?0:.5/(n-e),h=e<t?-1:1,d}}function ab(){var t=wm(ob());return t.copy=function(){return ib(t,ab()).exponent(t.exponent())},Ay.apply(t,arguments)}!function(t){Rx=function(t){var e=t.dateTime,n=t.date,i=t.time,r=t.periods,s=t.days,o=t.shortDays,a=t.months,l=t.shortMonths,c=Bx(r),h=Yx(r),u=Bx(s),f=Yx(s),d=Bx(o),g=Yx(o),p=Bx(a),_=Yx(a),y=Bx(l),m=Yx(l),x={a:function(t){return o[t.getDay()]},A:function(t){return s[t.getDay()]},b:function(t){return l[t.getMonth()]},B:function(t){return a[t.getMonth()]},c:null,d:hv,e:hv,f:pv,g:Nv,G:kv,H:uv,I:fv,j:dv,L:gv,m:_v,M:yv,p:function(t){return r[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:Zv,s:Qv,S:mv,u:xv,U:vv,V:Mv,w:wv,W:Ev,x:null,X:null,y:Sv,Y:Iv,Z:Ov,"%":Jv},v={a:function(t){return o[t.getUTCDay()]},A:function(t){return s[t.getUTCDay()]},b:function(t){return l[t.getUTCMonth()]},B:function(t){return a[t.getUTCMonth()]},c:null,d:Cv,e:Cv,f:Pv,g:Wv,G:Vv,H:Av,I:Tv,j:Rv,L:Lv,m:Dv,M:zv,p:function(t){return r[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:Zv,s:Qv,S:Fv,u:Gv,U:jv,V:Bv,w:Yv,W:$v,x:null,X:null,y:Uv,Y:Xv,Z:Hv,"%":Jv},b={a:function(t,e,n){var i=d.exec(e.slice(n));return i?(t.w=g.get(i[0].toLowerCase()),n+i[0].length):-1},A:function(t,e,n){var i=u.exec(e.slice(n));return i?(t.w=f.get(i[0].toLowerCase()),n+i[0].length):-1},b:function(t,e,n){var i=y.exec(e.slice(n));return i?(t.m=m.get(i[0].toLowerCase()),n+i[0].length):-1},B:function(t,e,n){var i=p.exec(e.slice(n));return i?(t.m=_.get(i[0].toLowerCase()),n+i[0].length):-1},c:function(t,n,i){return E(t,e,n,i)},d:tv,e:tv,f:ov,g:Jx,G:Hx,H:nv,I:nv,j:ev,L:sv,m:Kx,M:iv,p:function(t,e,n){var i=c.exec(e.slice(n));return i?(t.p=h.get(i[0].toLowerCase()),n+i[0].length):-1},q:Qx,Q:lv,s:cv,S:rv,u:Ux,U:Wx,V:Xx,w:$x,W:Vx,x:function(t,e,i){return E(t,n,e,i)},X:function(t,e,n){return E(t,i,e,n)},y:Jx,Y:Hx,Z:Zx,"%":av};function M(t,e){return function(n){var i,r,s,o=[],a=-1,l=0,c=t.length;for(n instanceof Date||(n=new Date(+n));++a<c;)37===t.charCodeAt(a)&&(o.push(t.slice(l,a)),null!=(r=Dx[i=t.charAt(++a)])?i=t.charAt(++a):r="e"===i?" ":"0",(s=e[i])&&(i=s(n,r)),o.push(i),l=a+1);return o.push(t.slice(l,a)),o.join("")}}function w(t,e){return function(n){var i,r,s=Tx(1900,void 0,1);if(E(s,t,n+="",0)!=n.length)return null;if("Q"in s)return new Date(s.Q);if("s"in s)return new Date(1e3*s.s+("L"in s?s.L:0));if(e&&!("Z"in s)&&(s.Z=0),"p"in s&&(s.H=s.H%12+12*s.p),void 0===s.m&&(s.m="q"in s?s.q:0),"V"in s){if(s.V<1||s.V>53)return null;"w"in s||(s.w=1),"Z"in s?(r=(i=Ax(Tx(s.y,0,1))).getUTCDay(),i=r>4||0===r?px.ceil(i):px(i),i=fx.offset(i,7*(s.V-1)),s.y=i.getUTCFullYear(),s.m=i.getUTCMonth(),s.d=i.getUTCDate()+(s.w+6)%7):(r=(i=Cx(Tx(s.y,0,1))).getDay(),i=r>4||0===r?Zm.ceil(i):Zm(i),i=Vm.offset(i,7*(s.V-1)),s.y=i.getFullYear(),s.m=i.getMonth(),s.d=i.getDate()+(s.w+6)%7)}else("W"in s||"U"in s)&&("w"in s||(s.w="u"in s?s.u%7:"W"in s?1:0),r="Z"in s?Ax(Tx(s.y,0,1)).getUTCDay():Cx(Tx(s.y,0,1)).getDay(),s.m=0,s.d="W"in s?(s.w+6)%7+7*s.W-(r+5)%7:s.w+7*s.U-(r+6)%7);return"Z"in s?(s.H+=s.Z/100|0,s.M+=s.Z%100,Ax(s)):Cx(s)}}function E(t,e,n,i){for(var r,s,o=0,a=e.length,l=n.length;o<a;){if(i>=l)return-1;if(37===(r=e.charCodeAt(o++))){if(r=e.charAt(o++),!(s=b[r in Dx?e.charAt(o++):r])||(i=s(t,n,i))<0)return-1}else if(r!=n.charCodeAt(i++))return-1}return i}return x.x=M(n,x),x.X=M(i,x),x.c=M(e,x),v.x=M(n,v),v.X=M(i,v),v.c=M(e,v),{format:function(t){var e=M(t+="",x);return e.toString=function(){return t},e},parse:function(t){var e=w(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=M(t+="",v);return e.toString=function(){return t},e},utcParse:function(t){var e=w(t+="",!0);return e.toString=function(){return t},e}}}(t),Lx=Rx.format,Rx.parse,Px=Rx.utcFormat,Rx.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var lb=Object.freeze({__proto__:null,scaleBand:Ly,scalePoint:function(){return Py(Ly.apply(null,arguments).paddingInner(1))},scaleIdentity:function t(e){var n;function i(t){return null==t||isNaN(t=+t)?n:t}return i.invert=i,i.domain=i.range=function(t){return arguments.length?(e=Array.from(t,Dy),i):e.slice()},i.unknown=function(t){return arguments.length?(n=t,i):n},i.copy=function(){return t(e).unknown(n)},e=arguments.length?Array.from(e,Dy):[0,1],am(i)},scaleLinear:lm,scaleLog:function t(){const e=_m(Yy()).domain([1,10]);return e.copy=()=>By(e,t()).base(e.base()),Cy.apply(e,arguments),e},scaleSymlog:function t(){var e=xm(Yy());return e.copy=function(){return By(e,t()).constant(e.constant())},Cy.apply(e,arguments)},scaleOrdinal:Ry,scaleImplicit:Ty,scalePow:Em,scaleSqrt:Sm,scaleRadial:function t(){var e,n=$y(),i=[0,1],r=!1;function s(t){var i=Im(n(t));return isNaN(i)?e:r?Math.round(i):i}return s.invert=function(t){return n.invert(Nm(t))},s.domain=function(t){return arguments.length?(n.domain(t),s):n.domain()},s.range=function(t){return arguments.length?(n.range((i=Array.from(t,Dy)).map(Nm)),s):i.slice()},s.rangeRound=function(t){return s.range(t).round(!0)},s.round=function(t){return arguments.length?(r=!!t,s):r},s.clamp=function(t){return arguments.length?(n.clamp(t),s):n.clamp()},s.unknown=function(t){return arguments.length?(e=t,s):e},s.copy=function(){return t(n.domain(),i).round(r).clamp(n.clamp()).unknown(e)},Cy.apply(s,arguments),am(s)},scaleQuantile:function t(){var n,i=[],r=[],s=[];function o(){var t=0,e=Math.max(1,r.length);for(s=new Array(e-1);++t<e;)s[t-1]=ft(i,t/e);return a}function a(t){return null==t||isNaN(t=+t)?n:r[u(s,t)]}return a.invertExtent=function(t){var e=r.indexOf(t);return e<0?[NaN,NaN]:[e>0?s[e-1]:i[0],e<s.length?s[e]:i[i.length-1]]},a.domain=function(t){if(!arguments.length)return i.slice();i=[];for(let e of t)null==e||isNaN(e=+e)||i.push(e);return i.sort(e),o()},a.range=function(t){return arguments.length?(r=Array.from(t),o()):r.slice()},a.unknown=function(t){return arguments.length?(n=t,a):n},a.quantiles=function(){return s.slice()},a.copy=function(){return t().domain(i).range(r).unknown(n)},Cy.apply(a,arguments)},scaleQuantize:function t(){var e,n=0,i=1,r=1,s=[.5],o=[0,1];function a(t){return null!=t&&t<=t?o[u(s,t,0,r)]:e}function l(){var t=-1;for(s=new Array(r);++t<r;)s[t]=((t+1)*i-(t-r)*n)/(r+1);return a}return a.domain=function(t){return arguments.length?([n,i]=t,n=+n,i=+i,l()):[n,i]},a.range=function(t){return arguments.length?(r=(o=Array.from(t)).length-1,l()):o.slice()},a.invertExtent=function(t){var e=o.indexOf(t);return e<0?[NaN,NaN]:e<1?[n,s[0]]:e>=r?[s[r-1],i]:[s[e-1],s[e]]},a.unknown=function(t){return arguments.length?(e=t,a):a},a.thresholds=function(){return s.slice()},a.copy=function(){return t().domain([n,i]).range(o).unknown(e)},Cy.apply(am(a),arguments)},scaleThreshold:km,scaleTime:function(){return Cy.apply(eb(kx,Ox,ox,rx,Jm,Vm,Wm,$m,Bm,Lx).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},scaleUtc:function(){return Cy.apply(eb(Nx,Ix,Ex,Mx,gx,fx,hx,lx,Bm,Px).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)},scaleSequential:function t(){var e=am(nb()(Fy));return e.copy=function(){return ib(e,t())},Ay.apply(e,arguments)},scaleSequentialLog:function t(){var e=_m(nb()).domain([1,10]);return e.copy=function(){return ib(e,t()).base(e.base())},Ay.apply(e,arguments)},scaleSequentialPow:rb,scaleSequentialSqrt:function(){return rb.apply(null,arguments).exponent(.5)},scaleSequentialSymlog:function t(){var e=xm(nb());return e.copy=function(){return ib(e,t()).constant(e.constant())},Ay.apply(e,arguments)},scaleSequentialQuantile:sb,scaleDiverging:function t(){var e=am(ob()(Fy));return e.copy=function(){return ib(e,t())},Ay.apply(e,arguments)},scaleDivergingLog:function t(){var e=_m(ob()).domain([.1,1,10]);return e.copy=function(){return ib(e,t()).base(e.base())},Ay.apply(e,arguments)},scaleDivergingPow:ab,scaleDivergingSqrt:function(){return ab.apply(null,arguments).exponent(.5)},scaleDivergingSymlog:function t(){var e=xm(ob());return e.copy=function(){return ib(e,t()).constant(e.constant())},Ay.apply(e,arguments)},tickFormat:om});function cb(t,e){let n;return e>=0&&(n=+t.toFixed(e)),e<0&&(n=Math.round(t/+(1+"0".repeat(Math.abs(e))))*+(1+"0".repeat(Math.abs(e)))),null==e&&(n=t),n}const hb=Object.assign({},{scaleSqrt:Sm,max:rt,descending:n});function ub(t,e,n={},i=0,r=0){let s=n.values,o=n.k?n.k:50,a=n.stroke?n.stroke:"black",l=n.fill?n.fill:"none",c=n.strokeWidth?n.strokeWidth:.8,h=n.txtcol?n.txtcol:"#363636",u=n.x?n.x:null,f=n.y?n.y:null,d=n.title?n.title:"Title, year\n(units)",g=n.fontSize?n.fontSize:14,p=n.fontSize2?n.fontSize2:10,_=null!=n.round?n.round:void 0,y=null!=n.divisor?n.divisor:1,m=n.fixmax;const x=null!=m?m:hb.max(s);let v=hb.scaleSqrt([0,x],[0,o]),b=v(hb.max(s));if(null!=u&&null!=f){let n=t.append("g").attr("class","bertinlegend").attr("class","legcircle_"+e);0!=r&&n.attr("opacity",0).transition().delay(i).duration(r).attr("opacity",1),n.selectAll("circle").data(s.sort(hb.descending)).join("circle").attr("r",(t=>v(t))).attr("fill",l).attr("stroke",a).attr("stroke-width",c).attr("transform",(t=>`translate(${u+b},${f-v(t)+2*b+(d.split("\n").length+1)*g})`)),n.selectAll("line").data(s).join("line").attr("x1",u+b).attr("y1",(t=>f+2*b-2*v(t)+(d.split("\n").length+1)*g)).attr("x2",u+2*b+g).attr("y2",(t=>f+2*b-2*v(t)+(d.split("\n").length+1)*g)).attr("stroke",a).attr("stroke-width",c).attr("stroke-dasharray",2),n.append("g").selectAll("text").data(d.split("\n")).join("text").attr("x",u).attr("y",f).attr("font-size",`${g}px`).attr("dy",((t,e)=>e*g)).attr("text-anchor","start").attr("dominant-baseline","hanging").attr("fill",h).text((t=>t)),n.append("g").selectAll("text").data(s).join("text").attr("x",u+2*b+g+p/2).attr("y",(t=>f+2*b-2*v(t)+(d.split("\n").length+1)*g)).attr("font-size",p).attr("dominant-baseline","central").attr("fill",h).text((t=>cb(t/y,_)))}}const fb=Object.assign({},{reverse:Et});function db(t,e={},n=0,i=0){let r=e.x?e.x:null,s=e.y?e.y:null,o=e.w?e.w:30,a=e.h?e.h:20,l=e.title?e.title:null,c=e.fontSize?e.fontSize:14,h=e.fontSize2?e.fontSize2:10,u=e.stroke?e.stroke:"black",f=e.fillOpacity?e.fillOpacity:1,d=e.strokeWidth?e.strokeWidth:.5,g=e.txtcol?e.txtcol:"#363636",p=e.breaks,_=e.colors,y=e.missing;const m=null!=y?_.length:-1,x=null==y?fb.reverse(p):[fb.reverse(p),y[0]].flat(),v=null==y?fb.reverse(_):[fb.reverse(_),y[1]].flat();if(null!=r&&null!=s){let p=t.append("g").attr("class","bertinlegend").attr("class",e.id);0!=i&&p.attr("opacity",0).transition().delay(n).duration(i).attr("opacity",1);let _=0;null!=l&&(_=(l.split("\n").length+1)*c,p.append("g").selectAll("text").data(l.split("\n")).join("text").attr("x",r).attr("y",s).attr("font-size",`${c}px`).attr("dy",((t,e)=>e*c)).attr("text-anchor","start").attr("dominant-baseline","hanging").attr("fill",g).text((t=>t))),p.selectAll("rect").data(v).join("rect").attr("x",r).attr("y",((t,e)=>s+_+(a+0)*e+(e===m?a/2:0))).attr("height",a).attr("width",o).attr("stroke",u).attr("stroke-width",d).attr("fill-opacity",f).attr("fill",(t=>t)),p.append("g").selectAll("text").data(x).join("text").attr("x",r+o+h/2).attr("y",s+_).attr("font-size",`${h}px`).attr("fill",g).attr("dy",((t,e)=>(a+0)*e)).attr("text-anchor","start").attr("dominant-baseline","central").text((t=>t))}}const gb=Object.assign({},{scaleOrdinal:Ry});function pb(t,e={},n=0,i=0){let r=e.x?e.x:null,s=e.y?e.y:null,o=e.w?e.w:30,a=e.h?e.h:20,l=e.title?e.title:null,c=e.fontSize?e.fontSize:14,h=e.fontSize2?e.fontSize2:10,u=e.stroke?e.stroke:"black",f=e.fillOpacity?e.fillOpacity:1,d=e.strokeWidth?e.strokeWidth:.5,g=e.txtcol?e.txtcol:"#363636",p=e.types,_=e.colors,y=gb.scaleOrdinal().domain(p).range(_);if(console.log(i),console.log(n),null!=r&&null!=s){console.log("legtypo2");let _=t.append("g").attr("class","bertinlegend").attr("class",e.id);0!=i&&_.attr("opacity",0).transition().delay(n).duration(i).attr("opacity",1);let m=0;null!=l&&(m=(l.split("\n").length+1)*c,_.append("g").selectAll("text").data(l.split("\n")).join("text").attr("x",r).attr("y",s).attr("font-size",`${c}px`).attr("dy",((t,e)=>e*c)).attr("text-anchor","start").attr("dominant-baseline","hanging").attr("fill",g).text((t=>t))),_.selectAll("rect").data(p).join("rect").attr("x",r).attr("y",((t,e)=>s+m+(a+3)*e)).attr("height",a).attr("width",o).attr("fill",(t=>y(t))).attr("stroke",u).attr("stroke-width",d).attr("fill-opacity",f),_.append("g").selectAll("text").data(p).join("text").attr("x",r+o+h/2).attr("y",s+m+a/2).attr("font-size",`${h}px`).attr("fill",g).attr("dy",((t,e)=>(a+3)*e)).attr("text-anchor","start").attr("dominant-baseline","central").text((t=>t))}}const _b=Object.assign({},{reverse:Et});const yb=Object.assign({},{reverse:Et});function mb(t){for(var e=t.length/6|0,n=new Array(e),i=0;i<e;)n[i]="#"+t.slice(6*i,6*++i);return n}var xb=mb("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),vb=mb("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),bb=mb("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),Mb=mb("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),wb=mb("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),Eb=mb("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),Sb=mb("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),Nb=mb("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),Ib=mb("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),kb=mb("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),Ob=t=>dl(t[t.length-1]),Cb=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(mb),Ab=Ob(Cb),Tb=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(mb),Rb=Ob(Tb),Lb=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(mb),Pb=Ob(Lb),Db=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(mb),zb=Ob(Db),Fb=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(mb),Gb=Ob(Fb),jb=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(mb),qb=Ob(jb),Bb=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(mb),Yb=Ob(Bb),$b=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(mb),Ub=Ob($b),Wb=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(mb),Xb=Ob(Wb),Vb=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(mb),Hb=Ob(Vb),Jb=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(mb),Zb=Ob(Jb),Qb=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(mb),Kb=Ob(Qb),tM=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(mb),eM=Ob(tM),nM=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(mb),iM=Ob(nM),rM=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(mb),sM=Ob(rM),oM=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(mb),aM=Ob(oM),lM=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(mb),cM=Ob(lM),hM=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(mb),uM=Ob(hM),fM=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(mb),dM=Ob(fM),gM=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(mb),pM=Ob(gM),_M=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(mb),yM=Ob(_M),mM=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(mb),xM=Ob(mM),vM=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(mb),bM=Ob(vM),MM=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(mb),wM=Ob(MM),EM=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(mb),SM=Ob(EM),NM=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(mb),IM=Ob(NM),kM=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(mb),OM=Ob(kM);var CM=Tl(sl(300,.5,0),sl(-240,.5,1)),AM=Tl(sl(-100,.75,.35),sl(80,1.5,.8)),TM=Tl(sl(260,.75,.35),sl(80,1.5,.8)),RM=sl();var LM=Pa(),PM=Math.PI/3,DM=2*Math.PI/3;function zM(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}var FM=zM(mb("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),GM=zM(mb("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),jM=zM(mb("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),qM=zM(mb("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),BM=Object.freeze({__proto__:null,schemeCategory10:xb,schemeAccent:vb,schemeDark2:bb,schemePaired:Mb,schemePastel1:wb,schemePastel2:Eb,schemeSet1:Sb,schemeSet2:Nb,schemeSet3:Ib,schemeTableau10:kb,interpolateBrBG:Ab,schemeBrBG:Cb,interpolatePRGn:Rb,schemePRGn:Tb,interpolatePiYG:Pb,schemePiYG:Lb,interpolatePuOr:zb,schemePuOr:Db,interpolateRdBu:Gb,schemeRdBu:Fb,interpolateRdGy:qb,schemeRdGy:jb,interpolateRdYlBu:Yb,schemeRdYlBu:Bb,interpolateRdYlGn:Ub,schemeRdYlGn:$b,interpolateSpectral:Xb,schemeSpectral:Wb,interpolateBuGn:Hb,schemeBuGn:Vb,interpolateBuPu:Zb,schemeBuPu:Jb,interpolateGnBu:Kb,schemeGnBu:Qb,interpolateOrRd:eM,schemeOrRd:tM,interpolatePuBuGn:iM,schemePuBuGn:nM,interpolatePuBu:sM,schemePuBu:rM,interpolatePuRd:aM,schemePuRd:oM,interpolateRdPu:cM,schemeRdPu:lM,interpolateYlGnBu:uM,schemeYlGnBu:hM,interpolateYlGn:dM,schemeYlGn:fM,interpolateYlOrBr:pM,schemeYlOrBr:gM,interpolateYlOrRd:yM,schemeYlOrRd:_M,interpolateBlues:xM,schemeBlues:mM,interpolateGreens:bM,schemeGreens:vM,interpolateGreys:wM,schemeGreys:MM,interpolatePurples:SM,schemePurples:EM,interpolateReds:IM,schemeReds:NM,interpolateOranges:OM,schemeOranges:kM,interpolateCividis:function(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-t*(35.34-t*(2381.73-t*(6402.7-t*(7024.72-2710.57*t)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+t*(170.73+t*(52.82-t*(131.46-t*(176.58-67.37*t)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+t*(442.36-t*(2482.43-t*(6167.24-t*(6614.94-2475.67*t)))))))+")"},interpolateCubehelixDefault:CM,interpolateRainbow:function(t){(t<0||t>1)&&(t-=Math.floor(t));var e=Math.abs(t-.5);return RM.h=360*t-100,RM.s=1.5-1.5*e,RM.l=.8-.9*e,RM+""},interpolateWarm:AM,interpolateCool:TM,interpolateSinebow:function(t){var e;return t=(.5-t)*Math.PI,LM.r=255*(e=Math.sin(t))*e,LM.g=255*(e=Math.sin(t+PM))*e,LM.b=255*(e=Math.sin(t+DM))*e,LM+""},interpolateTurbo:function(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+t*(1172.33-t*(10793.56-t*(33300.12-t*(38394.49-14825.05*t)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+t*(557.33+t*(1225.33-t*(3574.96-t*(1073.77+707.56*t)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+t*(3211.1-t*(15327.97-t*(27814-t*(22569.18-6838.66*t)))))))+")"},interpolateViridis:FM,interpolateMagma:GM,interpolateInferno:jM,interpolatePlasma:qM});function YM(t){return null!==t&&""!==t&&isFinite(t)}const $M=Object.assign({},kt);const UM=Object.assign({},kt);const WM=Object.assign({},kt);const XM=Object.assign({},kt);function VM({values:t,method:e,nb:n,precision:i,k:r,middle:s}){let o;switch(e){case"q6":a=(a=t).filter((t=>YM(t))).map((t=>+t)),o=6>a.length?null:[$M.quantile(a,0),$M.quantile(a,.05),$M.quantile(a,.25),$M.quantile(a,.5),$M.quantile(a,.75),$M.quantile(a,.95),$M.quantile(a,1)];break;case"quantile":o=function(t,e){if(t=t.filter((t=>YM(t))).map((t=>+t)),e>t.length)return null;const n=[],i=1/e;for(let r=0;r<=e;r++)n.push(UM.quantile(t,i*r));return n}(t,n);break;case"equal":o=function(t,e){if(t=t.filter((t=>YM(t))).map((t=>+t)),e>t.length)return null;const n=[WM.min(t),WM.max(t)],i=(n[1]-n[0])/e;let r=n[0];for(let t=0;t<e-1;t++)n.push(r+i),r+=i;return n.sort(WM.ascending)}(t,n);break;case"jenks":o=function(t,e){if(t=t.filter((t=>YM(t))).map((t=>+t)).sort((function(t,e){return t-e})),e>t.length)return null;if(e>[...new Set(t)].length)return null;let n=function(t,e){const n=[],i=[],r=t.length;let s,o,a,l,c,h,u,f,d,g,p,_;for(s=0;s<r;s++){const t=[],r=[],a=0===s?1:0;for(o=0;o<e;o++)t.push(a),r.push(1/0);n.push(t),i.push(r)}for(c=0,l=0;l<r;l++){for(u=f=d=0,a=0;a<=l;a++)if(_=l-a,h=t[_],d++,u+=h,f+=h*h,c=f-u*u/d,p=_-1,p>-1)for(o=1;o<e;o++)g=c+i[p][o-1],i[l][o]>=g&&(n[l][o]=_+1,i[l][o]=g);n[l][0]=1,i[l][0]=c}return{lower_class_limits:n,variance_combinations:i}}(t,e);return function(t,e,n){const i=[];let r,s,o=t.length;for(i[n]=t[t.length-1],i[0]=t[0],r=1;r<n;r++)s=n-r+1,i[s-1]=t[e[o-1][s-1]-2],o=e[o-1][s-1]-1;return i}(t,n.lower_class_limits,e)}(t,n);break;case"msd":o=function(t,e=1,n=!1){t=t.filter((t=>YM(t))).map((t=>+t));const i=XM.min(t),r=XM.max(t),s=XM.mean(t),o=XM.deviation(t),a=[i,r];if(1==n){let t=s+e/2*o;for(;t<r;)a.push(t),t+=o*e;for(t=s-e/2*o;t>i;)a.push(t),t-=o*e}else{a.push(s);let t=s+o*e;for(;t<r;)a.push(t),t+=o*e;for(t=s-o*e;t>i;)a.push(t),t-=o*e}return a.sort(XM.ascending)}(t,r,s);break;case"geometric":o=function(t,e){if(t=t.filter((t=>YM(t))).map((t=>+t)),t.some((t=>t<=0)))return null;const n=new Array(e+1),i=ot(t),r=rt(t),s=Math.log(r)/Math.LN10,o=Math.log(i)/Math.LN10,a=(s-o)/e;n[0]=i;for(let t=1;t<e;t++)n[t]=Math.pow(10,o+t*a);return n[e]=r,n}(t,n)}var a;return Number.isInteger(+i)?o.map((t=>function(t,e){let n;return e>=0&&(n=+t.toFixed(e)),e<0&&(n=Math.round(t/+(1+"0".repeat(Math.abs(e))))*+(1+"0".repeat(Math.abs(e)))),n}(t,i))):o}const HM=Math.PI,JM=2*HM,ZM=1e-6,QM=JM-ZM;function KM(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function tw(){return new KM}function ew(t){return function(){return t}}KM.prototype=tw.prototype={constructor:KM,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,i){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(t,e,n,i,r,s){this._+="C"+ +t+","+ +e+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+s)},arcTo:function(t,e,n,i,r){t=+t,e=+e,n=+n,i=+i,r=+r;var s=this._x1,o=this._y1,a=n-t,l=i-e,c=s-t,h=o-e,u=c*c+h*h;if(r<0)throw new Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(u>ZM)if(Math.abs(h*a-l*c)>ZM&&r){var f=n-s,d=i-o,g=a*a+l*l,p=f*f+d*d,_=Math.sqrt(g),y=Math.sqrt(u),m=r*Math.tan((HM-Math.acos((g+u-p)/(2*_*y)))/2),x=m/y,v=m/_;Math.abs(x-1)>ZM&&(this._+="L"+(t+x*c)+","+(e+x*h)),this._+="A"+r+","+r+",0,0,"+ +(h*f>c*d)+","+(this._x1=t+v*a)+","+(this._y1=e+v*l)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,i,r,s){t=+t,e=+e,s=!!s;var o=(n=+n)*Math.cos(i),a=n*Math.sin(i),l=t+o,c=e+a,h=1^s,u=s?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+l+","+c:(Math.abs(this._x1-l)>ZM||Math.abs(this._y1-c)>ZM)&&(this._+="L"+l+","+c),n&&(u<0&&(u=u%JM+JM),u>QM?this._+="A"+n+","+n+",0,1,"+h+","+(t-o)+","+(e-a)+"A"+n+","+n+",0,1,"+h+","+(this._x1=l)+","+(this._y1=c):u>ZM&&(this._+="A"+n+","+n+",0,"+ +(u>=HM)+","+h+","+(this._x1=t+n*Math.cos(r))+","+(this._y1=e+n*Math.sin(r))))},rect:function(t,e,n,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};const nw=Math.abs,iw=Math.atan2,rw=Math.cos,sw=Math.max,ow=Math.min,aw=Math.sin,lw=Math.sqrt,cw=1e-12,hw=Math.PI,uw=hw/2,fw=2*hw;function dw(t){return t>1?0:t<-1?hw:Math.acos(t)}function gw(t){return t>=1?uw:t<=-1?-uw:Math.asin(t)}function pw(t){return t.innerRadius}function _w(t){return t.outerRadius}function yw(t){return t.startAngle}function mw(t){return t.endAngle}function xw(t){return t&&t.padAngle}function vw(t,e,n,i,r,s,o,a){var l=n-t,c=i-e,h=o-r,u=a-s,f=u*l-h*c;if(!(f*f<cw))return[t+(f=(h*(e-s)-u*(t-r))/f)*l,e+f*c]}function bw(t,e,n,i,r,s,o){var a=t-n,l=e-i,c=(o?s:-s)/lw(a*a+l*l),h=c*l,u=-c*a,f=t+h,d=e+u,g=n+h,p=i+u,_=(f+g)/2,y=(d+p)/2,m=g-f,x=p-d,v=m*m+x*x,b=r-s,M=f*p-g*d,w=(x<0?-1:1)*lw(sw(0,b*b*v-M*M)),E=(M*x-m*w)/v,S=(-M*m-x*w)/v,N=(M*x+m*w)/v,I=(-M*m+x*w)/v,k=E-_,O=S-y,C=N-_,A=I-y;return k*k+O*O>C*C+A*A&&(E=N,S=I),{cx:E,cy:S,x01:-h,y01:-u,x11:E*(r/b-1),y11:S*(r/b-1)}}var Mw=Array.prototype.slice;function ww(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function Ew(t){this._context=t}function Sw(t){return new Ew(t)}function Nw(t){return t[0]}function Iw(t){return t[1]}function kw(t,e){var n=ew(!0),i=null,r=Sw,s=null;function o(o){var a,l,c,h=(o=ww(o)).length,u=!1;for(null==i&&(s=r(c=tw())),a=0;a<=h;++a)!(a<h&&n(l=o[a],a,o))===u&&((u=!u)?s.lineStart():s.lineEnd()),u&&s.point(+t(l,a,o),+e(l,a,o));if(c)return s=null,c+""||null}return t="function"==typeof t?t:void 0===t?Nw:ew(t),e="function"==typeof e?e:void 0===e?Iw:ew(e),o.x=function(e){return arguments.length?(t="function"==typeof e?e:ew(+e),o):t},o.y=function(t){return arguments.length?(e="function"==typeof t?t:ew(+t),o):e},o.defined=function(t){return arguments.length?(n="function"==typeof t?t:ew(!!t),o):n},o.curve=function(t){return arguments.length?(r=t,null!=i&&(s=r(i)),o):r},o.context=function(t){return arguments.length?(null==t?i=s=null:s=r(i=t),o):i},o}function Ow(t,e,n){var i=null,r=ew(!0),s=null,o=Sw,a=null;function l(l){var c,h,u,f,d,g=(l=ww(l)).length,p=!1,_=new Array(g),y=new Array(g);for(null==s&&(a=o(d=tw())),c=0;c<=g;++c){if(!(c<g&&r(f=l[c],c,l))===p)if(p=!p)h=c,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),u=c-1;u>=h;--u)a.point(_[u],y[u]);a.lineEnd(),a.areaEnd()}p&&(_[c]=+t(f,c,l),y[c]=+e(f,c,l),a.point(i?+i(f,c,l):_[c],n?+n(f,c,l):y[c]))}if(d)return a=null,d+""||null}function c(){return kw().defined(r).curve(o).context(s)}return t="function"==typeof t?t:void 0===t?Nw:ew(+t),e="function"==typeof e?e:ew(void 0===e?0:+e),n="function"==typeof n?n:void 0===n?Iw:ew(+n),l.x=function(e){return arguments.length?(t="function"==typeof e?e:ew(+e),i=null,l):t},l.x0=function(e){return arguments.length?(t="function"==typeof e?e:ew(+e),l):t},l.x1=function(t){return arguments.length?(i=null==t?null:"function"==typeof t?t:ew(+t),l):i},l.y=function(t){return arguments.length?(e="function"==typeof t?t:ew(+t),n=null,l):e},l.y0=function(t){return arguments.length?(e="function"==typeof t?t:ew(+t),l):e},l.y1=function(t){return arguments.length?(n=null==t?null:"function"==typeof t?t:ew(+t),l):n},l.lineX0=l.lineY0=function(){return c().x(t).y(e)},l.lineY1=function(){return c().x(t).y(n)},l.lineX1=function(){return c().x(i).y(e)},l.defined=function(t){return arguments.length?(r="function"==typeof t?t:ew(!!t),l):r},l.curve=function(t){return arguments.length?(o=t,null!=s&&(a=o(s)),l):o},l.context=function(t){return arguments.length?(null==t?s=a=null:a=o(s=t),l):s},l}function Cw(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function Aw(t){return t}Ew.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var Tw=Lw(Sw);function Rw(t){this._curve=t}function Lw(t){function e(e){return new Rw(t(e))}return e._curve=t,e}function Pw(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?e(Lw(t)):e()._curve},t}function Dw(){return Pw(kw().curve(Tw))}function zw(){var t=Ow().curve(Tw),e=t.curve,n=t.lineX0,i=t.lineX1,r=t.lineY0,s=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return Pw(n())},delete t.lineX0,t.lineEndAngle=function(){return Pw(i())},delete t.lineX1,t.lineInnerRadius=function(){return Pw(r())},delete t.lineY0,t.lineOuterRadius=function(){return Pw(s())},delete t.lineY1,t.curve=function(t){return arguments.length?e(Lw(t)):e()._curve},t}function Fw(t,e){return[(e=+e)*Math.cos(t-=Math.PI/2),e*Math.sin(t)]}Rw.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};class Gw{constructor(t,e){this._context=t,this._x=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line}point(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,e,t,e):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+e)/2,t,this._y0,t,e)}this._x0=t,this._y0=e}}class jw{constructor(t){this._context=t}lineStart(){this._point=0}lineEnd(){}point(t,e){if(t=+t,e=+e,0==this._point++)this._x0=t,this._y0=e;else{const n=Fw(this._x0,this._y0),i=Fw(this._x0,this._y0=(this._y0+e)/2),r=Fw(t,this._y0),s=Fw(t,e);this._context.moveTo(...n),this._context.bezierCurveTo(...i,...r,...s)}}}function qw(t){return new Gw(t,!0)}function Bw(t){return new Gw(t,!1)}function Yw(t){return new jw(t)}function $w(t){return t.source}function Uw(t){return t.target}function Ww(t){let e=$w,n=Uw,i=Nw,r=Iw,s=null,o=null;function a(){let a;const l=Mw.call(arguments),c=e.apply(this,l),h=n.apply(this,l);if(null==s&&(o=t(a=tw())),o.lineStart(),l[0]=c,o.point(+i.apply(this,l),+r.apply(this,l)),l[0]=h,o.point(+i.apply(this,l),+r.apply(this,l)),o.lineEnd(),a)return o=null,a+""||null}return a.source=function(t){return arguments.length?(e=t,a):e},a.target=function(t){return arguments.length?(n=t,a):n},a.x=function(t){return arguments.length?(i="function"==typeof t?t:ew(+t),a):i},a.y=function(t){return arguments.length?(r="function"==typeof t?t:ew(+t),a):r},a.context=function(e){return arguments.length?(null==e?s=o=null:o=t(s=e),a):s},a}const Xw=lw(3);var Vw={draw(t,e){const n=.59436*lw(e+ow(e/28,.75)),i=n/2,r=i*Xw;t.moveTo(0,n),t.lineTo(0,-n),t.moveTo(-r,-i),t.lineTo(r,i),t.moveTo(-r,i),t.lineTo(r,-i)}},Hw={draw(t,e){const n=lw(e/hw);t.moveTo(n,0),t.arc(0,0,n,0,fw)}},Jw={draw(t,e){const n=lw(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}};const Zw=lw(1/3),Qw=2*Zw;var Kw={draw(t,e){const n=lw(e/Qw),i=n*Zw;t.moveTo(0,-n),t.lineTo(i,0),t.lineTo(0,n),t.lineTo(-i,0),t.closePath()}},tE={draw(t,e){const n=.62625*lw(e);t.moveTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.lineTo(-n,0),t.closePath()}},eE={draw(t,e){const n=.87559*lw(e-ow(e/7,2));t.moveTo(-n,0),t.lineTo(n,0),t.moveTo(0,n),t.lineTo(0,-n)}},nE={draw(t,e){const n=lw(e),i=-n/2;t.rect(i,i,n,n)}},iE={draw(t,e){const n=.4431*lw(e);t.moveTo(n,n),t.lineTo(n,-n),t.lineTo(-n,-n),t.lineTo(-n,n),t.closePath()}};const rE=aw(hw/10)/aw(7*hw/10),sE=aw(fw/10)*rE,oE=-rw(fw/10)*rE;var aE={draw(t,e){const n=lw(.8908130915292852*e),i=sE*n,r=oE*n;t.moveTo(0,-n),t.lineTo(i,r);for(let e=1;e<5;++e){const s=fw*e/5,o=rw(s),a=aw(s);t.lineTo(a*n,-o*n),t.lineTo(o*i-a*r,a*i+o*r)}t.closePath()}};const lE=lw(3);var cE={draw(t,e){const n=-lw(e/(3*lE));t.moveTo(0,2*n),t.lineTo(-lE*n,-n),t.lineTo(lE*n,-n),t.closePath()}};const hE=lw(3);var uE={draw(t,e){const n=.6824*lw(e),i=n/2,r=n*hE/2;t.moveTo(0,-n),t.lineTo(r,i),t.lineTo(-r,i),t.closePath()}};const fE=-.5,dE=lw(3)/2,gE=1/lw(12),pE=3*(gE/2+1);var _E={draw(t,e){const n=lw(e/pE),i=n/2,r=n*gE,s=i,o=n*gE+n,a=-s,l=o;t.moveTo(i,r),t.lineTo(s,o),t.lineTo(a,l),t.lineTo(fE*i-dE*r,dE*i+fE*r),t.lineTo(fE*s-dE*o,dE*s+fE*o),t.lineTo(fE*a-dE*l,dE*a+fE*l),t.lineTo(fE*i+dE*r,fE*r-dE*i),t.lineTo(fE*s+dE*o,fE*o-dE*s),t.lineTo(fE*a+dE*l,fE*l-dE*a),t.closePath()}},yE={draw(t,e){const n=.6189*lw(e-ow(e/6,1.7));t.moveTo(-n,-n),t.lineTo(n,n),t.moveTo(-n,n),t.lineTo(n,-n)}};const mE=[Hw,Jw,Kw,nE,aE,cE,_E],xE=[Hw,eE,yE,uE,Vw,iE,tE];function vE(t,e){let n=null;function i(){let i;if(n||(n=i=tw()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),i)return n=null,i+""||null}return t="function"==typeof t?t:ew(t||Hw),e="function"==typeof e?e:ew(void 0===e?64:+e),i.type=function(e){return arguments.length?(t="function"==typeof e?e:ew(e),i):t},i.size=function(t){return arguments.length?(e="function"==typeof t?t:ew(+t),i):e},i.context=function(t){return arguments.length?(n=null==t?null:t,i):n},i}function bE(){}function ME(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function wE(t){this._context=t}function EE(t){this._context=t}function SE(t){this._context=t}function NE(t,e){this._basis=new wE(t),this._beta=e}wE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:ME(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:ME(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},EE.prototype={areaStart:bE,areaEnd:bE,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:ME(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},SE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,i=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:ME(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},NE.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var i,r=t[0],s=e[0],o=t[n]-r,a=e[n]-s,l=-1;++l<=n;)i=l/n,this._basis.point(this._beta*t[l]+(1-this._beta)*(r+i*o),this._beta*e[l]+(1-this._beta)*(s+i*a));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var IE=function t(e){function n(t){return 1===e?new wE(t):new NE(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function kE(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function OE(t,e){this._context=t,this._k=(1-e)/6}OE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:kE(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:kE(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var CE=function t(e){function n(t){return new OE(t,e)}return n.tension=function(e){return t(+e)},n}(0);function AE(t,e){this._context=t,this._k=(1-e)/6}AE.prototype={areaStart:bE,areaEnd:bE,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:kE(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var TE=function t(e){function n(t){return new AE(t,e)}return n.tension=function(e){return t(+e)},n}(0);function RE(t,e){this._context=t,this._k=(1-e)/6}RE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:kE(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var LE=function t(e){function n(t){return new RE(t,e)}return n.tension=function(e){return t(+e)},n}(0);function PE(t,e,n){var i=t._x1,r=t._y1,s=t._x2,o=t._y2;if(t._l01_a>cw){var a=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,l=3*t._l01_a*(t._l01_a+t._l12_a);i=(i*a-t._x0*t._l12_2a+t._x2*t._l01_2a)/l,r=(r*a-t._y0*t._l12_2a+t._y2*t._l01_2a)/l}if(t._l23_a>cw){var c=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,h=3*t._l23_a*(t._l23_a+t._l12_a);s=(s*c+t._x1*t._l23_2a-e*t._l12_2a)/h,o=(o*c+t._y1*t._l23_2a-n*t._l12_2a)/h}t._context.bezierCurveTo(i,r,s,o,t._x2,t._y2)}function DE(t,e){this._context=t,this._alpha=e}DE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:PE(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var zE=function t(e){function n(t){return e?new DE(t,e):new OE(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function FE(t,e){this._context=t,this._alpha=e}FE.prototype={areaStart:bE,areaEnd:bE,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:PE(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var GE=function t(e){function n(t){return e?new FE(t,e):new AE(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function jE(t,e){this._context=t,this._alpha=e}jE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:PE(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var qE=function t(e){function n(t){return e?new jE(t,e):new RE(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function BE(t){this._context=t}function YE(t){return t<0?-1:1}function $E(t,e,n){var i=t._x1-t._x0,r=e-t._x1,s=(t._y1-t._y0)/(i||r<0&&-0),o=(n-t._y1)/(r||i<0&&-0),a=(s*r+o*i)/(i+r);return(YE(s)+YE(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(a))||0}function UE(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function WE(t,e,n){var i=t._x0,r=t._y0,s=t._x1,o=t._y1,a=(s-i)/3;t._context.bezierCurveTo(i+a,r+a*e,s-a,o-a*n,s,o)}function XE(t){this._context=t}function VE(t){this._context=new HE(t)}function HE(t){this._context=t}function JE(t){this._context=t}function ZE(t){var e,n,i=t.length-1,r=new Array(i),s=new Array(i),o=new Array(i);for(r[0]=0,s[0]=2,o[0]=t[0]+2*t[1],e=1;e<i-1;++e)r[e]=1,s[e]=4,o[e]=4*t[e]+2*t[e+1];for(r[i-1]=2,s[i-1]=7,o[i-1]=8*t[i-1]+t[i],e=1;e<i;++e)n=r[e]/s[e-1],s[e]-=n,o[e]-=n*o[e-1];for(r[i-1]=o[i-1]/s[i-1],e=i-2;e>=0;--e)r[e]=(o[e]-r[e+1])/s[e];for(s[i-1]=(t[i]+r[i-1])/2,e=0;e<i-1;++e)s[e]=2*t[e+1]-r[e+1];return[r,s]}function QE(t,e){this._context=t,this._t=e}function KE(t,e){if((r=t.length)>1)for(var n,i,r,s=1,o=t[e[0]],a=o.length;s<r;++s)for(i=o,o=t[e[s]],n=0;n<a;++n)o[n][1]+=o[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function tS(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function eS(t,e){return t[e]}function nS(t){const e=[];return e.key=t,e}function iS(t){var e=t.map(rS);return tS(t).sort((function(t,n){return e[t]-e[n]}))}function rS(t){for(var e,n=-1,i=0,r=t.length,s=-1/0;++n<r;)(e=+t[n][1])>s&&(s=e,i=n);return i}function sS(t){var e=t.map(oS);return tS(t).sort((function(t,n){return e[t]-e[n]}))}function oS(t){for(var e,n=0,i=-1,r=t.length;++i<r;)(e=+t[i][1])&&(n+=e);return n}BE.prototype={areaStart:bE,areaEnd:bE,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}},XE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:WE(this,this._t0,UE(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,WE(this,UE(this,n=$E(this,t,e)),n);break;default:WE(this,this._t0,n=$E(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(VE.prototype=Object.create(XE.prototype)).point=function(t,e){XE.prototype.point.call(this,e,t)},HE.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,i,r,s){this._context.bezierCurveTo(e,t,i,n,s,r)}},JE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var i=ZE(t),r=ZE(e),s=0,o=1;o<n;++s,++o)this._context.bezierCurveTo(i[0][s],r[0][s],i[1][s],r[1][s],t[o],e[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},QE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};var aS=Object.freeze({__proto__:null,arc:function(){var t=pw,e=_w,n=ew(0),i=null,r=yw,s=mw,o=xw,a=null;function l(){var l,c,h=+t.apply(this,arguments),u=+e.apply(this,arguments),f=r.apply(this,arguments)-uw,d=s.apply(this,arguments)-uw,g=nw(d-f),p=d>f;if(a||(a=l=tw()),u<h&&(c=u,u=h,h=c),u>cw)if(g>fw-cw)a.moveTo(u*rw(f),u*aw(f)),a.arc(0,0,u,f,d,!p),h>cw&&(a.moveTo(h*rw(d),h*aw(d)),a.arc(0,0,h,d,f,p));else{var _,y,m=f,x=d,v=f,b=d,M=g,w=g,E=o.apply(this,arguments)/2,S=E>cw&&(i?+i.apply(this,arguments):lw(h*h+u*u)),N=ow(nw(u-h)/2,+n.apply(this,arguments)),I=N,k=N;if(S>cw){var O=gw(S/h*aw(E)),C=gw(S/u*aw(E));(M-=2*O)>cw?(v+=O*=p?1:-1,b-=O):(M=0,v=b=(f+d)/2),(w-=2*C)>cw?(m+=C*=p?1:-1,x-=C):(w=0,m=x=(f+d)/2)}var A=u*rw(m),T=u*aw(m),R=h*rw(b),L=h*aw(b);if(N>cw){var P,D=u*rw(x),z=u*aw(x),F=h*rw(v),G=h*aw(v);if(g<hw&&(P=vw(A,T,F,G,D,z,R,L))){var j=A-P[0],q=T-P[1],B=D-P[0],Y=z-P[1],$=1/aw(dw((j*B+q*Y)/(lw(j*j+q*q)*lw(B*B+Y*Y)))/2),U=lw(P[0]*P[0]+P[1]*P[1]);I=ow(N,(h-U)/($-1)),k=ow(N,(u-U)/($+1))}}w>cw?k>cw?(_=bw(F,G,A,T,u,k,p),y=bw(D,z,R,L,u,k,p),a.moveTo(_.cx+_.x01,_.cy+_.y01),k<N?a.arc(_.cx,_.cy,k,iw(_.y01,_.x01),iw(y.y01,y.x01),!p):(a.arc(_.cx,_.cy,k,iw(_.y01,_.x01),iw(_.y11,_.x11),!p),a.arc(0,0,u,iw(_.cy+_.y11,_.cx+_.x11),iw(y.cy+y.y11,y.cx+y.x11),!p),a.arc(y.cx,y.cy,k,iw(y.y11,y.x11),iw(y.y01,y.x01),!p))):(a.moveTo(A,T),a.arc(0,0,u,m,x,!p)):a.moveTo(A,T),h>cw&&M>cw?I>cw?(_=bw(R,L,D,z,h,-I,p),y=bw(A,T,F,G,h,-I,p),a.lineTo(_.cx+_.x01,_.cy+_.y01),I<N?a.arc(_.cx,_.cy,I,iw(_.y01,_.x01),iw(y.y01,y.x01),!p):(a.arc(_.cx,_.cy,I,iw(_.y01,_.x01),iw(_.y11,_.x11),!p),a.arc(0,0,h,iw(_.cy+_.y11,_.cx+_.x11),iw(y.cy+y.y11,y.cx+y.x11),p),a.arc(y.cx,y.cy,I,iw(y.y11,y.x11),iw(y.y01,y.x01),!p))):a.arc(0,0,h,b,v,p):a.lineTo(R,L)}else a.moveTo(0,0);if(a.closePath(),l)return a=null,l+""||null}return l.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,i=(+r.apply(this,arguments)+ +s.apply(this,arguments))/2-hw/2;return[rw(i)*n,aw(i)*n]},l.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:ew(+e),l):t},l.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:ew(+t),l):e},l.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:ew(+t),l):n},l.padRadius=function(t){return arguments.length?(i=null==t?null:"function"==typeof t?t:ew(+t),l):i},l.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:ew(+t),l):r},l.endAngle=function(t){return arguments.length?(s="function"==typeof t?t:ew(+t),l):s},l.padAngle=function(t){return arguments.length?(o="function"==typeof t?t:ew(+t),l):o},l.context=function(t){return arguments.length?(a=null==t?null:t,l):a},l},area:Ow,line:kw,pie:function(){var t=Aw,e=Cw,n=null,i=ew(0),r=ew(fw),s=ew(0);function o(o){var a,l,c,h,u,f=(o=ww(o)).length,d=0,g=new Array(f),p=new Array(f),_=+i.apply(this,arguments),y=Math.min(fw,Math.max(-fw,r.apply(this,arguments)-_)),m=Math.min(Math.abs(y)/f,s.apply(this,arguments)),x=m*(y<0?-1:1);for(a=0;a<f;++a)(u=p[g[a]=a]=+t(o[a],a,o))>0&&(d+=u);for(null!=e?g.sort((function(t,n){return e(p[t],p[n])})):null!=n&&g.sort((function(t,e){return n(o[t],o[e])})),a=0,c=d?(y-f*x)/d:0;a<f;++a,_=h)l=g[a],h=_+((u=p[l])>0?u*c:0)+x,p[l]={data:o[l],index:a,value:u,startAngle:_,endAngle:h,padAngle:m};return p}return o.value=function(e){return arguments.length?(t="function"==typeof e?e:ew(+e),o):t},o.sortValues=function(t){return arguments.length?(e=t,n=null,o):e},o.sort=function(t){return arguments.length?(n=t,e=null,o):n},o.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:ew(+t),o):i},o.endAngle=function(t){return arguments.length?(r="function"==typeof t?t:ew(+t),o):r},o.padAngle=function(t){return arguments.length?(s="function"==typeof t?t:ew(+t),o):s},o},areaRadial:zw,radialArea:zw,lineRadial:Dw,radialLine:Dw,pointRadial:Fw,link:Ww,linkHorizontal:function(){return Ww(qw)},linkVertical:function(){return Ww(Bw)},linkRadial:function(){const t=Ww(Yw);return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t},symbol:vE,symbolsStroke:xE,symbolsFill:mE,symbols:mE,symbolAsterisk:Vw,symbolCircle:Hw,symbolCross:Jw,symbolDiamond:Kw,symbolDiamond2:tE,symbolPlus:eE,symbolSquare:nE,symbolSquare2:iE,symbolStar:aE,symbolTriangle:cE,symbolTriangle2:uE,symbolWye:_E,symbolX:yE,curveBasisClosed:function(t){return new EE(t)},curveBasisOpen:function(t){return new SE(t)},curveBasis:function(t){return new wE(t)},curveBumpX:qw,curveBumpY:Bw,curveBundle:IE,curveCardinalClosed:TE,curveCardinalOpen:LE,curveCardinal:CE,curveCatmullRomClosed:GE,curveCatmullRomOpen:qE,curveCatmullRom:zE,curveLinearClosed:function(t){return new BE(t)},curveLinear:Sw,curveMonotoneX:function(t){return new XE(t)},curveMonotoneY:function(t){return new VE(t)},curveNatural:function(t){return new JE(t)},curveStep:function(t){return new QE(t,.5)},curveStepAfter:function(t){return new QE(t,1)},curveStepBefore:function(t){return new QE(t,0)},stack:function(){var t=ew([]),e=tS,n=KE,i=eS;function r(r){var s,o,a=Array.from(t.apply(this,arguments),nS),l=a.length,c=-1;for(const t of r)for(s=0,++c;s<l;++s)(a[s][c]=[0,+i(t,a[s].key,c,r)]).data=t;for(s=0,o=ww(e(a));s<l;++s)a[o[s]].index=s;return n(a,o),a}return r.keys=function(e){return arguments.length?(t="function"==typeof e?e:ew(Array.from(e)),r):t},r.value=function(t){return arguments.length?(i="function"==typeof t?t:ew(+t),r):i},r.order=function(t){return arguments.length?(e=null==t?tS:"function"==typeof t?t:ew(Array.from(t)),r):e},r.offset=function(t){return arguments.length?(n=null==t?KE:t,r):n},r},stackOffsetExpand:function(t,e){if((i=t.length)>0){for(var n,i,r,s=0,o=t[0].length;s<o;++s){for(r=n=0;n<i;++n)r+=t[n][s][1]||0;if(r)for(n=0;n<i;++n)t[n][s][1]/=r}KE(t,e)}},stackOffsetDiverging:function(t,e){if((a=t.length)>0)for(var n,i,r,s,o,a,l=0,c=t[e[0]].length;l<c;++l)for(s=o=0,n=0;n<a;++n)(r=(i=t[e[n]][l])[1]-i[0])>0?(i[0]=s,i[1]=s+=r):r<0?(i[1]=o,i[0]=o+=r):(i[0]=0,i[1]=r)},stackOffsetNone:KE,stackOffsetSilhouette:function(t,e){if((n=t.length)>0){for(var n,i=0,r=t[e[0]],s=r.length;i<s;++i){for(var o=0,a=0;o<n;++o)a+=t[o][i][1]||0;r[i][1]+=r[i][0]=-a/2}KE(t,e)}},stackOffsetWiggle:function(t,e){if((r=t.length)>0&&(i=(n=t[e[0]]).length)>0){for(var n,i,r,s=0,o=1;o<i;++o){for(var a=0,l=0,c=0;a<r;++a){for(var h=t[e[a]],u=h[o][1]||0,f=(u-(h[o-1][1]||0))/2,d=0;d<a;++d){var g=t[e[d]];f+=(g[o][1]||0)-(g[o-1][1]||0)}l+=u,c+=f*u}n[o-1][1]+=n[o-1][0]=s,l&&(s-=c/l)}n[o-1][1]+=n[o-1][0]=s,KE(t,e)}},stackOrderAppearance:iS,stackOrderAscending:sS,stackOrderDescending:function(t){return sS(t).reverse()},stackOrderInsideOut:function(t){var e,n,i=t.length,r=t.map(oS),s=iS(t),o=0,a=0,l=[],c=[];for(e=0;e<i;++e)n=s[e],o<a?(o+=r[n],l.push(n)):(a+=r[n],c.push(n));return c.reverse().concat(l)},stackOrderNone:tS,stackOrderReverse:function(t){return tS(t).reverse()}});Object.assign({},kt,Do,lb,aS),Object.assign({},kt,Do,lb,aS);const lS=Object.assign({},BM,{sort:Y,scaleThreshold:km,scaleOrdinal:Ry});function cS(t,e){if("string"==typeof e)return{getcol:t=>e};if(t=null==t[0].properties?t:t.map((t=>t.properties)),"object"==typeof e&&"choro"==e.type){let n=e.values,i=e.colors?e.colors:"Blues",r=null!=e.nbreaks?e.nbreaks:5,s=e.breaks?e.breaks:null,o=null!=e.k?e.k:1,a=1==e.middle,l=e.method?e.method:"quantile",c=e.col_missing?e.col_missing:"#f5f5f5",h=e.txt_missing?e.txt_missing:"No data",u=void 0!==e.leg_round?e.leg_round:void 0;"q6"==l&&(r=6);const f=t.map((t=>t[n])),d=f.filter((t=>void 0!==t)).filter((t=>null!==t)).filter((t=>!isNaN(+t))).filter((t=>""!==t)),g=f.length===d.length?null:[h,c];s=null==s?VM({values:d,method:l,nb:r,k:o,middle:a,precision:u}):lS.sort(s),Array.isArray(i)||(i=lS[`scheme${i}`][s.length-1]);let p=[...s];function _(t){return""===t||isNaN(+t)?c:lS.scaleThreshold(p,i).unknown(c)(t)}return p.pop(),p.shift(),{getcol:_,breaks:s,colors:i,missing:g}}if("object"==typeof e&&"typo"==e.type){let y=e.values,m=e.colors?e.colors:"Tableau10",x=e.col_missing?e.col_missing:"#f5f5f5",v=e.txt_missing?e.txt_missing:"No data";const b=null!=e.order?e.order:Array.from(new Set(t.map((t=>t[y]))));let M=null!=e.types?e.types:b.filter((t=>""!==t&&null!=t&&null!=t));return Array.isArray(m)?m.slice(0,M.length):m=lS[`scheme${m}`].slice(0,M.length),{getcol:lS.scaleOrdinal().domain(M).range(m).unknown(x),types:M.length==b.length?M:[M,v].flat(),colors:M.length==b.length?m:[m,x].flat()}}if("object"==typeof e&&"split"==e.type){let w=e.values,E=null!=e.split?e.split:0,S=e.colors?e.colors:["#F25842","#4a7cd9"],N=e.col_missing?e.col_missing:"#f5f5f5",I=e.txt_missing?e.txt_missing:"No data";const k=t.map((t=>t[w])),O=k.filter((t=>""!==t&&null!=t&&null!=t));return{getcol:t=>t>=E?S[0]:t<E?S[1]:null==t||""===t?N:void 0,types:k.length==O.length?[`>= ${E}`,`< ${E}`]:[[`>= ${E}`,`< ${E}`],I].flat(),colors:k.length==O.length?S:[S,N].flat()}}}const hS=Object.assign({},{min:ot,max:rt,scaleLinear:lm,scaleOrdinal:Ry,scaleThreshold:km,quantize:function(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t(i/(e-1));return n},interpolate:Ml});function uS(t,e){const n=e.type?e.type:"linear";if("number"==typeof e||"string"==typeof e)return{getthickness:()=>+e};if(0==t.length)return{getthickness:()=>0,valmax:0,sizemax:0};if("number"!=typeof e&&"string"!=typeof e&&"linear"==n){let i=null!=e.k?e.k:10,r=e.values,s=null!=e.fixmax?e.fixmax:void 0,o=null!=e.fixmin?e.fixmin:0;if("geometry"in t[0]&&"properties"in t[0]&&(t=t.map((t=>t.properties))),"string"==typeof e||"number"==typeof e)return{getcol:t=>e};1==o&&(o=hS.min(t.map((t=>Math.abs(+t[r])))));const a=null==s?hS.max(t.map((t=>Math.abs(+t[r])))):s,l=hS.max(t.map((t=>Math.abs(+t[r]))));return{type:n,getthickness:hS.scaleLinear().domain([o,a]).range([0,i]),valmax:l,valmin:o,sizemax:hS.scaleLinear().domain([o,a]).range([0,i])(l)}}if("number"!=typeof e&&"string"!=typeof e&&"quali"==n){const t=e.categories,i=null!=e.k?e.k:10,r=e.sizes?e.sizes:hS.quantize(hS.interpolate(1,i),t.length);return{type:n,categories:t,sizes:r,getthickness:hS.scaleOrdinal().domain(t).range(r).unknown(0)}}if("number"!=typeof e&&"string"!=typeof e&&"discr"==n){const i=e.values;let r=e.sizes,s=null!=e.nbreaks?e.nbreaks:5,o=e.breaks?e.breaks:null,a=null!=e.k?e.k:10,l=null!=e.nbsd?e.nbsd:1,c=1==e.middle,h=e.method?e.method:"quantile";"q6"==h&&(s=6);const u=t.map((t=>+t.properties[i])).filter((t=>null!=t&&null!=t&&""!=t));o=null==o?VM({values:u,method:h,nb:s,k:l,middle:c}):hS.sort(o),null==r&&(r=hS.quantize(hS.interpolate(1,a),o.length-1));let f=[...o];return f.pop(),f.shift(),{type:n,breaks:o,sizes:r,getthickness:hS.scaleThreshold(f,r).unknown(0)}}}function fS(t,e,n,i,r,s,o,a){"object"==typeof n&&"choro"==n.type&&db(e,{x:n.leg_x,y:n.leg_y,w:n.leg_w,h:n.leg_h,stroke:n.leg_stroke,fillOpacity:n.leg_fillOpacity,strokeWidth:n.leg_strokeWidth,txtcol:n.leg_txtcol,title:n.leg_title?n.leg_title:n.values,fontSize:n.leg_fontSize,fontSize2:n.leg_fontSize2,breaks:cS(t.features,n).breaks,colors:cS(t.features,n).colors,missing:cS(t.features,n).missing,id:"legboxfill_"+s},o,a),"object"==typeof i&&"choro"==i.type&&db(e,{x:i.leg_x,y:i.leg_y,w:i.leg_w,h:i.leg_h,stroke:i.leg_stroke,fillOpacity:i.leg_fillOpacity,strokeWidth:i.leg_strokeWidth,txtcol:i.leg_txtcol,title:i.leg_title?i.leg_title:i.values,fontSize:i.leg_fontSize,fontSize2:i.leg_fontSize2,breaks:cS(t.features,i).breaks,colors:cS(t.features,i).colors,missing:cS(t.features,i).missing,id:"legboxstroke_"+s},o,a),"object"!=typeof n||"typo"!=n.type&&"split"!=n.type||pb(e,{x:n.leg_x,y:n.leg_y,w:n.leg_w,h:n.leg_h,stroke:n.leg_stroke,fillOpacity:n.leg_fillOpacity,strokeWidth:n.leg_strokeWidth,txtcol:n.leg_txtcol,title:n.leg_title?n.leg_title:n.values,fontSize:n.leg_fontSize,fontSize2:n.leg_fontSize2,types:cS(t.features,n).types,colors:cS(t.features,n).colors,id:"legboxfill_"+s},o,a),"object"!=typeof i||"typo"!=i.type&&"split"!=i.type||pb(e,{x:i.leg_x,y:i.leg_y,w:i.leg_w,h:i.leg_h,stroke:i.leg_stroke,fillOpacity:i.leg_fillOpacity,strokeWidth:i.leg_strokeWidth,txtcol:i.leg_txtcol,title:i.leg_title?i.leg_title:i.values,fontSize:i.leg_fontSize,fontSize2:i.leg_fontSize2,types:cS(t.features,i).types,colors:cS(t.features,i).colors,id:"legboxstroke_"+s},o,a),"object"!=typeof r||null==r.values||"linear"!=r.type&&null!=r.type||function(t,e={},n=0,i=0){let r=null!=e.x?e.x:null,s=null!=e.y?e.y:null,o=e.valmax,a=e.valmin,l=e.sizemax,c=e.title?e.title:null,h=null!=e.fontSize?e.fontSize:14,u=null!=e.fontSize2?e.fontSize2:10,f=e.fill?e.fill:"none",d=e.stroke?e.stroke:"black",g=null!=e.strokeWidth?e.strokeWidth:.4,p=null!=e.fillOpacity?e.fillOpacity:1,_=e.txtcol?e.txtcol:"#363636",y=null!=e.w?e.w:75,m=null!=e.round?e.round:void 0;if(null!=r&&null!=s){let x=t.append("g").attr("class","bertinlegend").attr("class",e.id);0!=i&&x.attr("opacity",0).transition().delay(n).duration(i).attr("opacity",1);let v=0;null!=c&&(v=(c.split("\n").length+1)*h,x.append("g").selectAll("text").data(c.split("\n")).join("text").attr("x",r).attr("y",s).attr("font-size",`${h}px`).attr("dy",((t,e)=>e*h)).attr("text-anchor","start").attr("dominant-baseline","hanging").attr("fill",_).text((t=>t))),x.append("path").attr("d",`M ${r},${s+v+l/2} ${r+y},${s+v} ${r+y},${s+v+l} Z `).attr("stroke",d).attr("fill",f).attr("stroke-width",g).attr("fill-opacity",p),x.append("text").attr("font-size",`${u}px`).attr("fill",_).attr("text-anchor","start").attr("dominant-baseline","hanging").attr("x",r).attr("y",s+v+l/2+u/2).text(cb(a,m)),x.append("text").attr("font-size",`${u}px`).attr("fill",_).attr("text-anchor","end").attr("dominant-baseline","hanging").attr("x",r+y).attr("y",s+v+l+u/2).text(cb(o,m))}}(e,{x:r.leg_x,y:r.leg_y,valmax:uS(t.features,r).valmax,valmin:uS(t.features,r).valmin,sizemax:uS(t.features,r).sizemax,title:r.leg_title?r.leg_title:r.values,fontSize:r.leg_fontSize,fontSize2:r.leg_fontSize2,fill:r.stroke,fillOpacity:r.fillOpacity,txtcol:r.leg_txtcol,w:r.leg_w,round:r.leg_round,id:"legthickness_"+s},o,a),"object"==typeof r&&null!=r.values&&"discr"==r.type&&function(t,e={},n=0,i=0){let r=e.x?e.x:null,s=e.y?e.y:null,o=e.w?e.w:30,a=e.title?e.title:null,l=null!=e.fontSize?e.fontSize:14,c=null!=e.fontSize2?e.fontSize2:10,h=e.stroke?e.stroke:"black",u=null!=e.strokeOpacity?e.strokeOpacity:1,f=e.txtcol?e.txtcol:"#363636",d=e.breaks,g=e.sizes,p=void 0!==e.round?e.round:void 0;if(g=_b.reverse(g),d=_b.reverse(d),null!=r&&null!=s){let _=t.append("g").attr("class","bertinlegend").attr("class",e.id);0!=i&&_.attr("opacity",0).transition().delay(n).duration(i).attr("opacity",1);let y=0;null!=a&&(y=(a.split("\n").length+1)*l,_.append("g").selectAll("text").data(a.split("\n")).join("text").attr("x",r).attr("y",s).attr("font-size",`${l}px`).attr("dy",((t,e)=>e*l)).attr("text-anchor","start").attr("dominant-baseline","hanging").attr("fill",f).text((t=>t)));const m=10;let x=[],v=0;for(let t=0;t<g.length;t++)x.push(s+y+v+g[t]/2+t*m),v+=g[t];let b=[];v=0;for(let t=0;t<d.length;t++)b.push(s+y+v-m/2),v+=g[t]+m;_.selectAll("line").data(g).join("line").attr("x1",r).attr("y1",((t,e)=>x[e])).attr("x2",r+o).attr("y2",((t,e)=>x[e])).attr("stroke",h).attr("stroke-opacity",u).attr("stroke-width",(t=>t)),_.append("g").selectAll("text").data(d).join("text").attr("x",r+o+c/2).attr("y",((t,e)=>b[e])).attr("font-size",`${c}px`).attr("fill",f).attr("text-anchor","start").attr("dominant-baseline","central").text((t=>cb(t,p)))}}(e,{x:r.leg_x,y:r.leg_y,breaks:uS(t.features,r).breaks,sizes:uS(t.features,r).sizes,w:r.leg_w,title:r.leg_title?r.leg_title:r.values,fontSize:r.leg_fontSize,fontSize2:r.leg_fontSize2,stroke:r.stroke,strokeOpacity:r.strokeOpacity,txtcol:r.leg_txtcol,round:r.leg_round,id:"legthickness_"+s},o,a),"object"==typeof r&&null!=r.values&&"quali"==r.type&&function(t,e={},n=0,i=0){let r=e.x?e.x:null,s=e.y?e.y:null,o=e.w?e.w:30,a=e.title?e.title:null,l=e.fontSize?e.fontSize:14,c=e.fontSize2?e.fontSize2:10,h=e.stroke?e.stroke:"black",u=e.strokeOpacity?e.strokeOpacity:1,f=e.txtcol?e.txtcol:"#363636",d=e.categories,g=e.sizes;if(g=yb.reverse(g),d=yb.reverse(d),null!=r&&null!=s){let p=t.append("g").attr("class","bertinlegend").attr("class",e.id);0!=i&&p.attr("opacity",0).transition().delay(n).duration(i).attr("opacity",1);let _=0;null!=a&&(_=(a.split("\n").length+1)*l,p.append("g").selectAll("text").data(a.split("\n")).join("text").attr("x",r).attr("y",s).attr("font-size",`${l}px`).attr("dy",((t,e)=>e*l)).attr("text-anchor","start").attr("dominant-baseline","hanging").attr("fill",f).text((t=>t)));const y=10;let m=[],x=0;for(let t=0;t<g.length;t++)m.push(s+_+x+g[t]/2+t*y),x+=g[t];p.selectAll("line").data(g).join("line").attr("x1",r).attr("y1",((t,e)=>m[e])).attr("x2",r+o).attr("y2",((t,e)=>m[e])).attr("stroke",h).attr("stroke-opacity",u).attr("stroke-width",(t=>t)),p.append("g").selectAll("text").data(d).join("text").attr("x",r+o+c/2).attr("y",((t,e)=>m[e])).attr("font-size",`${c}px`).attr("fill",f).attr("text-anchor","start").attr("dominant-baseline","central").text((t=>t))}}(e,{x:r.leg_x,y:r.leg_y,categories:uS(t.features,r).categories,sizes:uS(t.features,r).sizes,w:r.leg_w,title:r.leg_title?r.leg_title:"Catégories",fontSize:r.leg_fontSize,fontSize2:r.leg_fontSize2,stroke:r.stroke,strokeOpacity:r.strokeOpacity,txtcol:r.leg_txtcol,id:"legthickness_"+s},o,a)}function dS(t,e,n,i){if(isNaN(e)||isNaN(n))return t;var r,s,o,a,l,c,h,u,f,d=t._root,g={data:i},p=t._x0,_=t._y0,y=t._x1,m=t._y1;if(!d)return t._root=g,t;for(;d.length;)if((c=e>=(s=(p+y)/2))?p=s:y=s,(h=n>=(o=(_+m)/2))?_=o:m=o,r=d,!(d=d[u=h<<1|c]))return r[u]=g,t;if(a=+t._x.call(null,d.data),l=+t._y.call(null,d.data),e===a&&n===l)return g.next=d,r?r[u]=g:t._root=g,t;do{r=r?r[u]=new Array(4):t._root=new Array(4),(c=e>=(s=(p+y)/2))?p=s:y=s,(h=n>=(o=(_+m)/2))?_=o:m=o}while((u=h<<1|c)==(f=(l>=o)<<1|a>=s));return r[f]=d,r[u]=g,t}function gS(t,e,n,i,r){this.node=t,this.x0=e,this.y0=n,this.x1=i,this.y1=r}function pS(t){return t[0]}function _S(t){return t[1]}function yS(t,e,n){var i=new mS(null==e?pS:e,null==n?_S:n,NaN,NaN,NaN,NaN);return null==t?i:i.addAll(t)}function mS(t,e,n,i,r,s){this._x=t,this._y=e,this._x0=n,this._y0=i,this._x1=r,this._y1=s,this._root=void 0}function xS(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var vS=yS.prototype=mS.prototype;function bS(t){return function(){return t}}function MS(t){return 1e-6*(t()-.5)}function wS(t){return t.x+t.vx}function ES(t){return t.y+t.vy}function SS(t){var e,n,i,r=1,s=1;function o(){for(var t,o,l,c,h,u,f,d=e.length,g=0;g<s;++g)for(o=yS(e,wS,ES).visitAfter(a),t=0;t<d;++t)l=e[t],u=n[l.index],f=u*u,c=l.x+l.vx,h=l.y+l.vy,o.visit(p);function p(t,e,n,s,o){var a=t.data,d=t.r,g=u+d;if(!a)return e>c+g||s<c-g||n>h+g||o<h-g;if(a.index>l.index){var p=c-a.x-a.vx,_=h-a.y-a.vy,y=p*p+_*_;y<g*g&&(0===p&&(y+=(p=MS(i))*p),0===_&&(y+=(_=MS(i))*_),y=(g-(y=Math.sqrt(y)))/y*r,l.vx+=(p*=y)*(g=(d*=d)/(f+d)),l.vy+=(_*=y)*g,a.vx-=p*(g=1-g),a.vy-=_*g)}}}function a(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function l(){if(e){var i,r,s=e.length;for(n=new Array(s),i=0;i<s;++i)r=e[i],n[r.index]=+t(r,i,e)}}return"function"!=typeof t&&(t=bS(null==t?1:+t)),o.initialize=function(t,n){e=t,i=n,l()},o.iterations=function(t){return arguments.length?(s=+t,o):s},o.strength=function(t){return arguments.length?(r=+t,o):r},o.radius=function(e){return arguments.length?(t="function"==typeof e?e:bS(+e),l(),o):t},o}vS.copy=function(){var t,e,n=new mS(this._x,this._y,this._x0,this._y0,this._x1,this._y1),i=this._root;if(!i)return n;if(!i.length)return n._root=xS(i),n;for(t=[{source:i,target:n._root=new Array(4)}];i=t.pop();)for(var r=0;r<4;++r)(e=i.source[r])&&(e.length?t.push({source:e,target:i.target[r]=new Array(4)}):i.target[r]=xS(e));return n},vS.add=function(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return dS(this.cover(e,n),e,n,t)},vS.addAll=function(t){var e,n,i,r,s=t.length,o=new Array(s),a=new Array(s),l=1/0,c=1/0,h=-1/0,u=-1/0;for(n=0;n<s;++n)isNaN(i=+this._x.call(null,e=t[n]))||isNaN(r=+this._y.call(null,e))||(o[n]=i,a[n]=r,i<l&&(l=i),i>h&&(h=i),r<c&&(c=r),r>u&&(u=r));if(l>h||c>u)return this;for(this.cover(l,c).cover(h,u),n=0;n<s;++n)dS(this,o[n],a[n],t[n]);return this},vS.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,r=this._x1,s=this._y1;if(isNaN(n))r=(n=Math.floor(t))+1,s=(i=Math.floor(e))+1;else{for(var o,a,l=r-n||1,c=this._root;n>t||t>=r||i>e||e>=s;)switch(a=(e<i)<<1|t<n,(o=new Array(4))[a]=c,c=o,l*=2,a){case 0:r=n+l,s=i+l;break;case 1:n=r-l,s=i+l;break;case 2:r=n+l,i=s-l;break;case 3:n=r-l,i=s-l}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=i,this._x1=r,this._y1=s,this},vS.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},vS.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},vS.find=function(t,e,n){var i,r,s,o,a,l,c,h=this._x0,u=this._y0,f=this._x1,d=this._y1,g=[],p=this._root;for(p&&g.push(new gS(p,h,u,f,d)),null==n?n=1/0:(h=t-n,u=e-n,f=t+n,d=e+n,n*=n);l=g.pop();)if(!(!(p=l.node)||(r=l.x0)>f||(s=l.y0)>d||(o=l.x1)<h||(a=l.y1)<u))if(p.length){var _=(r+o)/2,y=(s+a)/2;g.push(new gS(p[3],_,y,o,a),new gS(p[2],r,y,_,a),new gS(p[1],_,s,o,y),new gS(p[0],r,s,_,y)),(c=(e>=y)<<1|t>=_)&&(l=g[g.length-1],g[g.length-1]=g[g.length-1-c],g[g.length-1-c]=l)}else{var m=t-+this._x.call(null,p.data),x=e-+this._y.call(null,p.data),v=m*m+x*x;if(v<n){var b=Math.sqrt(n=v);h=t-b,u=e-b,f=t+b,d=e+b,i=p.data}}return i},vS.remove=function(t){if(isNaN(s=+this._x.call(null,t))||isNaN(o=+this._y.call(null,t)))return this;var e,n,i,r,s,o,a,l,c,h,u,f,d=this._root,g=this._x0,p=this._y0,_=this._x1,y=this._y1;if(!d)return this;if(d.length)for(;;){if((c=s>=(a=(g+_)/2))?g=a:_=a,(h=o>=(l=(p+y)/2))?p=l:y=l,e=d,!(d=d[u=h<<1|c]))return this;if(!d.length)break;(e[u+1&3]||e[u+2&3]||e[u+3&3])&&(n=e,f=u)}for(;d.data!==t;)if(i=d,!(d=d.next))return this;return(r=d.next)&&delete d.next,i?(r?i.next=r:delete i.next,this):e?(r?e[u]=r:delete e[u],(d=e[0]||e[1]||e[2]||e[3])&&d===(e[3]||e[2]||e[1]||e[0])&&!d.length&&(n?n[f]=d:this._root=d),this):(this._root=r,this)},vS.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},vS.root=function(){return this._root},vS.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},vS.visit=function(t){var e,n,i,r,s,o,a=[],l=this._root;for(l&&a.push(new gS(l,this._x0,this._y0,this._x1,this._y1));e=a.pop();)if(!t(l=e.node,i=e.x0,r=e.y0,s=e.x1,o=e.y1)&&l.length){var c=(i+s)/2,h=(r+o)/2;(n=l[3])&&a.push(new gS(n,c,h,s,o)),(n=l[2])&&a.push(new gS(n,i,h,c,o)),(n=l[1])&&a.push(new gS(n,c,r,s,h)),(n=l[0])&&a.push(new gS(n,i,r,c,h))}return this},vS.visitAfter=function(t){var e,n=[],i=[];for(this._root&&n.push(new gS(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var r=e.node;if(r.length){var s,o=e.x0,a=e.y0,l=e.x1,c=e.y1,h=(o+l)/2,u=(a+c)/2;(s=r[0])&&n.push(new gS(s,o,a,h,u)),(s=r[1])&&n.push(new gS(s,h,a,l,u)),(s=r[2])&&n.push(new gS(s,o,u,h,c)),(s=r[3])&&n.push(new gS(s,h,u,l,c))}i.push(e)}for(;e=i.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},vS.x=function(t){return arguments.length?(this._x=t,this):this._x},vS.y=function(t){return arguments.length?(this._y=t,this):this._y};const NS=4294967296;var IS=Math.PI*(3-Math.sqrt(5));function kS(t){var e,n=1,i=.001,r=1-Math.pow(i,1/300),s=0,o=.6,a=new Map,l=na(u),c=Fo("tick","end"),h=function(){let t=1;return()=>(t=(1664525*t+1013904223)%NS)/NS}();function u(){f(),c.call("tick",e),n<i&&(l.stop(),c.call("end",e))}function f(i){var l,c,h=t.length;void 0===i&&(i=1);for(var u=0;u<i;++u)for(n+=(s-n)*r,a.forEach((function(t){t(n)})),l=0;l<h;++l)null==(c=t[l]).fx?c.x+=c.vx*=o:(c.x=c.fx,c.vx=0),null==c.fy?c.y+=c.vy*=o:(c.y=c.fy,c.vy=0);return e}function d(){for(var e,n=0,i=t.length;n<i;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var r=10*Math.sqrt(.5+n),s=n*IS;e.x=r*Math.cos(s),e.y=r*Math.sin(s)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function g(e){return e.initialize&&e.initialize(t,h),e}return null==t&&(t=[]),d(),e={tick:f,restart:function(){return l.restart(u),e},stop:function(){return l.stop(),e},nodes:function(n){return arguments.length?(t=n,d(),a.forEach(g),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(i=+t,e):i},alphaDecay:function(t){return arguments.length?(r=+t,e):+r},alphaTarget:function(t){return arguments.length?(s=+t,e):s},velocityDecay:function(t){return arguments.length?(o=1-t,e):1-o},randomSource:function(t){return arguments.length?(h=t,a.forEach(g),e):h},force:function(t,n){return arguments.length>1?(null==n?a.delete(t):a.set(t,g(n)),e):a.get(t)},find:function(e,n,i){var r,s,o,a,l,c=0,h=t.length;for(null==i?i=1/0:i*=i,c=0;c<h;++c)(o=(r=e-(a=t[c]).x)*r+(s=n-a.y)*s)<i&&(l=a,i=o);return l},on:function(t,n){return arguments.length>1?(c.on(t,n),e):c.on(t)}}}function OS(t){var e,n,i,r=bS(.1);function s(t){for(var r,s=0,o=e.length;s<o;++s)(r=e[s]).vx+=(i[s]-r.x)*n[s]*t}function o(){if(e){var s,o=e.length;for(n=new Array(o),i=new Array(o),s=0;s<o;++s)n[s]=isNaN(i[s]=+t(e[s],s,e))?0:+r(e[s],s,e)}}return"function"!=typeof t&&(t=bS(null==t?0:+t)),s.initialize=function(t){e=t,o()},s.strength=function(t){return arguments.length?(r="function"==typeof t?t:bS(+t),o(),s):r},s.x=function(e){return arguments.length?(t="function"==typeof e?e:bS(+e),o(),s):t},s}function CS(t){var e,n,i,r=bS(.1);function s(t){for(var r,s=0,o=e.length;s<o;++s)(r=e[s]).vy+=(i[s]-r.y)*n[s]*t}function o(){if(e){var s,o=e.length;for(n=new Array(o),i=new Array(o),s=0;s<o;++s)n[s]=isNaN(i[s]=+t(e[s],s,e))?0:+r(e[s],s,e)}}return"function"!=typeof t&&(t=bS(null==t?0:+t)),s.initialize=function(t){e=t,o()},s.strength=function(t){return arguments.length?(r="function"==typeof t?t:bS(+t),o(),s):r},s.y=function(e){return arguments.length?(t="function"==typeof e?e:bS(+e),o(),s):t},s}const AS=Object.assign({},{forceX:OS,forceY:CS,forceCollide:SS,forceSimulation:kS});function TS(t,e,n,i,r){return AS.forceSimulation(t).force("x",AS.forceX((t=>r(t.geometry.coordinates)[0]))).force("y",AS.forceY((t=>r(t.geometry.coordinates)[1]))).force("collide",AS.forceCollide((r=>i(Math.abs(r.properties[e]))+uS(t,n).getthickness(r.properties[n.values]||0)/2)))}const RS=Object.assign({},{min:ot,max:rt,scaleSqrt:Sm});const LS=Object.assign({},{scaleSqrt:Sm,max:rt,descending:n});function PS(t,e={},n,i=0,r=0){let s=e.values,o=e.k?e.k:50,a=e.stroke?e.stroke:"black",l=e.fill?e.fill:"none",c=e.strokeWidth?e.strokeWidth:.8,h=e.txtcol?e.txtcol:"#363636",u=e.x?e.x:null,f=e.y?e.y:null,d=e.title?e.title:"Title, year\n  (units)",g=e.fontSize?e.fontSize:14,p=e.fontSize2?e.fontSize2:10,_=null!=e.round?e.round:void 0,y=null!=e.divisor?e.divisor:1,m=e.fixmax;const x=null!=m?m:LS.max(s);let v=LS.scaleSqrt([0,x],[0,1.77*o]),b=v(LS.max(s));if(null!=u&&null!=f){let e=t.append("g").attr("class","bertinlegend").attr("class","legsquare_"+n);0!=r&&e.attr("opacity",0).transition().delay(i).duration(r).attr("opacity",1),e.selectAll("rect").data(s.sort(LS.descending)).join("rect").attr("width",(t=>v(t))).attr("height",(t=>v(t))).attr("fill",l).attr("stroke",a).attr("stroke-width",c).attr("transform",(t=>`translate(${u+b-v(t)},${f-v(t)+b+(d.split("\n").length+1)*g})`)),e.selectAll("line").data(s).join("line").attr("x1",u+b).attr("y1",(t=>f+b-v(t)+(d.split("\n").length+1)*g)).attr("x2",u+b+g).attr("y2",(t=>f+b-v(t)+(d.split("\n").length+1)*g)).attr("stroke",a).attr("stroke-width",c).attr("stroke-dasharray",2),e.append("g").selectAll("text").data(d.split("\n")).join("text").attr("x",u).attr("y",f).attr("font-size",`${g}px`).attr("dy",((t,e)=>e*g)).attr("text-anchor","start").attr("dominant-baseline","hanging").attr("fill",h).text((t=>t)),e.append("g").selectAll("text").data(s).join("text").attr("x",u+b+g+p/2).attr("y",(t=>f+b-v(t)+(d.split("\n").length+1)*g)).attr("font-size",p).attr("dominant-baseline","central").attr("fill",h).text((t=>cb(t/y,_)))}}const DS=Object.assign({},{quadtree:yS,forceX:OS,forceY:CS,forceCollide:SS,forceSimulation:kS});function zS(t){return DS.forceSimulation(t).force("_x",DS.forceX((t=>t._x))).force("_y",DS.forceY((t=>t._y))).force("collide",function(){let t;function e(e){const n=DS.quadtree(t,(t=>t._x),(t=>t._y));for(const e of t)n.visit(((t,n,i,r,s)=>{let o=!1;if(t.data&&t.data!==e){let n,i,r,s=e._x-t.data._x,a=e._y-t.data._y,l=e._padding+(t.data._size+e._size)/2,c=e._padding+(t.data._size+e._size)/2,h=Math.abs(s),u=Math.abs(a);h<l&&u<c&&(n=Math.sqrt(s*s+a*a),i=(h-l)/n,r=(u-c)/n,Math.abs(i)>Math.abs(r)?i=0:r=0,e._x-=s*=i,e._y-=a*=r,t.data.x+=s,t.data.y+=a,o=!0)}return o}))}return e.initialize=e=>t=e,e}())}const FS=Object.assign({},{min:ot,max:rt,scaleSqrt:Sm});const GS=Object.assign({},{symbol:vE,symbolCircle:Hw,symbolDiamond:Kw,symbolCross:Jw,symbolSquare:nE,symbolStar:aE,symbolTriangle:cE,symbolWye:_E});function jS(t,e={},n,i=0,r=0){let s=e.type?e.type:"box",o=e.x?e.x:null,a=e.y?e.y:null,l=null!=e.w?e.w:30,c=null!=e.h?e.h:20,h=e.title?e.title:null,u=e.text?e.text:"leg_text",f=null!=e.fontSize?e.fontSize:14,d=null!=e.fontSize2?e.fontSize2:10,g=e.stroke?e.stroke:"black",p=e.fill?e.fill:"#CCCCCC",_=null!=e.fillOpacity?e.fillOpacity:1,y=null!=e.strokeWidth?e.strokeWidth:.5,m=e.txtcol?e.txtcol:"#363636";if(null!=o&&null!=a){let x=t.append("g").attr("class","bertinlegend").attr("class","legbox_"+n);0!=r&&x.attr("opacity",0).transition().delay(i).duration(r).attr("opacity",1);let v=0;null!=h&&(v=(h.split("\n").length+1)*f,x.append("g").selectAll("text").data(h.split("\n")).join("text").attr("x",o).attr("y",a).attr("font-size",`${f}px`).attr("dy",((t,e)=>e*f)).attr("text-anchor","start").attr("dominant-baseline","hanging").attr("fill",m).text((t=>t))),"box"==s&&(x.append("rect").attr("x",o).attr("y",a+v).attr("height",c).attr("width",l).attr("fill",p).attr("stroke",g).attr("stroke-width",y).attr("fill-opacity",_),x.append("g").selectAll("text").data(u.split("\n")).join("text").attr("x",o+l+d/2).attr("y",a+c/2-d*u.split("\n").length/2+v).attr("font-size",`${d}px`).attr("dy",((t,e)=>e*d)).attr("fill",m).attr("text-anchor","start").attr("dominant-baseline","hanging").text((t=>t)));const b=new Map([["circle",GS.symbolCircle],["cross",GS.symbolCross],["diamond",GS.symbolDiamond],["square",GS.symbolSquare],["star",GS.symbolStar],["triangle",GS.symbolTriangle],["wye",GS.symbolWye]]);if(b.has(s)){const t=e.symbol_size;x.append("path").attr("x",o).attr("y",a+v).attr("d",GS.symbol().size(t).type(b.get(s))).attr("transform",`translate(${o+Math.sqrt(t)},${a+v})`).attr("fill",p).attr("stroke",g).attr("stroke-width",y).attr("fill-opacity",_),x.append("g").selectAll("text").data(u.split("\n")).join("text").attr("x",o+2*Math.sqrt(t)+d/2).attr("y",a+v).attr("font-size",`${d}px`).attr("dy",((t,e)=>e*d)).attr("fill",m).attr("text-anchor","start").attr("dominant-baseline","middle").text((t=>t))}}}const qS=Object.assign({},{min:ot,max:rt,symbol:vE,symbolCircle:Hw,symbolDiamond:Kw,symbolCross:Jw,symbolSquare:nE,symbolStar:aE,symbolTriangle:cE,symbolWye:_E});const BS=Object.assign({},{descending:n,scaleLinear:lm});function YS(t,e={},n,i=0,r=0){if(console.log(e),null!=e.leg_x&&null!=e.leg_y){const s=BS.scaleLinear().domain([0,e.legval[3]]).range([0,e.k]);let o=t.append("g").attr("class","bertinlegend").attr("class","legspike_"+n);0!=r&&o.attr("opacity",0).transition().delay(i).duration(r).attr("opacity",1),null!=e.leg_title&&(e.leg_title.split("\n").length,e.leg_fontSize,o.append("g").selectAll("text").data(e.leg_title.split("\n")).join("text").attr("x",e.leg_x).attr("y",e.leg_y).attr("font-size",`${e.leg_fontSize}px`).attr("dy",((t,n)=>n*e.leg_fontSize)).attr("text-anchor","start").attr("dominant-baseline","hanging").attr("fill",e.leg_txtcol).text((t=>t))),o.append("g").selectAll("path").data(e.legval.sort(BS.descending)).join("path").attr("d",(t=>`M ${-e.w/2},0 0,${-s(t)} ${e.w/2},0`)).attr("fill","object"==typeof e.leg_fill?"white":e.leg_fill).attr("fill-opacity",e.leg_fillOpacity).attr("stroke","object"==typeof e.leg_stroke?"black":e.leg_stroke).attr("stroke-width",1).attr("transform",((t,n)=>`translate(${e.leg_x+e.w/2+(e.w+5)*n},${e.leg_y+e.k+(e.leg_title?e.leg_title.split("\n").length+1:1)*e.leg_fontSize})`)),o.append("g").selectAll("text").data(e.legval.sort(BS.descending)).join("text").attr("text-anchor","start").attr("dominant-baseline","middle").attr("transform",((t,n)=>`translate(${e.leg_x+e.w/2+(e.w+5)*n},${e.leg_y+e.k+(e.leg_title?e.leg_title.split("\n").length+1:1)*e.leg_fontSize+e.leg_fontSize2/2}) rotate(90)`)).attr("font-size",`${e.leg_fontSize2}px`).attr("fill",e.leg_txtcol).text((t=>cb(t,e.leg_round)))}}const $S=Object.assign({},{min:ot,max:rt,scaleLinear:lm,geoPath:Mr});const US=Object.assign({},{geoPath:Mr,max:rt,scaleLinear:lm});function WS({svg:t,projection:e,width:n,height:i,id:r=null,attr:s=null,value:o=null,legend:a=null,duration:l=0,delay:c=0}={}){if("visibility"==s){(o?1:0)?t.selectAll(`g.${r}, #info_${r}, g.legbox_${r}, g.legboxfill_${r}, g.legboxstroke_${r}, g.legthickness_${r}, g.legcircle_${r}, g.legsquare_${r}, g.legspike_${r}, g.legmushroom_${r}, info_${r},  g.legdotcartogram_${r}`).attr("visibility","visible").transition().delay(c).duration(l).style("opacity",1).attr("opacity",1):t.selectAll(`g.${r}, #info_${r}, g.legbox_${r}, g.legboxfill_${r}, g.legboxstroke_${r}, g.legthickness_${r}, g.legcircle_${r}, g.legsquare_${r}, g.legspike_${r}, g.legmushroom_${r}, info_${r},  g.legdotcartogram_${r}`).transition().delay(c).duration(l).style("opacity",0).attr("opacity",0).transition().attr("visibility","hidden")}else{switch(JSON.parse(t.select(`g.${r}`).attr("data-layer"))._type){case"tissot":console.log("update tissot"),function({svg:t,projection:e,id:n=null,attr:i=null,value:r=null,duration:s=0,delay:o=0}={}){let a=t.select(`g.${n}`);"step"==i?a.selectAll("path").datum(ky(r)).transition().delay(o).duration(s).attr("d",Mr(e)):a.transition().delay(o).duration(s).attr(Iy(i),r).style(Iy(i),r)}({svg:t,projection:e,id:r,attr:s,value:o,duration:l,delay:c});break;case"rhumbs":console.log("update rhumbs"),function({svg:t,id:e=null,width:n,height:i,attr:r=null,value:s=null,duration:o=0,delay:a=0}={}){let l=t.select(`g.${e}`),c=Math.max(n,i);if("nb"==r){let t=l.selectAll("polyline").nodes()[0].animatedPoints[0];l.selectAll("polyline").data(Oy(s)).join("polyline").transition().delay(a).duration(o).attr("points",(function(e,n){let i=t.x+Math.cos(e)*c,r=t.y+Math.sin(e)*c;return t.x+","+t.y+" "+i+","+r}))}else"position"==r?l.selectAll("polyline").data(Oy(l.selectAll("polyline").size())).join("polyline").transition().delay(a).duration(o).attr("points",(function(t,e){let n=s[0]+Math.cos(t)*c,i=s[1]+Math.sin(t)*c;return s[0]+","+s[1]+" "+n+","+i})):l.transition().delay(a).duration(o).attr(Iy(r),s).style(Iy(r),s)}({svg:t,id:r,attr:s,width:n,height:i,value:o,duration:l,delay:c});break;case"bubble":console.log("update bubble"),function({svg:t,id:e=null,attr:n=null,value:i=null,legend:r=null,projection:s,duration:o=0,delay:a=0}={}){let l=t.select(`g.${e}`),c=JSON.parse(l.attr("data-layer"));if(i="object"==typeof i&&"object"==typeof c[n]?{...c[n],...i}:i,c[n]=i,t.select(`g.${e}`).attr("data-layer",JSON.stringify(c)),"dorling"==n){let t=RS.scaleSqrt([0,c.valmax],[0,c.k]),e=l.selectAll("circle").data();if(i){const n=TS(e,c.values,c.strokeWidth,t,s);for(let t=0;t<c.iteration;t++)n.tick();l.selectAll("circle").transition().delay(a).duration(o).attr("cx",(t=>t.x)).attr("cy",(t=>t.y))}else l.selectAll("circle").transition().delay(a).duration(o).attr("cx",(t=>s(t.geometry.coordinates)[0])).attr("cy",(t=>s(t.geometry.coordinates)[1]))}else if("values"==n){let n=l.selectAll("circle").data().map((t=>+t.properties[i]));c.valmax=null!=c.fixmax?c.fixmax:RS.max(n);let h=RS.scaleSqrt([0,c.valmax],[0,c.k]);if(c.legval=[RS.min(n),h.invert(h(RS.max(n))/3),h.invert(h(RS.max(n))/1.5),RS.max(n)],t.select(`g.${e}`).attr("data-layer",JSON.stringify(c)),1==c.dorling){const t=TS(l.selectAll("circle").data(),c.values,c.strokeWidth,h,s);for(let e=0;e<c.iteration;e++)t.tick();l.selectAll("circle").transition().delay(a).duration(o).attr("cx",(t=>t.x)).attr("cy",(t=>t.y)).attr("r",(t=>h(Math.abs(t.properties[c.values]))))}else l.selectAll("circle").transition().delay(a).duration(o).attr("r",(t=>h(Math.abs(t.properties[c.values]))));t.select(`g.legcircle_${e}`).remove(),ub(t,e,{x:c.leg_x,y:c.leg_y,round:void 0!==c.leg_round?c.leg_round:void 0,divisor:c.leg_divisor,k:c.k,fixmax:c.fixmax,stroke:c.leg_stroke,fill:c.leg_fill,strokeWidth:c.leg_strokeWidth,txtcol:c.leg_txtcol,title:c.leg_title,fontSize:c.leg_fontSize,fontSize2:c.leg_fontSize2,title:r||(c.leg_title?c.leg_title:c.values),values:c.legval},a+o/2,o/2)}else if("k"==n){let n=RS.scaleSqrt([0,c.valmax],[0,c.k]);if(1==c.dorling){const t=TS(l.selectAll("circle").data(),c.values,c.strokeWidth,n,s);for(let e=0;e<c.iteration;e++)t.tick();l.selectAll("circle").transition().delay(a).duration(o).attr("cx",(t=>t.x)).attr("cy",(t=>t.y)).attr("r",(t=>n(Math.abs(t.properties[c.values]))))}else l.selectAll("circle").transition().delay(a).duration(o).attr("r",(t=>n(Math.abs(t.properties[c.values]))));t.selectAll(`g.legcircle_${e}`).remove(),ub(t,e,{x:c.leg_x,y:c.leg_y,round:void 0!==c.leg_round?c.leg_round:void 0,divisor:c.leg_divisor,k:i,fixmax:c.fixmax,stroke:c.leg_stroke,fill:c.leg_fill,strokeWidth:c.leg_strokeWidth,txtcol:c.leg_txtcol,title:c.leg_title,fontSize:c.leg_fontSize,fontSize2:c.leg_fontSize2,title:r||(c.leg_title?c.leg_title:c.values),values:c.legval},a+o/2,o/2)}else if("fill"==n||"stroke"==n)switch(t.selectAll(`g.legbox${n}_${e}`).remove(),typeof i){case"string":l.selectAll("circle").transition().delay(a).duration(o).style(n,i);break;case"object":l.selectAll("circle").transition().delay(a).duration(o).style(n,(t=>cS(l.selectAll("circle").data(),i).getcol(t.properties[i.values]))),"object"==typeof i&&fS({type:"FeatureCollection",features:l.selectAll("circle").data()},t,"fill"==n?i:void 0,"stroke"==n?i:void 0,void 0,e,a,o)}else if("strokeWidth"==n){if(t.selectAll(`g.legthickness_${e}`).remove(),1==c.dorling){const t=TS(l.selectAll("circle").data(),c.values,c.strokeWidth,RS.scaleSqrt([0,c.valmax],[0,c.k]),s);for(let e=0;e<c.iteration;e++)t.tick();l.selectAll("circle").transition().delay(a).duration(o).attr("cx",(t=>t.x)).attr("cy",(t=>t.y)).style("stroke-width",(t=>uS(l.selectAll("circle").data(),i).getthickness(t.properties[i.values]||void 0))).attr("stroke-width",(t=>uS(l.selectAll("circle").data(),i).getthickness(t.properties[i.values]||void 0)))}else l.selectAll("circle").transition().delay(a).duration(o).style("stroke-width",(t=>uS(l.selectAll("circle").data(),i).getthickness(t.properties[i.values]||void 0))).attr("stroke-width",(t=>uS(l.selectAll("circle").data(),i).getthickness(t.properties[i.values]||void 0)));"object"==typeof i&&fS({type:"FeatureCollection",features:l.selectAll("circle").data()},t,void 0,void 0,i,e,a,o)}}({svg:t,id:r,attr:s,width:n,height:i,value:o,legend:a,projection:e,duration:l,delay:c});break;case"square":console.log("update square"),function({svg:t,id:e=null,attr:n=null,value:i=null,legend:r=null,duration:s=0,delay:o=0}={}){let a=t.select(`g.${e}`),l=JSON.parse(a.attr("data-layer"));if(i="object"==typeof i&&"object"==typeof l[n]?{...l[n],...i}:i,l[n]=i,t.select(`g.${e}`).attr("data-layer",JSON.stringify(l)),"dorling"==n||"demers"==n)if(i){const t=zS(a.selectAll("rect").data());for(let e=0;e<l.iteration;e++)t.tick();a.selectAll("rect").transition().delay(o).duration(s).attr("x",(t=>t._x-t._size/2)).attr("y",(t=>t._y-t._size/2))}else a.selectAll("rect").transition().delay(o).duration(s).attr("x",(t=>t.ctrx-t._size/2)).attr("y",(t=>t.ctry-t._size/2));else if("values"==n){let n=a.selectAll("rect").data().map((t=>+t[i]));l.valmax=null!=l.fixmax?l.fixmax:FS.max(n);let c=FS.scaleSqrt([0,l.valmax],[0,1.77*l.k]);if(l.legval=[FS.min(n),c.invert(c(FS.max(n))/3),c.invert(c(FS.max(n))/1.5),FS.max(n)],a.attr("data-layer",JSON.stringify(l)),1==l.dorling||1==l.demers){let t=a.selectAll("rect").data();t.forEach((t=>{t._size=c(Math.abs(t[l.values]))}));const e=zS(t);for(let t=0;t<l.iteration;t++)e.tick();a.selectAll("rect").transition().delay(o).duration(s).attr("x",(t=>t._x-c(Math.abs(t[l.values]))/2)).attr("y",(t=>t._y-c(Math.abs(t[l.values]))/2)).attr("width",(t=>c(Math.abs(t[l.values])))).attr("height",(t=>c(Math.abs(t[l.values]))))}else a.selectAll("rect").transition().delay(o).duration(s).attr("x",(t=>t.ctrx-c(Math.abs(t[l.values]))/2)).attr("y",(t=>t.ctry-c(Math.abs(t[l.values]))/2)).attr("width",(t=>c(Math.abs(t[l.values])))).attr("height",(t=>c(Math.abs(t[l.values]))));t.select(`g.legsquare_${e}`).remove(),PS(t,{x:l.leg_x,y:l.leg_y,round:void 0!==l.leg_round?l.leg_round:void 0,divisor:l.leg_divisor,k:l.k,fixmax:l.fixmax,stroke:l.leg_stroke,fill:l.leg_fill,strokeWidth:l.leg_strokeWidth,txtcol:l.leg_txtcol,title:l.leg_title,fontSize:l.leg_fontSize,fontSize2:l.leg_fontSize2,title:r||(l.leg_title?l.leg_title:l.values),values:l.legval},e,o+s/2,s/2)}else if("k"==n){let n=FS.scaleSqrt([0,l.valmax],[0,1.77*l.k]);if(1==l.dorling||1==l.demers){let t=a.selectAll("rect").data();t.forEach((t=>{t._size=n(Math.abs(t[l.values])),t.x=t.ctrx,t.y=t.ctry,t._x=t.ctrx,t._y=t.ctry}));const e=zS(t);for(let t=0;t<l.iteration;t++)e.tick();a.join(t).selectAll("rect").transition().delay(o).duration(s).attr("x",(t=>t._x-n(Math.abs(t[l.values]))/2)).attr("y",(t=>t._y-n(Math.abs(t[l.values]))/2)).attr("width",(t=>n(Math.abs(t[l.values])))).attr("height",(t=>n(Math.abs(t[l.values]))))}else a.selectAll("rect").transition().delay(o).duration(s).attr("x",(t=>t.ctrx-n(Math.abs(t[l.values]))/2)).attr("y",(t=>t.ctry-n(Math.abs(t[l.values]))/2)).attr("width",(t=>n(Math.abs(t[l.values])))).attr("height",(t=>n(Math.abs(t[l.values]))));t.select(`g.legsquare_${e}`).remove(),PS(t,{x:l.leg_x,y:l.leg_y,round:void 0!==l.leg_round?l.leg_round:void 0,divisor:l.leg_divisor,k:i,fixmax:l.fixmax,stroke:l.leg_stroke,fill:l.leg_fill,strokeWidth:l.leg_strokeWidth,txtcol:l.leg_txtcol,title:l.leg_title,fontSize:l.leg_fontSize,fontSize2:l.leg_fontSize2,title:r||(l.leg_title?l.leg_title:l.values),values:l.legval},e,o+s/2,s/2)}else if("fill"==n||"stroke"==n)switch(t.selectAll(`g.legbox${n}_${e}`).remove(),typeof i){case"string":a.selectAll("rect").transition().delay(o).duration(s).style(n,i);break;case"object":a.selectAll("rect").transition().delay(o).duration(s).style(n,(t=>cS(a.selectAll("rect").data(),i).getcol(t[i.values]))),"object"==typeof i&&fS({type:"FeatureCollection",features:a.selectAll("rect").data()},t,"fill"==n?i:void 0,"stroke"==n?i:void 0,void 0,e,o,s)}else if("strokeWidth"==n){t.selectAll(`g.legthickness_${e}`).remove();let n=a.selectAll("rect").data();n.map((t=>t.properties={[i.values]:+t[i.values]}));let r=FS.scaleSqrt([0,l.valmax],[0,1.77*l.k]);if(1==l.dorling||1==l.demers){n.forEach((t=>{t.x=t.ctrx,t.y=t.ctry,t._x=t.ctrx,t._y=t.ctry,t._padding=uS(n,i).getthickness(t.properties[i.values]||0)/2+0}));const t=zS(n);for(let e=0;e<l.iteration;e++)t.tick();a.join(n).selectAll("rect").transition().delay(o).duration(s).attr("x",(t=>t._x-r(Math.abs(t[l.values]))/2)).attr("y",(t=>t._y-r(Math.abs(t[l.values]))/2)).style("stroke-width",(t=>uS(a.selectAll("rect").data(),i).getthickness(t[i.values]||void 0))).attr("stroke-width",(t=>uS(a.selectAll("rect").data(),i).getthickness(t[i.values]||void 0)))}else a.selectAll("rect").transition().delay(o).duration(s).style("stroke-width",(t=>uS(a.selectAll("rect").data(),i).getthickness(t[i.values]||void 0))).attr("stroke-width",(t=>uS(a.selectAll("rect").data(),i).getthickness(t[i.values]||void 0)));"object"==typeof i&&fS({type:"FeatureCollection",features:a.selectAll("rect").data()},t,void 0,void 0,i,e,o,s)}else a.selectAll("rect").transition().delay(o).duration(s).attr(Iy(n),i).style(Iy(n),i)}({svg:t,id:r,attr:s,width:n,height:i,value:o,legend:a,projection:e,duration:l,delay:c});break;case"spikes":console.log("update spike"),function({svg:t,id:e=null,attr:n=null,value:i=null,projection:r,legend:s=null,duration:o=0,delay:a=0}={}){let l=t.select(`g.${e}`),c=JSON.parse(l.attr("data-layer"));if(i="object"==typeof i&&"object"==typeof c[n]?{...c[n],...i}:i,c[n]=i,s&&(c.leg.leg_title=s),t.select(`g.${e}`).attr("data-layer",JSON.stringify(c)),"values"==n){let n=l.selectAll("path").data();n.forEach((t=>{t.coords=$S.geoPath(r).centroid(t.geometry)}));const s=$S.scaleLinear().domain([0,$S.max(n.map((t=>+t.properties[i])))]).range([0,c.k]),h=n.filter((t=>""!=t.properties[i])).map((t=>+t.properties[i])),u=[$S.min(h),s.invert(c.k/3),s.invert(c.k/1.5),$S.max(h)];c.leg.legval=u,t.select(`g.${e}`).attr("data-layer",JSON.stringify(c)),l.selectAll("path").transition().delay(a).duration(o).attr("d",(t=>`M ${-c.w/2}, 0 0, ${0-s(t.properties[c.values])} ${c.w/2}, 0`)).attr("transform",(t=>`translate(\n       ${t.coords[0]},\n       ${t.coords[1]})`)),t.select(`g.legspike_${e}`).remove(),YS(t,c.leg,e,a+o/2,o/2)}else if("k"==n){c.leg[n]=i,t.select(`g.${e}`).attr("data-layer",JSON.stringify(c)),l.selectAll("path").data().forEach((t=>{t.coords=$S.geoPath(r).centroid(t.geometry)}));const s=$S.scaleLinear().domain([0,$S.max(l.selectAll("path").data().map((t=>+t.properties[c.values])))]).range([0,i]);l.selectAll("path").transition().delay(a).duration(o).attr("d",(t=>`M ${-c.w/2}, 0 0, ${0-s(t.properties[c.values])} ${c.w/2}, 0`)).attr("transform",(t=>`translate(\n       ${t.coords[0]},\n       ${t.coords[1]})`)),t.select(`g.legspike_${e}`).remove(),YS(t,c.leg,e,a+o/2,o/2)}else if("fill"==n||"stroke"==n)switch(t.selectAll(`g.legbox${n}_${e}`).remove(),typeof i){case"string":l.selectAll("path").transition().delay(a).duration(o).style(n,i);break;case"object":l.selectAll("path").transition().delay(a).duration(o).style(n,(t=>cS(l.selectAll("path").data(),i).getcol(t.properties[i.values]))),"object"==typeof i&&fS({type:"FeatureCollection",features:l.selectAll("path").data()},t,"fill"==n?i:void 0,"stroke"==n?i:void 0,void 0,e,a,o)}else"strokeWidth"==n?(t.selectAll(`g.legthickness_${e}`).remove(),l.selectAll("path").transition().delay(a).duration(o).style("stroke-width",(t=>uS(l.selectAll("path").data(),i).getthickness(t.properties[i.values]||void 0))).attr("stroke-width",(t=>uS(l.selectAll("path").data(),i).getthickness(t.properties[i.values]||void 0))),"object"==typeof i&&fS({type:"FeatureCollection",features:l.selectAll("path").data()},t,void 0,void 0,i,e,a,o)):l.selectAll("path").transition().delay(a).duration(o).attr(Iy(n),i).style(Iy(n),i)}({svg:t,id:r,attr:s,width:n,height:i,value:o,legend:a,projection:e,duration:l,delay:c});break;case"simple":console.log("update simple"),function({svg:t,id:e=null,attr:n=null,value:i=null,legend:r=null,duration:s=0,delay:o=0}={}){let a=t.select(`g.${e}`),l=JSON.parse(a.attr("data-layer"));if(i="object"==typeof i&&"object"==typeof l[n]?{...l[n],...i}:i,l[n]=i,t.select(`g.${e}`).attr("data-layer",JSON.stringify(l)),"fill"==n||"stroke"==n)switch(t.selectAll(`g.legbox_${e}`).remove(),t.selectAll(`g.legbox${n}_${e}`).remove(),typeof i){case"string":a.selectAll("path").transition().delay(o).duration(s).style(n,i),l.leg.x>0&&l.leg.y>0&&(r&&(l.leg.text=r),l.leg[n]=i,t.select(`g.legbox_${e}`).remove(),jS(t,l.leg,e,o,s));break;case"object":a.selectAll("path").transition().delay(o).duration(s).style(n,(t=>cS(a.selectAll("path").data(),i).getcol(t.properties[i.values]))),fS({type:"FeatureCollection",features:a.selectAll("path").data()},t,"fill"==n?i:void 0,"stroke"==n?i:void 0,void 0,e,o,s)}else if("strokeWidth"==n)t.selectAll(`g.legthickness_${e}`).remove(),a.selectAll("path").transition().delay(o).duration(s).style("stroke-width",(t=>uS(a.selectAll("path").data(),i).getthickness(t.properties[i.values]||void 0))).attr("stroke-width",(t=>uS(a.selectAll("path").data(),i).getthickness(t.properties[i.values]||void 0))),"object"==typeof i&&fS({type:"FeatureCollection",features:a.selectAll("path").data()},t,void 0,void 0,i,e,o,s);else if("symbol_size"==n||"symbol"==n){t.selectAll(`g.legbox_${e}`).remove();const c=new Map([["circle",qS.symbolCircle],["cross",qS.symbolCross],["diamond",qS.symbolDiamond],["square",qS.symbolSquare],["star",qS.symbolStar],["triangle",qS.symbolTriangle],["wye",qS.symbolWye]]);"symbol_size"==n?a.selectAll("path").transition().delay(o).duration(s).attr("d",qS.symbol().size(i).type(c.get(l.symbol))):(l.leg.type=i,a.selectAll("path").transition().delay(o).duration(s).attr("d",qS.symbol().size(l.symbol_size).type(c.get(i)))),l.leg.x>0&&l.leg.y>0&&(r&&(l.leg.text=r),l[n]=i,l.leg[n]=i,t.select(`g.legbox_${e}`).remove(),jS(t,l.leg,e,o,s))}else a.selectAll("path").transition().delay(o).duration(s).attr(Iy(n),i).style(Iy(n),i)}({svg:t,id:r,attr:s,width:n,height:i,value:o,duration:l,delay:c,legend:a});break;case"shadow":console.log("update shadow"),function({svg:t,id:e=null,attr:n=null,value:i=null,duration:r=0,delay:s=0}={}){let o=t.select(`g.${e}`),a=JSON.parse(o.attr("data-layer"));"dx"==n?o.selectAll("path").transition().delay(s).duration(r).attr("transform",`translate(${i} ${a.dy})`):"dy"==n?o.selectAll("path").transition().delay(s).duration(r).attr("transform",`translate(${a.dx} ${i})`):o.selectAll("path").transition().delay(s).duration(r).attr(Iy(n),i).style(Iy(n),i)}({svg:t,id:r,attr:s,value:o,duration:l,delay:c});break;case"ridge":console.log("update ridge"),function({svg:t,id:e=null,attr:n=null,value:i=null,duration:r=0,delay:s=0}={}){let o=t.select(`g.${e}`),a=JSON.parse(o.attr("data-layer"));if("k"==n){let t=Array.from(new Set(a.mygrid.map((t=>t.y)))),e=US.scaleLinear().domain([0,US.max(a.mygrid.map((t=>t.value)))]).range([0,i]),n=[];t.forEach((t=>{let i=[];a.mygrid.filter((e=>e.y==t)).forEach((t=>i.push([t.x,t.y-e(t.value)])));let r={type:"LineString",coordinates:i};n.push({type:"Feature",properties:{y:t},geometry:r})})),0==r&&0==s?o.join(n).selectAll("path").data(n).join("path").attr("d",US.geoPath()):o.join(n).selectAll("path").data(n).join("path").transition().delay(s).duration(r).attr("d",US.geoPath())}else o.selectAll("path").transition().delay(s).duration(r).attr(Iy(n),i).style(Iy(n),i)}({svg:t,id:r,attr:s,value:o,duration:l,delay:c,width:n});break;case"header":console.log("update header"),function({svg:t,id:e=null,attr:n=null,value:i=null,duration:r=0,delay:s=0}={}){"text"==n&&t.select(`g.${e}`).selectAll("text").transition().delay(s).duration(r/2).attr("opacity",0).transition().delay(0).duration(r/2).text(i).attr("opacity",1)}({svg:t,id:r,attr:s,value:o,duration:l,delay:c});break;case"footer":console.log("update footer"),function({svg:t,id:e=null,attr:n=null,value:i=null,duration:r=0,delay:s=0}={}){"text"==n&&t.select(`g.${e}`).selectAll("text").transition().delay(s).duration(r/2).attr("opacity",0).transition().delay(0).duration(r/2).text(i).attr("opacity",1)}({svg:t,id:r,attr:s,value:o,duration:l,delay:c});break;case"graticule":case"geolines":console.log("update default"),function({svg:t,id:e=null,attr:n=null,value:i=null,duration:r=0,delay:s=0}={}){t.select(`g.${e}`).selectAll("path").transition().delay(s).duration(r).attr(Iy(n),i).style(Iy(n),i)}({svg:t,id:r,attr:s,value:o,duration:l,delay:c})}}}const XS=Object.assign({},{geoPath:Mr,geoGraticule:mi});function VS(t){let e=[],n=-180;for(;n<=180;)e.push([n,t]),n+=2.5;return{type:"MultiLineString",coordinates:[e]}}const HS=Object.assign({},{geoPath:Mr});function JS(t,e,n,i={},r){if(!n){let n=null!=i.stroke?i.stroke:"#020e21";Array.isArray(n)||(n=Array(3).fill(n));let s=null!=i.strokeWidth?i.strokeWidth:[1.5,1.2,.7];Array.isArray(s)||(s=Array(3).fill(s));let o=null!=i.strokeOpacity?i.strokeOpacity:1;Array.isArray(o)||(o=Array(3).fill(o));let a=null!=i.strokeDasharray?i.strokeDasharray:["none",5,3];Array.isArray(a)||(a=Array(3).fill(a));let l=null!=i.strokeLinecap?i.strokeLinecap:"butt";Array.isArray(l)||(l=Array(3).fill(l));let c=function(){let t=[];return[["Equator",0],["Tropic of Cancer",23.43656],["Tropic of Capricorn",-23.43636],["Arctic Circle",66.56345],["Antarctic Circle",-66.56364]].forEach((e=>{t.push({type:"Feature",properties:{name:e[0],latitude:e[1]},geometry:VS(e[1])})})),{type:"FeatureCollection",features:t}}().features,h=t.append("g").attr("class",i.id).attr("data-layer",JSON.stringify({_type:"geolines"}));h.attr("clip-path",null==r?"none":`url(#clip_${r})`),h.append("g").selectAll("path").data(c.filter((t=>"Equator"==t.properties.name))).join("path").attr("d",HS.geoPath(e)).attr("class","onglobe").attr("fill","none").attr("stroke",n[0]).attr("stroke-width",s[0]).attr("stroke-opacity",o[0]).attr("stroke-dasharray",a[0]).attr("stroke-linecap",l[0]),h.append("g").selectAll("path").data(c.filter((t=>t.properties.name.includes("Tropic")))).join("path").attr("d",HS.geoPath(e)).attr("class","onglobe").attr("fill","none").attr("stroke",n[1]).attr("stroke-width",s[1]).attr("stroke-opacity",o[1]).attr("stroke-dasharray",a[1]).attr("stroke-linecap",l[1]),h.append("g").selectAll("path").data(c.filter((t=>t.properties.name.includes("Circle")))).join("path").attr("d",HS.geoPath(e)).attr("class","onglobe").attr("fill","none").attr("stroke",n[2]).attr("stroke-width",s[2]).attr("stroke-opacity",o[2]).attr("stroke-dasharray",a[2]).attr("stroke-linecap",l[2])}}const ZS=Object.assign({},{geoPath:Mr});function QS(t,e,n,i={}){if(!n){let n=i.fill?i.fill:"#add8f7",r=null!=i.fillOpacity?i.fillOpacity:1,s=i.stroke?i.stroke:"none",o=null!=i.strokeWidth?i.strokeWidth:1;t.append("g").attr("class",i.id).attr("data-layer",JSON.stringify({_type:"outline"})).attr("data-layer",void 0).append("path").attr("d",ZS.geoPath(e)({type:"Sphere"})).attr("fill",n).attr("fill-opacity",r).attr("stroke",s).attr("stroke-width",o)}}function KS(t,e,n){const i=.33*e,r=.25*n;return t[0]<i&&t[1]<r?"bottomright":t[0]>e-i&&t[1]<r?"bottomleft":t[0]<i&&t[1]>n-r?"topright":t[0]>e-i&&t[1]>n-r?"topleft":t[1]>n-r?"top":t[0]<i?"right":t[0]>e-i?"left":"bottom"}function tN(t,e){if(!e)return t.style("display","none");const n=1==Array.isArray(e.fields)?e.fields:[e.fields],i=e.fill?e.fill:"#fcf7e6",r=null!=e.strokeWidth?e.strokeWidth:1,s=null!=e.fillOpacity?e.fillOpacity:1,o=null!=e.strokeOpacity?e.strokeOpacity:1,a=e.stroke?e.stroke:"#4a4d4b",l=e.type?e.type:"bottom",c=n.length;let h=e.col?e.col:"#4d4545";Array.isArray(h)||(h=Array(c).fill(h));let u=e.fontWeight;null==u&&1==c&&(u=["bold"]),null==u&&c>1&&(u=["bold"].concat(Array(c-1).fill("normal"))),"string"==typeof u&&(u=Array(c).fill(u));let f=e.fontSize;null==f&&1==c&&(f=[18]),null==f&&c>1&&(f=[18].concat(Array(c-1).fill(12))),"number"==typeof f&&(f=Array(c).fill(f));let d=e.fontStyle;null==d&&(d=Array(c).fill("normal")),"string"==typeof d&&(d=Array(c).fill(d)),t.style("display",null).style("pointer-events","none").style("font","8px sans-serif");const g=t.selectAll("path").data([null]).join("path").attr("fill",i).attr("stroke",a).attr("stroke-width",r).attr("fill-opacity",s).attr("stroke-opacity",o),p=t.selectAll("text").data([null]).join("text").call((t=>t.selectAll("tspan").data(n).join("tspan").attr("x",0).attr("y",((t,e)=>`${f.slice(0,e+1).reduce(((t,e)=>t+e),0)+3*e}px`)).style("font-weight",((t,e)=>u[e])).style("font-size",((t,e)=>`${f[e]}px`)).style("font-style",((t,e)=>d[e])).style("fill",((t,e)=>h[e])).text((t=>t)))),{x:_,y:y,width:m,height:x}=p.node().getBBox();switch(l){case"bottom":p.attr("transform",`translate(${-m/2},${15-y})`),g.attr("d",`M${-m/2-10},5H-5l5,-5l5,5H${m/2+10}v${x+20}h-${m+20}z`);break;case"top":p.attr("transform",`translate(${-m/2},${-15-y-x})`),g.attr("d",`M${-m/2-10},-5H-5l5,5l5,-5H${m/2+10}v${-x-20}h-${m+20}z`);break;case"left":p.attr("transform",`translate(${-m-15},${-y-x/2})`),g.attr("d",`M0,0l-5,5v${x/2+5}h${-m-20}v${-x-20}h${m+20}v${x/2+5}z`);break;case"right":p.attr("transform",`translate(15,${-y-x/2})`),g.attr("d",`M0,0l5,5v${x/2+5}h${m+20}v${-x-20}h${-m-20}v${x/2+5}z`);break;case"topleft":p.attr("transform",`translate(${-m-10},${-15-y-x})`),g.attr("d",`M0,0v${-x-5-20}h${-m-20}v${x+20}h${m+15}z`);break;case"topright":p.attr("transform",`translate(10,${-15-y-x})`),g.attr("d",`M0,0v${-x-5-20}h${m+20}v${x+20}h${-m-15}z`);break;case"bottomleft":p.attr("transform",`translate(${-m-10},${15-y})`),g.attr("d",`M0,0v${+x+5+20}h${-m-20}v${-x-20}h${+m+15}z`);break;case"bottomright":p.attr("transform",`translate(10,${15-y})`),g.attr("d",`M0,0v${+x+5+20}h${m+20}v${-x-20}h${-m-15}z`)}}const eN=Object.assign({},{select:Oo,pointer:Po,forceX:OS,forceY:CS,forceCollide:SS,forceSimulation:kS,geoPath:Mr,symbol:vE,symbolCircle:Hw,symbolDiamond:Kw,symbolCross:Jw,symbolSquare:nE,symbolStar:aE,symbolTriangle:cE,symbolWye:_E});function nN(t,e,n={},i,r,s){let o=["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],a=n.geojson,l=n.fill?n.fill:o[Math.floor(Math.random()*o.length)],c=n.strokeLinecap?n.strokeLinecap:"round",h=n.strokeLinejoin?n.strokeLinejoin:"round",u=null!=n.strokeDasharray?n.strokeDasharray:"none",f=n.stroke?n.stroke:"white",d=null!=n.strokeWidth?n.strokeWidth:.5,g=null!=n.fillOpacity?n.fillOpacity:1,p=null!=n.strokeOpacity?n.strokeOpacity:1,_=!!n.tooltip&&n.tooltip;Array.isArray(_)&&(_={fields:_}),"function"!=typeof _&&"string"!=typeof _||(_={fields:[_]});let y=n.symbol?n.symbol:"circle",m=null!=n.symbol_size?n.symbol_size:40,x=null!=n.symbol_iteration?n.symbol_iteration:200,v=null!=n.symbol_shift?n.symbol_shift:0,b=!!n.viewof,M={x:n.leg_x,y:n.leg_y,w:n.leg_w,h:n.leg_h,symbol_size:m,title:n.leg_title,text:n.leg_text,fontSize:n.leg_fontSize,fontSize2:n.leg_fontSize2,stroke:n.leg_stroke,fillOpacity:n.leg_fillOpacity?n.leg_fillOpacity:g,fill:n.leg_fill?n.leg_fill:l,strokeWidth:n.leg_strokeWidth,txtcol:n.leg_txtcol,symbol:n.symbol,symbol_size:n.symbol_size,symbol_iteration:n.symbol_iteration,symbol_shift:n.symbol_shift,viewof:n.viewof},w={},E=n.id?`info_${n.id}`:`info_${Date.now().toString(36)+Math.random().toString(36).substring(2)}`;if(t.append("g").attr("id",E).attr("class","info"),"l"==ry(a)&&(f=n.stroke?n.stroke:o[Math.floor(Math.random()*o.length)],l=n.fill?n.fill:"none",d=n.strokeWidth?n.strokeWidth:1),"l"!=ry(a)&&"z"!=ry(a)||t.append("g").attr("class",n.id).attr("data-layer",JSON.stringify({_type:n._type?n._type:"simple",fill:l,stroke:f,strokeWidth:d,leg:M})).attr("clip-path",null==i?"none":`url(#clip_${i})`).selectAll("path").data(a.features).join("path").attr("d",eN.geoPath(e)).attr("class","onglobe").attr("fill",(t=>cS(a.features,l).getcol(t.properties[l.values]))).attr("stroke",(t=>cS(a.features,f).getcol(t.properties[f.values]))).attr("stroke-width",(t=>uS(a.features,d).getthickness(t.properties[d.values]||void 0))).attr("fill-opacity",g).attr("stroke-opacity",p).attr("stroke-linecap",c).attr("stroke-linejoin",h).attr("stroke-dasharray",u).on("touchmove mousemove",(function(e,n){b&&(eN.select(this).attr("stroke-opacity",p-.3).attr("fill-opacity",g-.3),w=n.properties,t.dispatch("input"),Object.defineProperty(t.node(),"value",{get:()=>w,configurable:!0})),_&&t.select(`#${E}`).call(tN,{fields:function(){const t=_.fields;let e=[];return t.forEach((t=>{let i="";"function"==typeof t?i=[n].map(t)[0]:"string"==typeof t&&"$"==t[0]?i=`${n.properties[t.substring(1,t.length)]}`:"string"==typeof t&&(i=t),e.push(""==i?"N/A":i)})),e}(),fontWeight:_.fontWeight,fontSize:_.fontSize,fontStyle:_.fontStyle,fill:_.fill,stroke:_.stroke,strokeWidth:_.strokeWidth,fillOpacity:_.fillOpacity,strokeOpacity:_.strokeOpacity,col:_.col,type:KS(eN.pointer(e,this),r,s)}),_&&(t.select(`#${E}`).attr("transform",`translate(${eN.pointer(e,this)})`),eN.select(this).attr("stroke-opacity",p-.3).attr("fill-opacity",g-.3).raise())})).on("touchend mouseleave",(function(){b&&(w={},t.dispatch("input")),t.select(`#${E}`).call(tN,null),eN.select(this).attr("stroke-opacity",p).attr("fill-opacity",g).lower()})),"p"==ry(a)){if(M.type=n.symbol?n.symbol:"circle",v>0){const t=eN.forceSimulation(a.features).force("x",eN.forceX((t=>e(t.geometry.coordinates)[0]))).force("y",eN.forceY((t=>e(t.geometry.coordinates)[1]))).force("collide",eN.forceCollide(Math.sqrt(m)/2+v/2));for(let e=0;e<x;e++)t.tick()}a.features.forEach((t=>{t.coords=eN.geoPath(e).centroid(t.geometry)}));const i=new Map([["circle",eN.symbolCircle],["cross",eN.symbolCross],["diamond",eN.symbolDiamond],["square",eN.symbolSquare],["star",eN.symbolStar],["triangle",eN.symbolTriangle],["wye",eN.symbolWye]]);t.append("g").attr("class",n.id).attr("data-layer",JSON.stringify({_type:n._type?n._type:"simple",fill:l,stroke:f,strokeWidth:d,leg:M,symbol:y,symbol_size:m})).selectAll("path").data(a.features).join("path").attr("class","onglobe_translate").attr("d",eN.symbol().size(m).type(i.get(y))).attr("transform",(t=>`translate(\n       ${v?t.x:t.coords[0]},\n       ${v?t.y:t.coords[1]})`)).attr("fill",(t=>cS(a.features,l).getcol(t.properties[l.values]||void 0))).attr("visibility",(t=>isNaN(t.coords[0])?"hidden":"visible")).attr("stroke",(t=>cS(a.features,f).getcol(t.properties[f.values]))).attr("stroke-width",(t=>uS(a.features,d).getthickness(t.properties[d.values]))).attr("fill-opacity",g).attr("stroke-opacity",p).attr("stroke-linecap",c).attr("stroke-linejoin",h).attr("stroke-dasharray",u).on("touchmove mousemove",(function(n,i){b&&(w=i.properties,t.dispatch("input"),Object.defineProperty(t.node(),"value",{get:()=>w,configurable:!0})),_&&t.select(`#${E}`).call(tN,{fields:function(){const t=_.fields;let e=[];return t.forEach((t=>{let n="";"function"==typeof t?n=[i].map(t)[0]:"string"==typeof t&&"$"==t[0]?n=`${i.properties[t.substring(1,t.length)]}`:"string"==typeof t&&(n=t),e.push(""==n?"N/A":n)})),e}(),fontWeight:_.fontWeight,fontSize:_.fontSize,fontStyle:_.fontStyle,fill:_.fill,stroke:_.stroke,strokeWidth:_.strokeWidth,fillOpacity:_.fillOpacity,strokeOpacity:_.strokeOpacity,col:_.col,type:KS(v?[i.x,i.y]:e(i.geometry.coordinates),r,s)}),_&&(t.select(`#${E}`).attr("transform",`translate(\n         ${v?i.x:e(i.geometry.coordinates)[0]},\n         ${v?i.y:e(i.geometry.coordinates)[1]})`),eN.select(this).attr("stroke-opacity",p-.3).attr("fill-opacity",g-.3))})).on("touchend mouseleave",(function(){b&&(w={},t.dispatch("input")),t.select(`#${E}`).call(tN,null),eN.select(this).attr("stroke-opacity",p).attr("fill-opacity",g)}))}b&&Object.defineProperty(t.node(),"value",{get:()=>w,configurable:!0}),fS(a,t,l,f,d,n.id),jS(t,M,n.id)}const iN=Object.assign({},{geoArea:Oe,geoCentroid:wn,geoIdentity:as,geoPath:Mr});function rN(t,e={}){if("p"===ry(t))return t;{let n=!1!==e.largest,i=!0===e.planar,r=iN.geoPath(iN.geoIdentity());t=Mc(t);const s=function(t){var e={},n=0;return t.geometry.coordinates.forEach((function(t){var s={type:"Polygon",coordinates:t},o=i?r.area(s):iN.geoArea(s);o>n&&(n=o,e=s)})),e};let o=t.features.map((t=>(t.geometry.coordinates=i?r.centroid(1==n?"Polygon"==t.geometry.type?t:s(t):t):iN.geoCentroid(1==n?"Polygon"==t.geometry.type?t:s(t):t),t.geometry.type="Point",t)));return t.features=o,t}}const sN=Object.assign({},{min:ot,max:rt,descending:n,scaleSqrt:Sm,select:Oo,pointer:Po,geoPath:Mr});function oN(t,e,n,i={},r,s,o){let a,l=["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],c=i.geojson,h=i.values,u=null!=i.fixmax?i.fixmax:void 0,f=i.k?i.k:50,d=i.fill?i.fill:l[Math.floor(Math.random()*l.length)],g=i.stroke?i.stroke:"white",p=null!=i.strokeWidth?i.strokeWidth:.5,_=i.strokeDasharray?i.strokeDasharray:"none",y=null!=i.strokeOpacity?i.strokeOpacity:1,m=null!=i.fillOpacity?i.fillOpacity:1,x=!!i.dorling&&i.dorling,v=null!=i.iteration?i.iteration:200,b=!!i.tooltip&&i.tooltip,M=!!i.viewof;Array.isArray(b)&&(b={fields:b}),"function"!=typeof b&&"string"!=typeof b||(b={fields:[b]}),a="p"==ry(c)?c.features:rN(c,{planar:n}).features.filter((t=>!isNaN(t.geometry.coordinates[0])));const w=null!=u?u:sN.max(a,(t=>Math.abs(+t.properties[h])));let E=sN.scaleSqrt([0,w],[0,f]),S=a.map((t=>Math.abs(+t.properties[h]))),N=[sN.min(S),E.invert(E(sN.max(S))/3),E.invert(E(sN.max(S))/1.5),sN.max(S)];if(1==x){const t=TS(a,h,p,E,e);for(let e=0;e<v;e++)t.tick()}a.forEach((t=>{t.coords=sN.geoPath(e).centroid(t.geometry)}));let I=i.id?`info_${i.id}`:`info_${Date.now().toString(36)+Math.random().toString(36).substring(2)}`;t.append("g").attr("id",I).attr("class","info");let k={};t.append("g").attr("class",i.id).attr("data-layer",JSON.stringify({_type:i._type?i._type:"bubble",valmax:w,k:f,dorling:x,iteration:v,strokeWidth:p,fill:d,stroke:g,values:h,fixmax:u,legval:N,leg_x:i.leg_x,leg_y:i.leg_y,leg_round:i.leg_round,leg_divisor:i.leg_divisor,leg_stroke:i.leg_stroke,leg_fill:i.leg_fill,leg_strokeWidth:i.leg_strokeWidth,leg_txtcol:i.leg_txtcol,leg_title:i.leg_title,leg_fontSize:i.leg_fontSize,leg_fontSize2:i.leg_fontSize2,leg_title:i.leg_title})).selectAll("circle").data(a.filter((t=>null!=t.geometry.coordinates)).filter((t=>null!=t.properties[h])).sort(((t,e)=>sN.descending(Math.abs(+t.properties[h]),Math.abs(+e.properties[h]))))).join("circle").attr("class","onglobe_coords").attr("fill",(t=>cS(a,d).getcol(t.properties[d.values]))).attr("stroke",(t=>cS(a,g).getcol(t.properties[g.values]))).attr("stroke-width",(t=>uS(a,p).getthickness(t.properties[p.values]||void 0))).attr("fill-opacity",m).attr("stroke-dasharray",_).attr("stroke-opacity",y).attr("visibility",(t=>isNaN(t.coords[0])?"hidden":"visible")).attr("cx",(t=>x?t.x:t.coords[0])).attr("cy",(t=>x?t.y:t.coords[1])).attr("r",(t=>E(Math.abs(t.properties[h])))).on("touchmove mousemove",(function(e,n){M&&(sN.select(this).attr("stroke-opacity",y-.3).attr("fill-opacity",m-.3),k=n.properties,t.dispatch("input"),Object.defineProperty(t.node(),"value",{get:()=>k,configurable:!0})),b&&t.select(`#${I}`).call(tN,{fields:function(){const t=b.fields;let e=[];return t.forEach((t=>{let i="";"function"==typeof t?i=[n].map(t)[0]:"string"==typeof t&&"$"==t[0]?i=`${n.properties[t.substring(1,t.length)]}`:"string"==typeof t&&(i=t),e.push(""==i?"N/A":i)})),e}(),fontWeight:b.fontWeight,fontSize:b.fontSize,fontStyle:b.fontStyle,fill:b.fill,stroke:b.stroke,strokeWidth:b.strokeWidth,fillOpacity:b.fillOpacity,strokeOpacity:b.strokeOpacity,col:b.col,type:KS(sN.pointer(e,this),s,o)}),b&&(t.select(`#${I}`).attr("transform",`translate(${sN.pointer(e,this)})`),sN.select(this).attr("stroke-opacity",y-.3).attr("fill-opacity",m-.3))})).on("touchend mouseleave",(function(){M&&(k={},t.dispatch("input")),t.select(`#${I}`).call(tN,null),sN.select(this).attr("stroke-opacity",y).attr("fill-opacity",m)})),M&&Object.defineProperty(t.node(),"value",{get:()=>k,configurable:!0}),fS(c,t,d,g,p,i.id),ub(t,i.id,{x:i.leg_x,y:i.leg_y,round:void 0!==i.leg_round?i.leg_round:void 0,divisor:i.leg_divisor,k:f,fixmax:u,stroke:i.leg_stroke,fill:i.leg_fill,strokeWidth:i.leg_strokeWidth,txtcol:i.leg_txtcol,title:i.leg_title,fontSize:i.leg_fontSize,fontSize2:i.leg_fontSize2,title:i.leg_title?i.leg_title:h,values:N})}const aN=Object.assign({},{min:ot,max:rt,descending:n,scaleSqrt:Sm,select:Oo,pointer:Po});function lN(t,e,n,i={},r,s,o){let a,l=["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],c=i.geojson,h=i.values,u=null!=i.fixmax?i.fixmax:void 0,f=i.k?i.k:50,d=i.fill?i.fill:l[Math.floor(Math.random()*l.length)],g=i.stroke?i.stroke:"white",p=null!=i.strokeWidth?i.strokeWidth:.5,_=i.strokeDasharray?i.strokeDasharray:"none",y=null!=i.strokeOpacity?i.strokeOpacity:1,m=null!=i.fillOpacity?i.fillOpacity:1,x=!!i.dorling&&i.dorling,v=!!i.demers&&i.demers,b=null!=i.iteration?i.iteration:200,M=!!i.viewof,w=!!i.tooltip&&i.tooltip;Array.isArray(w)&&(w={fields:w}),"function"!=typeof w&&"string"!=typeof w||(w={fields:[w]}),a="p"==ry(c)?c.features:rN(c,{planar:n}).features;const E=null!=u?u:aN.max(a,(t=>Math.abs(+t.properties[h])));let S=aN.scaleSqrt([0,E],[0,1.77*f]),N=[...a].map((t=>Object.assign(t.properties,{ctrx:e(t.geometry.coordinates)[0],ctry:e(t.geometry.coordinates)[1],_x:e(t.geometry.coordinates)[0],_y:e(t.geometry.coordinates)[1],_size:S(Math.abs(t.properties[h])),_padding:uS(a,p).getthickness(t.properties[p.values]||0)/2+0}))).filter((t=>!isNaN(t._x))).filter((t=>!isNaN(t._y))).filter((t=>null!=t[h])),I=N.map((t=>Math.abs(+t[h]))),k=[aN.min(I),S.invert(S(aN.max(I))/3),S.invert(S(aN.max(I))/1.5),aN.max(I)];if(1==x||1==v){const t=zS(N);for(let e=0;e<b;e++)t.tick()}let O=i.id?`info_${i.id}`:`info_${Date.now().toString(36)+Math.random().toString(36).substring(2)}`;t.append("g").attr("id",O).attr("class","info");let C={};t.append("g").attr("class",i.id).attr("data-layer",JSON.stringify({_type:i._type?i._type:"square",valmax:E,k:f,demers:v,dorling:x,iteration:b,strokeWidth:p,fill:d,stroke:g,values:h,fixmax:u,legval:k,leg_x:i.leg_x,leg_y:i.leg_y,leg_round:i.leg_round,leg_divisor:i.leg_divisor,leg_stroke:i.leg_stroke,leg_fill:i.leg_fill,leg_strokeWidth:i.leg_strokeWidth,leg_txtcol:i.leg_txtcol,leg_title:i.leg_title,leg_fontSize:i.leg_fontSize,leg_fontSize2:i.leg_fontSize2,leg_title:i.leg_title})).selectAll("squares").data(N.sort(((t,e)=>aN.descending(Math.abs(+t[h]),Math.abs(+e[h]))))).join("rect").attr("class","onglobe_coords").attr("fill",(t=>cS(N,d).getcol(t[d.values]))).attr("stroke",(t=>cS(N,g).getcol(t[g.values]))).attr("stroke-width",(t=>uS(N,p).getthickness(t[p.values]||void 0))).attr("fill-opacity",m).attr("stroke-dasharray",_).attr("stroke-opacity",y).attr("x",(t=>t._x-t._size/2)).attr("y",(t=>t._y-t._size/2)).attr("width",(t=>t._size)).attr("height",(t=>t._size)).on("touchmove mousemove",(function(e,n){M&&(aN.select(this).attr("stroke-opacity",y-.3).attr("fill-opacity",m-.3),C=n,t.dispatch("input"),Object.defineProperty(t.node(),"value",{get:()=>C,configurable:!0})),w&&(n.properties=n,t.select(`#${O}`).call(tN,{fields:function(){const t=w.fields;let e=[];return t.forEach((t=>{let i="";"function"==typeof t?i=[n].map(t)[0]:"string"==typeof t&&"$"==t[0]?i=`${n.properties[t.substring(1,t.length)]}`:"string"==typeof t&&(i=t),e.push(""==i?"N/A":i)})),e}(),fontWeight:w.fontWeight,fontSize:w.fontSize,fontStyle:w.fontStyle,fill:w.fill,stroke:w.stroke,strokeWidth:w.strokeWidth,fillOpacity:w.fillOpacity,strokeOpacity:w.strokeOpacity,col:w.col,type:KS(aN.pointer(e,this),s,o)})),w&&(t.select(`#${O}`).attr("transform",`translate(${aN.pointer(e,this)})`),aN.select(this).attr("stroke-opacity",y-.3).attr("fill-opacity",m-.3))})).on("touchend mouseleave",(function(){M&&(C={},t.dispatch("input")),t.select(`#${O}`).call(tN,null),aN.select(this).attr("stroke-opacity",y).attr("fill-opacity",m)})),M&&Object.defineProperty(t.node(),"value",{get:()=>C,configurable:!0}),fS(c,t,d,g,p,i.id),PS(t,{x:i.leg_x,y:i.leg_y,round:void 0!==i.leg_round?i.leg_round:void 0,divisor:i.leg_divisor,k:f,fixmax:u,stroke:i.leg_stroke,fill:i.leg_fill,strokeWidth:i.leg_strokeWidth,txtcol:i.leg_txtcol,title:i.leg_title,fontSize:i.leg_fontSize,fontSize2:i.leg_fontSize2,title:i.leg_title?i.leg_title:h,values:k},i.id)}function cN(t,e,n){void 0===n&&(n={});var i={type:"Feature"};return(0===n.id||n.id)&&(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.properties=e||{},i.geometry=t,i}function hN(t){return"Feature"===t.type?t.geometry:t}function uN(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var i=function(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}(t),r=hN(e),s=r.type,o=e.bbox,a=r.coordinates;if(o&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(i,o))return!1;"Polygon"===s&&(a=[a]);for(var l=!1,c=0;c<a.length&&!l;c++)if(fN(i,a[c][0],n.ignoreBoundary)){for(var h=!1,u=1;u<a[c].length&&!h;)fN(i,a[c][u],!n.ignoreBoundary)&&(h=!0),u++;h||(l=!0)}return l}function fN(t,e,n){var i=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var r=0,s=e.length-1;r<e.length;s=r++){var o=e[r][0],a=e[r][1],l=e[s][0],c=e[s][1];if(t[1]*(o-l)+a*(l-t[0])+c*(t[0]-o)==0&&(o-t[0])*(l-t[0])<=0&&(a-t[1])*(c-t[1])<=0)return!n;a>t[1]!=c>t[1]&&t[0]<(l-o)*(t[1]-a)/(c-a)+o&&(i=!i)}return i}function dN(t,e,n){if(null!==t)for(var i,r,s,o,a,l,c,h,u=0,f=0,d=t.type,g="FeatureCollection"===d,p="Feature"===d,_=g?t.features.length:1,y=0;y<_;y++){a=(h=!!(c=g?t.features[y].geometry:p?t.geometry:t)&&"GeometryCollection"===c.type)?c.geometries.length:1;for(var m=0;m<a;m++){var x=0,v=0;if(null!==(o=h?c.geometries[m]:c)){l=o.coordinates;var b=o.type;switch(u=!n||"Polygon"!==b&&"MultiPolygon"!==b?0:1,b){case null:break;case"Point":if(!1===e(l,f,y,x,v))return!1;f++,x++;break;case"LineString":case"MultiPoint":for(i=0;i<l.length;i++){if(!1===e(l[i],f,y,x,v))return!1;f++,"MultiPoint"===b&&x++}"LineString"===b&&x++;break;case"Polygon":case"MultiLineString":for(i=0;i<l.length;i++){for(r=0;r<l[i].length-u;r++){if(!1===e(l[i][r],f,y,x,v))return!1;f++}"MultiLineString"===b&&x++,"Polygon"===b&&v++}"Polygon"===b&&x++;break;case"MultiPolygon":for(i=0;i<l.length;i++){for(v=0,r=0;r<l[i].length;r++){for(s=0;s<l[i][r].length-u;s++){if(!1===e(l[i][r][s],f,y,x,v))return!1;f++}v++}x++}break;case"GeometryCollection":for(i=0;i<o.geometries.length;i++)if(!1===dN(o.geometries[i],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function gN(t){var e=[1/0,1/0,-1/0,-1/0];return dN(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}
/**
   * splaytree v3.1.1
   * Fast Splay tree for Node and browser
   *
   * @author Alexander Milevski <info@w8r.name>
   * @license MIT
   * @preserve
   */
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */
function pN(t,e){var n,i,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}gN.default=gN;var _N=function(t,e){this.next=null,this.key=t,this.data=e,this.left=null,this.right=null};function yN(t,e){return t>e?1:t<e?-1:0}function mN(t,e,n){for(var i=new _N(null,null),r=i,s=i;;){var o=n(t,e.key);if(o<0){if(null===e.left)break;if(n(t,e.left.key)<0){var a=e.left;if(e.left=a.right,a.right=e,null===(e=a).left)break}s.left=e,s=e,e=e.left}else{if(!(o>0))break;if(null===e.right)break;if(n(t,e.right.key)>0){a=e.right;if(e.right=a.left,a.left=e,null===(e=a).right)break}r.right=e,r=e,e=e.right}}return r.right=e.left,s.left=e.right,e.left=i.right,e.right=i.left,e}function xN(t,e,n,i){var r=new _N(t,e);if(null===n)return r.left=r.right=null,r;var s=i(t,(n=mN(t,n,i)).key);return s<0?(r.left=n.left,r.right=n,n.left=null):s>=0&&(r.right=n.right,r.left=n,n.right=null),r}function vN(t,e,n){var i=null,r=null;if(e){var s=n((e=mN(t,e,n)).key,t);0===s?(i=e.left,r=e.right):s<0?(r=e.right,e.right=null,i=e):(i=e.left,e.left=null,r=e)}return{left:i,right:r}}function bN(t,e,n,i,r){if(t){i(e+(n?"└── ":"├── ")+r(t)+"\n");var s=e+(n?"    ":"│   ");t.left&&bN(t.left,s,!1,i,r),t.right&&bN(t.right,s,!0,i,r)}}var MN=function(){function t(t){void 0===t&&(t=yN),this._root=null,this._size=0,this._comparator=t}return t.prototype.insert=function(t,e){return this._size++,this._root=xN(t,e,this._root,this._comparator)},t.prototype.add=function(t,e){var n=new _N(t,e);null===this._root&&(n.left=n.right=null,this._size++,this._root=n);var i=this._comparator,r=mN(t,this._root,i),s=i(t,r.key);return 0===s?this._root=r:(s<0?(n.left=r.left,n.right=r,r.left=null):s>0&&(n.right=r.right,n.left=r,r.right=null),this._size++,this._root=n),this._root},t.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},t.prototype._remove=function(t,e,n){var i;return null===e?null:0===n(t,(e=mN(t,e,n)).key)?(null===e.left?i=e.right:(i=mN(t,e.left,n)).right=e.right,this._size--,i):e},t.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=mN(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},t.prototype.findStatic=function(t){for(var e=this._root,n=this._comparator;e;){var i=n(t,e.key);if(0===i)return e;e=i<0?e.left:e.right}return null},t.prototype.find=function(t){return this._root&&(this._root=mN(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root},t.prototype.contains=function(t){for(var e=this._root,n=this._comparator;e;){var i=n(t,e.key);if(0===i)return!0;e=i<0?e.left:e.right}return!1},t.prototype.forEach=function(t,e){for(var n=this._root,i=[],r=!1;!r;)null!==n?(i.push(n),n=n.left):0!==i.length?(n=i.pop(),t.call(e,n),n=n.right):r=!0;return this},t.prototype.range=function(t,e,n,i){for(var r=[],s=this._comparator,o=this._root;0!==r.length||o;)if(o)r.push(o),o=o.left;else{if(s((o=r.pop()).key,e)>0)break;if(s(o.key,t)>=0&&n.call(i,o))return this;o=o.right}return this},t.prototype.keys=function(){var t=[];return this.forEach((function(e){var n=e.key;return t.push(n)})),t},t.prototype.values=function(){var t=[];return this.forEach((function(e){var n=e.data;return t.push(n)})),t},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},t.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},t.prototype.at=function(t){for(var e=this._root,n=!1,i=0,r=[];!n;)if(e)r.push(e),e=e.left;else if(r.length>0){if(e=r.pop(),i===t)return e;i++,e=e.right}else n=!0;return null},t.prototype.next=function(t){var e=this._root,n=null;if(t.right){for(n=t.right;n.left;)n=n.left;return n}for(var i=this._comparator;e;){var r=i(t.key,e.key);if(0===r)break;r<0?(n=e,e=e.left):e=e.right}return n},t.prototype.prev=function(t){var e=this._root,n=null;if(null!==t.left){for(n=t.left;n.right;)n=n.right;return n}for(var i=this._comparator;e;){var r=i(t.key,e.key);if(0===r)break;r<0?e=e.left:(n=e,e=e.right)}return n},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return function(t){var e=t,n=[],i=!1,r=new _N(null,null),s=r;for(;!i;)e?(n.push(e),e=e.left):n.length>0?e=(e=s=s.next=n.pop()).right:i=!0;return s.next=null,r.next}(this._root)},t.prototype.load=function(t,e,n){void 0===e&&(e=[]),void 0===n&&(n=!1);var i=t.length,r=this._comparator;if(n&&SN(t,e,0,i-1,r),null===this._root)this._root=wN(t,e,0,i),this._size=i;else{var s=function(t,e,n){var i=new _N(null,null),r=i,s=t,o=e;for(;null!==s&&null!==o;)n(s.key,o.key)<0?(r.next=s,s=s.next):(r.next=o,o=o.next),r=r.next;null!==s?r.next=s:null!==o&&(r.next=o);return i.next}(this.toList(),function(t,e){for(var n=new _N(null,null),i=n,r=0;r<t.length;r++)i=i.next=new _N(t[r],e[r]);return i.next=null,n.next}(t,e),r);i=this._size+i,this._root=EN({head:s},0,i)}return this},t.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(t){void 0===t&&(t=function(t){return String(t.key)});var e=[];return bN(this._root,"",!0,(function(t){return e.push(t)}),t),e.join("")},t.prototype.update=function(t,e,n){var i=this._comparator,r=vN(t,this._root,i),s=r.left,o=r.right;i(t,e)<0?o=xN(e,n,o,i):s=xN(e,n,s,i),this._root=function(t,e,n){return null===e?t:(null===t||((e=mN(t.key,e,n)).left=t),e)}(s,o,i)},t.prototype.split=function(t){return vN(t,this._root,this._comparator)},t.prototype[Symbol.iterator]=function(){var t;return pN(this,(function(e){switch(e.label){case 0:t=this.minNode(),e.label=1;case 1:return t?[4,t]:[3,3];case 2:return e.sent(),t=this.next(t),[3,1];case 3:return[2]}}))},t}();function wN(t,e,n,i){var r=i-n;if(r>0){var s=n+Math.floor(r/2),o=t[s],a=e[s],l=new _N(o,a);return l.left=wN(t,e,n,s),l.right=wN(t,e,s+1,i),l}return null}function EN(t,e,n){var i=n-e;if(i>0){var r=e+Math.floor(i/2),s=EN(t,e,r),o=t.head;return o.left=s,t.head=t.head.next,o.right=EN(t,r+1,n),o}return null}function SN(t,e,n,i,r){if(!(n>=i)){for(var s=t[n+i>>1],o=n-1,a=i+1;;){do{o++}while(r(t[o],s)<0);do{a--}while(r(t[a],s)>0);if(o>=a)break;var l=t[o];t[o]=t[a],t[a]=l,l=e[o],e[o]=e[a],e[a]=l}SN(t,e,n,a,r),SN(t,e,a+1,i,r)}}function NN(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function IN(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function kN(t,e,n){return e&&IN(t.prototype,e),n&&IN(t,n),t}var ON=function(t,e){return t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y},CN=function(t,e){if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;var n=t.ll.x<e.ll.x?e.ll.x:t.ll.x,i=t.ur.x<e.ur.x?t.ur.x:e.ur.x;return{ll:{x:n,y:t.ll.y<e.ll.y?e.ll.y:t.ll.y},ur:{x:i,y:t.ur.y<e.ur.y?t.ur.y:e.ur.y}}},AN=Number.EPSILON;void 0===AN&&(AN=Math.pow(2,-52));var TN=AN*AN,RN=function(t,e){if(-AN<t&&t<AN&&-AN<e&&e<AN)return 0;var n=t-e;return n*n<TN*t*e?0:t<e?-1:1},LN=function(){function t(){NN(this,t),this.reset()}return kN(t,[{key:"reset",value:function(){this.xRounder=new PN,this.yRounder=new PN}},{key:"round",value:function(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}}]),t}(),PN=function(){function t(){NN(this,t),this.tree=new MN,this.round(0)}return kN(t,[{key:"round",value:function(t){var e=this.tree.add(t),n=this.tree.prev(e);if(null!==n&&0===RN(e.key,n.key))return this.tree.remove(t),n.key;var i=this.tree.next(e);return null!==i&&0===RN(e.key,i.key)?(this.tree.remove(t),i.key):t}}]),t}(),DN=new LN,zN=function(t,e){return t.x*e.y-t.y*e.x},FN=function(t,e){return t.x*e.x+t.y*e.y},GN=function(t,e,n){var i={x:e.x-t.x,y:e.y-t.y},r={x:n.x-t.x,y:n.y-t.y},s=zN(i,r);return RN(s,0)},jN=function(t){return Math.sqrt(FN(t,t))},qN=function(t,e,n){var i={x:e.x-t.x,y:e.y-t.y},r={x:n.x-t.x,y:n.y-t.y};return FN(r,i)/jN(r)/jN(i)},BN=function(t,e,n){return 0===e.y?null:{x:t.x+e.x/e.y*(n-t.y),y:n}},YN=function(t,e,n){return 0===e.x?null:{x:n,y:t.y+e.y/e.x*(n-t.x)}},$N=function(){function t(e,n){NN(this,t),void 0===e.events?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=n}return kN(t,null,[{key:"compare",value:function(e,n){var i=t.comparePoints(e.point,n.point);return 0!==i?i:(e.point!==n.point&&e.link(n),e.isLeft!==n.isLeft?e.isLeft?1:-1:WN.compare(e.segment,n.segment))}},{key:"comparePoints",value:function(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}}]),kN(t,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var e=t.point.events,n=0,i=e.length;n<i;n++){var r=e[n];this.point.events.push(r),r.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,e=0;e<t;e++){var n=this.point.events[e];if(void 0===n.segment.consumedBy)for(var i=e+1;i<t;i++){var r=this.point.events[i];void 0===r.consumedBy&&(n.otherSE.point.events===r.otherSE.point.events&&n.segment.consume(r.segment))}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],e=0,n=this.point.events.length;e<n;e++){var i=this.point.events[e];i!==this&&!i.segment.ringOut&&i.segment.isInResult()&&t.push(i)}return t}},{key:"getLeftmostComparator",value:function(t){var e=this,n=new Map,i=function(i){var r,s,o,a,l,c=i.otherSE;n.set(i,{sine:(r=e.point,s=t.point,o=c.point,a={x:s.x-r.x,y:s.y-r.y},l={x:o.x-r.x,y:o.y-r.y},zN(l,a)/jN(l)/jN(a)),cosine:qN(e.point,t.point,c.point)})};return function(t,e){n.has(t)||i(t),n.has(e)||i(e);var r=n.get(t),s=r.sine,o=r.cosine,a=n.get(e),l=a.sine,c=a.cosine;return s>=0&&l>=0?o<c?1:o>c?-1:0:s<0&&l<0?o<c?-1:o>c?1:0:l<s?-1:l>s?1:0}}}]),t}(),UN=0,WN=function(){function t(e,n,i,r){NN(this,t),this.id=++UN,this.leftSE=e,e.segment=this,e.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=e,this.rings=i,this.windings=r}return kN(t,null,[{key:"compare",value:function(t,e){var n=t.leftSE.point.x,i=e.leftSE.point.x,r=t.rightSE.point.x,s=e.rightSE.point.x;if(s<n)return 1;if(r<i)return-1;var o=t.leftSE.point.y,a=e.leftSE.point.y,l=t.rightSE.point.y,c=e.rightSE.point.y;if(n<i){if(a<o&&a<l)return 1;if(a>o&&a>l)return-1;var h=t.comparePoint(e.leftSE.point);if(h<0)return 1;if(h>0)return-1;var u=e.comparePoint(t.rightSE.point);return 0!==u?u:-1}if(n>i){if(o<a&&o<c)return-1;if(o>a&&o>c)return 1;var f=e.comparePoint(t.leftSE.point);if(0!==f)return f;var d=t.comparePoint(e.rightSE.point);return d<0?1:d>0?-1:1}if(o<a)return-1;if(o>a)return 1;if(r<s){var g=e.comparePoint(t.rightSE.point);if(0!==g)return g}if(r>s){var p=t.comparePoint(e.rightSE.point);if(p<0)return 1;if(p>0)return-1}if(r!==s){var _=l-o,y=r-n,m=c-a,x=s-i;if(_>y&&m<x)return 1;if(_<y&&m>x)return-1}return r>s?1:r<s||l<c?-1:l>c?1:t.id<e.id?-1:t.id>e.id?1:0}}]),kN(t,[{key:"replaceRightSE",value:function(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:t>e?t:e}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var e=this.leftSE.point,n=this.rightSE.point,i=this.vector();if(e.x===n.x)return t.x===e.x?0:t.x<e.x?1:-1;var r=(t.y-e.y)/i.y,s=e.x+r*i.x;if(t.x===s)return 0;var o=(t.x-e.x)/i.x,a=e.y+o*i.y;return t.y===a?0:t.y<a?-1:1}},{key:"getIntersection",value:function(t){var e=this.bbox(),n=t.bbox(),i=CN(e,n);if(null===i)return null;var r=this.leftSE.point,s=this.rightSE.point,o=t.leftSE.point,a=t.rightSE.point,l=ON(e,o)&&0===this.comparePoint(o),c=ON(n,r)&&0===t.comparePoint(r),h=ON(e,a)&&0===this.comparePoint(a),u=ON(n,s)&&0===t.comparePoint(s);if(c&&l)return u&&!h?s:!u&&h?a:null;if(c)return h&&r.x===a.x&&r.y===a.y?null:r;if(l)return u&&s.x===o.x&&s.y===o.y?null:o;if(u&&h)return null;if(u)return s;if(h)return a;var f=function(t,e,n,i){if(0===e.x)return YN(n,i,t.x);if(0===i.x)return YN(t,e,n.x);if(0===e.y)return BN(n,i,t.y);if(0===i.y)return BN(t,e,n.y);var r=zN(e,i);if(0==r)return null;var s={x:n.x-t.x,y:n.y-t.y},o=zN(s,e)/r,a=zN(s,i)/r;return{x:(t.x+a*e.x+(n.x+o*i.x))/2,y:(t.y+a*e.y+(n.y+o*i.y))/2}}(r,this.vector(),o,t.vector());return null===f?null:ON(i,f)?DN.round(f.x,f.y):null}},{key:"split",value:function(e){var n=[],i=void 0!==e.events,r=new $N(e,!0),s=new $N(e,!1),o=this.rightSE;this.replaceRightSE(s),n.push(s),n.push(r);var a=new t(r,o,this.rings.slice(),this.windings.slice());return $N.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),$N.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),i&&(r.checkForConsuming(),s.checkForConsuming()),n}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var e=0,n=this.windings.length;e<n;e++)this.windings[e]*=-1}},{key:"consume",value:function(e){for(var n=this,i=e;n.consumedBy;)n=n.consumedBy;for(;i.consumedBy;)i=i.consumedBy;var r=t.compare(n,i);if(0!==r){if(r>0){var s=n;n=i,i=s}if(n.prev===i){var o=n;n=i,i=o}for(var a=0,l=i.rings.length;a<l;a++){var c=i.rings[a],h=i.windings[a],u=n.rings.indexOf(c);-1===u?(n.rings.push(c),n.windings.push(h)):n.windings[u]+=h}i.rings=null,i.windings=null,i.consumedBy=n,i.leftSE.consumedBy=n.leftSE,i.rightSE.consumedBy=n.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){var t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};for(var e=this._afterState.rings,n=this._afterState.windings,i=this._afterState.multiPolys,r=0,s=this.rings.length;r<s;r++){var o=this.rings[r],a=this.windings[r],l=e.indexOf(o);-1===l?(e.push(o),n.push(a)):n[l]+=a}for(var c=[],h=[],u=0,f=e.length;u<f;u++)if(0!==n[u]){var d=e[u],g=d.poly;if(-1===h.indexOf(g))if(d.isExterior)c.push(g);else{-1===h.indexOf(g)&&h.push(g);var p=c.indexOf(d.poly);-1!==p&&c.splice(p,1)}}for(var _=0,y=c.length;_<y;_++){var m=c[_].multiPoly;-1===i.indexOf(m)&&i.push(m)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(nI.type){case"union":var n=0===t.length,i=0===e.length;this._isInResult=n!==i;break;case"intersection":var r,s;t.length<e.length?(r=t.length,s=e.length):(r=e.length,s=t.length),this._isInResult=s===nI.numMultiPolys&&r<s;break;case"xor":var o=Math.abs(t.length-e.length);this._isInResult=o%2==1;break;case"difference":var a=function(t){return 1===t.length&&t[0].isSubject};this._isInResult=a(t)!==a(e);break;default:throw new Error("Unrecognized operation type found ".concat(nI.type))}return this._isInResult}}],[{key:"fromRing",value:function(e,n,i){var r,s,o,a=$N.comparePoints(e,n);if(a<0)r=e,s=n,o=1;else{if(!(a>0))throw new Error("Tried to create degenerate segment at [".concat(e.x,", ").concat(e.y,"]"));r=n,s=e,o=-1}return new t(new $N(r,!0),new $N(s,!1),[i],[o])}}]),t}(),XN=function(){function t(e,n,i){if(NN(this,t),!Array.isArray(e)||0===e.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=i,this.segments=[],"number"!=typeof e[0][0]||"number"!=typeof e[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var r=DN.round(e[0][0],e[0][1]);this.bbox={ll:{x:r.x,y:r.y},ur:{x:r.x,y:r.y}};for(var s=r,o=1,a=e.length;o<a;o++){if("number"!=typeof e[o][0]||"number"!=typeof e[o][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var l=DN.round(e[o][0],e[o][1]);l.x===s.x&&l.y===s.y||(this.segments.push(WN.fromRing(s,l,this)),l.x<this.bbox.ll.x&&(this.bbox.ll.x=l.x),l.y<this.bbox.ll.y&&(this.bbox.ll.y=l.y),l.x>this.bbox.ur.x&&(this.bbox.ur.x=l.x),l.y>this.bbox.ur.y&&(this.bbox.ur.y=l.y),s=l)}r.x===s.x&&r.y===s.y||this.segments.push(WN.fromRing(s,r,this))}return kN(t,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,n=this.segments.length;e<n;e++){var i=this.segments[e];t.push(i.leftSE),t.push(i.rightSE)}return t}}]),t}(),VN=function(){function t(e,n){if(NN(this,t),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new XN(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var i=1,r=e.length;i<r;i++){var s=new XN(e[i],this,!1);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.interiorRings.push(s)}this.multiPoly=n}return kN(t,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),e=0,n=this.interiorRings.length;e<n;e++)for(var i=this.interiorRings[e].getSweepEvents(),r=0,s=i.length;r<s;r++)t.push(i[r]);return t}}]),t}(),HN=function(){function t(e,n){if(NN(this,t),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof e[0][0][0]&&(e=[e])}catch(t){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var i=0,r=e.length;i<r;i++){var s=new VN(e[i],this);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.polys.push(s)}this.isSubject=n}return kN(t,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,n=this.polys.length;e<n;e++)for(var i=this.polys[e].getSweepEvents(),r=0,s=i.length;r<s;r++)t.push(i[r]);return t}}]),t}(),JN=function(){function t(e){NN(this,t),this.events=e;for(var n=0,i=e.length;n<i;n++)e[n].segment.ringOut=this;this.poly=null}return kN(t,null,[{key:"factory",value:function(e){for(var n=[],i=0,r=e.length;i<r;i++){var s=e[i];if(s.isInResult()&&!s.ringOut){for(var o=null,a=s.leftSE,l=s.rightSE,c=[a],h=a.point,u=[];o=a,a=l,c.push(a),a.point!==h;)for(;;){var f=a.getAvailableLinkedEvents();if(0===f.length){var d=c[0].point,g=c[c.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(d.x,",")+" ".concat(d.y,"]. Last matching segment found ends at")+" [".concat(g.x,", ").concat(g.y,"]."))}if(1===f.length){l=f[0].otherSE;break}for(var p=null,_=0,y=u.length;_<y;_++)if(u[_].point===a.point){p=_;break}if(null===p){u.push({index:c.length,point:a.point});var m=a.getLeftmostComparator(o);l=f.sort(m)[0].otherSE;break}var x=u.splice(p)[0],v=c.splice(x.index);v.unshift(v[0].otherSE),n.push(new t(v.reverse()))}n.push(new t(c))}}return n}}]),kN(t,[{key:"getGeom",value:function(){for(var t=this.events[0].point,e=[t],n=1,i=this.events.length-1;n<i;n++){var r=this.events[n].point,s=this.events[n+1].point;0!==GN(r,t,s)&&(e.push(r),t=r)}if(1===e.length)return null;var o=e[0],a=e[1];0===GN(o,t,a)&&e.shift(),e.push(e[0]);for(var l=this.isExteriorRing()?1:-1,c=this.isExteriorRing()?0:e.length-1,h=this.isExteriorRing()?e.length:-1,u=[],f=c;f!=h;f+=l)u.push([e[f].x,e[f].y]);return u}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],e=1,n=this.events.length;e<n;e++){var i=this.events[e];$N.compare(t,i)>0&&(t=i)}for(var r=t.segment.prevInResult(),s=r?r.prevInResult():null;;){if(!r)return null;if(!s)return r.ringOut;if(s.ringOut!==r.ringOut)return s.ringOut.enclosingRing()!==r.ringOut?r.ringOut:r.ringOut.enclosingRing();r=s.prevInResult(),s=r?r.prevInResult():null}}}]),t}(),ZN=function(){function t(e){NN(this,t),this.exteriorRing=e,e.poly=this,this.interiorRings=[]}return kN(t,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(var e=0,n=this.interiorRings.length;e<n;e++){var i=this.interiorRings[e].getGeom();null!==i&&t.push(i)}return t}}]),t}(),QN=function(){function t(e){NN(this,t),this.rings=e,this.polys=this._composePolys(e)}return kN(t,[{key:"getGeom",value:function(){for(var t=[],e=0,n=this.polys.length;e<n;e++){var i=this.polys[e].getGeom();null!==i&&t.push(i)}return t}},{key:"_composePolys",value:function(t){for(var e=[],n=0,i=t.length;n<i;n++){var r=t[n];if(!r.poly)if(r.isExteriorRing())e.push(new ZN(r));else{var s=r.enclosingRing();s.poly||e.push(new ZN(s)),s.poly.addInterior(r)}}return e}}]),t}(),KN=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:WN.compare;NN(this,t),this.queue=e,this.tree=new MN(n),this.segments=[]}return kN(t,[{key:"process",value:function(t){var e=t.segment,n=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(e),n;var i=t.isLeft?this.tree.insert(e):this.tree.find(e);if(!i)throw new Error("Unable to find segment #".concat(e.id," ")+"[".concat(e.leftSE.point.x,", ").concat(e.leftSE.point.y,"] -> ")+"[".concat(e.rightSE.point.x,", ").concat(e.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var r=i,s=i,o=void 0,a=void 0;void 0===o;)null===(r=this.tree.prev(r))?o=null:void 0===r.key.consumedBy&&(o=r.key);for(;void 0===a;)null===(s=this.tree.next(s))?a=null:void 0===s.key.consumedBy&&(a=s.key);if(t.isLeft){var l=null;if(o){var c=o.getIntersection(e);if(null!==c&&(e.isAnEndpoint(c)||(l=c),!o.isAnEndpoint(c)))for(var h=this._splitSafely(o,c),u=0,f=h.length;u<f;u++)n.push(h[u])}var d=null;if(a){var g=a.getIntersection(e);if(null!==g&&(e.isAnEndpoint(g)||(d=g),!a.isAnEndpoint(g)))for(var p=this._splitSafely(a,g),_=0,y=p.length;_<y;_++)n.push(p[_])}if(null!==l||null!==d){var m=null;if(null===l)m=d;else if(null===d)m=l;else{m=$N.comparePoints(l,d)<=0?l:d}this.queue.remove(e.rightSE),n.push(e.rightSE);for(var x=e.split(m),v=0,b=x.length;v<b;v++)n.push(x[v])}n.length>0?(this.tree.remove(e),n.push(t)):(this.segments.push(e),e.prev=o)}else{if(o&&a){var M=o.getIntersection(a);if(null!==M){if(!o.isAnEndpoint(M))for(var w=this._splitSafely(o,M),E=0,S=w.length;E<S;E++)n.push(w[E]);if(!a.isAnEndpoint(M))for(var N=this._splitSafely(a,M),I=0,k=N.length;I<k;I++)n.push(N[I])}}this.tree.remove(e)}return n}},{key:"_splitSafely",value:function(t,e){this.tree.remove(t);var n=t.rightSE;this.queue.remove(n);var i=t.split(e);return i.push(n),void 0===t.consumedBy&&this.tree.insert(t),i}}]),t}(),tI="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,eI="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,nI=new(function(){function t(){NN(this,t)}return kN(t,[{key:"run",value:function(t,e,n){nI.type=t,DN.reset();for(var i=[new HN(e,!0)],r=0,s=n.length;r<s;r++)i.push(new HN(n[r],!1));if(nI.numMultiPolys=i.length,"difference"===nI.type)for(var o=i[0],a=1;a<i.length;)null!==CN(i[a].bbox,o.bbox)?a++:i.splice(a,1);if("intersection"===nI.type)for(var l=0,c=i.length;l<c;l++)for(var h=i[l],u=l+1,f=i.length;u<f;u++)if(null===CN(h.bbox,i[u].bbox))return[];for(var d=new MN($N.compare),g=0,p=i.length;g<p;g++)for(var _=i[g].getSweepEvents(),y=0,m=_.length;y<m;y++)if(d.insert(_[y]),d.size>tI)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var x=new KN(d),v=d.size,b=d.pop();b;){var M=b.key;if(d.size===v){var w=M.segment;throw new Error("Unable to pop() ".concat(M.isLeft?"left":"right"," SweepEvent ")+"[".concat(M.point.x,", ").concat(M.point.y,"] from segment #").concat(w.id," ")+"[".concat(w.leftSE.point.x,", ").concat(w.leftSE.point.y,"] -> ")+"[".concat(w.rightSE.point.x,", ").concat(w.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(d.size>tI)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(x.segments.length>eI)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var E=x.process(M),S=0,N=E.length;S<N;S++){var I=E[S];void 0===I.consumedBy&&d.insert(I)}v=d.size,b=d.pop()}DN.reset();var k=JN.factory(x.segments);return new QN(k).getGeom()}}]),t}()),iI={union:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return nI.run("union",t,n)},intersection:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return nI.run("intersection",t,n)},xor:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return nI.run("xor",t,n)},difference:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return nI.run("difference",t,n)}},rI=iI;function sI(t,e,n,i,r){oI(t,e,n||0,i||t.length-1,r||lI)}function oI(t,e,n,i,r){for(;i>n;){if(i-n>600){var s=i-n+1,o=e-n+1,a=Math.log(s),l=.5*Math.exp(2*a/3),c=.5*Math.sqrt(a*l*(s-l)/s)*(o-s/2<0?-1:1);oI(t,e,Math.max(n,Math.floor(e-o*l/s+c)),Math.min(i,Math.floor(e+(s-o)*l/s+c)),r)}var h=t[e],u=n,f=i;for(aI(t,n,e),r(t[i],h)>0&&aI(t,n,i);u<f;){for(aI(t,u,f),u++,f--;r(t[u],h)<0;)u++;for(;r(t[f],h)>0;)f--}0===r(t[n],h)?aI(t,n,f):aI(t,++f,i),f<=e&&(n=f+1),e<=f&&(i=f-1)}}function aI(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function lI(t,e){return t<e?-1:t>e?1:0}class cI{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}all(){return this._all(this.data,[])}search(t){let e=this.data;const n=[];if(!bI(t,e))return n;const i=this.toBBox,r=[];for(;e;){for(let s=0;s<e.children.length;s++){const o=e.children[s],a=e.leaf?i(o):o;bI(t,a)&&(e.leaf?n.push(o):vI(t,a)?this._all(o,n):r.push(o))}e=r.pop()}return n}collides(t){let e=this.data;if(!bI(t,e))return!1;const n=[];for(;e;){for(let i=0;i<e.children.length;i++){const r=e.children[i],s=e.leaf?this.toBBox(r):r;if(bI(t,s)){if(e.leaf||vI(t,s))return!0;n.push(r)}}e=n.pop()}return!1}load(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(let e=0;e<t.length;e++)this.insert(t[e]);return this}let e=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){const t=this.data;this.data=e,e=t}this._insert(e,this.data.height-e.height-1,!0)}else this.data=e;return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=MI([]),this}remove(t,e){if(!t)return this;let n=this.data;const i=this.toBBox(t),r=[],s=[];let o,a,l;for(;n||r.length;){if(n||(n=r.pop(),a=r[r.length-1],o=s.pop(),l=!0),n.leaf){const i=hI(t,n.children,e);if(-1!==i)return n.children.splice(i,1),r.push(n),this._condense(r),this}l||n.leaf||!vI(n,i)?a?(o++,n=a.children[o],l=!1):n=null:(r.push(n),s.push(o),o=0,a=n,n=n.children[0])}return this}toBBox(t){return t}compareMinX(t,e){return t.minX-e.minX}compareMinY(t,e){return t.minY-e.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,e){const n=[];for(;t;)t.leaf?e.push(...t.children):n.push(...t.children),t=n.pop();return e}_build(t,e,n,i){const r=n-e+1;let s,o=this._maxEntries;if(r<=o)return s=MI(t.slice(e,n+1)),uI(s,this.toBBox),s;i||(i=Math.ceil(Math.log(r)/Math.log(o)),o=Math.ceil(r/Math.pow(o,i-1))),s=MI([]),s.leaf=!1,s.height=i;const a=Math.ceil(r/o),l=a*Math.ceil(Math.sqrt(o));wI(t,e,n,l,this.compareMinX);for(let r=e;r<=n;r+=l){const e=Math.min(r+l-1,n);wI(t,r,e,a,this.compareMinY);for(let n=r;n<=e;n+=a){const r=Math.min(n+a-1,e);s.children.push(this._build(t,n,r,i-1))}}return uI(s,this.toBBox),s}_chooseSubtree(t,e,n,i){for(;i.push(e),!e.leaf&&i.length-1!==n;){let n,i=1/0,r=1/0;for(let s=0;s<e.children.length;s++){const o=e.children[s],a=_I(o),l=mI(t,o)-a;l<r?(r=l,i=a<i?a:i,n=o):l===r&&a<i&&(i=a,n=o)}e=n||e.children[0]}return e}_insert(t,e,n){const i=n?t:this.toBBox(t),r=[],s=this._chooseSubtree(i,this.data,e,r);for(s.children.push(t),dI(s,i);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(i,r,e)}_split(t,e){const n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);const s=this._chooseSplitIndex(n,r,i),o=MI(n.children.splice(s,n.children.length-s));o.height=n.height,o.leaf=n.leaf,uI(n,this.toBBox),uI(o,this.toBBox),e?t[e-1].children.push(o):this._splitRoot(n,o)}_splitRoot(t,e){this.data=MI([t,e]),this.data.height=t.height+1,this.data.leaf=!1,uI(this.data,this.toBBox)}_chooseSplitIndex(t,e,n){let i,r=1/0,s=1/0;for(let o=e;o<=n-e;o++){const e=fI(t,0,o,this.toBBox),a=fI(t,o,n,this.toBBox),l=xI(e,a),c=_I(e)+_I(a);l<r?(r=l,i=o,s=c<s?c:s):l===r&&c<s&&(s=c,i=o)}return i||n-e}_chooseSplitAxis(t,e,n){const i=t.leaf?this.compareMinX:gI,r=t.leaf?this.compareMinY:pI;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)}_allDistMargin(t,e,n,i){t.children.sort(i);const r=this.toBBox,s=fI(t,0,e,r),o=fI(t,n-e,n,r);let a=yI(s)+yI(o);for(let i=e;i<n-e;i++){const e=t.children[i];dI(s,t.leaf?r(e):e),a+=yI(s)}for(let i=n-e-1;i>=e;i--){const e=t.children[i];dI(o,t.leaf?r(e):e),a+=yI(o)}return a}_adjustParentBBoxes(t,e,n){for(let i=n;i>=0;i--)dI(e[i],t)}_condense(t){for(let e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children,e.splice(e.indexOf(t[n]),1)):this.clear():uI(t[n],this.toBBox)}}function hI(t,e,n){if(!n)return e.indexOf(t);for(let i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function uI(t,e){fI(t,0,t.children.length,e,t)}function fI(t,e,n,i,r){r||(r=MI(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=e;s<n;s++){const e=t.children[s];dI(r,t.leaf?i(e):e)}return r}function dI(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function gI(t,e){return t.minX-e.minX}function pI(t,e){return t.minY-e.minY}function _I(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function yI(t){return t.maxX-t.minX+(t.maxY-t.minY)}function mI(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function xI(t,e){const n=Math.max(t.minX,e.minX),i=Math.max(t.minY,e.minY),r=Math.min(t.maxX,e.maxX),s=Math.min(t.maxY,e.maxY);return Math.max(0,r-n)*Math.max(0,s-i)}function vI(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function bI(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function MI(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function wI(t,e,n,i,r){const s=[e,n];for(;s.length;){if((n=s.pop())-(e=s.pop())<=i)continue;const o=e+Math.ceil((n-e)/i/2)*i;sI(t,o,e,n,r),s.push(e,o,o,n)}}const EI=Object.assign({},{booleanPointInPolygon:uN,intersect:function(t,e,n){void 0===n&&(n={});var i=hN(t),r=hN(e),s=rI.intersection(i.coordinates,r.coordinates);return 0===s.length?null:1===s.length?function(t,e,n){void 0===n&&(n={});for(var i=0,r=t;i<r.length;i++){var s=r[i];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var o=0;o<s[s.length-1].length;o++)if(s[s.length-1][o]!==s[0][o])throw new Error("First and last Position are not equivalent.")}return cN({type:"Polygon",coordinates:t},e,n)}(s[0],n.properties):function(t,e,n){return void 0===n&&(n={}),cN({type:"MultiPolygon",coordinates:t},e,n)}(s,n.properties)},bbox:gN}),SI=Object.assign({},{geoProject:jf,range:yt,rollup:z,ascending:e,blur2:f,sum:bt,mean:gt,flatGroup:D,geoPath:Mr});function NI({geojson:t,values:e=null,projection:n,width:i,height:r,step:s=20,output:o="dots",blur:a=0,keep:l=!1,operator:c="sum",geoprocessing:h="intersection"}={}){let u,f=function(t,e,n){let i=SI.range(0+t/2,e,t),r=SI.range(0+t/2,n,t).reverse();return{dots:i.map(((t,e)=>r.map((e=>[t,e])))).flat(),squares:i.map(((e,n)=>r.map((n=>[[e-t/2,n-t/2],[e+t/2,n-t/2],[e+t/2,n+t/2],[e-t/2,n+t/2],[e-t/2,n-t/2]])))).flat(),width:r.length,height:i.length}}(s,i,r),d=function(t){let e=!1;Array.isArray(t)&&2==t.length&&(e=!0);return e}(e),g=function(t,e){let n;n=null===e||null==e||Array.isArray(e)?null!==e&&Array.isArray(e)&&1==e.length?new Map(t.features.map(((t,n)=>[n,+t.properties[e[0]]]))):null!==e&&Array.isArray(e)&&2==e.length?[new Map(t.features.map(((t,n)=>[n,+t.properties[e[0]]]))),new Map(t.features.map(((t,n)=>[n,+t.properties[e[1]]])))]:new Map(t.features.map(((t,e)=>[e,1]))):new Map(t.features.map(((t,n)=>[n,+t.properties[e]])));return n}(t,e);return"p"==ry(t)&&(u=function(t,e,n,i,r,s){let o=SI.geoProject(t,i);o=o.features.map(((t,e)=>[e,t.geometry.coordinates]));let a=[];return e.squares.forEach((t=>{let e=[],i=[],l=[];o.forEach((s=>{EI.booleanPointInPolygon({type:"Point",coordinates:s[1]},{type:"Polygon",coordinates:[t]})&&(r?(i.push(n[0].get(s[0])),l.push(n[1].get(s[0]))):e.push(n.get(s[0])))})),r?a.push(SI.sum(i)/SI.sum(l)):"sum"==s?a.push(SI.sum(e)):a.push(SI.mean(e))})),a.map((t=>void 0===t?0:t))}(t,f,g,n,d,c)),"z"==ry(t)&&("dotinpoly"==h&&(u=function(t,e,n,i,r,s){const o=SI.geoProject(t,i);o.features.map((t=>SI.geoPath().area(t)));let a=[];e.dots.forEach(((t,e)=>{for(let n=0;n<o.features.length;n++)EI.booleanPointInPolygon({type:"Point",coordinates:t},o.features[n])&&(a.push([e,n]),n=o.features.length)}));let l=SI.rollup(a,(t=>t.length),(t=>t[1]));a=a.map((t=>{if("sum"==s){let e=null!=l.get(t[1])?l.get(t[1]):1;return r?[t[0],n[0].get(t[1])/e/(n[1].get(t[1])/e)]:[t[0],n.get(t[1])/e]}if(r){let e=null!=l.get(t[1])?l.get(t[1]):1;return[t[0],n[0].get(t[1])/e/(n[1].get(t[1])/e)]}return[t[0],n.get(t[1])]}));let c=new Map(a);return e.dots.map(((t,e)=>c.get(e))).map((t=>void 0===t||isNaN(t)?0:t))}(t,f,g,n,d,c)),"intersection"==h&&(u=function(t,e,n,i,r,s,o){const a=SI.geoProject(t,r),l=a.features.map((t=>SI.geoPath().area(t))),c=n*n,h=new cI;h.load(a.features.map(((t,e)=>{const n=II(t);return n.ix=e,n})));let u=[];e.squares.forEach(((t,e)=>{const n={type:"Polygon",coordinates:[t]};h.search(II(n)).forEach((t=>{const i=t.ix,r=a.features[i];let s=EI.intersect(r,n);if(null!==s){let t=SI.geoPath().area(s),n=l[i];u.push({id_square:e,id_poly:i,area_piece:t,area_poly:n,share:t/n,share2:t/c,feature:s})}}))}));let f=SI.flatGroup(u,(t=>t.id_square)),d=[];if(s)f.forEach((t=>{d.push([t[0],SI.sum(t[1].map((t=>t.share*i[0].get(t.id_poly))))/SI.sum(t[1].map((t=>t.share*i[1].get(t.id_poly))))])}));else{let t="sum"==o?"share":"share2";f.forEach((e=>{d.push([e[0],SI.sum(e[1].map((e=>e[t]*i.get(e.id_poly))))])}))}let g=new Map(d);return e.dots.map(((t,e)=>g.get(e))).map((t=>void 0===t?0:t))}(t,f,s,g,n,d,c))),a>0&&(u=function(t,e,n,i){return SI.blur2({data:t.map((t=>void 0===t?0:t)),width:n,height:i},e).data}(u,a,f.width,f.height)),function(t,e,n,i){let r=[];"dots"!=n&&"dot"!=n||e.dots.forEach(((e,n)=>{r.push({type:"Feature",properties:{id:n,value:t[n]},geometry:{type:"Point",coordinates:e}})}));"squares"!=n&&"square"!=n||e.squares.forEach(((e,n)=>{r.push({type:"Feature",properties:{id:n,value:t[n]},geometry:{type:"Polygon",coordinates:[e]}})}));return 1==i?{type:"FeatureCollection",features:r.sort(((t,e)=>SI.ascending(t.properties.value,e.properties.value)))}:{type:"FeatureCollection",features:r.filter((t=>t.properties.value>0)).sort(((t,e)=>SI.ascending(t.properties.value,e.properties.value)))}}(u,f,o,l)}const II=t=>{const e=EI.bbox(t);return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}};const kI=Object.assign({},{geoPath:Mr,max:rt,scaleLinear:lm,ascending:e,select:Oo});const OI=Object.assign({},{create:Co});function CI(t,e,n,i={},r){let s=i.style?i.style:"fit",o=i.margin?i.margin:0,a=i.d,l=i.rotate?i.rotate:0,c=i.fill?i.fill:"#4a4a4a",h=i.strokeLinecap?i.strokeLinecap:"round",u=i.strokeLinejoin?i.strokeLinejoin:"round",f=null!=i.strokeDasharray?i.strokeDasharray:"none",d=i.stroke?i.stroke:"#2e2e2e",g=null!=i.strokeWidth?i.strokeWidth:1,p=null!=i.fillOpacity?i.fillOpacity:1,_=null!=i.strokeOpacity?i.strokeOpacity:1,y=i.x?i.x:0,m=i.y?i.y:0,x=i.scale?i.scale:1,v=t.append("path").attr("d",a),b=function(t){const e=t.clone(!0),n=OI.create("svg");n.node().appendChild(e.node()),document.body.appendChild(n.node());const{x:i,y:r,width:s,height:o}=e.node().getBBox();return document.body.removeChild(n.node()),{x:i,y:r,width:s,height:o}}(v);v.remove(),Array.isArray(o)||(o=[o,o,o,o]);let M=t.append("g").attr("class",i.id).attr("data-layer",JSON.stringify({_type:"path"}));if("fit"==s&&M.append("path").attr("fill",c).attr("fill-opacity",p).attr("stroke-opacity",_).attr("stroke",d).attr("stroke-width",g).attr("stroke-linecap",h).attr("stroke-linejoin",u).attr("stroke-dasharray",f).attr("d",a).attr("transform",`translate(${y-b.x*x+o[3]},${m-b.y*x+o[0]})  scale(${x}) rotate(${l} ${b.x+b.width/2} ${b.y+b.height/2})`),"raw"==s&&M.append("path").attr("fill",c).attr("fill-opacity",p).attr("stroke-opacity",_).attr("stroke",d).attr("stroke-width",g).attr("stroke-linecap",h).attr("stroke-linejoin",u).attr("stroke-dasharray",f).attr("d",a).attr("transform",`translate(${y},${m}) scale(${x}) rotate(${l} ${b.x+b.width/2} ${b.y+b.height/2} )`),"repeat"==s){let t=e/(b.width*x+o[1]+o[3]),i=n/(b.height*x+o[0]+o[2]),s=M.attr("clip-path",null==r?"none":`url(#clip_${r})`);for(let e=0;e<=t;e++)for(let t=0;t<=i;t++)s.append("path").attr("fill",c).attr("fill-opacity",p).attr("stroke-opacity",_).attr("stroke",d).attr("stroke-width",g).attr("stroke-linecap",h).attr("stroke-linejoin",u).attr("stroke-dasharray",f).attr("d",a).attr("transform",`translate(${y+o[3]-b.x*x+e*(b.width*x+o[1]+o[3])},${m+o[0]-b.y*x+t*(b.height*x+o[0]+o[2])})  scale(${x}) rotate(${l} ${b.x+b.width/2} ${b.y+b.height/2})`)}}var AI=Array.prototype.slice;function TI(t,e){return t-e}var RI=t=>()=>t;function LI(t,e){for(var n,i=-1,r=e.length;++i<r;)if(n=PI(t,e[i]))return n;return 0}function PI(t,e){for(var n=e[0],i=e[1],r=-1,s=0,o=t.length,a=o-1;s<o;a=s++){var l=t[s],c=l[0],h=l[1],u=t[a],f=u[0],d=u[1];if(DI(l,u,e))return 0;h>i!=d>i&&n<(f-c)*(i-h)/(d-h)+c&&(r=-r)}return r}function DI(t,e,n){var i,r,s,o;return function(t,e,n){return(e[0]-t[0])*(n[1]-t[1])==(n[0]-t[0])*(e[1]-t[1])}(t,e,n)&&(r=t[i=+(t[0]===e[0])],s=n[i],o=e[i],r<=s&&s<=o||o<=s&&s<=r)}function zI(){}var FI=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function GI(){var t=1,e=1,n=nt,i=a;function r(t){var e=n(t);if(Array.isArray(e))e=e.slice().sort(TI);else{const n=E(t),i=tt(n[0],n[1],e);e=Q(Math.floor(n[0]/i)*i,Math.floor(n[1]/i-1)*i,e)}return e.map((e=>s(t,e)))}function s(n,r){var s=[],a=[];return function(n,i,r){var s,a,l,c,h,u,f=new Array,d=new Array;s=a=-1,c=n[0]>=i,FI[c<<1].forEach(g);for(;++s<t-1;)l=c,c=n[s+1]>=i,FI[l|c<<1].forEach(g);FI[c<<0].forEach(g);for(;++a<e-1;){for(s=-1,c=n[a*t+t]>=i,h=n[a*t]>=i,FI[c<<1|h<<2].forEach(g);++s<t-1;)l=c,c=n[a*t+t+s+1]>=i,u=h,h=n[a*t+s+1]>=i,FI[l|c<<1|h<<2|u<<3].forEach(g);FI[c|h<<3].forEach(g)}s=-1,h=n[a*t]>=i,FI[h<<2].forEach(g);for(;++s<t-1;)u=h,h=n[a*t+s+1]>=i,FI[h<<2|u<<3].forEach(g);function g(t){var e,n,i=[t[0][0]+s,t[0][1]+a],l=[t[1][0]+s,t[1][1]+a],c=o(i),h=o(l);(e=d[c])?(n=f[h])?(delete d[e.end],delete f[n.start],e===n?(e.ring.push(l),r(e.ring)):f[e.start]=d[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete d[e.end],e.ring.push(l),d[e.end=h]=e):(e=f[h])?(n=d[c])?(delete f[e.start],delete d[n.end],e===n?(e.ring.push(l),r(e.ring)):f[n.start]=d[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete f[e.start],e.ring.unshift(i),f[e.start=c]=e):f[c]=d[h]={start:c,end:h,ring:[i,l]}}FI[h<<3].forEach(g)}(n,r,(function(t){i(t,n,r),function(t){for(var e=0,n=t.length,i=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];++e<n;)i+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return i}(t)>0?s.push([t]):a.push(t)})),a.forEach((function(t){for(var e,n=0,i=s.length;n<i;++n)if(-1!==LI((e=s[n])[0],t))return void e.push(t)})),{type:"MultiPolygon",value:r,coordinates:s}}function o(e){return 2*e[0]+e[1]*(t+1)*4}function a(n,i,r){n.forEach((function(n){var s,o=n[0],a=n[1],l=0|o,c=0|a,h=i[c*t+l];o>0&&o<t&&l===o&&(s=i[c*t+l-1],n[0]=o+(r-s)/(h-s)-.5),a>0&&a<e&&c===a&&(s=i[(c-1)*t+l],n[1]=a+(r-s)/(h-s)-.5)}))}return r.contour=s,r.size=function(n){if(!arguments.length)return[t,e];var i=Math.floor(n[0]),s=Math.floor(n[1]);if(!(i>=0&&s>=0))throw new Error("invalid size");return t=i,e=s,r},r.thresholds=function(t){return arguments.length?(n="function"==typeof t?t:Array.isArray(t)?RI(AI.call(t)):RI(t),r):n},r.smooth=function(t){return arguments.length?(i=t?a:zI,r):i===a},r}function jI(t){return t[0]}function qI(t){return t[1]}function BI(){return 1}const YI=Object.assign({},BM,{sum:bt,contourDensity:function(){var t=jI,e=qI,n=BI,i=960,r=500,s=20,o=2,a=3*s,l=i+2*a>>o,c=r+2*a>>o,h=RI(20);function u(i){var r=new Float32Array(l*c),h=Math.pow(2,-o),u=-1;for(const s of i){var d=(t(s,++u,i)+a)*h,g=(e(s,u,i)+a)*h,p=+n(s,u,i);if(d>=0&&d<l&&g>=0&&g<c){var _=Math.floor(d),y=Math.floor(g),m=d-_-.5,x=g-y-.5;r[_+y*l]+=(1-m)*(1-x)*p,r[_+1+y*l]+=m*(1-x)*p,r[_+1+(y+1)*l]+=m*x*p,r[_+(y+1)*l]+=(1-m)*x*p}}return f({data:r,width:l,height:c},s*h),r}function d(t){var e=u(t),n=h(e),i=Math.pow(2,2*o);return Array.isArray(n)||(n=Q(Number.MIN_VALUE,rt(e)/i,n)),GI().size([l,c]).thresholds(n.map((t=>t*i)))(e).map(((t,e)=>(t.value=+n[e],g(t))))}function g(t){return t.coordinates.forEach(p),t}function p(t){t.forEach(_)}function _(t){t.forEach(y)}function y(t){t[0]=t[0]*Math.pow(2,o)-a,t[1]=t[1]*Math.pow(2,o)-a}function m(){return l=i+2*(a=3*s)>>o,c=r+2*a>>o,d}return d.contours=function(t){var e=u(t),n=GI().size([l,c]),i=Math.pow(2,2*o),r=t=>{t=+t;var r=g(n.contour(e,t*i));return r.value=t,r};return Object.defineProperty(r,"max",{get:()=>rt(e)/i}),r},d.x=function(e){return arguments.length?(t="function"==typeof e?e:RI(+e),d):t},d.y=function(t){return arguments.length?(e="function"==typeof t?t:RI(+t),d):e},d.weight=function(t){return arguments.length?(n="function"==typeof t?t:RI(+t),d):n},d.size=function(t){if(!arguments.length)return[i,r];var e=+t[0],n=+t[1];if(!(e>=0&&n>=0))throw new Error("invalid size");return i=e,r=n,m()},d.cellSize=function(t){if(!arguments.length)return 1<<o;if(!((t=+t)>=1))throw new Error("invalid cell size");return o=Math.floor(Math.log(t)/Math.LN2),m()},d.thresholds=function(t){return arguments.length?(h="function"==typeof t?t:Array.isArray(t)?RI(AI.call(t)):RI(t),d):h},d.bandwidth=function(t){if(!arguments.length)return Math.sqrt(s*(s+1));if(!((t=+t)>=0))throw new Error("invalid bandwidth");return s=(Math.sqrt(4*t*t+1)-1)/2,m()},d},geoIdentity:as,geoPath:Mr,scaleSequentialQuantile:sb});function $I(t={}){let e=t.geojson,n=t.values,i=t.nb?t.nb:1e3,r=t.projection,s=[];if(null==n)e.features.forEach((t=>{s.push(r(t.geometry.coordinates))}));else{let t,o=1;t=YI.sum(e.features.map((t=>t.properties[n]))),t>i&&(o=t/i),e.features.forEach((t=>{let e=r(t.geometry.coordinates),i=Math.round(t.properties[n]/o);for(let t=0;t<=i;t++)s.push(e)}))}return s}const UI=Object.assign({},{descending:n,max:rt,scaleSqrt:Sm,select:Oo,pointer:Po});const WI=Object.assign({},{geoPath:Mr});function XI(t,e){return t.interfaces_&&t.interfaces_.indexOf(e)>-1}class VI{constructor(t,e){this.low=e||0,this.high=t||0}static toBinaryString(t){let e,n="";for(e=2147483648;e>0;e>>>=1)n+=(t.high&e)===e?"1":"0";for(e=2147483648;e>0;e>>>=1)n+=(t.low&e)===e?"1":"0";return n}}function HI(){}function JI(){}HI.NaN=NaN,HI.isNaN=t=>Number.isNaN(t),HI.isInfinite=t=>!Number.isFinite(t),HI.MAX_VALUE=Number.MAX_VALUE,HI.POSITIVE_INFINITY=Number.POSITIVE_INFINITY,HI.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,"function"==typeof Float64Array&&"function"==typeof Int32Array?function(){const t=2146435072,e=new Float64Array(1),n=new Int32Array(e.buffer);HI.doubleToLongBits=function(i){e[0]=i;let r=0|n[0],s=0|n[1];return(s&t)===t&&0!=(1048575&s)&&0!==r&&(r=0,s=2146959360),new VI(s,r)},HI.longBitsToDouble=function(t){return n[0]=t.low,n[1]=t.high,e[0]}}():function(){const t=1023,e=Math.log2,n=Math.floor,i=Math.pow,r=function(){for(let t=53;t>0;t--){const r=i(2,t)-1;if(n(e(r))+1===t)return r}return 0}();HI.doubleToLongBits=function(s){let o,a,l,c,h,u,f,d,g;if(s<0||1/s===Number.NEGATIVE_INFINITY?(u=1<<31,s=-s):u=0,0===s)return g=0,d=u,new VI(d,g);if(s===1/0)return g=0,d=2146435072|u,new VI(d,g);if(s!=s)return g=0,d=2146959360,new VI(d,g);if(c=0,g=0,o=n(s),o>1)if(o<=r)c=n(e(o)),c<=20?(g=0,d=o<<20-c&1048575):(l=c-20,a=i(2,l),g=o%a<<32-l,d=o/a&1048575);else for(l=o,g=0;a=l/2,l=n(a),0!==l;)c++,g>>>=1,g|=(1&d)<<31,d>>>=1,a!==l&&(d|=524288);if(f=c+t,h=0===o,o=s-o,c<52&&0!==o)for(l=0;;){if(a=2*o,a>=1?(o=a-1,h?(f--,h=!1):(l<<=1,l|=1,c++)):(o=a,h?0==--f&&(c++,h=!1):(l<<=1,c++)),20===c)d|=l,l=0;else if(52===c){g|=l;break}if(1===a){c<20?d|=l<<20-c:c<52&&(g|=l<<52-c);break}}return d|=f<<20,d|=u,new VI(d,g)},HI.longBitsToDouble=function(e){let n,r,s,o;const a=e.high,l=e.low,c=a&1<<31?-1:1;for(s=((2146435072&a)>>20)-t,o=0,r=1<<19,n=1;n<=20;n++)a&r&&(o+=i(2,-n)),r>>>=1;for(r=1<<31,n=21;n<=52;n++)l&r&&(o+=i(2,-n)),r>>>=1;if(-1023===s){if(0===o)return 0*c;s=-1022}else{if(1024===s)return 0===o?c/0:NaN;o+=1}return c*o*i(2,s)}}();class ZI{getM(t){if(this.hasM()){const e=this.getDimension()-this.getMeasures();return this.getOrdinate(t,e)}return HI.NaN}setOrdinate(t,e,n){}getZ(t){return this.hasZ()?this.getOrdinate(t,2):HI.NaN}size(){}getOrdinate(t,e){}getCoordinate(){}getCoordinateCopy(t){}createCoordinate(){}getDimension(){}hasM(){return this.getMeasures()>0}getX(t){}hasZ(){return this.getDimension()-this.getMeasures()>2}getMeasures(){return 0}expandEnvelope(t){}copy(){}getY(t){}toCoordinateArray(){}get interfaces_(){return[JI]}}ZI.X=0,ZI.Y=1,ZI.Z=2,ZI.M=3;class QI{create(){if(1===arguments.length)arguments[0]instanceof Array||XI(arguments[0],ZI);else if(2===arguments.length);else if(3===arguments.length){const t=arguments[0],e=arguments[1];return this.create(t,e)}}}class KI extends Error{constructor(t){super(t),this.name=Object.keys({Exception:KI})[0]}toString(){return this.message}}class tk extends KI{constructor(t){super(t),this.name=Object.keys({IllegalArgumentException:tk})[0]}}class ek{filter(t){}}function nk(){}function ik(){}class rk{static equalsWithTolerance(t,e,n){return Math.abs(t-e)<=n}}function sk(){}class ok extends KI{constructor(t){super(t),this.name=Object.keys({RuntimeException:ok})[0]}}class ak extends ok{constructor(){super(),ak.constructor_.apply(this,arguments)}static constructor_(){if(0===arguments.length)ok.constructor_.call(this);else if(1===arguments.length){const t=arguments[0];ok.constructor_.call(this,t)}}}class lk{static shouldNeverReachHere(){if(0===arguments.length)lk.shouldNeverReachHere(null);else if(1===arguments.length){const t=arguments[0];throw new ak("Should never reach here"+(null!==t?": "+t:""))}}static isTrue(){if(1===arguments.length){const t=arguments[0];lk.isTrue(t,null)}else if(2===arguments.length){const t=arguments[1];if(!arguments[0])throw null===t?new ak:new ak(t)}}static equals(){if(2===arguments.length){const t=arguments[0],e=arguments[1];lk.equals(t,e,null)}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];if(!e.equals(t))throw new ak("Expected "+t+" but encountered "+e+(null!==n?": "+n:""))}}}const ck=new ArrayBuffer(8),hk=new Float64Array(ck),uk=new Int32Array(ck);class fk{constructor(){fk.constructor_.apply(this,arguments)}static constructor_(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)fk.constructor_.call(this,0,0);else if(1===arguments.length){const t=arguments[0];fk.constructor_.call(this,t.x,t.y,t.getZ())}else if(2===arguments.length){const t=arguments[0],e=arguments[1];fk.constructor_.call(this,t,e,fk.NULL_ORDINATE)}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this.x=t,this.y=e,this.z=n}}static hashCode(t){return hk[0]=t,uk[0]^uk[1]}getM(){return HI.NaN}setOrdinate(t,e){switch(t){case fk.X:this.x=e;break;case fk.Y:this.y=e;break;case fk.Z:this.setZ(e);break;default:throw new tk("Invalid ordinate index: "+t)}}equals2D(){if(1===arguments.length){const t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){const t=arguments[0],e=arguments[1];return!!rk.equalsWithTolerance(this.x,t.x,e)&&!!rk.equalsWithTolerance(this.y,t.y,e)}}setM(t){throw new tk("Invalid ordinate index: "+fk.M)}getZ(){return this.z}getOrdinate(t){switch(t){case fk.X:return this.x;case fk.Y:return this.y;case fk.Z:return this.getZ()}throw new tk("Invalid ordinate index: "+t)}equals3D(t){return this.x===t.x&&this.y===t.y&&(this.getZ()===t.getZ()||HI.isNaN(this.getZ())&&HI.isNaN(t.getZ()))}equals(t){return t instanceof fk&&this.equals2D(t)}equalInZ(t,e){return rk.equalsWithTolerance(this.getZ(),t.getZ(),e)}setX(t){this.x=t}compareTo(t){const e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0}getX(){return this.x}setZ(t){this.z=t}clone(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return lk.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw t}}copy(){return new fk(this)}toString(){return"("+this.x+", "+this.y+", "+this.getZ()+")"}distance3D(t){const e=this.x-t.x,n=this.y-t.y,i=this.getZ()-t.getZ();return Math.sqrt(e*e+n*n+i*i)}getY(){return this.y}setY(t){this.y=t}distance(t){const e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)}hashCode(){let t=17;return t=37*t+fk.hashCode(this.x),t=37*t+fk.hashCode(this.y),t}setCoordinate(t){this.x=t.x,this.y=t.y,this.z=t.getZ()}get interfaces_(){return[nk,JI,ik]}}class dk{constructor(){dk.constructor_.apply(this,arguments)}static constructor_(){if(this._dimensionsToTest=2,0===arguments.length)dk.constructor_.call(this,2);else if(1===arguments.length){const t=arguments[0];if(2!==t&&3!==t)throw new tk("only 2 or 3 dimensions may be specified");this._dimensionsToTest=t}}static compare(t,e){return t<e?-1:t>e?1:HI.isNaN(t)?HI.isNaN(e)?0:-1:HI.isNaN(e)?1:0}compare(t,e){const n=dk.compare(t.x,e.x);if(0!==n)return n;const i=dk.compare(t.y,e.y);if(0!==i)return i;if(this._dimensionsToTest<=2)return 0;return dk.compare(t.getZ(),e.getZ())}get interfaces_(){return[sk]}}fk.DimensionalComparator=dk,fk.NULL_ORDINATE=HI.NaN,fk.X=0,fk.Y=1,fk.Z=2,fk.M=3;class gk{constructor(){gk.constructor_.apply(this,arguments)}static constructor_(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof fk){const t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof gk){const t=arguments[0];this.init(t)}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.init(t.x,e.x,t.y,e.y)}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.init(t,e,n,i)}}static intersects(){if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];return n.x>=(t.x<e.x?t.x:e.x)&&n.x<=(t.x>e.x?t.x:e.x)&&n.y>=(t.y<e.y?t.y:e.y)&&n.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];let r=Math.min(n.x,i.x),s=Math.max(n.x,i.x),o=Math.min(t.x,e.x),a=Math.max(t.x,e.x);return!(o>s)&&(!(a<r)&&(r=Math.min(n.y,i.y),s=Math.max(n.y,i.y),o=Math.min(t.y,e.y),a=Math.max(t.y,e.y),!(o>s)&&!(a<r)))}}getArea(){return this.getWidth()*this.getHeight()}equals(t){if(!(t instanceof gk))return!1;const e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()}intersection(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new gk;const e=this._minx>t._minx?this._minx:t._minx,n=this._miny>t._miny?this._miny:t._miny,i=this._maxx<t._maxx?this._maxx:t._maxx,r=this._maxy<t._maxy?this._maxy:t._maxy;return new gk(e,i,n,r)}isNull(){return this._maxx<this._minx}getMaxX(){return this._maxx}covers(){if(1===arguments.length){if(arguments[0]instanceof fk){const t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof gk){const t=arguments[0];return!this.isNull()&&!t.isNull()&&(t.getMinX()>=this._minx&&t.getMaxX()<=this._maxx&&t.getMinY()>=this._miny&&t.getMaxY()<=this._maxy)}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];return!this.isNull()&&(t>=this._minx&&t<=this._maxx&&e>=this._miny&&e<=this._maxy)}}intersects(){if(1===arguments.length){if(arguments[0]instanceof gk){const t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof fk){const t=arguments[0];return this.intersects(t.x,t.y)}}else if(2===arguments.length){if(arguments[0]instanceof fk&&arguments[1]instanceof fk){const t=arguments[0],e=arguments[1];if(this.isNull())return!1;if((t.x<e.x?t.x:e.x)>this._maxx)return!1;if((t.x>e.x?t.x:e.x)<this._minx)return!1;if((t.y<e.y?t.y:e.y)>this._maxy)return!1;return!((t.y>e.y?t.y:e.y)<this._miny)}if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1];return!this.isNull()&&!(t>this._maxx||t<this._minx||e>this._maxy||e<this._miny)}}}getMinY(){return this._miny}getDiameter(){if(this.isNull())return 0;const t=this.getWidth(),e=this.getHeight();return Math.sqrt(t*t+e*e)}getMinX(){return this._minx}expandToInclude(){if(1===arguments.length){if(arguments[0]instanceof fk){const t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof gk){const t=arguments[0];if(t.isNull())return null;this.isNull()?(this._minx=t.getMinX(),this._maxx=t.getMaxX(),this._miny=t.getMinY(),this._maxy=t.getMaxY()):(t._minx<this._minx&&(this._minx=t._minx),t._maxx>this._maxx&&(this._maxx=t._maxx),t._miny<this._miny&&(this._miny=t._miny),t._maxy>this._maxy&&(this._maxy=t._maxy))}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.isNull()?(this._minx=t,this._maxx=t,this._miny=e,this._maxy=e):(t<this._minx&&(this._minx=t),t>this._maxx&&(this._maxx=t),e<this._miny&&(this._miny=e),e>this._maxy&&(this._maxy=e))}}minExtent(){if(this.isNull())return 0;const t=this.getWidth(),e=this.getHeight();return t<e?t:e}getWidth(){return this.isNull()?0:this._maxx-this._minx}compareTo(t){const e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0}translate(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)}copy(){return new gk(this)}toString(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}setToNull(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}disjoint(t){return!(!this.isNull()&&!t.isNull())||(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}getHeight(){return this.isNull()?0:this._maxy-this._miny}maxExtent(){if(this.isNull())return 0;const t=this.getWidth(),e=this.getHeight();return t>e?t:e}expandBy(){if(1===arguments.length){const t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];if(this.isNull())return null;this._minx-=t,this._maxx+=t,this._miny-=e,this._maxy+=e,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}contains(){if(1===arguments.length){if(arguments[0]instanceof gk){const t=arguments[0];return this.covers(t)}if(arguments[0]instanceof fk){const t=arguments[0];return this.covers(t)}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];return this.covers(t,e)}}centre(){return this.isNull()?null:new fk((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}init(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof fk){const t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof gk){const t=arguments[0];this._minx=t._minx,this._maxx=t._maxx,this._miny=t._miny,this._maxy=t._maxy}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.init(t.x,e.x,t.y,e.y)}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];t<e?(this._minx=t,this._maxx=e):(this._minx=e,this._maxx=t),n<i?(this._miny=n,this._maxy=i):(this._miny=i,this._maxy=n)}}getMaxY(){return this._maxy}distance(t){if(this.intersects(t))return 0;let e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);let n=0;return this._maxy<t._miny?n=t._miny-this._maxy:this._miny>t._maxy&&(n=this._miny-t._maxy),0===e?n:0===n?e:Math.sqrt(e*e+n*n)}hashCode(){let t=17;return t=37*t+fk.hashCode(this._minx),t=37*t+fk.hashCode(this._maxx),t=37*t+fk.hashCode(this._miny),t=37*t+fk.hashCode(this._maxy),t}get interfaces_(){return[nk,ik]}}class pk{constructor(){pk.constructor_.apply(this,arguments)}isGeometryCollection(){return this.getTypeCode()===pk.TYPECODE_GEOMETRYCOLLECTION}getFactory(){return this._factory}getGeometryN(t){return this}getArea(){return 0}isRectangle(){return!1}equalsExact(t){return this===t||this.equalsExact(t,0)}geometryChanged(){this.apply(pk.geometryChangedFilter)}geometryChangedAction(){this._envelope=null}equalsNorm(t){return null!==t&&this.norm().equalsExact(t.norm())}getLength(){return 0}getNumGeometries(){return 1}compareTo(){let t;if(1===arguments.length){const e=arguments[0];return t=e,this.getTypeCode()!==t.getTypeCode()?this.getTypeCode()-t.getTypeCode():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(e)}if(2===arguments.length){const e=arguments[0],n=arguments[1];return t=e,this.getTypeCode()!==t.getTypeCode()?this.getTypeCode()-t.getTypeCode():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(e,n)}}getUserData(){return this._userData}getSRID(){return this._SRID}getEnvelope(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}static checkNotGeometryCollection(t){if(t.getTypeCode()===pk.TYPECODE_GEOMETRYCOLLECTION)throw new tk("This method does not support GeometryCollection arguments")}equal(t,e,n){return 0===n?t.equals(e):t.distance(e)<=n}norm(){const t=this.copy();return t.normalize(),t}reverse(){const t=this.reverseInternal();return null!=this.envelope&&(t.envelope=this.envelope.copy()),t.setSRID(this.getSRID()),t}copy(){const t=this.copyInternal();return t.envelope=null==this._envelope?null:this._envelope.copy(),t._SRID=this._SRID,t._userData=this._userData,t}getPrecisionModel(){return this._factory.getPrecisionModel()}getEnvelopeInternal(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new gk(this._envelope)}setSRID(t){this._SRID=t}setUserData(t){this._userData=t}compare(t,e){const n=t.iterator(),i=e.iterator();for(;n.hasNext()&&i.hasNext();){const t=n.next(),e=i.next(),r=t.compareTo(e);if(0!==r)return r}return n.hasNext()?1:i.hasNext()?-1:0}hashCode(){return this.getEnvelopeInternal().hashCode()}isEquivalentClass(t){return this.getTypeCode()==t.getTypeCode()}get interfaces_(){return[JI,nk,ik]}getClass(){return pk}static hasNonEmptyElements(t){for(let e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1}static hasNullElements(t){for(let e=0;e<t.length;e++)if(null===t[e])return!0;return!1}}pk.constructor_=function(t){t&&(this._envelope=null,this._userData=null,this._factory=t,this._SRID=t.getSRID())},pk.TYPECODE_POINT=0,pk.TYPECODE_MULTIPOINT=1,pk.TYPECODE_LINESTRING=2,pk.TYPECODE_LINEARRING=3,pk.TYPECODE_MULTILINESTRING=4,pk.TYPECODE_POLYGON=5,pk.TYPECODE_MULTIPOLYGON=6,pk.TYPECODE_GEOMETRYCOLLECTION=7,pk.TYPENAME_POINT="Point",pk.TYPENAME_MULTIPOINT="MultiPoint",pk.TYPENAME_LINESTRING="LineString",pk.TYPENAME_LINEARRING="LinearRing",pk.TYPENAME_MULTILINESTRING="MultiLineString",pk.TYPENAME_POLYGON="Polygon",pk.TYPENAME_MULTIPOLYGON="MultiPolygon",pk.TYPENAME_GEOMETRYCOLLECTION="GeometryCollection",pk.geometryChangedFilter={get interfaces_(){return[ek]},filter(t){t.geometryChangedAction()}};class _k{filter(t){}}class yk{static ofLine(t){const e=t.size();if(e<=1)return 0;let n=0;const i=new fk;t.getCoordinate(0,i);let r=i.x,s=i.y;for(let o=1;o<e;o++){t.getCoordinate(o,i);const e=i.x,a=i.y,l=e-r,c=a-s;n+=Math.sqrt(l*l+c*c),r=e,s=a}return n}}class mk{}class xk{static copyCoord(t,e,n,i){const r=Math.min(t.getDimension(),n.getDimension());for(let s=0;s<r;s++)n.setOrdinate(i,s,t.getOrdinate(e,s))}static isRing(t){const e=t.size();return 0===e||!(e<=3)&&(t.getOrdinate(0,ZI.X)===t.getOrdinate(e-1,ZI.X)&&t.getOrdinate(0,ZI.Y)===t.getOrdinate(e-1,ZI.Y))}static scroll(){if(2===arguments.length){if(XI(arguments[0],ZI)&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1];xk.scroll(t,e,xk.isRing(t))}else if(XI(arguments[0],ZI)&&arguments[1]instanceof fk){const t=arguments[0],e=arguments[1],n=xk.indexOf(e,t);if(n<=0)return null;xk.scroll(t,n)}}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];if(e<=0)return null;const i=t.copy(),r=n?t.size()-1:t.size();for(let n=0;n<r;n++)for(let s=0;s<t.getDimension();s++)t.setOrdinate(n,s,i.getOrdinate((e+n)%r,s));if(n)for(let e=0;e<t.getDimension();e++)t.setOrdinate(r,e,t.getOrdinate(0,e))}}static isEqual(t,e){const n=t.size();if(n!==e.size())return!1;const i=Math.min(t.getDimension(),e.getDimension());for(let r=0;r<n;r++)for(let n=0;n<i;n++){const i=t.getOrdinate(r,n),s=e.getOrdinate(r,n);if(t.getOrdinate(r,n)!==e.getOrdinate(r,n)&&(!HI.isNaN(i)||!HI.isNaN(s)))return!1}return!0}static minCoordinateIndex(){if(1===arguments.length){const t=arguments[0];return xk.minCoordinateIndex(t,0,t.size()-1)}if(3===arguments.length){const t=arguments[0],e=arguments[2];let n=-1,i=null;for(let r=arguments[1];r<=e;r++){const e=t.getCoordinate(r);(null===i||i.compareTo(e)>0)&&(i=e,n=r)}return n}}static extend(t,e,n){const i=t.create(n,e.getDimension()),r=e.size();if(xk.copy(e,0,i,0,r),r>0)for(let t=r;t<n;t++)xk.copy(e,r-1,i,t,1);return i}static reverse(t){const e=t.size()-1,n=Math.trunc(e/2);for(let i=0;i<=n;i++)xk.swap(t,i,e-i)}static swap(t,e,n){if(e===n)return null;for(let i=0;i<t.getDimension();i++){const r=t.getOrdinate(e,i);t.setOrdinate(e,i,t.getOrdinate(n,i)),t.setOrdinate(n,i,r)}}static copy(t,e,n,i,r){for(let s=0;s<r;s++)xk.copyCoord(t,e+s,n,i+s)}static ensureValidRing(t,e){const n=e.size();if(0===n)return e;if(n<=3)return xk.createClosedRing(t,e,4);return e.getOrdinate(0,ZI.X)===e.getOrdinate(n-1,ZI.X)&&e.getOrdinate(0,ZI.Y)===e.getOrdinate(n-1,ZI.Y)?e:xk.createClosedRing(t,e,n+1)}static indexOf(t,e){for(let n=0;n<e.size();n++)if(t.x===e.getOrdinate(n,ZI.X)&&t.y===e.getOrdinate(n,ZI.Y))return n;return-1}static createClosedRing(t,e,n){const i=t.create(n,e.getDimension()),r=e.size();xk.copy(e,0,i,0,r);for(let t=r;t<n;t++)xk.copy(e,0,i,t,1);return i}static minCoordinate(t){let e=null;for(let n=0;n<t.size();n++){const i=t.getCoordinate(n);(null===e||e.compareTo(i)>0)&&(e=i)}return e}}class vk extends KI{constructor(t){super(t),this.name=Object.keys({UnsupportedOperationException:vk})[0]}}class bk{static isWhitespace(t){return t<=32&&t>=0||127===t}static toUpperCase(t){return t.toUpperCase()}}class Mk{static toDimensionSymbol(t){switch(t){case Mk.FALSE:return Mk.SYM_FALSE;case Mk.TRUE:return Mk.SYM_TRUE;case Mk.DONTCARE:return Mk.SYM_DONTCARE;case Mk.P:return Mk.SYM_P;case Mk.L:return Mk.SYM_L;case Mk.A:return Mk.SYM_A}throw new tk("Unknown dimension value: "+t)}static toDimensionValue(t){switch(bk.toUpperCase(t)){case Mk.SYM_FALSE:return Mk.FALSE;case Mk.SYM_TRUE:return Mk.TRUE;case Mk.SYM_DONTCARE:return Mk.DONTCARE;case Mk.SYM_P:return Mk.P;case Mk.SYM_L:return Mk.L;case Mk.SYM_A:return Mk.A}throw new tk("Unknown dimension symbol: "+t)}}Mk.P=0,Mk.L=1,Mk.A=2,Mk.FALSE=-1,Mk.TRUE=-2,Mk.DONTCARE=-3,Mk.SYM_FALSE="F",Mk.SYM_TRUE="T",Mk.SYM_DONTCARE="*",Mk.SYM_P="0",Mk.SYM_L="1",Mk.SYM_A="2";class wk{filter(t){}}class Ek{filter(t,e){}isDone(){}isGeometryChanged(){}}class Sk extends pk{constructor(){super(),Sk.constructor_.apply(this,arguments)}static constructor_(){if(this._points=null,0===arguments.length);else if(2===arguments.length){const t=arguments[0],e=arguments[1];pk.constructor_.call(this,e),this.init(t)}}computeEnvelopeInternal(){return this.isEmpty()?new gk:this._points.expandEnvelope(new gk)}isRing(){return this.isClosed()&&this.isSimple()}getCoordinates(){return this._points.toCoordinateArray()}copyInternal(){return new Sk(this._points.copy(),this._factory)}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof pk){const t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;const n=t;if(this._points.size()!==n._points.size())return!1;for(let t=0;t<this._points.size();t++)if(!this.equal(this._points.getCoordinate(t),n._points.getCoordinate(t),e))return!1;return!0}return super.equalsExact.apply(this,arguments)}normalize(){for(let t=0;t<Math.trunc(this._points.size()/2);t++){const e=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(e))){if(this._points.getCoordinate(t).compareTo(this._points.getCoordinate(e))>0){const t=this._points.copy();xk.reverse(t),this._points=t}return null}}}getCoordinate(){return this.isEmpty()?null:this._points.getCoordinate(0)}getBoundaryDimension(){return this.isClosed()?Mk.FALSE:0}isClosed(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}reverseInternal(){const t=this._points.copy();return xk.reverse(t),this.getFactory().createLineString(t)}getEndPoint(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}getTypeCode(){return pk.TYPECODE_LINESTRING}getDimension(){return 1}getLength(){return yk.ofLine(this._points)}getNumPoints(){return this._points.size()}compareToSameClass(){if(1===arguments.length){const t=arguments[0];let e=0,n=0;for(;e<this._points.size()&&n<t._points.size();){const i=this._points.getCoordinate(e).compareTo(t._points.getCoordinate(n));if(0!==i)return i;e++,n++}return e<this._points.size()?1:n<t._points.size()?-1:0}if(2===arguments.length){const t=arguments[0];return arguments[1].compare(this._points,t._points)}}apply(){if(XI(arguments[0],_k)){const t=arguments[0];for(let e=0;e<this._points.size();e++)t.filter(this._points.getCoordinate(e))}else if(XI(arguments[0],Ek)){const t=arguments[0];if(0===this._points.size())return null;for(let e=0;e<this._points.size()&&(t.filter(this._points,e),!t.isDone());e++);t.isGeometryChanged()&&this.geometryChanged()}else if(XI(arguments[0],wk)){arguments[0].filter(this)}else if(XI(arguments[0],ek)){arguments[0].filter(this)}}getBoundary(){throw new vk}isEquivalentClass(t){return t instanceof Sk}getCoordinateN(t){return this._points.getCoordinate(t)}getGeometryType(){return pk.TYPENAME_LINESTRING}getCoordinateSequence(){return this._points}isEmpty(){return 0===this._points.size()}init(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new tk("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t}isCoordinate(t){for(let e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1}getStartPoint(){return this.isEmpty()?null:this.getPointN(0)}getPointN(t){return this.getFactory().createPoint(this._points.getCoordinate(t))}get interfaces_(){return[mk]}}class Nk{}class Ik extends KI{constructor(t){super(t),this.name=Object.keys({IllegalStateException:Ik})[0]}}class kk extends pk{constructor(){super(),kk.constructor_.apply(this,arguments)}static constructor_(){this._coordinates=null;const t=arguments[0],e=arguments[1];pk.constructor_.call(this,e),this.init(t)}computeEnvelopeInternal(){if(this.isEmpty())return new gk;const t=new gk;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t}getCoordinates(){return this.isEmpty()?[]:[this.getCoordinate()]}copyInternal(){return new kk(this._coordinates.copy(),this._factory)}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof pk){const t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&(!(!this.isEmpty()||!t.isEmpty())||this.isEmpty()===t.isEmpty()&&this.equal(t.getCoordinate(),this.getCoordinate(),e))}return super.equalsExact.apply(this,arguments)}normalize(){}getCoordinate(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null}getBoundaryDimension(){return Mk.FALSE}reverseInternal(){return this.getFactory().createPoint(this._coordinates.copy())}getTypeCode(){return pk.TYPECODE_POINT}getDimension(){return 0}getNumPoints(){return this.isEmpty()?0:1}getX(){if(null===this.getCoordinate())throw new Ik("getX called on empty Point");return this.getCoordinate().x}compareToSameClass(){if(1===arguments.length){const t=arguments[0];return this.getCoordinate().compareTo(t.getCoordinate())}if(2===arguments.length){const t=arguments[0];return arguments[1].compare(this._coordinates,t._coordinates)}}apply(){if(XI(arguments[0],_k)){const t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(XI(arguments[0],Ek)){const t=arguments[0];if(this.isEmpty())return null;t.filter(this._coordinates,0),t.isGeometryChanged()&&this.geometryChanged()}else if(XI(arguments[0],wk)){arguments[0].filter(this)}else if(XI(arguments[0],ek)){arguments[0].filter(this)}}getBoundary(){return this.getFactory().createGeometryCollection()}getGeometryType(){return pk.TYPENAME_POINT}getCoordinateSequence(){return this._coordinates}getY(){if(null===this.getCoordinate())throw new Ik("getY called on empty Point");return this.getCoordinate().y}isEmpty(){return 0===this._coordinates.size()}init(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),lk.isTrue(t.size()<=1),this._coordinates=t}isSimple(){return!0}get interfaces_(){return[Nk]}}class Ok{static ofRing(){if(arguments[0]instanceof Array){const t=arguments[0];return Math.abs(Ok.ofRingSigned(t))}if(XI(arguments[0],ZI)){const t=arguments[0];return Math.abs(Ok.ofRingSigned(t))}}static ofRingSigned(){if(arguments[0]instanceof Array){const t=arguments[0];if(t.length<3)return 0;let e=0;const n=t[0].x;for(let i=1;i<t.length-1;i++){const r=t[i].x-n,s=t[i+1].y;e+=r*(t[i-1].y-s)}return e/2}if(XI(arguments[0],ZI)){const t=arguments[0],e=t.size();if(e<3)return 0;const n=new fk,i=new fk,r=new fk;t.getCoordinate(0,i),t.getCoordinate(1,r);const s=i.x;r.x-=s;let o=0;for(let a=1;a<e-1;a++)n.y=i.y,i.x=r.x,i.y=r.y,t.getCoordinate(a+1,r),r.x-=s,o+=i.x*(n.y-r.y);return o/2}}}class Ck{add(){}addAll(){}isEmpty(){}iterator(){}size(){}toArray(){}remove(){}}class Ak extends KI{constructor(t){super(t),this.name=Object.keys({IndexOutOfBoundsException:Ak})[0]}}class Tk extends Ck{get(){}set(){}isEmpty(){}}class Rk extends KI{constructor(t){super(t),this.name=Object.keys({NoSuchElementException:Rk})[0]}}class Lk extends Tk{constructor(t){super(),this.array=[],t instanceof Ck&&this.addAll(t)}get interfaces_(){return[Tk,Ck]}ensureCapacity(){}add(t){return 1===arguments.length?this.array.push(t):this.array.splice(arguments[0],0,arguments[1]),!0}clear(){this.array=[]}addAll(t){for(const e of t)this.array.push(e)}set(t,e){const n=this.array[t];return this.array[t]=e,n}iterator(){return new Pk(this)}get(t){if(t<0||t>=this.size())throw new Ak;return this.array[t]}isEmpty(){return 0===this.array.length}sort(t){t?this.array.sort(((e,n)=>t.compare(e,n))):this.array.sort()}size(){return this.array.length}toArray(){return this.array.slice()}remove(t){for(let e=0,n=this.array.length;e<n;e++)if(this.array[e]===t)return!!this.array.splice(e,1);return!1}[Symbol.iterator](){return this.array.values()}}class Pk{constructor(t){this.arrayList=t,this.position=0}next(){if(this.position===this.arrayList.size())throw new Rk;return this.arrayList.get(this.position++)}hasNext(){return this.position<this.arrayList.size()}set(t){return this.arrayList.set(this.position-1,t)}remove(){this.arrayList.remove(this.arrayList.get(this.position))}}class Dk{static sort(){const t=arguments[0];if(1===arguments.length)t.sort(((t,e)=>t.compareTo(e)));else if(2===arguments.length)t.sort(((t,e)=>arguments[1].compare(t,e)));else if(3===arguments.length){const e=t.slice(arguments[1],arguments[2]);e.sort();const n=t.slice(0,arguments[1]).concat(e,t.slice(arguments[2],t.length));t.splice(0,t.length);for(const e of n)t.push(e)}else if(4===arguments.length){const e=t.slice(arguments[1],arguments[2]);e.sort(((t,e)=>arguments[3].compare(t,e)));const n=t.slice(0,arguments[1]).concat(e,t.slice(arguments[2],t.length));t.splice(0,t.length);for(const e of n)t.push(e)}}static asList(t){const e=new Lk;for(const n of t)e.add(n);return e}static copyOf(t,e){return t.slice(0,e)}}class zk{constructor(t){this.str=t}append(t){this.str+=t}setCharAt(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)}toString(){return this.str}}class Fk{constructor(t){this.value=t}intValue(){return this.value}compareTo(t){return this.value<t?-1:this.value>t?1:0}static compare(t,e){return t<e?-1:t>e?1:0}static isNan(t){return Number.isNaN(t)}static valueOf(t){return new Fk(t)}}class Gk{constructor(){Gk.constructor_.apply(this,arguments)}static constructor_(){if(this._hi=0,this._lo=0,0===arguments.length)this.init(0);else if(1===arguments.length){if("number"==typeof arguments[0]){const t=arguments[0];this.init(t)}else if(arguments[0]instanceof Gk){const t=arguments[0];this.init(t)}else if("string"==typeof arguments[0]){const t=arguments[0];Gk.constructor_.call(this,Gk.parse(t))}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.init(t,e)}}static determinant(){if("number"==typeof arguments[3]&&"number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];return Gk.determinant(Gk.valueOf(t),Gk.valueOf(e),Gk.valueOf(n),Gk.valueOf(i))}if(arguments[3]instanceof Gk&&arguments[2]instanceof Gk&&arguments[0]instanceof Gk&&arguments[1]instanceof Gk){const t=arguments[1],e=arguments[2],n=arguments[3];return arguments[0].multiply(n).selfSubtract(t.multiply(e))}}static sqr(t){return Gk.valueOf(t).selfMultiply(t)}static valueOf(){if("string"==typeof arguments[0]){const t=arguments[0];return Gk.parse(t)}if("number"==typeof arguments[0]){return new Gk(arguments[0])}}static sqrt(t){return Gk.valueOf(t).sqrt()}static parse(t){let e=0;const n=t.length;for(;bk.isWhitespace(t.charAt(e));)e++;let i=!1;if(e<n){const n=t.charAt(e);"-"!==n&&"+"!==n||(e++,"-"===n&&(i=!0))}const r=new Gk;let s=0,o=0,a=0,l=!1;for(;!(e>=n);){const n=t.charAt(e);if(e++,bk.isDigit(n)){const t=n-"0";r.selfMultiply(Gk.TEN),r.selfAdd(t),s++}else{if("."!==n){if("e"===n||"E"===n){const n=t.substring(e);try{a=Fk.parseInt(n)}catch(e){throw e instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+n+" in string "+t):e}break}throw new NumberFormatException("Unexpected character '"+n+"' at position "+e+" in string "+t)}o=s,l=!0}}let c=r;l||(o=s);const h=s-o-a;if(0===h)c=r;else if(h>0){const t=Gk.TEN.pow(h);c=r.divide(t)}else if(h<0){const t=Gk.TEN.pow(-h);c=r.multiply(t)}return i?c.negate():c}static createNaN(){return new Gk(HI.NaN,HI.NaN)}static copy(t){return new Gk(t)}static magnitude(t){const e=Math.abs(t),n=Math.log(e)/Math.log(10);let i=Math.trunc(Math.floor(n));return 10*Math.pow(10,i)<=e&&(i+=1),i}static stringOfChar(t,e){const n=new zk;for(let i=0;i<e;i++)n.append(t);return n.toString()}le(t){return this._hi<t._hi||this._hi===t._hi&&this._lo<=t._lo}extractSignificantDigits(t,e){let n=this.abs(),i=Gk.magnitude(n._hi);const r=Gk.TEN.pow(i);n=n.divide(r),n.gt(Gk.TEN)?(n=n.divide(Gk.TEN),i+=1):n.lt(Gk.ONE)&&(n=n.multiply(Gk.TEN),i-=1);const s=i+1,o=new zk,a=Gk.MAX_PRINT_DIGITS-1;for(let e=0;e<=a;e++){t&&e===s&&o.append(".");const i=Math.trunc(n._hi);if(i<0)break;let r=!1,l=0;i>9?(r=!0,l="9"):l="0"+i,o.append(l),n=n.subtract(Gk.valueOf(i)).multiply(Gk.TEN),r&&n.selfAdd(Gk.TEN);let c=!0;const h=Gk.magnitude(n._hi);if(h<0&&Math.abs(h)>=a-e&&(c=!1),!c)break}return e[0]=i,o.toString()}sqr(){return this.multiply(this)}doubleValue(){return this._hi+this._lo}subtract(){if(arguments[0]instanceof Gk){const t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){const t=arguments[0];return this.add(-t)}}equals(){if(1===arguments.length&&arguments[0]instanceof Gk){const t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}}isZero(){return 0===this._hi&&0===this._lo}selfSubtract(){if(arguments[0]instanceof Gk){const t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if("number"==typeof arguments[0]){const t=arguments[0];return this.isNaN()?this:this.selfAdd(-t,0)}}getSpecialNumberString(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}min(t){return this.le(t)?this:t}selfDivide(){if(1===arguments.length){if(arguments[0]instanceof Gk){const t=arguments[0];return this.selfDivide(t._hi,t._lo)}if("number"==typeof arguments[0]){const t=arguments[0];return this.selfDivide(t,0)}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];let n=null,i=null,r=null,s=null,o=null,a=null,l=null,c=null;return o=this._hi/t,a=Gk.SPLIT*o,n=a-o,c=Gk.SPLIT*t,n=a-n,i=o-n,r=c-t,l=o*t,r=c-r,s=t-r,c=n*r-l+n*s+i*r+i*s,a=(this._hi-l-c+this._lo-o*e)/t,c=o+a,this._hi=c,this._lo=o-c+a,this}}dump(){return"DD<"+this._hi+", "+this._lo+">"}divide(){if(arguments[0]instanceof Gk){const t=arguments[0];let e=null,n=null,i=null,r=null,s=null,o=null,a=null,l=null;s=this._hi/t._hi,o=Gk.SPLIT*s,e=o-s,l=Gk.SPLIT*t._hi,e=o-e,n=s-e,i=l-t._hi,a=s*t._hi,i=l-i,r=t._hi-i,l=e*i-a+e*r+n*i+n*r,o=(this._hi-a-l+this._lo-s*t._lo)/t._hi,l=s+o;return new Gk(l,s-l+o)}if("number"==typeof arguments[0]){const t=arguments[0];return HI.isNaN(t)?Gk.createNaN():Gk.copy(this).selfDivide(t,0)}}ge(t){return this._hi>t._hi||this._hi===t._hi&&this._lo>=t._lo}pow(t){if(0===t)return Gk.valueOf(1);let e=new Gk(this),n=Gk.valueOf(1),i=Math.abs(t);if(i>1)for(;i>0;)i%2==1&&n.selfMultiply(e),i/=2,i>0&&(e=e.sqr());else n=e;return t<0?n.reciprocal():n}ceil(){if(this.isNaN())return Gk.NaN;const t=Math.ceil(this._hi);let e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new Gk(t,e)}compareTo(t){const e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0}rint(){if(this.isNaN())return this;return this.add(.5).floor()}setValue(){if(arguments[0]instanceof Gk){const t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){const t=arguments[0];return this.init(t),this}}max(t){return this.ge(t)?this:t}sqrt(){if(this.isZero())return Gk.valueOf(0);if(this.isNegative())return Gk.NaN;const t=1/Math.sqrt(this._hi),e=this._hi*t,n=Gk.valueOf(e),i=this.subtract(n.sqr())._hi*(.5*t);return n.add(i)}selfAdd(){if(1===arguments.length){if(arguments[0]instanceof Gk){const t=arguments[0];return this.selfAdd(t._hi,t._lo)}if("number"==typeof arguments[0]){const t=arguments[0];let e=null,n=null,i=null,r=null,s=null,o=null;return i=this._hi+t,s=i-this._hi,r=i-s,r=t-s+(this._hi-r),o=r+this._lo,e=i+o,n=o+(i-e),this._hi=e+n,this._lo=n+(e-this._hi),this}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];let n=null,i=null,r=null,s=null,o=null,a=null,l=null,c=null;o=this._hi+t,r=this._lo+e,l=o-this._hi,c=r-this._lo,a=o-l,s=r-c,a=t-l+(this._hi-a),s=e-c+(this._lo-s),l=a+r,n=o+l,i=l+(o-n),l=s+i;const h=n+l,u=l+(n-h);return this._hi=h,this._lo=u,this}}selfMultiply(){if(1===arguments.length){if(arguments[0]instanceof Gk){const t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if("number"==typeof arguments[0]){const t=arguments[0];return this.selfMultiply(t,0)}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];let n=null,i=null,r=null,s=null,o=null,a=null;o=Gk.SPLIT*this._hi,n=o-this._hi,a=Gk.SPLIT*t,n=o-n,i=this._hi-n,r=a-t,o=this._hi*t,r=a-r,s=t-r,a=n*r-o+n*s+i*r+i*s+(this._hi*e+this._lo*t);const l=o+a;n=o-l;const c=a+n;return this._hi=l,this._lo=c,this}}selfSqr(){return this.selfMultiply(this)}floor(){if(this.isNaN())return Gk.NaN;const t=Math.floor(this._hi);let e=0;return t===this._hi&&(e=Math.floor(this._lo)),new Gk(t,e)}negate(){return this.isNaN()?this:new Gk(-this._hi,-this._lo)}clone(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return null;throw t}}multiply(){if(arguments[0]instanceof Gk){const t=arguments[0];return t.isNaN()?Gk.createNaN():Gk.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){const t=arguments[0];return HI.isNaN(t)?Gk.createNaN():Gk.copy(this).selfMultiply(t,0)}}isNaN(){return HI.isNaN(this._hi)}intValue(){return Math.trunc(this._hi)}toString(){const t=Gk.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()}toStandardNotation(){const t=this.getSpecialNumberString();if(null!==t)return t;const e=new Array(1).fill(null),n=this.extractSignificantDigits(!0,e),i=e[0]+1;let r=n;if("."===n.charAt(0))r="0"+n;else if(i<0)r="0."+Gk.stringOfChar("0",-i)+n;else if(-1===n.indexOf(".")){const t=i-n.length;r=n+Gk.stringOfChar("0",t)+".0"}return this.isNegative()?"-"+r:r}reciprocal(){let t=null,e=null,n=null,i=null,r=null,s=null,o=null,a=null;r=1/this._hi,s=Gk.SPLIT*r,t=s-r,a=Gk.SPLIT*this._hi,t=s-t,e=r-t,n=a-this._hi,o=r*this._hi,n=a-n,i=this._hi-n,a=t*n-o+t*i+e*n+e*i,s=(1-o-a-r*this._lo)/this._hi;const l=r+s;return new Gk(l,r-l+s)}toSciNotation(){if(this.isZero())return Gk.SCI_NOT_ZERO;const t=this.getSpecialNumberString();if(null!==t)return t;const e=new Array(1).fill(null),n=this.extractSignificantDigits(!1,e),i=Gk.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===n.charAt(0))throw new Ik("Found leading zero: "+n);let r="";n.length>1&&(r=n.substring(1));const s=n.charAt(0)+"."+r;return this.isNegative()?"-"+s+i:s+i}abs(){return this.isNaN()?Gk.NaN:this.isNegative()?this.negate():new Gk(this)}isPositive(){return this._hi>0||0===this._hi&&this._lo>0}lt(t){return this._hi<t._hi||this._hi===t._hi&&this._lo<t._lo}add(){if(arguments[0]instanceof Gk){const t=arguments[0];return Gk.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){const t=arguments[0];return Gk.copy(this).selfAdd(t)}}init(){if(1===arguments.length){if("number"==typeof arguments[0]){const t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof Gk){const t=arguments[0];this._hi=t._hi,this._lo=t._lo}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this._hi=t,this._lo=e}}gt(t){return this._hi>t._hi||this._hi===t._hi&&this._lo>t._lo}isNegative(){return this._hi<0||0===this._hi&&this._lo<0}trunc(){return this.isNaN()?Gk.NaN:this.isPositive()?this.floor():this.ceil()}signum(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}get interfaces_(){return[ik,nk,JI]}}Gk.PI=new Gk(3.141592653589793,12246467991473532e-32),Gk.TWO_PI=new Gk(6.283185307179586,24492935982947064e-32),Gk.PI_2=new Gk(1.5707963267948966,6123233995736766e-32),Gk.E=new Gk(2.718281828459045,14456468917292502e-32),Gk.NaN=new Gk(HI.NaN,HI.NaN),Gk.EPS=123259516440783e-46,Gk.SPLIT=134217729,Gk.MAX_PRINT_DIGITS=32,Gk.TEN=Gk.valueOf(10),Gk.ONE=Gk.valueOf(1),Gk.SCI_NOT_EXPONENT_CHAR="E",Gk.SCI_NOT_ZERO="0.0E0";class jk{static orientationIndex(t,e,n){const i=jk.orientationIndexFilter(t,e,n);if(i<=1)return i;const r=Gk.valueOf(e.x).selfAdd(-t.x),s=Gk.valueOf(e.y).selfAdd(-t.y),o=Gk.valueOf(n.x).selfAdd(-e.x),a=Gk.valueOf(n.y).selfAdd(-e.y);return r.selfMultiply(a).selfSubtract(s.selfMultiply(o)).signum()}static signOfDet2x2(){if(arguments[3]instanceof Gk&&arguments[2]instanceof Gk&&arguments[0]instanceof Gk&&arguments[1]instanceof Gk){const t=arguments[1],e=arguments[2],n=arguments[3];return arguments[0].multiply(n).selfSubtract(t.multiply(e)).signum()}if("number"==typeof arguments[3]&&"number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=Gk.valueOf(t),s=Gk.valueOf(e),o=Gk.valueOf(n),a=Gk.valueOf(i);return r.multiply(a).selfSubtract(s.multiply(o)).signum()}}static intersection(t,e,n,i){const r=new Gk(t.y).selfSubtract(e.y),s=new Gk(e.x).selfSubtract(t.x),o=new Gk(t.x).selfMultiply(e.y).selfSubtract(new Gk(e.x).selfMultiply(t.y)),a=new Gk(n.y).selfSubtract(i.y),l=new Gk(i.x).selfSubtract(n.x),c=new Gk(n.x).selfMultiply(i.y).selfSubtract(new Gk(i.x).selfMultiply(n.y)),h=s.multiply(c).selfSubtract(l.multiply(o)),u=a.multiply(o).selfSubtract(r.multiply(c)),f=r.multiply(l).selfSubtract(a.multiply(s)),d=h.selfDivide(f).doubleValue(),g=u.selfDivide(f).doubleValue();return HI.isNaN(d)||HI.isInfinite(d)||HI.isNaN(g)||HI.isInfinite(g)?null:new fk(d,g)}static orientationIndexFilter(t,e,n){let i=null;const r=(t.x-n.x)*(e.y-n.y),s=(t.y-n.y)*(e.x-n.x),o=r-s;if(r>0){if(s<=0)return jk.signum(o);i=r+s}else{if(!(r<0))return jk.signum(o);if(s>=0)return jk.signum(o);i=-r-s}const a=jk.DP_SAFE_EPSILON*i;return o>=a||-o>=a?jk.signum(o):2}static signum(t){return t>0?1:t<0?-1:0}}jk.DP_SAFE_EPSILON=1e-15;class qk{static index(t,e,n){return jk.orientationIndex(t,e,n)}static isCCW(){if(arguments[0]instanceof Array){const t=arguments[0],e=t.length-1;if(e<3)throw new tk("Ring has fewer than 4 points, so orientation cannot be determined");let n=t[0],i=0;for(let r=1;r<=e;r++){const e=t[r];e.y>n.y&&(n=e,i=r)}let r=i;do{r-=1,r<0&&(r=e)}while(t[r].equals2D(n)&&r!==i);let s=i;do{s=(s+1)%e}while(t[s].equals2D(n)&&s!==i);const o=t[r],a=t[s];if(o.equals2D(n)||a.equals2D(n)||o.equals2D(a))return!1;const l=qk.index(o,n,a);let c=null;return c=0===l?o.x>a.x:l>0,c}if(XI(arguments[0],ZI)){const t=arguments[0],e=t.size()-1;if(e<3)throw new tk("Ring has fewer than 4 points, so orientation cannot be determined");let n=t.getCoordinate(0),i=0;for(let r=1;r<=e;r++){const e=t.getCoordinate(r);e.y>n.y&&(n=e,i=r)}let r=null,s=i;do{s-=1,s<0&&(s=e),r=t.getCoordinate(s)}while(r.equals2D(n)&&s!==i);let o=null,a=i;do{a=(a+1)%e,o=t.getCoordinate(a)}while(o.equals2D(n)&&a!==i);if(r.equals2D(n)||o.equals2D(n)||r.equals2D(o))return!1;const l=qk.index(r,n,o);let c=null;return c=0===l?r.x>o.x:l>0,c}}}qk.CLOCKWISE=-1,qk.RIGHT=qk.CLOCKWISE,qk.COUNTERCLOCKWISE=1,qk.LEFT=qk.COUNTERCLOCKWISE,qk.COLLINEAR=0,qk.STRAIGHT=qk.COLLINEAR;class Bk{}class Yk extends pk{constructor(){super(),Yk.constructor_.apply(this,arguments)}static constructor_(){this._shell=null,this._holes=null;let t=arguments[0],e=arguments[1],n=arguments[2];if(pk.constructor_.call(this,n),null===t&&(t=this.getFactory().createLinearRing()),null===e&&(e=[]),pk.hasNullElements(e))throw new tk("holes must not contain null elements");if(t.isEmpty()&&pk.hasNonEmptyElements(e))throw new tk("shell is empty but holes are not");this._shell=t,this._holes=e}computeEnvelopeInternal(){return this._shell.getEnvelopeInternal()}getCoordinates(){if(this.isEmpty())return[];const t=new Array(this.getNumPoints()).fill(null);let e=-1;const n=this._shell.getCoordinates();for(let i=0;i<n.length;i++)e++,t[e]=n[i];for(let n=0;n<this._holes.length;n++){const i=this._holes[n].getCoordinates();for(let n=0;n<i.length;n++)e++,t[e]=i[n]}return t}getArea(){let t=0;t+=Ok.ofRing(this._shell.getCoordinateSequence());for(let e=0;e<this._holes.length;e++)t-=Ok.ofRing(this._holes[e].getCoordinateSequence());return t}copyInternal(){const t=this._shell.copy(),e=new Array(this._holes.length).fill(null);for(let t=0;t<this._holes.length;t++)e[t]=this._holes[t].copy();return new Yk(t,e,this._factory)}isRectangle(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;const t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal();for(let n=0;n<5;n++){const i=t.getX(n);if(i!==e.getMinX()&&i!==e.getMaxX())return!1;const r=t.getY(n);if(r!==e.getMinY()&&r!==e.getMaxY())return!1}let n=t.getX(0),i=t.getY(0);for(let e=1;e<=4;e++){const r=t.getX(e),s=t.getY(e);if(r!==n===(s!==i))return!1;n=r,i=s}return!0}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof pk){const t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;const n=t,i=this._shell,r=n._shell;if(!i.equalsExact(r,e))return!1;if(this._holes.length!==n._holes.length)return!1;for(let t=0;t<this._holes.length;t++)if(!this._holes[t].equalsExact(n._holes[t],e))return!1;return!0}return super.equalsExact.apply(this,arguments)}normalize(){if(0===arguments.length){this._shell=this.normalized(this._shell,!0);for(let t=0;t<this._holes.length;t++)this._holes[t]=this.normalized(this._holes[t],!1);Dk.sort(this._holes)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];if(t.isEmpty())return null;const n=t.getCoordinateSequence(),i=xk.minCoordinateIndex(n,0,n.size()-2);xk.scroll(n,i,!0),qk.isCCW(n)===e&&xk.reverse(n)}}getCoordinate(){return this._shell.getCoordinate()}getNumInteriorRing(){return this._holes.length}getBoundaryDimension(){return 1}reverseInternal(){const t=this.getExteriorRing().reverse(),e=new Array(this.getNumInteriorRing()).fill(null);for(let t=0;t<e.length;t++)e[t]=this.getInteriorRingN(t).reverse();return this.getFactory().createPolygon(t,e)}getTypeCode(){return pk.TYPECODE_POLYGON}getDimension(){return 2}getLength(){let t=0;t+=this._shell.getLength();for(let e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t}getNumPoints(){let t=this._shell.getNumPoints();for(let e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t}convexHull(){return this.getExteriorRing().convexHull()}normalized(t,e){const n=t.copy();return this.normalize(n,e),n}compareToSameClass(){if(1===arguments.length){const t=arguments[0],e=this._shell,n=t._shell;return e.compareToSameClass(n)}if(2===arguments.length){const t=arguments[1],e=arguments[0],n=this._shell,i=e._shell,r=n.compareToSameClass(i,t);if(0!==r)return r;const s=this.getNumInteriorRing(),o=e.getNumInteriorRing();let a=0;for(;a<s&&a<o;){const n=this.getInteriorRingN(a),i=e.getInteriorRingN(a),r=n.compareToSameClass(i,t);if(0!==r)return r;a++}return a<s?1:a<o?-1:0}}apply(){if(XI(arguments[0],_k)){const t=arguments[0];this._shell.apply(t);for(let e=0;e<this._holes.length;e++)this._holes[e].apply(t)}else if(XI(arguments[0],Ek)){const t=arguments[0];if(this._shell.apply(t),!t.isDone())for(let e=0;e<this._holes.length&&(this._holes[e].apply(t),!t.isDone());e++);t.isGeometryChanged()&&this.geometryChanged()}else if(XI(arguments[0],wk)){arguments[0].filter(this)}else if(XI(arguments[0],ek)){const t=arguments[0];t.filter(this),this._shell.apply(t);for(let e=0;e<this._holes.length;e++)this._holes[e].apply(t)}}getBoundary(){if(this.isEmpty())return this.getFactory().createMultiLineString();const t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(let e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)}getGeometryType(){return pk.TYPENAME_POLYGON}getExteriorRing(){return this._shell}isEmpty(){return this._shell.isEmpty()}getInteriorRingN(t){return this._holes[t]}get interfaces_(){return[Bk]}}class $k extends Ck{contains(){}}class Uk extends $k{}class Wk extends Uk{constructor(t){super(),this.array=[],t instanceof Ck&&this.addAll(t)}contains(t){for(const e of this.array)if(0===e.compareTo(t))return!0;return!1}add(t){if(this.contains(t))return!1;for(let e=0,n=this.array.length;e<n;e++){if(1===this.array[e].compareTo(t))return!!this.array.splice(e,0,t)}return this.array.push(t),!0}addAll(t){for(const e of t)this.add(e);return!0}remove(){throw new vk}size(){return this.array.length}isEmpty(){return 0===this.array.length}toArray(){return this.array.slice()}iterator(){return new Xk(this.array)}}class Xk{constructor(t){this.array=t,this.position=0}next(){if(this.position===this.array.length)throw new Rk;return this.array[this.position++]}hasNext(){return this.position<this.array.length}remove(){throw new vk}}class Vk extends pk{constructor(){super(),Vk.constructor_.apply(this,arguments)}static constructor_(){if(this._geometries=null,0===arguments.length);else if(2===arguments.length){let t=arguments[0],e=arguments[1];if(pk.constructor_.call(this,e),null===t&&(t=[]),pk.hasNullElements(t))throw new tk("geometries must not contain null elements");this._geometries=t}}computeEnvelopeInternal(){const t=new gk;for(let e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t}getGeometryN(t){return this._geometries[t]}getCoordinates(){const t=new Array(this.getNumPoints()).fill(null);let e=-1;for(let n=0;n<this._geometries.length;n++){const i=this._geometries[n].getCoordinates();for(let n=0;n<i.length;n++)e++,t[e]=i[n]}return t}getArea(){let t=0;for(let e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t}copyInternal(){const t=new Array(this._geometries.length).fill(null);for(let e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new Vk(t,this._factory)}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof pk){const t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;const n=t;if(this._geometries.length!==n._geometries.length)return!1;for(let t=0;t<this._geometries.length;t++)if(!this._geometries[t].equalsExact(n._geometries[t],e))return!1;return!0}return super.equalsExact.apply(this,arguments)}normalize(){for(let t=0;t<this._geometries.length;t++)this._geometries[t].normalize();Dk.sort(this._geometries)}getCoordinate(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}getBoundaryDimension(){let t=Mk.FALSE;for(let e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t}reverseInternal(){const t=this._geometries.length,e=new Lk(t);for(let n=0;n<t;n++)e.add(this._geometries[n].reverse());return this.getFactory().buildGeometry(e)}getTypeCode(){return pk.TYPECODE_GEOMETRYCOLLECTION}getDimension(){let t=Mk.FALSE;for(let e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t}getLength(){let t=0;for(let e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t}getNumPoints(){let t=0;for(let e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t}getNumGeometries(){return this._geometries.length}compareToSameClass(){if(1===arguments.length){const t=arguments[0],e=new Wk(Dk.asList(this._geometries)),n=new Wk(Dk.asList(t._geometries));return this.compare(e,n)}if(2===arguments.length){const t=arguments[1],e=arguments[0],n=this.getNumGeometries(),i=e.getNumGeometries();let r=0;for(;r<n&&r<i;){const n=this.getGeometryN(r),i=e.getGeometryN(r),s=n.compareToSameClass(i,t);if(0!==s)return s;r++}return r<n?1:r<i?-1:0}}apply(){if(XI(arguments[0],_k)){const t=arguments[0];for(let e=0;e<this._geometries.length;e++)this._geometries[e].apply(t)}else if(XI(arguments[0],Ek)){const t=arguments[0];if(0===this._geometries.length)return null;for(let e=0;e<this._geometries.length&&(this._geometries[e].apply(t),!t.isDone());e++);t.isGeometryChanged()&&this.geometryChanged()}else if(XI(arguments[0],wk)){const t=arguments[0];t.filter(this);for(let e=0;e<this._geometries.length;e++)this._geometries[e].apply(t)}else if(XI(arguments[0],ek)){const t=arguments[0];t.filter(this);for(let e=0;e<this._geometries.length;e++)this._geometries[e].apply(t)}}getBoundary(){return pk.checkNotGeometryCollection(this),lk.shouldNeverReachHere(),null}getGeometryType(){return pk.TYPENAME_GEOMETRYCOLLECTION}isEmpty(){for(let t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0}}class Hk extends Vk{constructor(){super(),Hk.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],e=arguments[1];Vk.constructor_.call(this,t,e)}copyInternal(){const t=new Array(this._geometries.length).fill(null);for(let e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new Hk(t,this._factory)}isValid(){return!0}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof pk){const t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&super.equalsExact.call(this,t,e)}return super.equalsExact.apply(this,arguments)}getCoordinate(){if(1===arguments.length&&Number.isInteger(arguments[0])){const t=arguments[0];return this._geometries[t].getCoordinate()}return super.getCoordinate.apply(this,arguments)}getBoundaryDimension(){return Mk.FALSE}getTypeCode(){return pk.TYPECODE_MULTIPOINT}getDimension(){return 0}getBoundary(){return this.getFactory().createGeometryCollection()}getGeometryType(){return pk.TYPENAME_MULTIPOINT}get interfaces_(){return[Nk]}}class Jk extends Sk{constructor(){super(),Jk.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],e=arguments[1];Sk.constructor_.call(this,t,e),this.validateConstruction()}copyInternal(){return new Jk(this._points.copy(),this._factory)}getBoundaryDimension(){return Mk.FALSE}isClosed(){return!!this.isEmpty()||super.isClosed.call(this)}reverseInternal(){const t=this._points.copy();return xk.reverse(t),this.getFactory().createLinearRing(t)}getTypeCode(){return pk.TYPECODE_LINEARRING}validateConstruction(){if(!this.isEmpty()&&!super.isClosed.call(this))throw new tk("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<Jk.MINIMUM_VALID_SIZE)throw new tk("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}getGeometryType(){return pk.TYPENAME_LINEARRING}}Jk.MINIMUM_VALID_SIZE=4;class Zk extends fk{constructor(){super(),Zk.constructor_.apply(this,arguments)}static constructor_(){if(0===arguments.length)fk.constructor_.call(this);else if(1===arguments.length){if(arguments[0]instanceof Zk){const t=arguments[0];fk.constructor_.call(this,t.x,t.y)}else if(arguments[0]instanceof fk){const t=arguments[0];fk.constructor_.call(this,t.x,t.y)}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];fk.constructor_.call(this,t,e,fk.NULL_ORDINATE)}}setOrdinate(t,e){switch(t){case Zk.X:this.x=e;break;case Zk.Y:this.y=e;break;default:throw new tk("Invalid ordinate index: "+t)}}getZ(){return fk.NULL_ORDINATE}getOrdinate(t){switch(t){case Zk.X:return this.x;case Zk.Y:return this.y}throw new tk("Invalid ordinate index: "+t)}setZ(t){throw new tk("CoordinateXY dimension 2 does not support z-ordinate")}copy(){return new Zk(this)}toString(){return"("+this.x+", "+this.y+")"}setCoordinate(t){this.x=t.x,this.y=t.y,this.z=t.getZ()}}Zk.X=0,Zk.Y=1,Zk.Z=-1,Zk.M=-1;class Qk extends fk{constructor(){super(),Qk.constructor_.apply(this,arguments)}static constructor_(){if(this._m=null,0===arguments.length)fk.constructor_.call(this),this._m=0;else if(1===arguments.length){if(arguments[0]instanceof Qk){const t=arguments[0];fk.constructor_.call(this,t.x,t.y),this._m=t._m}else if(arguments[0]instanceof fk){const t=arguments[0];fk.constructor_.call(this,t.x,t.y),this._m=this.getM()}}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];fk.constructor_.call(this,t,e,fk.NULL_ORDINATE),this._m=n}}getM(){return this._m}setOrdinate(t,e){switch(t){case Qk.X:this.x=e;break;case Qk.Y:this.y=e;break;case Qk.M:this._m=e;break;default:throw new tk("Invalid ordinate index: "+t)}}setM(t){this._m=t}getZ(){return fk.NULL_ORDINATE}getOrdinate(t){switch(t){case Qk.X:return this.x;case Qk.Y:return this.y;case Qk.M:return this._m}throw new tk("Invalid ordinate index: "+t)}setZ(t){throw new tk("CoordinateXY dimension 2 does not support z-ordinate")}copy(){return new Qk(this)}toString(){return"("+this.x+", "+this.y+" m="+this.getM()+")"}setCoordinate(t){this.x=t.x,this.y=t.y,this.z=t.getZ(),this._m=t.getM()}}Qk.X=0,Qk.Y=1,Qk.Z=-1,Qk.M=2;class Kk extends fk{constructor(){super(),Kk.constructor_.apply(this,arguments)}static constructor_(){if(this._m=null,0===arguments.length)fk.constructor_.call(this),this._m=0;else if(1===arguments.length){if(arguments[0]instanceof Kk){const t=arguments[0];fk.constructor_.call(this,t),this._m=t._m}else if(arguments[0]instanceof fk){const t=arguments[0];fk.constructor_.call(this,t),this._m=this.getM()}}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];fk.constructor_.call(this,t,e,n),this._m=i}}getM(){return this._m}setOrdinate(t,e){switch(t){case fk.X:this.x=e;break;case fk.Y:this.y=e;break;case fk.Z:this.z=e;break;case fk.M:this._m=e;break;default:throw new tk("Invalid ordinate index: "+t)}}setM(t){this._m=t}getOrdinate(t){switch(t){case fk.X:return this.x;case fk.Y:return this.y;case fk.Z:return this.getZ();case fk.M:return this.getM()}throw new tk("Invalid ordinate index: "+t)}copy(){return new Kk(this)}toString(){return"("+this.x+", "+this.y+", "+this.getZ()+" m="+this.getM()+")"}setCoordinate(t){this.x=t.x,this.y=t.y,this.z=t.getZ(),this._m=t.getM()}}class tO{static measures(t){return t instanceof Zk?0:t instanceof Qk||t instanceof Kk?1:0}static dimension(t){return t instanceof Zk?2:t instanceof Qk?3:t instanceof Kk?4:3}static create(){if(1===arguments.length){const t=arguments[0];return tO.create(t,0)}if(2===arguments.length){const t=arguments[0],e=arguments[1];return 2===t?new Zk:3===t&&0===e?new fk:3===t&&1===e?new Qk:4===t&&1===e?new Kk:new fk}}}class eO extends Lk{constructor(){super(),eO.constructor_.apply(this,arguments)}static constructor_(){if(0===arguments.length);else if(1===arguments.length){const t=arguments[0];this.ensureCapacity(t.length),this.add(t,!0)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.ensureCapacity(t.length),this.add(t,e)}}getCoordinate(t){return this.get(t)}addAll(){if(2===arguments.length&&"boolean"==typeof arguments[1]&&XI(arguments[0],Ck)){const t=arguments[1];let e=!1;for(let n=arguments[0].iterator();n.hasNext();)this.add(n.next(),t),e=!0;return e}return super.addAll.apply(this,arguments)}clone(){const t=super.clone.call(this);for(let e=0;e<this.size();e++)t.add(e,this.get(e).clone());return t}toCoordinateArray(){if(0===arguments.length)return this.toArray(eO.coordArrayType);if(1===arguments.length){if(arguments[0])return this.toArray(eO.coordArrayType);const t=this.size(),e=new Array(t).fill(null);for(let n=0;n<t;n++)e[n]=this.get(t-n-1);return e}}add(){if(1===arguments.length){const t=arguments[0];return super.add.call(this,t)}if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){const t=arguments[0],e=arguments[1];return this.add(t,e,!0),!0}if(arguments[0]instanceof fk&&"boolean"==typeof arguments[1]){const t=arguments[0];if(!arguments[1]&&this.size()>=1){if(this.get(this.size()-1).equals2D(t))return null}super.add.call(this,t)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){const t=arguments[0],e=arguments[1];return this.add(t,e),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){const t=arguments[0],e=arguments[1];if(arguments[2])for(let n=0;n<t.length;n++)this.add(t[n],e);else for(let n=t.length-1;n>=0;n--)this.add(t[n],e);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof fk){const t=arguments[0],e=arguments[1];if(!arguments[2]){const n=this.size();if(n>0){if(t>0){if(this.get(t-1).equals2D(e))return null}if(t<n){if(this.get(t).equals2D(e))return null}}}super.add.call(this,t,e)}}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];let r=1;n>i&&(r=-1);for(let s=n;s!==i;s+=r)this.add(t[s],e);return!0}}closeRing(){if(this.size()>0){const t=this.get(0).copy();this.add(t,!1)}}}eO.coordArrayType=new Array(0).fill(null);class nO{static log10(t){const e=Math.log(t);return HI.isInfinite(e)||HI.isNaN(e)?e:e/nO.LOG_10}static min(t,e,n,i){let r=t;return e<r&&(r=e),n<r&&(r=n),i<r&&(r=i),r}static clamp(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1],n=arguments[2];return t<e?e:t>n?n:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1],n=arguments[2];return t<e?e:t>n?n:t}}static wrap(t,e){return t<0?e- -t%e:t%e}static max(){if(3===arguments.length){const t=arguments[1],e=arguments[2];let n=arguments[0];return t>n&&(n=t),e>n&&(n=e),n}if(4===arguments.length){const t=arguments[1],e=arguments[2],n=arguments[3];let i=arguments[0];return t>i&&(i=t),e>i&&(i=e),n>i&&(i=n),i}}static average(t,e){return(t+e)/2}}nO.LOG_10=Math.log(10);class iO{static arraycopy(t,e,n,i,r){let s=0;for(let o=e;o<e+r;o++)n[i+s]=t[o],s++}static getProperty(t){return{"line.separator":"\n"}[t]}}class rO{static isRing(t){return!(t.length<4)&&!!t[0].equals2D(t[t.length-1])}static ptNotInList(t,e){for(let n=0;n<t.length;n++){const i=t[n];if(rO.indexOf(i,e)<0)return i}return null}static scroll(t,e){const n=rO.indexOf(e,t);if(n<0)return null;const i=new Array(t.length).fill(null);iO.arraycopy(t,n,i,0,t.length-n),iO.arraycopy(t,0,i,t.length-n,n),iO.arraycopy(i,0,t,0,t.length)}static equals(){if(2===arguments.length){const t=arguments[0],e=arguments[1];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0}if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(0!==n.compare(t[i],e[i]))return!1;return!0}}static intersection(t,e){const n=new eO;for(let i=0;i<t.length;i++)e.intersects(t[i])&&n.add(t[i],!0);return n.toCoordinateArray()}static measures(t){if(null===t||0===t.length)return 0;let e=0;for(const n of t)e=Math.max(e,tO.measures(n));return e}static hasRepeatedPoints(t){for(let e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1}static removeRepeatedPoints(t){if(!rO.hasRepeatedPoints(t))return t;return new eO(t,!1).toCoordinateArray()}static reverse(t){const e=t.length-1,n=Math.trunc(e/2);for(let i=0;i<=n;i++){const n=t[i];t[i]=t[e-i],t[e-i]=n}}static removeNull(t){let e=0;for(let n=0;n<t.length;n++)null!==t[n]&&e++;const n=new Array(e).fill(null);if(0===e)return n;let i=0;for(let e=0;e<t.length;e++)null!==t[e]&&(n[i++]=t[e]);return n}static copyDeep(){if(1===arguments.length){const t=arguments[0],e=new Array(t.length).fill(null);for(let n=0;n<t.length;n++)e[n]=t[n].copy();return e}if(5===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=arguments[4];for(let s=0;s<r;s++)n[i+s]=t[e+s].copy()}}static isEqualReversed(t,e){for(let n=0;n<t.length;n++){const i=t[n],r=e[t.length-n-1];if(0!==i.compareTo(r))return!1}return!0}static envelope(t){const e=new gk;for(let n=0;n<t.length;n++)e.expandToInclude(t[n]);return e}static toCoordinateArray(t){return t.toArray(rO.coordArrayType)}static dimension(t){if(null===t||0===t.length)return 3;let e=0;for(const n of t)e=Math.max(e,tO.dimension(n));return e}static atLeastNCoordinatesOrNothing(t,e){return e.length>=t?e:[]}static indexOf(t,e){for(let n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1}static increasingDirection(t){for(let e=0;e<Math.trunc(t.length/2);e++){const n=t.length-1-e,i=t[e].compareTo(t[n]);if(0!==i)return i}return 1}static compare(t,e){let n=0;for(;n<t.length&&n<e.length;){const i=t[n].compareTo(e[n]);if(0!==i)return i;n++}return n<e.length?-1:n<t.length?1:0}static minCoordinate(t){let e=null;for(let n=0;n<t.length;n++)(null===e||e.compareTo(t[n])>0)&&(e=t[n]);return e}static extract(t,e,n){e=nO.clamp(e,0,t.length);let i=(n=nO.clamp(n,-1,t.length))-e+1;n<0&&(i=0),e>=t.length&&(i=0),n<e&&(i=0);const r=new Array(i).fill(null);if(0===i)return r;let s=0;for(let i=e;i<=n;i++)r[s++]=t[i];return r}}rO.ForwardComparator=class{compare(t,e){const n=t,i=e;return rO.compare(n,i)}get interfaces_(){return[sk]}},rO.BidirectionalComparator=class{compare(t,e){const n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;const r=rO.compare(n,i);return rO.isEqualReversed(n,i)?0:r}OLDcompare(t,e){const n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;const r=rO.increasingDirection(n),s=rO.increasingDirection(i);let o=r>0?0:n.length-1,a=s>0?0:n.length-1;for(let t=0;t<n.length;t++){const t=n[o].compareTo(i[a]);if(0!==t)return t;o+=r,a+=s}return 0}get interfaces_(){return[sk]}},rO.coordArrayType=new Array(0).fill(null);class sO{constructor(t){this.str=t}append(t){this.str+=t}setCharAt(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)}toString(){return this.str}}class oO{constructor(){oO.constructor_.apply(this,arguments)}static constructor_(){if(this._dimension=3,this._measures=0,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array){const t=arguments[0];oO.constructor_.call(this,t,rO.dimension(t),rO.measures(t))}else if(Number.isInteger(arguments[0])){const t=arguments[0];this._coordinates=new Array(t).fill(null);for(let e=0;e<t;e++)this._coordinates[e]=new fk}else if(XI(arguments[0],ZI)){const t=arguments[0];if(null===t)return this._coordinates=new Array(0).fill(null),null;this._dimension=t.getDimension(),this._measures=t.getMeasures(),this._coordinates=new Array(t.size()).fill(null);for(let e=0;e<this._coordinates.length;e++)this._coordinates[e]=t.getCoordinateCopy(e)}}else if(2===arguments.length){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1];oO.constructor_.call(this,t,e,rO.measures(t))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1];this._coordinates=new Array(t).fill(null),this._dimension=e;for(let n=0;n<t;n++)this._coordinates[n]=tO.create(e)}}else if(3===arguments.length)if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1],n=arguments[2];this._dimension=e,this._measures=n,this._coordinates=null===t?new Array(0).fill(null):t}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1],n=arguments[2];this._coordinates=new Array(t).fill(null),this._dimension=e,this._measures=n;for(let e=0;e<t;e++)this._coordinates[e]=this.createCoordinate()}}getM(t){return this.hasM()?this._coordinates[t].getM():HI.NaN}setOrdinate(t,e,n){switch(e){case ZI.X:this._coordinates[t].x=n;break;case ZI.Y:this._coordinates[t].y=n;break;default:this._coordinates[t].setOrdinate(e,n)}}getZ(t){return this.hasZ()?this._coordinates[t].getZ():HI.NaN}size(){return this._coordinates.length}getOrdinate(t,e){switch(e){case ZI.X:return this._coordinates[t].x;case ZI.Y:return this._coordinates[t].y;default:return this._coordinates[t].getOrdinate(e)}}getCoordinate(){if(1===arguments.length){const t=arguments[0];return this._coordinates[t]}if(2===arguments.length){const t=arguments[0];arguments[1].setCoordinate(this._coordinates[t])}}getCoordinateCopy(t){const e=this.createCoordinate();return e.setCoordinate(this._coordinates[t]),e}createCoordinate(){return tO.create(this.getDimension(),this.getMeasures())}getDimension(){return this._dimension}getX(t){return this._coordinates[t].x}getMeasures(){return this._measures}expandEnvelope(t){for(let e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t}copy(){const t=new Array(this.size()).fill(null);for(let e=0;e<this._coordinates.length;e++){const n=this.createCoordinate();n.setCoordinate(this._coordinates[e]),t[e]=n}return new oO(t,this._dimension,this._measures)}toString(){if(this._coordinates.length>0){const t=new sO(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(let e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"}getY(t){return this._coordinates[t].y}toCoordinateArray(){return this._coordinates}get interfaces_(){return[ZI,ik]}}class aO{static instance(){return aO.instanceObject}readResolve(){return aO.instance()}create(){if(1===arguments.length){if(arguments[0]instanceof Array){return new oO(arguments[0])}if(XI(arguments[0],ZI)){return new oO(arguments[0])}}else{if(2===arguments.length){let t=arguments[1];return t>3&&(t=3),t<2&&(t=2),new oO(arguments[0],t)}if(3===arguments.length){let t=arguments[2],e=arguments[1]-t;return t>1&&(t=1),e>3&&(e=3),e<2&&(e=2),new oO(arguments[0],e+t,t)}}}get interfaces_(){return[QI,ik]}}aO.instanceObject=new aO;class lO extends Vk{constructor(){super(),lO.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],e=arguments[1];Vk.constructor_.call(this,t,e)}copyInternal(){const t=new Array(this._geometries.length).fill(null);for(let e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new lO(t,this._factory)}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof pk){const t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&super.equalsExact.call(this,t,e)}return super.equalsExact.apply(this,arguments)}getBoundaryDimension(){return 1}getTypeCode(){return pk.TYPECODE_MULTIPOLYGON}getDimension(){return 2}getBoundary(){if(this.isEmpty())return this.getFactory().createMultiLineString();const t=new Lk;for(let e=0;e<this._geometries.length;e++){const n=this._geometries[e].getBoundary();for(let e=0;e<n.getNumGeometries();e++)t.add(n.getGeometryN(e))}const e=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(e))}getGeometryType(){return pk.TYPENAME_MULTIPOLYGON}get interfaces_(){return[Bk]}}class cO{get(){}put(){}size(){}values(){}entrySet(){}}class hO extends $k{constructor(t){super(),this.map=new Map,t instanceof Ck&&this.addAll(t)}contains(t){const e=t.hashCode?t.hashCode():t;return!!this.map.has(e)}add(t){const e=t.hashCode?t.hashCode():t;return!this.map.has(e)&&!!this.map.set(e,t)}addAll(t){for(const e of t)this.add(e);return!0}remove(){throw new vk}size(){return this.map.size}isEmpty(){return 0===this.map.size}toArray(){return Array.from(this.map.values())}iterator(){return new uO(this.map)}[Symbol.iterator](){return this.map}}class uO{constructor(t){this.iterator=t.values();const{done:e,value:n}=this.iterator.next();this.done=e,this.value=n}next(){if(this.done)throw new Rk;const t=this.value,{done:e,value:n}=this.iterator.next();return this.done=e,this.value=n,t}hasNext(){return!this.done}remove(){throw new vk}}class fO extends cO{constructor(){super(),this.map=new Map}get(t){return this.map.get(t)||null}put(t,e){return this.map.set(t,e),e}values(){const t=new Lk,e=this.map.values();let n=e.next();for(;!n.done;)t.add(n.value),n=e.next();return t}entrySet(){const t=new hO;return this.map.entries().forEach((e=>t.add(e))),t}size(){return this.map.size()}}class dO{constructor(){dO.constructor_.apply(this,arguments)}static constructor_(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=dO.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof gO){const t=arguments[0];this._modelType=t,t===dO.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){const t=arguments[0];this._modelType=dO.FIXED,this.setScale(t)}else if(arguments[0]instanceof dO){const t=arguments[0];this._modelType=t._modelType,this._scale=t._scale}}static mostPrecise(t,e){return t.compareTo(e)>=0?t:e}equals(t){if(!(t instanceof dO))return!1;const e=t;return this._modelType===e._modelType&&this._scale===e._scale}compareTo(t){const e=t,n=this.getMaximumSignificantDigits(),i=e.getMaximumSignificantDigits();return Fk.compare(n,i)}getScale(){return this._scale}isFloating(){return this._modelType===dO.FLOATING||this._modelType===dO.FLOATING_SINGLE}getType(){return this._modelType}toString(){let t="UNKNOWN";return this._modelType===dO.FLOATING?t="Floating":this._modelType===dO.FLOATING_SINGLE?t="Floating-Single":this._modelType===dO.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t}makePrecise(){if("number"==typeof arguments[0]){const t=arguments[0];if(HI.isNaN(t))return t;if(this._modelType===dO.FLOATING_SINGLE){return t}return this._modelType===dO.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof fk){const t=arguments[0];if(this._modelType===dO.FLOATING)return null;t.x=this.makePrecise(t.x),t.y=this.makePrecise(t.y)}}getMaximumSignificantDigits(){let t=16;return this._modelType===dO.FLOATING?t=16:this._modelType===dO.FLOATING_SINGLE?t=6:this._modelType===dO.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t}setScale(t){this._scale=Math.abs(t)}get interfaces_(){return[ik,nk]}}class gO{constructor(){gO.constructor_.apply(this,arguments)}static constructor_(){this._name=null;const t=arguments[0];this._name=t,gO.nameToTypeMap.put(t,this)}readResolve(){return gO.nameToTypeMap.get(this._name)}toString(){return this._name}get interfaces_(){return[ik]}}gO.nameToTypeMap=new fO,dO.Type=gO,dO.FIXED=new gO("FIXED"),dO.FLOATING=new gO("FLOATING"),dO.FLOATING_SINGLE=new gO("FLOATING SINGLE"),dO.maximumPreciseValue=9007199254740992;class pO extends Vk{constructor(){super(),pO.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],e=arguments[1];Vk.constructor_.call(this,t,e)}copyInternal(){const t=new Array(this._geometries.length).fill(null);for(let e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new pO(t,this._factory)}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof pk){const t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&super.equalsExact.call(this,t,e)}return super.equalsExact.apply(this,arguments)}getBoundaryDimension(){return this.isClosed()?Mk.FALSE:0}isClosed(){if(this.isEmpty())return!1;for(let t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0}getTypeCode(){return pk.TYPECODE_MULTILINESTRING}getDimension(){return 1}getBoundary(){throw new vk}getGeometryType(){return pk.TYPENAME_MULTILINESTRING}get interfaces_(){return[mk]}}class _O{constructor(){_O.constructor_.apply(this,arguments)}static constructor_(){if(this._precisionModel=null,this._coordinateSequenceFactory=null,this._SRID=null,0===arguments.length)_O.constructor_.call(this,new dO,0);else if(1===arguments.length){if(XI(arguments[0],QI)){const t=arguments[0];_O.constructor_.call(this,new dO,0,t)}else if(arguments[0]instanceof dO){const t=arguments[0];_O.constructor_.call(this,t,0,_O.getDefaultCoordinateSequenceFactory())}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];_O.constructor_.call(this,t,e,_O.getDefaultCoordinateSequenceFactory())}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this._precisionModel=t,this._coordinateSequenceFactory=n,this._SRID=e}}static toMultiPolygonArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static toGeometryArray(t){if(null===t)return null;const e=new Array(t.size()).fill(null);return t.toArray(e)}static getDefaultCoordinateSequenceFactory(){return aO.instance()}static toMultiLineStringArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static toLineStringArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static toMultiPointArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static toLinearRingArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static toPointArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static toPolygonArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static createPointFromInternalCoord(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)}createEmpty(t){switch(t){case-1:return this.createGeometryCollection();case 0:return this.createPoint();case 1:return this.createLineString();case 2:return this.createPolygon();default:throw new tk("Invalid dimension: "+t)}}toGeometry(t){return t.isNull()?this.createPoint():t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new fk(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new fk(t.getMinX(),t.getMinY()),new fk(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new fk(t.getMinX(),t.getMinY()),new fk(t.getMinX(),t.getMaxY()),new fk(t.getMaxX(),t.getMaxY()),new fk(t.getMaxX(),t.getMinY()),new fk(t.getMinX(),t.getMinY())]),null)}createLineString(){if(0===arguments.length)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){const t=arguments[0];return this.createLineString(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(XI(arguments[0],ZI)){return new Sk(arguments[0],this)}}}createMultiLineString(){if(0===arguments.length)return new pO(null,this);if(1===arguments.length){return new pO(arguments[0],this)}}buildGeometry(t){let e=null,n=!1,i=!1;for(let r=t.iterator();r.hasNext();){const t=r.next(),s=t.getTypeCode();null===e&&(e=s),s!==e&&(n=!0),t instanceof Vk&&(i=!0)}if(null===e)return this.createGeometryCollection();if(n||i)return this.createGeometryCollection(_O.toGeometryArray(t));const r=t.iterator().next();if(t.size()>1){if(r instanceof Yk)return this.createMultiPolygon(_O.toPolygonArray(t));if(r instanceof Sk)return this.createMultiLineString(_O.toLineStringArray(t));if(r instanceof kk)return this.createMultiPoint(_O.toPointArray(t));lk.shouldNeverReachHere("Unhandled geometry type: "+r.getGeometryType())}return r}createMultiPointFromCoords(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)}createPoint(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof fk){const t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(XI(arguments[0],ZI)){return new kk(arguments[0],this)}}}getCoordinateSequenceFactory(){return this._coordinateSequenceFactory}createPolygon(){if(0===arguments.length)return this.createPolygon(null,null);if(1===arguments.length){if(XI(arguments[0],ZI)){const t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){const t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Jk){const t=arguments[0];return this.createPolygon(t,null)}}else if(2===arguments.length){return new Yk(arguments[0],arguments[1],this)}}getSRID(){return this._SRID}createGeometryCollection(){if(0===arguments.length)return new Vk(null,this);if(1===arguments.length){return new Vk(arguments[0],this)}}getPrecisionModel(){return this._precisionModel}createLinearRing(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){const t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(XI(arguments[0],ZI)){return new Jk(arguments[0],this)}}}createMultiPolygon(){if(0===arguments.length)return new lO(null,this);if(1===arguments.length){return new lO(arguments[0],this)}}createMultiPoint(){if(0===arguments.length)return new Hk(null,this);if(1===arguments.length){if(arguments[0]instanceof Array){return new Hk(arguments[0],this)}if(XI(arguments[0],ZI)){const t=arguments[0];if(null===t)return this.createMultiPoint(new Array(0).fill(null));const e=new Array(t.size()).fill(null);for(let n=0;n<t.size();n++){const i=this.getCoordinateSequenceFactory().create(1,t.getDimension(),t.getMeasures());xk.copy(t,n,i,0,1),e[n]=this.createPoint(i)}return this.createMultiPoint(e)}}}get interfaces_(){return[ik]}}const yO=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"];class mO{constructor(t){this.geometryFactory=t||new _O}read(t){let e;e="string"==typeof t?JSON.parse(t):t;const n=e.type;if(!xO[n])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==yO.indexOf(n)?xO[n].call(this,e.coordinates):"GeometryCollection"===n?xO[n].call(this,e.geometries):xO[n].call(this,e)}write(t){const e=t.getGeometryType();if(!vO[e])throw new Error("Geometry is not supported");return vO[e].call(this,t)}}const xO={Feature:function(t){const e={};for(const n in t)e[n]=t[n];if(t.geometry){const n=t.geometry.type;if(!xO[n])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=xO.bbox.call(this,t.bbox)),e},FeatureCollection:function(t){const e={};if(t.features){e.features=[];for(let n=0;n<t.features.length;++n)e.features.push(this.read(t.features[n]))}return t.bbox&&(e.bbox=this.parse.bbox.call(this,t.bbox)),e},coordinates:function(t){const e=[];for(let n=0;n<t.length;++n){const i=t[n];e.push(new fk(...i))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new fk(t[0],t[1]),new fk(t[2],t[1]),new fk(t[2],t[3]),new fk(t[0],t[3]),new fk(t[0],t[1])])},Point:function(t){const e=new fk(...t);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){const e=[];for(let n=0;n<t.length;++n)e.push(xO.Point.call(this,t[n]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){const e=xO.coordinates.call(this,t);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){const e=[];for(let n=0;n<t.length;++n)e.push(xO.LineString.call(this,t[n]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){const e=xO.coordinates.call(this,t[0]),n=this.geometryFactory.createLinearRing(e),i=[];for(let e=1;e<t.length;++e){const n=t[e],r=xO.coordinates.call(this,n),s=this.geometryFactory.createLinearRing(r);i.push(s)}return this.geometryFactory.createPolygon(n,i)},MultiPolygon:function(t){const e=[];for(let n=0;n<t.length;++n){const i=t[n];e.push(xO.Polygon.call(this,i))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){const e=[];for(let n=0;n<t.length;++n){const i=t[n];e.push(this.read(i))}return this.geometryFactory.createGeometryCollection(e)}},vO={coordinate:function(t){const e=[t.x,t.y];return t.z&&e.push(t.z),t.m&&e.push(t.m),e},Point:function(t){return{type:"Point",coordinates:vO.coordinate.call(this,t.getCoordinate())}},MultiPoint:function(t){const e=[];for(let n=0;n<t._geometries.length;++n){const i=t._geometries[n],r=vO.Point.call(this,i);e.push(r.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){const e=[],n=t.getCoordinates();for(let t=0;t<n.length;++t){const i=n[t];e.push(vO.coordinate.call(this,i))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){const e=[];for(let n=0;n<t._geometries.length;++n){const i=t._geometries[n],r=vO.LineString.call(this,i);e.push(r.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){const e=[],n=vO.LineString.call(this,t._shell);e.push(n.coordinates);for(let n=0;n<t._holes.length;++n){const i=t._holes[n],r=vO.LineString.call(this,i);e.push(r.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){const e=[];for(let n=0;n<t._geometries.length;++n){const i=t._geometries[n],r=vO.Polygon.call(this,i);e.push(r.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){const e=[];for(let n=0;n<t._geometries.length;++n){const i=t._geometries[n],r=i.getGeometryType();e.push(vO[r].call(this,i))}return{type:"GeometryCollection",geometries:e}}};class bO{constructor(t){this.parser=new mO(t||new _O)}read(t){return this.parser.read(t)}}class MO{constructor(){this.parser=new mO(this.geometryFactory)}write(t){return this.parser.write(t)}}class wO{constructor(){wO.constructor_.apply(this,arguments)}static constructor_(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1}transformPoint(t,e){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))}transformPolygon(t,e){let n=!0;const i=this.transformLinearRing(t.getExteriorRing(),t);null!==i&&i instanceof Jk&&!i.isEmpty()||(n=!1);const r=new Lk;for(let e=0;e<t.getNumInteriorRing();e++){const i=this.transformLinearRing(t.getInteriorRingN(e),t);null===i||i.isEmpty()||(i instanceof Jk||(n=!1),r.add(i))}if(n)return this._factory.createPolygon(i,r.toArray([]));{const t=new Lk;return null!==i&&t.add(i),t.addAll(r),this._factory.buildGeometry(t)}}createCoordinateSequence(t){return this._factory.getCoordinateSequenceFactory().create(t)}getInputGeometry(){return this._inputGeom}transformMultiLineString(t,e){const n=new Lk;for(let e=0;e<t.getNumGeometries();e++){const i=this.transformLineString(t.getGeometryN(e),t);null!==i&&(i.isEmpty()||n.add(i))}return this._factory.buildGeometry(n)}transformCoordinates(t,e){return this.copy(t)}transformLineString(t,e){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))}transformMultiPoint(t,e){const n=new Lk;for(let e=0;e<t.getNumGeometries();e++){const i=this.transformPoint(t.getGeometryN(e),t);null!==i&&(i.isEmpty()||n.add(i))}return this._factory.buildGeometry(n)}transformMultiPolygon(t,e){const n=new Lk;for(let e=0;e<t.getNumGeometries();e++){const i=this.transformPolygon(t.getGeometryN(e),t);null!==i&&(i.isEmpty()||n.add(i))}return this._factory.buildGeometry(n)}copy(t){return t.copy()}transformGeometryCollection(t,e){const n=new Lk;for(let e=0;e<t.getNumGeometries();e++){const i=this.transform(t.getGeometryN(e));null!==i&&(this._pruneEmptyGeometry&&i.isEmpty()||n.add(i))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(_O.toGeometryArray(n)):this._factory.buildGeometry(n)}transform(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof kk)return this.transformPoint(t,null);if(t instanceof Hk)return this.transformMultiPoint(t,null);if(t instanceof Jk)return this.transformLinearRing(t,null);if(t instanceof Sk)return this.transformLineString(t,null);if(t instanceof pO)return this.transformMultiLineString(t,null);if(t instanceof Yk)return this.transformPolygon(t,null);if(t instanceof lO)return this.transformMultiPolygon(t,null);if(t instanceof Vk)return this.transformGeometryCollection(t,null);throw new tk("Unknown Geometry subtype: "+t.getGeometryType())}transformLinearRing(t,e){const n=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===n)return this._factory.createLinearRing(null);const i=n.size();return i>0&&i<4&&!this._preserveType?this._factory.createLineString(n):this._factory.createLinearRing(n)}}class EO{static intersection(t,e,n,i){const r=t.x<e.x?t.x:e.x,s=t.y<e.y?t.y:e.y,o=t.x>e.x?t.x:e.x,a=t.y>e.y?t.y:e.y,l=n.x<i.x?n.x:i.x,c=n.y<i.y?n.y:i.y,h=n.x>i.x?n.x:i.x,u=n.y>i.y?n.y:i.y,f=((r>l?r:l)+(o<h?o:h))/2,d=((s>c?s:c)+(a<u?a:u))/2,g=t.x-f,p=t.y-d,_=e.x-f,y=e.y-d,m=n.x-f,x=n.y-d,v=i.x-f,b=i.y-d,M=p-y,w=_-g,E=g*y-_*p,S=x-b,N=v-m,I=m*b-v*x,k=M*N-S*w,O=(w*I-N*E)/k,C=(S*E-M*I)/k;return HI.isNaN(O)||HI.isInfinite(O)||HI.isNaN(C)||HI.isInfinite(C)?null:new fk(O+f,C+d)}}class SO{static segmentToSegment(t,e,n,i){if(t.equals(e))return SO.pointToSegment(t,n,i);if(n.equals(i))return SO.pointToSegment(i,t,e);let r=!1;if(gk.intersects(t,e,n,i)){const s=(e.x-t.x)*(i.y-n.y)-(e.y-t.y)*(i.x-n.x);if(0===s)r=!0;else{const o=(t.y-n.y)*(i.x-n.x)-(t.x-n.x)*(i.y-n.y),a=((t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y))/s,l=o/s;(l<0||l>1||a<0||a>1)&&(r=!0)}}else r=!0;return r?nO.min(SO.pointToSegment(t,n,i),SO.pointToSegment(e,n,i),SO.pointToSegment(n,t,e),SO.pointToSegment(i,t,e)):0}static pointToSegment(t,e,n){if(e.x===n.x&&e.y===n.y)return t.distance(e);const i=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),r=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/i;if(r<=0)return t.distance(e);if(r>=1)return t.distance(n);const s=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/i;return Math.abs(s)*Math.sqrt(i)}static pointToLinePerpendicular(t,e,n){const i=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),r=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/i;return Math.abs(r)*Math.sqrt(i)}static pointToSegmentString(t,e){if(0===e.length)throw new tk("Line array must contain at least one vertex");let n=t.distance(e[0]);for(let i=0;i<e.length-1;i++){const r=SO.pointToSegment(t,e[i],e[i+1]);r<n&&(n=r)}return n}}const NO="XY",IO="XYZ",kO="XYM",OO="XYZM",CO={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},AO="EMPTY",TO=1,RO=2,LO=3,PO=4,DO=5,zO=6;for(const t in CO)CO[t].toUpperCase();class FO{constructor(t){this.wkt=t,this.index_=-1}isAlpha_(t){return t>="a"&&t<="z"||t>="A"&&t<="Z"}isNumeric_(t,e){return t>="0"&&t<="9"||"."==t&&!(void 0!==e&&e)}isWhiteSpace_(t){return" "==t||"\t"==t||"\r"==t||"\n"==t}nextChar_(){return this.wkt.charAt(++this.index_)}nextToken(){const t=this.nextChar_(),e=this.index_;let n,i=t;if("("==t)n=RO;else if(","==t)n=DO;else if(")"==t)n=LO;else if(this.isNumeric_(t)||"-"==t)n=PO,i=this.readNumber_();else if(this.isAlpha_(t))n=TO,i=this.readText_();else{if(this.isWhiteSpace_(t))return this.nextToken();if(""!==t)throw new Error("Unexpected character: "+t);n=zO}return{position:e,value:i,type:n}}readNumber_(){let t;const e=this.index_;let n=!1,i=!1;do{"."==t?n=!0:"e"!=t&&"E"!=t||(i=!0),t=this.nextChar_()}while(this.isNumeric_(t,n)||!i&&("e"==t||"E"==t)||i&&("-"==t||"+"==t));return parseFloat(this.wkt.substring(e,this.index_--))}readText_(){let t;const e=this.index_;do{t=this.nextChar_()}while(this.isAlpha_(t));return this.wkt.substring(e,this.index_--).toUpperCase()}}class GO{constructor(t,e){this.lexer_=t,this.token_,this.layout_=NO,this.factory=e}consume_(){this.token_=this.lexer_.nextToken()}isTokenType(t){return this.token_.type==t}match(t){const e=this.isTokenType(t);return e&&this.consume_(),e}parse(){this.consume_();return this.parseGeometry_()}parseGeometryLayout_(){let t=NO;const e=this.token_;if(this.isTokenType(TO)){const n=e.value;"Z"===n?t=IO:"M"===n?t=kO:"ZM"===n&&(t=OO),t!==NO&&this.consume_()}return t}parseGeometryCollectionText_(){if(this.match(RO)){const t=[];do{t.push(this.parseGeometry_())}while(this.match(DO));if(this.match(LO))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parsePointText_(){if(this.match(RO)){const t=this.parsePoint_();if(this.match(LO))return t}else if(this.isEmptyGeometry_())return null;throw new Error(this.formatErrorMessage_())}parseLineStringText_(){if(this.match(RO)){const t=this.parsePointList_();if(this.match(LO))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parsePolygonText_(){if(this.match(RO)){const t=this.parseLineStringTextList_();if(this.match(LO))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parseMultiPointText_(){if(this.match(RO)){let t;if(t=this.token_.type==RO?this.parsePointTextList_():this.parsePointList_(),this.match(LO))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parseMultiLineStringText_(){if(this.match(RO)){const t=this.parseLineStringTextList_();if(this.match(LO))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parseMultiPolygonText_(){if(this.match(RO)){const t=this.parsePolygonTextList_();if(this.match(LO))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parsePoint_(){const t=[],e=this.layout_.length;for(let n=0;n<e;++n){const e=this.token_;if(!this.match(PO))break;t.push(e.value)}if(t.length==e)return t;throw new Error(this.formatErrorMessage_())}parsePointList_(){const t=[this.parsePoint_()];for(;this.match(DO);)t.push(this.parsePoint_());return t}parsePointTextList_(){const t=[this.parsePointText_()];for(;this.match(DO);)t.push(this.parsePointText_());return t}parseLineStringTextList_(){const t=[this.parseLineStringText_()];for(;this.match(DO);)t.push(this.parseLineStringText_());return t}parsePolygonTextList_(){const t=[this.parsePolygonText_()];for(;this.match(DO);)t.push(this.parsePolygonText_());return t}isEmptyGeometry_(){const t=this.isTokenType(TO)&&this.token_.value==AO;return t&&this.consume_(),t}formatErrorMessage_(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}parseGeometry_(){const t=this.factory,e=t=>new fk(...t),n=n=>{const i=n.map((n=>t.createLinearRing(n.map(e))));return i.length>1?t.createPolygon(i[0],i.slice(1)):t.createPolygon(i[0])},i=this.token_;if(this.match(TO)){const r=i.value;if(this.layout_=this.parseGeometryLayout_(),"GEOMETRYCOLLECTION"==r){const e=this.parseGeometryCollectionText_();return t.createGeometryCollection(e)}switch(r){case"POINT":{const e=this.parsePointText_();return e?t.createPoint(new fk(...e)):t.createPoint()}case"LINESTRING":{const n=this.parseLineStringText_().map(e);return t.createLineString(n)}case"LINEARRING":{const n=this.parseLineStringText_().map(e);return t.createLinearRing(n)}case"POLYGON":{const e=this.parsePolygonText_();return e&&0!==e.length?n(e):t.createPolygon()}case"MULTIPOINT":{const n=this.parseMultiPointText_();if(!n||0===n.length)return t.createMultiPoint();const i=n.map(e).map((e=>t.createPoint(e)));return t.createMultiPoint(i)}case"MULTILINESTRING":{const n=this.parseMultiLineStringText_().map((n=>t.createLineString(n.map(e))));return t.createMultiLineString(n)}case"MULTIPOLYGON":{const e=this.parseMultiPolygonText_();if(!e||0===e.length)return t.createMultiPolygon();const i=e.map(n);return t.createMultiPolygon(i)}default:throw new Error("Invalid geometry type: "+r)}}throw new Error(this.formatErrorMessage_())}}function jO(t){if(t.isEmpty())return"";const e=t.getCoordinate(),n=[e.x,e.y];return void 0===e.z||Number.isNaN(e.z)||n.push(e.z),void 0===e.m||Number.isNaN(e.m)||n.push(e.m),n.join(" ")}function qO(t){const e=t.getCoordinates().map((t=>{const e=[t.x,t.y];return void 0===t.z||Number.isNaN(t.z)||e.push(t.z),void 0===t.m||Number.isNaN(t.m)||e.push(t.m),e})),n=[];for(let t=0,i=e.length;t<i;++t)n.push(e[t].join(" "));return n.join(", ")}function BO(t){const e=[];e.push("("+qO(t.getExteriorRing())+")");for(let n=0,i=t.getNumInteriorRing();n<i;++n)e.push("("+qO(t.getInteriorRingN(n))+")");return e.join(", ")}const YO={Point:jO,LineString:qO,LinearRing:qO,Polygon:BO,MultiPoint:function(t){const e=[];for(let n=0,i=t.getNumGeometries();n<i;++n)e.push("("+jO(t.getGeometryN(n))+")");return e.join(", ")},MultiLineString:function(t){const e=[];for(let n=0,i=t.getNumGeometries();n<i;++n)e.push("("+qO(t.getGeometryN(n))+")");return e.join(", ")},MultiPolygon:function(t){const e=[];for(let n=0,i=t.getNumGeometries();n<i;++n)e.push("("+BO(t.getGeometryN(n))+")");return e.join(", ")},GeometryCollection:function(t){const e=[];for(let n=0,i=t.getNumGeometries();n<i;++n)e.push($O(t.getGeometryN(n)));return e.join(", ")}};function $O(t){let e=t.getGeometryType();const n=YO[e];e=e.toUpperCase();const i=function(t){let e="";if(t.isEmpty())return e;const n=t.getCoordinate();return void 0===n.z||Number.isNaN(n.z)||(e+="Z"),void 0===n.m||Number.isNaN(n.m)||(e+="M"),e}(t);if(i.length>0&&(e+=" "+i),t.isEmpty())return e+" "+AO;return e+" ("+n(t)+")"}class UO{constructor(t){this.geometryFactory=t||new _O,this.precisionModel=this.geometryFactory.getPrecisionModel()}read(t){const e=new FO(t);return new GO(e,this.geometryFactory).parse()}write(t){return $O(t)}}class WO{constructor(t){this.parser=new UO(t)}write(t){return this.parser.write(t)}static toLineString(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"}}class XO{constructor(){XO.constructor_.apply(this,arguments)}static constructor_(){this._result=null,this._inputLines=Array(2).fill().map((()=>Array(2))),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new fk,this._intPt[1]=new fk,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0}static computeEdgeDistance(t,e,n){const i=Math.abs(n.x-e.x),r=Math.abs(n.y-e.y);let s=-1;if(t.equals(e))s=0;else if(t.equals(n))s=i>r?i:r;else{const n=Math.abs(t.x-e.x),o=Math.abs(t.y-e.y);s=i>r?n:o,0!==s||t.equals(e)||(s=Math.max(n,o))}return lk.isTrue(!(0===s&&!t.equals(e)),"Bad distance calculation"),s}static nonRobustComputeEdgeDistance(t,e,n){const i=t.x-e.x,r=t.y-e.y,s=Math.sqrt(i*i+r*r);return lk.isTrue(!(0===s&&!t.equals(e)),"Invalid distance calculation"),s}getIndexAlongSegment(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]}getTopologySummary(){const t=new sO;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()}computeIntersection(t,e,n,i){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=n,this._inputLines[1][1]=i,this._result=this.computeIntersect(t,e,n,i)}getIntersectionNum(){return this._result}computeIntLineIndex(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map((()=>Array(2))),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){const t=arguments[0];this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}}isProper(){return this.hasIntersection()&&this._isProper}setPrecisionModel(t){this._precisionModel=t}isInteriorIntersection(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){const t=arguments[0];for(let e=0;e<this._result;e++)if(!this._intPt[e].equals2D(this._inputLines[t][0])&&!this._intPt[e].equals2D(this._inputLines[t][1]))return!0;return!1}}getIntersection(t){return this._intPt[t]}isEndPoint(){return this.hasIntersection()&&!this._isProper}hasIntersection(){return this._result!==XO.NO_INTERSECTION}getEdgeDistance(t,e){return XO.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])}isCollinear(){return this._result===XO.COLLINEAR_INTERSECTION}toString(){return WO.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+WO.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()}getEndpoint(t,e){return this._inputLines[t][e]}isIntersection(t){for(let e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1}getIntersectionAlongSegment(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]}}XO.DONT_INTERSECT=0,XO.DO_INTERSECT=1,XO.COLLINEAR=2,XO.NO_INTERSECTION=0,XO.POINT_INTERSECTION=1,XO.COLLINEAR_INTERSECTION=2;class VO extends XO{constructor(){super()}static nearestEndpoint(t,e,n,i){let r=t,s=SO.pointToSegment(t,n,i),o=SO.pointToSegment(e,n,i);return o<s&&(s=o,r=e),o=SO.pointToSegment(n,t,e),o<s&&(s=o,r=n),o=SO.pointToSegment(i,t,e),o<s&&(s=o,r=i),r}isInSegmentEnvelopes(t){const e=new gk(this._inputLines[0][0],this._inputLines[0][1]),n=new gk(this._inputLines[1][0],this._inputLines[1][1]);return e.contains(t)&&n.contains(t)}computeIntersection(){if(3!==arguments.length)return super.computeIntersection.apply(this,arguments);{const t=arguments[0],e=arguments[1],n=arguments[2];if(this._isProper=!1,gk.intersects(e,n,t)&&0===qk.index(e,n,t)&&0===qk.index(n,e,t))return this._isProper=!0,(t.equals(e)||t.equals(n))&&(this._isProper=!1),this._result=XO.POINT_INTERSECTION,null;this._result=XO.NO_INTERSECTION}}intersection(t,e,n,i){let r=this.intersectionSafe(t,e,n,i);return this.isInSegmentEnvelopes(r)||(r=new fk(VO.nearestEndpoint(t,e,n,i))),null!==this._precisionModel&&this._precisionModel.makePrecise(r),r}checkDD(t,e,n,i,r){const s=jk.intersection(t,e,n,i),o=this.isInSegmentEnvelopes(s);iO.out.println("DD in env = "+o+"  --------------------- "+s),r.distance(s)>1e-4&&iO.out.println("Distance = "+r.distance(s))}intersectionSafe(t,e,n,i){let r=EO.intersection(t,e,n,i);return null===r&&(r=VO.nearestEndpoint(t,e,n,i)),r}computeCollinearIntersection(t,e,n,i){const r=gk.intersects(t,e,n),s=gk.intersects(t,e,i),o=gk.intersects(n,i,t),a=gk.intersects(n,i,e);return r&&s?(this._intPt[0]=n,this._intPt[1]=i,XO.COLLINEAR_INTERSECTION):o&&a?(this._intPt[0]=t,this._intPt[1]=e,XO.COLLINEAR_INTERSECTION):r&&o?(this._intPt[0]=n,this._intPt[1]=t,!n.equals(t)||s||a?XO.COLLINEAR_INTERSECTION:XO.POINT_INTERSECTION):r&&a?(this._intPt[0]=n,this._intPt[1]=e,!n.equals(e)||s||o?XO.COLLINEAR_INTERSECTION:XO.POINT_INTERSECTION):s&&o?(this._intPt[0]=i,this._intPt[1]=t,!i.equals(t)||r||a?XO.COLLINEAR_INTERSECTION:XO.POINT_INTERSECTION):s&&a?(this._intPt[0]=i,this._intPt[1]=e,!i.equals(e)||r||o?XO.COLLINEAR_INTERSECTION:XO.POINT_INTERSECTION):XO.NO_INTERSECTION}computeIntersect(t,e,n,i){if(this._isProper=!1,!gk.intersects(t,e,n,i))return XO.NO_INTERSECTION;const r=qk.index(t,e,n),s=qk.index(t,e,i);if(r>0&&s>0||r<0&&s<0)return XO.NO_INTERSECTION;const o=qk.index(n,i,t),a=qk.index(n,i,e);if(o>0&&a>0||o<0&&a<0)return XO.NO_INTERSECTION;return 0===r&&0===s&&0===o&&0===a?this.computeCollinearIntersection(t,e,n,i):(0===r||0===s||0===o||0===a?(this._isProper=!1,t.equals2D(n)||t.equals2D(i)?this._intPt[0]=t:e.equals2D(n)||e.equals2D(i)?this._intPt[0]=e:0===r?this._intPt[0]=new fk(n):0===s?this._intPt[0]=new fk(i):0===o?this._intPt[0]=new fk(t):0===a&&(this._intPt[0]=new fk(e))):(this._isProper=!0,this._intPt[0]=this.intersection(t,e,n,i)),XO.POINT_INTERSECTION)}}class HO{constructor(){HO.constructor_.apply(this,arguments)}static constructor_(){if(this.p0=null,this.p1=null,0===arguments.length)HO.constructor_.call(this,new fk,new fk);else if(1===arguments.length){const t=arguments[0];HO.constructor_.call(this,t.p0,t.p1)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.p0=t,this.p1=e}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];HO.constructor_.call(this,new fk(t,e),new fk(n,i))}}static midPoint(t,e){return new fk((t.x+e.x)/2,(t.y+e.y)/2)}minX(){return Math.min(this.p0.x,this.p1.x)}orientationIndex(){if(arguments[0]instanceof HO){const t=arguments[0],e=qk.index(this.p0,this.p1,t.p0),n=qk.index(this.p0,this.p1,t.p1);return e>=0&&n>=0||e<=0&&n<=0?Math.max(e,n):0}if(arguments[0]instanceof fk){const t=arguments[0];return qk.index(this.p0,this.p1,t)}}toGeometry(t){return t.createLineString([this.p0,this.p1])}isVertical(){return this.p0.x===this.p1.x}equals(t){if(!(t instanceof HO))return!1;const e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)}intersection(t){const e=new VO;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null}project(){if(arguments[0]instanceof fk){const t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new fk(t);const e=this.projectionFactor(t),n=new fk;return n.x=this.p0.x+e*(this.p1.x-this.p0.x),n.y=this.p0.y+e*(this.p1.y-this.p0.y),n}if(arguments[0]instanceof HO){const t=arguments[0],e=this.projectionFactor(t.p0),n=this.projectionFactor(t.p1);if(e>=1&&n>=1)return null;if(e<=0&&n<=0)return null;let i=this.project(t.p0);e<0&&(i=this.p0),e>1&&(i=this.p1);let r=this.project(t.p1);return n<0&&(r=this.p0),n>1&&(r=this.p1),new HO(i,r)}}normalize(){this.p1.compareTo(this.p0)<0&&this.reverse()}angle(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)}getCoordinate(t){return 0===t?this.p0:this.p1}distancePerpendicular(t){return SO.pointToLinePerpendicular(t,this.p0,this.p1)}minY(){return Math.min(this.p0.y,this.p1.y)}midPoint(){return HO.midPoint(this.p0,this.p1)}projectionFactor(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;const e=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,i=e*e+n*n;if(i<=0)return HI.NaN;return((t.x-this.p0.x)*e+(t.y-this.p0.y)*n)/i}closestPoints(t){const e=this.intersection(t);if(null!==e)return[e,e];const n=new Array(2).fill(null);let i=HI.MAX_VALUE,r=null;const s=this.closestPoint(t.p0);i=s.distance(t.p0),n[0]=s,n[1]=t.p0;const o=this.closestPoint(t.p1);r=o.distance(t.p1),r<i&&(i=r,n[0]=o,n[1]=t.p1);const a=t.closestPoint(this.p0);r=a.distance(this.p0),r<i&&(i=r,n[0]=this.p0,n[1]=a);const l=t.closestPoint(this.p1);return r=l.distance(this.p1),r<i&&(i=r,n[0]=this.p1,n[1]=l),n}closestPoint(t){const e=this.projectionFactor(t);if(e>0&&e<1)return this.project(t);return this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1}maxX(){return Math.max(this.p0.x,this.p1.x)}getLength(){return this.p0.distance(this.p1)}compareTo(t){const e=t,n=this.p0.compareTo(e.p0);return 0!==n?n:this.p1.compareTo(e.p1)}reverse(){const t=this.p0;this.p0=this.p1,this.p1=t}equalsTopo(t){return this.p0.equals(t.p0)&&this.p1.equals(t.p1)||this.p0.equals(t.p1)&&this.p1.equals(t.p0)}lineIntersection(t){return EO.intersection(this.p0,this.p1,t.p0,t.p1)}maxY(){return Math.max(this.p0.y,this.p1.y)}pointAlongOffset(t,e){const n=this.p0.x+t*(this.p1.x-this.p0.x),i=this.p0.y+t*(this.p1.y-this.p0.y),r=this.p1.x-this.p0.x,s=this.p1.y-this.p0.y,o=Math.sqrt(r*r+s*s);let a=0,l=0;if(0!==e){if(o<=0)throw new Ik("Cannot compute offset from zero-length line segment");a=e*r/o,l=e*s/o}return new fk(n-l,i+a)}setCoordinates(){if(1===arguments.length){const t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.p0.x=t.x,this.p0.y=t.y,this.p1.x=e.x,this.p1.y=e.y}}segmentFraction(t){let e=this.projectionFactor(t);return e<0?e=0:(e>1||HI.isNaN(e))&&(e=1),e}toString(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"}isHorizontal(){return this.p0.y===this.p1.y}reflect(t){const e=this.p1.getY()-this.p0.getY(),n=this.p0.getX()-this.p1.getX(),i=this.p0.getY()*(this.p1.getX()-this.p0.getX())-this.p0.getX()*(this.p1.getY()-this.p0.getY()),r=e*e+n*n,s=e*e-n*n,o=t.getX(),a=t.getY();return new fk((-s*o-2*e*n*a-2*e*i)/r,(s*a-2*e*n*o-2*n*i)/r)}distance(){if(arguments[0]instanceof HO){const t=arguments[0];return SO.segmentToSegment(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof fk){const t=arguments[0];return SO.pointToSegment(t,this.p0,this.p1)}}pointAlong(t){const e=new fk;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e}hashCode(){let t=HI.doubleToLongBits(this.p0.x);t^=31*HI.doubleToLongBits(this.p0.y);const e=Math.trunc(t)^Math.trunc(t>>32);let n=HI.doubleToLongBits(this.p1.x);n^=31*HI.doubleToLongBits(this.p1.y);return e^(Math.trunc(n)^Math.trunc(n>>32))}get interfaces_(){return[nk,ik]}}class JO{constructor(){JO.constructor_.apply(this,arguments)}static constructor_(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new HO,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Sk&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1];JO.constructor_.call(this,t.getCoordinates(),e)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1];this._srcPts=t,this._isClosed=JO.isClosed(t),this._snapTolerance=e}}static isClosed(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])}snapVertices(t,e){const n=this._isClosed?t.size()-1:t.size();for(let i=0;i<n;i++){const n=t.get(i),r=this.findSnapForVertex(n,e);null!==r&&(t.set(i,new fk(r)),0===i&&this._isClosed&&t.set(t.size()-1,new fk(r)))}}findSnapForVertex(t,e){for(let n=0;n<e.length;n++){if(t.equals2D(e[n]))return null;if(t.distance(e[n])<this._snapTolerance)return e[n]}return null}snapTo(t){const e=new eO(this._srcPts);this.snapVertices(e,t),this.snapSegments(e,t);return e.toCoordinateArray()}snapSegments(t,e){if(0===e.length)return null;let n=e.length;e[0].equals2D(e[e.length-1])&&(n=e.length-1);for(let i=0;i<n;i++){const n=e[i],r=this.findSegmentIndexToSnap(n,t);r>=0&&t.add(r+1,new fk(n),!1)}}findSegmentIndexToSnap(t,e){let n=HI.MAX_VALUE,i=-1;for(let r=0;r<e.size()-1;r++){if(this._seg.p0=e.get(r),this._seg.p1=e.get(r+1),this._seg.p0.equals2D(t)||this._seg.p1.equals2D(t)){if(this._allowSnappingToSourceVertices)continue;return-1}const s=this._seg.distance(t);s<this._snapTolerance&&s<n&&(n=s,i=r)}return i}setAllowSnappingToSourceVertices(t){this._allowSnappingToSourceVertices=t}}class ZO{constructor(){ZO.constructor_.apply(this,arguments)}static constructor_(){this._srcGeom=null;const t=arguments[0];this._srcGeom=t}static snap(t,e,n){const i=new Array(2).fill(null),r=new ZO(t);i[0]=r.snapTo(e,n);const s=new ZO(e);return i[1]=s.snapTo(i[0],n),i}static computeOverlaySnapTolerance(){if(1===arguments.length){const t=arguments[0];let e=ZO.computeSizeBasedSnapTolerance(t);const n=t.getPrecisionModel();if(n.getType()===dO.FIXED){const t=1/n.getScale()*2/1.415;t>e&&(e=t)}return e}if(2===arguments.length){const t=arguments[0],e=arguments[1];return Math.min(ZO.computeOverlaySnapTolerance(t),ZO.computeOverlaySnapTolerance(e))}}static computeSizeBasedSnapTolerance(t){const e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*ZO.SNAP_PRECISION_FACTOR}static snapToSelf(t,e,n){return new ZO(t).snapToSelf(e,n)}snapTo(t,e){const n=this.extractTargetCoordinates(t);return new QO(e,n).transform(this._srcGeom)}snapToSelf(t,e){const n=this.extractTargetCoordinates(this._srcGeom),i=new QO(t,n,!0).transform(this._srcGeom);let r=i;return e&&XI(r,Bk)&&(r=i.buffer(0)),r}computeSnapTolerance(t){return this.computeMinimumSegmentLength(t)/10}extractTargetCoordinates(t){const e=new Wk,n=t.getCoordinates();for(let t=0;t<n.length;t++)e.add(n[t]);return e.toArray(new Array(0).fill(null))}computeMinimumSegmentLength(t){let e=HI.MAX_VALUE;for(let n=0;n<t.length-1;n++){const i=t[n].distance(t[n+1]);i<e&&(e=i)}return e}}ZO.SNAP_PRECISION_FACTOR=1e-9;class QO extends wO{constructor(){super(),QO.constructor_.apply(this,arguments)}static constructor_(){if(this._snapTolerance=null,this._snapPts=null,this._isSelfSnap=!1,2===arguments.length){const t=arguments[0],e=arguments[1];this._snapTolerance=t,this._snapPts=e}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this._snapTolerance=t,this._snapPts=e,this._isSelfSnap=n}}snapLine(t,e){const n=new JO(t,this._snapTolerance);return n.setAllowSnappingToSourceVertices(this._isSelfSnap),n.snapTo(e)}transformCoordinates(t,e){const n=t.toCoordinateArray(),i=this.snapLine(n,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(i)}}class KO{constructor(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=new VI,this._commonSignExp=null}getCommon(){return HI.longBitsToDouble(this._commonBits)}add(t){const e=HI.doubleToLongBits(t);if(this._isFirst)return this._commonBits=e,this._commonSignExp=KO.signExpBits(this._commonBits),this._isFirst=!1,null;if(KO.signExpBits(e)!==this._commonSignExp)return this._commonBits.high=0,this._commonBits.low=0,null;this._commonMantissaBitsCount=KO.numCommonMostSigMantissaBits(this._commonBits,e),this._commonBits=KO.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))}toString(){if(1===arguments.length){const t=arguments[0],e=HI.longBitsToDouble(t),n="0000000000000000000000000000000000000000000000000000000000000000"+VI.toBinaryString(t),i=n.substring(n.length-64);return i.substring(0,1)+"  "+i.substring(1,12)+"(exp) "+i.substring(12)+" [ "+e+" ]"}}getClass(){return KO}get interfaces_(){return[]}static getBit(t,e){const n=1<<e%32;return e<32?0!=(t.low&n)?1:0:0!=(t.high&n)?1:0}static signExpBits(t){return t.high>>>20}static zeroLowerBits(t,e){let n="low";if(e>32&&(t.low=0,e%=32,n="high"),e>0){const i=e<32?~((1<<e)-1):0;t[n]&=i}return t}static numCommonMostSigMantissaBits(t,e){let n=0;for(let i=52;i>=0;i--){if(KO.getBit(t,i)!==KO.getBit(e,i))return n;n++}return 52}}class tC{constructor(){tC.constructor_.apply(this,arguments)}static constructor_(){this._commonCoord=null,this._ccFilter=new eC}addCommonBits(t){const e=new nC(this._commonCoord);t.apply(e),t.geometryChanged()}removeCommonBits(t){if(0===this._commonCoord.x&&0===this._commonCoord.y)return t;const e=new fk(this._commonCoord);e.x=-e.x,e.y=-e.y;const n=new nC(e);return t.apply(n),t.geometryChanged(),t}getCommonCoordinate(){return this._commonCoord}add(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()}}class eC{constructor(){eC.constructor_.apply(this,arguments)}static constructor_(){this._commonBitsX=new KO,this._commonBitsY=new KO}filter(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)}getCommonCoordinate(){return new fk(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())}get interfaces_(){return[_k]}}class nC{constructor(){nC.constructor_.apply(this,arguments)}static constructor_(){this.trans=null;const t=arguments[0];this.trans=t}filter(t,e){const n=t.getOrdinate(e,0)+this.trans.x,i=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,n),t.setOrdinate(e,1,i)}isDone(){return!1}isGeometryChanged(){return!0}get interfaces_(){return[Ek]}}tC.CommonCoordinateFilter=eC,tC.Translater=nC;class iC{static toLocationSymbol(t){switch(t){case iC.EXTERIOR:return"e";case iC.BOUNDARY:return"b";case iC.INTERIOR:return"i";case iC.NONE:return"-"}throw new tk("Unknown location value: "+t)}}iC.INTERIOR=0,iC.BOUNDARY=1,iC.EXTERIOR=2,iC.NONE=-1;class rC{constructor(){rC.constructor_.apply(this,arguments)}static constructor_(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;const t=arguments[0];this._p=t}static locatePointInRing(){if(arguments[0]instanceof fk&&XI(arguments[1],ZI)){const t=arguments[1],e=new rC(arguments[0]),n=new fk,i=new fk;for(let r=1;r<t.size();r++)if(t.getCoordinate(r,n),t.getCoordinate(r-1,i),e.countSegment(n,i),e.isOnSegment())return e.getLocation();return e.getLocation()}if(arguments[0]instanceof fk&&arguments[1]instanceof Array){const t=arguments[1],e=new rC(arguments[0]);for(let n=1;n<t.length;n++){const i=t[n],r=t[n-1];if(e.countSegment(i,r),e.isOnSegment())return e.getLocation()}return e.getLocation()}}countSegment(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){let n=t.x,i=e.x;return n>i&&(n=e.x,i=t.x),this._p.x>=n&&this._p.x<=i&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){let n=qk.index(t,e,this._p);if(n===qk.COLLINEAR)return this._isPointOnSegment=!0,null;e.y<t.y&&(n=-n),n===qk.LEFT&&this._crossingCount++}}isPointInPolygon(){return this.getLocation()!==iC.EXTERIOR}getLocation(){return this._isPointOnSegment?iC.BOUNDARY:this._crossingCount%2==1?iC.INTERIOR:iC.EXTERIOR}isOnSegment(){return this._isPointOnSegment}}class sC{static isOnLine(){if(arguments[0]instanceof fk&&XI(arguments[1],ZI)){const t=arguments[0],e=arguments[1],n=new VO,i=new fk,r=new fk,s=e.size();for(let o=1;o<s;o++)if(e.getCoordinate(o-1,i),e.getCoordinate(o,r),n.computeIntersection(t,i,r),n.hasIntersection())return!0;return!1}if(arguments[0]instanceof fk&&arguments[1]instanceof Array){const t=arguments[0],e=arguments[1],n=new VO;for(let i=1;i<e.length;i++){const r=e[i-1],s=e[i];if(n.computeIntersection(t,r,s),n.hasIntersection())return!0}return!1}}static locateInRing(t,e){return rC.locatePointInRing(t,e)}static isInRing(t,e){return sC.locateInRing(t,e)!==iC.EXTERIOR}}class oC{isInBoundary(t){}}class aC{isInBoundary(t){return t%2==1}get interfaces_(){return[oC]}}class lC{isInBoundary(t){return t>0}get interfaces_(){return[oC]}}class cC{isInBoundary(t){return t>1}get interfaces_(){return[oC]}}class hC{isInBoundary(t){return 1===t}get interfaces_(){return[oC]}}oC.Mod2BoundaryNodeRule=aC,oC.EndPointBoundaryNodeRule=lC,oC.MultiValentEndPointBoundaryNodeRule=cC,oC.MonoValentEndPointBoundaryNodeRule=hC,oC.MOD2_BOUNDARY_RULE=new aC,oC.ENDPOINT_BOUNDARY_RULE=new lC,oC.MULTIVALENT_ENDPOINT_BOUNDARY_RULE=new cC,oC.MONOVALENT_ENDPOINT_BOUNDARY_RULE=new hC,oC.OGC_SFS_BOUNDARY_RULE=oC.MOD2_BOUNDARY_RULE;class uC{hasNext(){}next(){}remove(){}}class fC{constructor(){fC.constructor_.apply(this,arguments)}static constructor_(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;const t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()}static isAtomic(t){return!(t instanceof Vk)}next(){if(this._atStart)return this._atStart=!1,fC.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new Rk;const t=this._parent.getGeometryN(this._index++);return t instanceof Vk?(this._subcollectionIterator=new fC(t),this._subcollectionIterator.next()):t}remove(){throw new vk(this.getClass().getName())}hasNext(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)}get interfaces_(){return[uC]}}class dC{constructor(){dC.constructor_.apply(this,arguments)}static constructor_(){if(this._boundaryRule=oC.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0===arguments.length);else if(1===arguments.length){const t=arguments[0];if(null===t)throw new tk("Rule must be non-null");this._boundaryRule=t}}locateInPolygonRing(t,e){return e.getEnvelopeInternal().intersects(t)?sC.locateInRing(t,e.getCoordinates()):iC.EXTERIOR}intersects(t,e){return this.locate(t,e)!==iC.EXTERIOR}updateLocationInfo(t){t===iC.INTERIOR&&(this._isIn=!0),t===iC.BOUNDARY&&this._numBoundaries++}computeLocation(t,e){if(e instanceof kk&&this.updateLocationInfo(this.locateOnPoint(t,e)),e instanceof Sk)this.updateLocationInfo(this.locateOnLineString(t,e));else if(e instanceof Yk)this.updateLocationInfo(this.locateInPolygon(t,e));else if(e instanceof pO){const n=e;for(let e=0;e<n.getNumGeometries();e++){const i=n.getGeometryN(e);this.updateLocationInfo(this.locateOnLineString(t,i))}}else if(e instanceof lO){const n=e;for(let e=0;e<n.getNumGeometries();e++){const i=n.getGeometryN(e);this.updateLocationInfo(this.locateInPolygon(t,i))}}else if(e instanceof Vk){const n=new fC(e);for(;n.hasNext();){const i=n.next();i!==e&&this.computeLocation(t,i)}}}locateOnPoint(t,e){return e.getCoordinate().equals2D(t)?iC.INTERIOR:iC.EXTERIOR}locateOnLineString(t,e){if(!e.getEnvelopeInternal().intersects(t))return iC.EXTERIOR;const n=e.getCoordinateSequence();return e.isClosed()||!t.equals(n.getCoordinate(0))&&!t.equals(n.getCoordinate(n.size()-1))?sC.isOnLine(t,n)?iC.INTERIOR:iC.EXTERIOR:iC.BOUNDARY}locateInPolygon(t,e){if(e.isEmpty())return iC.EXTERIOR;const n=e.getExteriorRing(),i=this.locateInPolygonRing(t,n);if(i===iC.EXTERIOR)return iC.EXTERIOR;if(i===iC.BOUNDARY)return iC.BOUNDARY;for(let n=0;n<e.getNumInteriorRing();n++){const i=e.getInteriorRingN(n),r=this.locateInPolygonRing(t,i);if(r===iC.INTERIOR)return iC.EXTERIOR;if(r===iC.BOUNDARY)return iC.BOUNDARY}return iC.INTERIOR}locate(t,e){return e.isEmpty()?iC.EXTERIOR:e instanceof Sk?this.locateOnLineString(t,e):e instanceof Yk?this.locateInPolygon(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?iC.BOUNDARY:this._numBoundaries>0||this._isIn?iC.INTERIOR:iC.EXTERIOR)}}class gC{static octant(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new tk("Cannot compute the octant for point ( "+t+", "+e+" )");const n=Math.abs(t),i=Math.abs(e);return t>=0?e>=0?n>=i?0:1:n>=i?7:6:e>=0?n>=i?3:2:n>=i?4:5}if(arguments[0]instanceof fk&&arguments[1]instanceof fk){const t=arguments[0],e=arguments[1],n=e.x-t.x,i=e.y-t.y;if(0===n&&0===i)throw new tk("Cannot compute the octant for two identical points "+t);return gC.octant(n,i)}}}class pC{getCoordinates(){}size(){}getCoordinate(t){}isClosed(){}setData(t){}getData(){}}class _C{constructor(){_C.constructor_.apply(this,arguments)}static constructor_(){this._pts=null,this._data=null;const t=arguments[0],e=arguments[1];this._pts=t,this._data=e}getCoordinates(){return this._pts}size(){return this._pts.length}getCoordinate(t){return this._pts[t]}isClosed(){return this._pts[0].equals(this._pts[this._pts.length-1])}getSegmentOctant(t){return t===this._pts.length-1?-1:gC.octant(this.getCoordinate(t),this.getCoordinate(t+1))}setData(t){this._data=t}getData(){return this._data}toString(){return WO.toLineString(new oO(this._pts))}get interfaces_(){return[pC]}}class yC{getBounds(){}}class mC{constructor(){mC.constructor_.apply(this,arguments)}static constructor_(){this._bounds=null,this._item=null;const t=arguments[0],e=arguments[1];this._bounds=t,this._item=e}getItem(){return this._item}getBounds(){return this._bounds}get interfaces_(){return[yC,ik]}}class xC{constructor(){xC.constructor_.apply(this,arguments)}static constructor_(){this._size=null,this._items=null,this._size=0,this._items=new Lk,this._items.add(null)}poll(){if(this.isEmpty())return null;const t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t}size(){return this._size}reorder(t){let e=null;const n=this._items.get(t);for(;2*t<=this._size&&(e=2*t,e!==this._size&&this._items.get(e+1).compareTo(this._items.get(e))<0&&e++,this._items.get(e).compareTo(n)<0);t=e)this._items.set(t,this._items.get(e));this._items.set(t,n)}clear(){this._size=0,this._items.clear()}peek(){if(this.isEmpty())return null;return this._items.get(1)}isEmpty(){return 0===this._size}add(t){this._items.add(null),this._size+=1;let e=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,t)}}class vC{insert(t,e){}remove(t,e){}query(){}}class bC{constructor(){bC.constructor_.apply(this,arguments)}static constructor_(){if(this._childBoundables=new Lk,this._bounds=null,this._level=null,0===arguments.length);else if(1===arguments.length){const t=arguments[0];this._level=t}}getLevel(){return this._level}size(){return this._childBoundables.size()}getChildBoundables(){return this._childBoundables}addChildBoundable(t){lk.isTrue(null===this._bounds),this._childBoundables.add(t)}isEmpty(){return this._childBoundables.isEmpty()}getBounds(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds}get interfaces_(){return[yC,ik]}}const MC={reverseOrder:function(){return{compare:(t,e)=>e.compareTo(t)}},min:function(t){return MC.sort(t),t.get(0)},sort:function(t,e){const n=t.toArray();e?Dk.sort(n,e):Dk.sort(n);const i=t.iterator();for(let t=0,e=n.length;t<e;t++)i.next(),i.set(n[t])},singletonList:function(t){const e=new Lk;return e.add(t),e}};class wC{static maxDistance(t,e,n,i,r,s,o,a){let l=wC.distance(t,e,r,s);return l=Math.max(l,wC.distance(t,e,o,a)),l=Math.max(l,wC.distance(n,i,r,s)),l=Math.max(l,wC.distance(n,i,o,a)),l}static distance(t,e,n,i){const r=n-t,s=i-e;return Math.sqrt(r*r+s*s)}static maximumDistance(t,e){const n=Math.min(t.getMinX(),e.getMinX()),i=Math.min(t.getMinY(),e.getMinY()),r=Math.max(t.getMaxX(),e.getMaxX()),s=Math.max(t.getMaxY(),e.getMaxY());return wC.distance(n,i,r,s)}static minMaxDistance(t,e){const n=t.getMinX(),i=t.getMinY(),r=t.getMaxX(),s=t.getMaxY(),o=e.getMinX(),a=e.getMinY(),l=e.getMaxX(),c=e.getMaxY();let h=wC.maxDistance(n,i,n,s,o,a,o,c);return h=Math.min(h,wC.maxDistance(n,i,n,s,o,a,l,a)),h=Math.min(h,wC.maxDistance(n,i,n,s,l,c,o,c)),h=Math.min(h,wC.maxDistance(n,i,n,s,l,c,l,a)),h=Math.min(h,wC.maxDistance(n,i,r,i,o,a,o,c)),h=Math.min(h,wC.maxDistance(n,i,r,i,o,a,l,a)),h=Math.min(h,wC.maxDistance(n,i,r,i,l,c,o,c)),h=Math.min(h,wC.maxDistance(n,i,r,i,l,c,l,a)),h=Math.min(h,wC.maxDistance(r,s,n,s,o,a,o,c)),h=Math.min(h,wC.maxDistance(r,s,n,s,o,a,l,a)),h=Math.min(h,wC.maxDistance(r,s,n,s,l,c,o,c)),h=Math.min(h,wC.maxDistance(r,s,n,s,l,c,l,a)),h=Math.min(h,wC.maxDistance(r,s,r,i,o,a,o,c)),h=Math.min(h,wC.maxDistance(r,s,r,i,o,a,l,a)),h=Math.min(h,wC.maxDistance(r,s,r,i,l,c,o,c)),h=Math.min(h,wC.maxDistance(r,s,r,i,l,c,l,a)),h}}class EC{constructor(){EC.constructor_.apply(this,arguments)}static constructor_(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;const t=arguments[0],e=arguments[1],n=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=n,this._distance=this.distance()}static area(t){return t.getBounds().getArea()}static isComposite(t){return t instanceof bC}maximumDistance(){return wC.maximumDistance(this._boundable1.getBounds(),this._boundable2.getBounds())}expandToQueue(t,e){const n=EC.isComposite(this._boundable1),i=EC.isComposite(this._boundable2);if(n&&i)return EC.area(this._boundable1)>EC.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,!1,t,e),null):(this.expand(this._boundable2,this._boundable1,!0,t,e),null);if(n)return this.expand(this._boundable1,this._boundable2,!1,t,e),null;if(i)return this.expand(this._boundable2,this._boundable1,!0,t,e),null;throw new tk("neither boundable is composite")}isLeaves(){return!(EC.isComposite(this._boundable1)||EC.isComposite(this._boundable2))}compareTo(t){const e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0}expand(t,e,n,i,r){for(let s=t.getChildBoundables().iterator();s.hasNext();){const t=s.next();let o=null;o=n?new EC(e,t,this._itemDistance):new EC(t,e,this._itemDistance),o.getDistance()<r&&i.add(o)}}getBoundable(t){return 0===t?this._boundable1:this._boundable2}getDistance(){return this._distance}distance(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())}get interfaces_(){return[nk]}}class SC{visitItem(t){}}class NC{constructor(){NC.constructor_.apply(this,arguments)}static constructor_(){if(this._root=null,this._built=!1,this._itemBoundables=new Lk,this._nodeCapacity=null,0===arguments.length)NC.constructor_.call(this,NC.DEFAULT_NODE_CAPACITY);else if(1===arguments.length){const t=arguments[0];lk.isTrue(t>1,"Node capacity must be greater than 1"),this._nodeCapacity=t}}static compareDoubles(t,e){return t>e?1:t<e?-1:0}queryInternal(){if(XI(arguments[2],SC)&&arguments[0]instanceof Object&&arguments[1]instanceof bC){const t=arguments[0],e=arguments[2],n=arguments[1].getChildBoundables();for(let i=0;i<n.size();i++){const r=n.get(i);this.getIntersectsOp().intersects(r.getBounds(),t)&&(r instanceof bC?this.queryInternal(t,r,e):r instanceof mC?e.visitItem(r.getItem()):lk.shouldNeverReachHere())}}else if(XI(arguments[2],Tk)&&arguments[0]instanceof Object&&arguments[1]instanceof bC){const t=arguments[0],e=arguments[2],n=arguments[1].getChildBoundables();for(let i=0;i<n.size();i++){const r=n.get(i);this.getIntersectsOp().intersects(r.getBounds(),t)&&(r instanceof bC?this.queryInternal(t,r,e):r instanceof mC?e.add(r.getItem()):lk.shouldNeverReachHere())}}}getNodeCapacity(){return this._nodeCapacity}lastNode(t){return t.get(t.size()-1)}size(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){let t=0;for(let e=arguments[0].getChildBoundables().iterator();e.hasNext();){const n=e.next();n instanceof bC?t+=this.size(n):n instanceof mC&&(t+=1)}return t}}removeItem(t,e){let n=null;for(let i=t.getChildBoundables().iterator();i.hasNext();){const t=i.next();t instanceof mC&&t.getItem()===e&&(n=t)}return null!==n&&(t.getChildBoundables().remove(n),!0)}itemsTree(){if(0===arguments.length){this.build();const t=this.itemsTree(this._root);return null===t?new Lk:t}if(1===arguments.length){const t=arguments[0],e=new Lk;for(let n=t.getChildBoundables().iterator();n.hasNext();){const t=n.next();if(t instanceof bC){const n=this.itemsTree(t);null!==n&&e.add(n)}else t instanceof mC?e.add(t.getItem()):lk.shouldNeverReachHere()}return e.size()<=0?null:e}}insert(t,e){lk.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new mC(t,e))}boundablesAtLevel(){if(1===arguments.length){const t=arguments[0],e=new Lk;return this.boundablesAtLevel(t,this._root,e),e}if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];if(lk.isTrue(t>-2),e.getLevel()===t)return n.add(e),null;for(let i=e.getChildBoundables().iterator();i.hasNext();){const e=i.next();e instanceof bC?this.boundablesAtLevel(t,e,n):(lk.isTrue(e instanceof mC),-1===t&&n.add(e))}return null}}query(){if(1===arguments.length){const t=arguments[0];this.build();const e=new Lk;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.queryInternal(t,this._root,e),e}if(2===arguments.length){const t=arguments[0],e=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.queryInternal(t,this._root,e)}}build(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0}getRoot(){return this.build(),this._root}remove(){if(2===arguments.length){const t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.remove(t,this._root,e)}if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];let i=this.removeItem(e,n);if(i)return!0;let r=null;for(let s=e.getChildBoundables().iterator();s.hasNext();){const e=s.next();if(this.getIntersectsOp().intersects(e.getBounds(),t)&&(e instanceof bC&&(i=this.remove(t,e,n),i))){r=e;break}}return null!==r&&r.getChildBoundables().isEmpty()&&e.getChildBoundables().remove(r),i}}createHigherLevels(t,e){lk.isTrue(!t.isEmpty());const n=this.createParentBoundables(t,e+1);return 1===n.size()?n.get(0):this.createHigherLevels(n,e+1)}depth(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){let t=0;for(let e=arguments[0].getChildBoundables().iterator();e.hasNext();){const n=e.next();if(n instanceof bC){const e=this.depth(n);e>t&&(t=e)}}return t+1}}createParentBoundables(t,e){lk.isTrue(!t.isEmpty());const n=new Lk;n.add(this.createNode(e));const i=new Lk(t);MC.sort(i,this.getComparator());for(let t=i.iterator();t.hasNext();){const i=t.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(e)),this.lastNode(n).addChildBoundable(i)}return n}isEmpty(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()}get interfaces_(){return[ik]}}NC.IntersectsOp=function(){},NC.DEFAULT_NODE_CAPACITY=10;class IC{distance(t,e){}}class kC extends NC{constructor(){super(),kC.constructor_.apply(this,arguments)}static constructor_(){if(0===arguments.length)kC.constructor_.call(this,kC.DEFAULT_NODE_CAPACITY);else if(1===arguments.length){const t=arguments[0];NC.constructor_.call(this,t)}}static centreX(t){return kC.avg(t.getMinX(),t.getMaxX())}static avg(t,e){return(t+e)/2}static getItems(t){const e=new Array(t.size()).fill(null);let n=0;for(;!t.isEmpty();){const i=t.poll();e[n]=i.getBoundable(0).getItem(),n++}return e}static centreY(t){return kC.avg(t.getMinY(),t.getMaxY())}createParentBoundablesFromVerticalSlices(t,e){lk.isTrue(t.length>0);const n=new Lk;for(let i=0;i<t.length;i++)n.addAll(this.createParentBoundablesFromVerticalSlice(t[i],e));return n}nearestNeighbourK(){if(2===arguments.length){const t=arguments[0],e=arguments[1];return this.nearestNeighbourK(t,HI.POSITIVE_INFINITY,e)}if(3===arguments.length){const t=arguments[0],e=arguments[2];let n=arguments[1];const i=new xC;i.add(t);const r=new xC;for(;!i.isEmpty()&&n>=0;){const t=i.poll(),s=t.getDistance();if(s>=n)break;if(t.isLeaves())if(r.size()<e)r.add(t);else{r.peek().getDistance()>s&&(r.poll(),r.add(t));n=r.peek().getDistance()}else t.expandToQueue(i,n)}return kC.getItems(r)}}createNode(t){return new OC(t)}size(){return 0===arguments.length?super.size.call(this):super.size.apply(this,arguments)}insert(){if(!(2===arguments.length&&arguments[1]instanceof Object&&arguments[0]instanceof gk))return super.insert.apply(this,arguments);{const t=arguments[0],e=arguments[1];if(t.isNull())return null;super.insert.call(this,t,e)}}getIntersectsOp(){return kC.intersectsOp}verticalSlices(t,e){const n=Math.trunc(Math.ceil(t.size()/e)),i=new Array(e).fill(null),r=t.iterator();for(let t=0;t<e;t++){i[t]=new Lk;let e=0;for(;r.hasNext()&&e<n;){const n=r.next();i[t].add(n),e++}}return i}query(){if(1===arguments.length){const t=arguments[0];return super.query.call(this,t)}if(2===arguments.length){const t=arguments[0],e=arguments[1];super.query.call(this,t,e)}}getComparator(){return kC.yComparator}createParentBoundablesFromVerticalSlice(t,e){return super.createParentBoundables.call(this,t,e)}remove(){if(2===arguments.length&&arguments[1]instanceof Object&&arguments[0]instanceof gk){const t=arguments[0],e=arguments[1];return super.remove.call(this,t,e)}return super.remove.apply(this,arguments)}depth(){return 0===arguments.length?super.depth.call(this):super.depth.apply(this,arguments)}createParentBoundables(t,e){lk.isTrue(!t.isEmpty());const n=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),i=new Lk(t);MC.sort(i,kC.xComparator);const r=this.verticalSlices(i,Math.trunc(Math.ceil(Math.sqrt(n))));return this.createParentBoundablesFromVerticalSlices(r,e)}nearestNeighbour(){if(1===arguments.length){if(XI(arguments[0],IC)){const t=arguments[0];if(this.isEmpty())return null;const e=new EC(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(e)}if(arguments[0]instanceof EC){const t=arguments[0];let e=HI.POSITIVE_INFINITY,n=null;const i=new xC;for(i.add(t);!i.isEmpty()&&e>0;){const t=i.poll(),r=t.getDistance();if(r>=e)break;t.isLeaves()?(e=r,n=t):t.expandToQueue(i,e)}return null===n?null:[n.getBoundable(0).getItem(),n.getBoundable(1).getItem()]}}else{if(2===arguments.length){const t=arguments[0],e=arguments[1];if(this.isEmpty()||t.isEmpty())return null;const n=new EC(this.getRoot(),t.getRoot(),e);return this.nearestNeighbour(n)}if(3===arguments.length){const t=arguments[2],e=new mC(arguments[0],arguments[1]),n=new EC(this.getRoot(),e,t);return this.nearestNeighbour(n)[0]}if(4===arguments.length){const t=arguments[2],e=arguments[3],n=new mC(arguments[0],arguments[1]),i=new EC(this.getRoot(),n,t);return this.nearestNeighbourK(i,e)}}}isWithinDistance(){if(2===arguments.length){const t=arguments[0],e=arguments[1];let n=HI.POSITIVE_INFINITY;const i=new xC;for(i.add(t);!i.isEmpty();){const t=i.poll(),r=t.getDistance();if(r>e)return!1;if(t.maximumDistance()<=e)return!0;if(t.isLeaves()){if(n=r,n<=e)return!0}else t.expandToQueue(i,n)}return!1}if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=new EC(this.getRoot(),t.getRoot(),e);return this.isWithinDistance(i,n)}}get interfaces_(){return[vC,ik]}}class OC extends bC{constructor(){super(),OC.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0];bC.constructor_.call(this,t)}computeBounds(){let t=null;for(let e=this.getChildBoundables().iterator();e.hasNext();){const n=e.next();null===t?t=new gk(n.getBounds()):t.expandToInclude(n.getBounds())}return t}}kC.STRtreeNode=OC,kC.xComparator=new class{get interfaces_(){return[sk]}compare(t,e){return NC.compareDoubles(kC.centreX(t.getBounds()),kC.centreX(e.getBounds()))}},kC.yComparator=new class{get interfaces_(){return[sk]}compare(t,e){return NC.compareDoubles(kC.centreY(t.getBounds()),kC.centreY(e.getBounds()))}},kC.intersectsOp=new class{get interfaces_(){return[IntersectsOp]}intersects(t,e){return t.intersects(e)}},kC.DEFAULT_NODE_CAPACITY=10;class CC{static relativeSign(t,e){return t<e?-1:t>e?1:0}static compare(t,e,n){if(e.equals2D(n))return 0;const i=CC.relativeSign(e.x,n.x),r=CC.relativeSign(e.y,n.y);switch(t){case 0:return CC.compareValue(i,r);case 1:return CC.compareValue(r,i);case 2:return CC.compareValue(r,-i);case 3:return CC.compareValue(-i,r);case 4:return CC.compareValue(-i,-r);case 5:return CC.compareValue(-r,-i);case 6:return CC.compareValue(-r,i);case 7:return CC.compareValue(i,-r)}return lk.shouldNeverReachHere("invalid octant value"),0}static compareValue(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0}}class AC{constructor(){AC.constructor_.apply(this,arguments)}static constructor_(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this._segString=t,this.coord=new fk(e),this.segmentIndex=n,this._segmentOctant=i,this._isInterior=!e.equals2D(t.getCoordinate(n))}getCoordinate(){return this.coord}print(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)}compareTo(t){const e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:this._isInterior?e._isInterior?CC.compare(this._segmentOctant,this.coord,e.coord):1:-1}isEndPoint(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t}toString(){return this.segmentIndex+":"+this.coord.toString()}isInterior(){return this._isInterior}get interfaces_(){return[nk]}}class TC extends cO{}function RC(t){return null==t?0:t.color}function LC(t){return null==t?null:t.parent}function PC(t,e){null!==t&&(t.color=e)}function DC(t){return null==t?null:t.left}function zC(t){return null==t?null:t.right}class FC extends TC{constructor(){super(),this.root_=null,this.size_=0}get(t){let e=this.root_;for(;null!==e;){const n=t.compareTo(e.key);if(n<0)e=e.left;else{if(!(n>0))return e.value;e=e.right}}return null}put(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:0,getValue(){return this.value},getKey(){return this.key}},this.size_=1,null;let n,i,r=this.root_;do{if(n=r,i=t.compareTo(r.key),i<0)r=r.left;else{if(!(i>0)){const t=r.value;return r.value=e,t}r=r.right}}while(null!==r);const s={key:t,left:null,right:null,value:e,parent:n,color:0,getValue(){return this.value},getKey(){return this.key}};return i<0?n.left=s:n.right=s,this.fixAfterInsertion(s),this.size_++,null}fixAfterInsertion(t){let e;for(t.color=1;null!=t&&t!==this.root_&&1===t.parent.color;)LC(t)===DC(LC(LC(t)))?(e=zC(LC(LC(t))),1===RC(e)?(PC(LC(t),0),PC(e,0),PC(LC(LC(t)),1),t=LC(LC(t))):(t===zC(LC(t))&&(t=LC(t),this.rotateLeft(t)),PC(LC(t),0),PC(LC(LC(t)),1),this.rotateRight(LC(LC(t))))):(e=DC(LC(LC(t))),1===RC(e)?(PC(LC(t),0),PC(e,0),PC(LC(LC(t)),1),t=LC(LC(t))):(t===DC(LC(t))&&(t=LC(t),this.rotateRight(t)),PC(LC(t),0),PC(LC(LC(t)),1),this.rotateLeft(LC(LC(t)))));this.root_.color=0}values(){const t=new Lk;let e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=FC.successor(e));)t.add(e.value);return t}entrySet(){const t=new hO;let e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=FC.successor(e));)t.add(e);return t}rotateLeft(t){if(null!=t){const e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null==t.parent?this.root_=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}}rotateRight(t){if(null!=t){const e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null==t.parent?this.root_=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}}getFirstEntry(){let t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t}static successor(t){let e;if(null===t)return null;if(null!==t.right){for(e=t.right;null!==e.left;)e=e.left;return e}{e=t.parent;let n=t;for(;null!==e&&n===e.right;)n=e,e=e.parent;return e}}size(){return this.size_}containsKey(t){let e=this.root_;for(;null!==e;){const n=t.compareTo(e.key);if(n<0)e=e.left;else{if(!(n>0))return!0;e=e.right}}return!1}}class GC{constructor(){GC.constructor_.apply(this,arguments)}static constructor_(){this._nodeMap=new FC,this._edge=null;const t=arguments[0];this._edge=t}getSplitCoordinates(){const t=new eO;this.addEndpoints();const e=this.iterator();let n=e.next();for(;e.hasNext();){const i=e.next();this.addEdgeCoordinates(n,i,t),n=i}return t.toCoordinateArray()}addCollapsedNodes(){const t=new Lk;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(let e=t.iterator();e.hasNext();){const t=e.next().intValue();this.add(this._edge.getCoordinate(t),t)}}createSplitEdgePts(t,e){let n=e.segmentIndex-t.segmentIndex+2;if(2===n)return[new fk(t.coord),new fk(e.coord)];const i=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);r||n--;const s=new Array(n).fill(null);let o=0;s[o++]=new fk(t.coord);for(let n=t.segmentIndex+1;n<=e.segmentIndex;n++)s[o++]=this._edge.getCoordinate(n);return r&&(s[o]=new fk(e.coord)),s}print(t){t.println("Intersections:");for(let e=this.iterator();e.hasNext();){e.next().print(t)}}findCollapsesFromExistingVertices(t){for(let e=0;e<this._edge.size()-2;e++){const n=this._edge.getCoordinate(e);this._edge.getCoordinate(e+1);const i=this._edge.getCoordinate(e+2);n.equals2D(i)&&t.add(Fk.valueOf(e+1))}}addEdgeCoordinates(t,e,n){const i=this.createSplitEdgePts(t,e);n.add(i,!1)}iterator(){return this._nodeMap.values().iterator()}addSplitEdges(t){this.addEndpoints(),this.addCollapsedNodes();const e=this.iterator();let n=e.next();for(;e.hasNext();){const i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}}findCollapseIndex(t,e,n){if(!t.coord.equals2D(e.coord))return!1;let i=e.segmentIndex-t.segmentIndex;return e.isInterior()||i--,1===i&&(n[0]=t.segmentIndex+1,!0)}findCollapsesFromInsertedNodes(t){const e=new Array(1).fill(null),n=this.iterator();let i=n.next();for(;n.hasNext();){const r=n.next();this.findCollapseIndex(i,r,e)&&t.add(Fk.valueOf(e[0])),i=r}}getEdge(){return this._edge}addEndpoints(){const t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)}createSplitEdge(t,e){const n=this.createSplitEdgePts(t,e);return new qC(n,this._edge.getData())}add(t,e){const n=new AC(this._edge,t,e,this._edge.getSegmentOctant(e)),i=this._nodeMap.get(n);return null!==i?(lk.isTrue(i.coord.equals2D(t),"Found equal nodes with different coordinates"),i):(this._nodeMap.put(n,n),n)}checkSplitEdgesCorrectness(t){const e=this._edge.getCoordinates(),n=t.get(0).getCoordinate(0);if(!n.equals2D(e[0]))throw new ok("bad split edge start point at "+n);const i=t.get(t.size()-1).getCoordinates(),r=i[i.length-1];if(!r.equals2D(e[e.length-1]))throw new ok("bad split edge end point at "+r)}}class jC{addIntersection(t,e){}get interfaces_(){return[pC]}}class qC{constructor(){qC.constructor_.apply(this,arguments)}static constructor_(){this._nodeList=new GC(this),this._pts=null,this._data=null;const t=arguments[0],e=arguments[1];this._pts=t,this._data=e}static getNodedSubstrings(){if(1===arguments.length){const t=arguments[0],e=new Lk;return qC.getNodedSubstrings(t,e),e}if(2===arguments.length){const t=arguments[1];for(let e=arguments[0].iterator();e.hasNext();){e.next().getNodeList().addSplitEdges(t)}}}getCoordinates(){return this._pts}size(){return this._pts.length}getCoordinate(t){return this._pts[t]}isClosed(){return this._pts[0].equals(this._pts[this._pts.length-1])}getSegmentOctant(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))}setData(t){this._data=t}safeOctant(t,e){return t.equals2D(e)?0:gC.octant(t,e)}getData(){return this._data}addIntersection(){if(2===arguments.length){const t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){const t=arguments[1],e=arguments[3],n=new fk(arguments[0].getIntersection(e));this.addIntersection(n,t)}}toString(){return WO.toLineString(new oO(this._pts))}getNodeList(){return this._nodeList}addIntersectionNode(t,e){let n=e;const i=n+1;if(i<this._pts.length){const e=this._pts[i];t.equals2D(e)&&(n=i)}return this._nodeList.add(t,n)}addIntersections(t,e,n){for(let i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)}get interfaces_(){return[jC]}}class BC{constructor(){BC.constructor_.apply(this,arguments)}static constructor_(){this._overlapSeg1=new HO,this._overlapSeg2=new HO}overlap(){if(2===arguments.length);else if(4===arguments.length){const t=arguments[1],e=arguments[2],n=arguments[3];arguments[0].getLineSegment(t,this._overlapSeg1),e.getLineSegment(n,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}}class YC{constructor(){YC.constructor_.apply(this,arguments)}static constructor_(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this._pts=t,this._start=e,this._end=n,this._context=i}getLineSegment(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]}computeSelect(t,e,n,i){const r=this._pts[e],s=this._pts[n];if(n-e==1)return i.select(this,e),null;if(!t.intersects(r,s))return null;const o=Math.trunc((e+n)/2);e<o&&this.computeSelect(t,e,o,i),o<n&&this.computeSelect(t,o,n,i)}getCoordinates(){const t=new Array(this._end-this._start+1).fill(null);let e=0;for(let n=this._start;n<=this._end;n++)t[e++]=this._pts[n];return t}computeOverlaps(){if(2===arguments.length){const t=arguments[0],e=arguments[1];this.computeOverlaps(this._start,this._end,t,t._start,t._end,e)}else if(6===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=arguments[4],s=arguments[5];if(e-t==1&&r-i==1)return s.overlap(this,t,n,i),null;if(!this.overlaps(t,e,n,i,r))return null;const o=Math.trunc((t+e)/2),a=Math.trunc((i+r)/2);t<o&&(i<a&&this.computeOverlaps(t,o,n,i,a,s),a<r&&this.computeOverlaps(t,o,n,a,r,s)),o<e&&(i<a&&this.computeOverlaps(o,e,n,i,a,s),a<r&&this.computeOverlaps(o,e,n,a,r,s))}}setId(t){this._id=t}select(t,e){this.computeSelect(t,this._start,this._end,e)}getEnvelope(){if(null===this._env){const t=this._pts[this._start],e=this._pts[this._end];this._env=new gk(t,e)}return this._env}overlaps(t,e,n,i,r){return gk.intersects(this._pts[t],this._pts[e],n._pts[i],n._pts[r])}getEndIndex(){return this._end}getStartIndex(){return this._start}getContext(){return this._context}getId(){return this._id}}class $C{static isNorthern(t){return t===$C.NE||t===$C.NW}static isOpposite(t,e){if(t===e)return!1;return 2===(t-e+4)%4}static commonHalfPlane(t,e){if(t===e)return t;if(2===(t-e+4)%4)return-1;const n=t<e?t:e;return 0===n&&3===(t>e?t:e)?3:n}static isInHalfPlane(t,e){return e===$C.SE?t===$C.SE||t===$C.SW:t===e||t===e+1}static quadrant(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new tk("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?$C.NE:$C.SE:e>=0?$C.NW:$C.SW}if(arguments[0]instanceof fk&&arguments[1]instanceof fk){const t=arguments[0],e=arguments[1];if(e.x===t.x&&e.y===t.y)throw new tk("Cannot compute the quadrant for two identical points "+t);return e.x>=t.x?e.y>=t.y?$C.NE:$C.SE:e.y>=t.y?$C.NW:$C.SW}}}$C.NE=0,$C.NW=1,$C.SW=2,$C.SE=3;class UC{static findChainEnd(t,e){let n=e;for(;n<t.length-1&&t[n].equals2D(t[n+1]);)n++;if(n>=t.length-1)return t.length-1;const i=$C.quadrant(t[n],t[n+1]);let r=e+1;for(;r<t.length;){if(!t[r-1].equals2D(t[r])){if($C.quadrant(t[r-1],t[r])!==i)break}r++}return r-1}static getChains(){if(1===arguments.length){const t=arguments[0];return UC.getChains(t,null)}if(2===arguments.length){const t=arguments[0],e=arguments[1],n=new Lk;let i=0;do{const r=UC.findChainEnd(t,i),s=new YC(t,i,r,e);n.add(s),i=r}while(i<t.length-1);return n}}}class WC{computeNodes(t){}getNodedSubstrings(){}}class XC{constructor(){XC.constructor_.apply(this,arguments)}static constructor_(){if(this._segInt=null,0===arguments.length);else if(1===arguments.length){const t=arguments[0];this.setSegmentIntersector(t)}}setSegmentIntersector(t){this._segInt=t}get interfaces_(){return[WC]}}class VC extends XC{constructor(){super(),VC.constructor_.apply(this,arguments)}static constructor_(){if(this._monoChains=new Lk,this._index=new kC,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0,0===arguments.length);else if(1===arguments.length){const t=arguments[0];XC.constructor_.call(this,t)}}getMonotoneChains(){return this._monoChains}getNodedSubstrings(){return qC.getNodedSubstrings(this._nodedSegStrings)}getIndex(){return this._index}add(t){for(let e=UC.getChains(t.getCoordinates(),t).iterator();e.hasNext();){const t=e.next();t.setId(this._idCounter++),this._index.insert(t.getEnvelope(),t),this._monoChains.add(t)}}computeNodes(t){this._nodedSegStrings=t;for(let e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()}intersectChains(){const t=new HC(this._segInt);for(let e=this._monoChains.iterator();e.hasNext();){const n=e.next();for(let e=this._index.query(n.getEnvelope()).iterator();e.hasNext();){const i=e.next();if(i.getId()>n.getId()&&(n.computeOverlaps(i,t),this._nOverlaps++),this._segInt.isDone())return null}}}}class HC extends BC{constructor(){super(),HC.constructor_.apply(this,arguments)}static constructor_(){this._si=null;const t=arguments[0];this._si=t}overlap(){if(4!==arguments.length)return super.overlap.apply(this,arguments);{const t=arguments[1],e=arguments[2],n=arguments[3],i=arguments[0].getContext(),r=e.getContext();this._si.processIntersections(i,t,r,n)}}}VC.SegmentOverlapAction=HC;class JC extends ok{constructor(t,e){super(e?t+" [ "+e+" ]":t),this.pt=e?new fk(e):void 0,this.name=Object.keys({TopologyException:JC})[0]}getCoordinate(){return this.pt}}class ZC{processIntersections(t,e,n,i){}isDone(){}}class QC{constructor(){QC.constructor_.apply(this,arguments)}static constructor_(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._keepIntersections=!0,this._isInteriorIntersectionsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new Lk,this._intersectionCount=0;const t=arguments[0];this._li=t,this._interiorIntersection=null}static createAllIntersectionsFinder(t){const e=new QC(t);return e.setFindAllIntersections(!0),e}static isInteriorVertexIntersection(){if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[3];return(!arguments[2]||!n)&&!!t.equals2D(e)}if(8===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=arguments[4],s=arguments[5],o=arguments[6],a=arguments[7];return!!QC.isInteriorVertexIntersection(t,n,r,o)||(!!QC.isInteriorVertexIntersection(t,i,r,a)||(!!QC.isInteriorVertexIntersection(e,n,s,o)||!!QC.isInteriorVertexIntersection(e,i,s,a)))}}static createInteriorIntersectionCounter(t){const e=new QC(t);return e.setInteriorIntersectionsOnly(!0),e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e}static createIntersectionCounter(t){const e=new QC(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e}static isEndSegment(t,e){return 0===e||e>=t.size()-2}static createAnyIntersectionFinder(t){return new QC(t)}static createInteriorIntersectionsFinder(t){const e=new QC(t);return e.setFindAllIntersections(!0),e.setInteriorIntersectionsOnly(!0),e}setCheckEndSegmentsOnly(t){this._isCheckEndSegmentsOnly=t}getIntersectionSegments(){return this._intSegments}count(){return this._intersectionCount}getIntersections(){return this._intersections}setFindAllIntersections(t){this._findAllIntersections=t}setKeepIntersections(t){this._keepIntersections=t}getIntersection(){return this._interiorIntersection}processIntersections(t,e,n,i){if(!this._findAllIntersections&&this.hasIntersection())return null;const r=t===n;if(r&&e===i)return null;if(this._isCheckEndSegmentsOnly){if(!(QC.isEndSegment(t,e)||QC.isEndSegment(n,i)))return null}const s=t.getCoordinate(e),o=t.getCoordinate(e+1),a=n.getCoordinate(i),l=n.getCoordinate(i+1),c=0===e,h=e+2===t.size(),u=0===i,f=i+2===n.size();this._li.computeIntersection(s,o,a,l);const d=this._li.hasIntersection()&&this._li.isInteriorIntersection();let g=!1;if(!this._isInteriorIntersectionsOnly){g=!(r&&Math.abs(i-e)<=1)&&QC.isInteriorVertexIntersection(s,o,a,l,c,h,u,f)}(d||g)&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=s,this._intSegments[1]=o,this._intSegments[2]=a,this._intSegments[3]=l,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)}hasIntersection(){return null!==this._interiorIntersection}isDone(){return!this._findAllIntersections&&null!==this._interiorIntersection}setInteriorIntersectionsOnly(t){this._isInteriorIntersectionsOnly=t}get interfaces_(){return[ZC]}}class KC{constructor(){KC.constructor_.apply(this,arguments)}static constructor_(){this._li=new VO,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;const t=arguments[0];this._segStrings=t}static computeIntersections(t){const e=new KC(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()}execute(){if(null!==this._segInt)return null;this.checkInteriorIntersections()}getIntersections(){return this._segInt.getIntersections()}isValid(){return this.execute(),this._isValid}setFindAllIntersections(t){this._findAllIntersections=t}checkInteriorIntersections(){this._isValid=!0,this._segInt=new QC(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);const t=new VC;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null}checkValid(){if(this.execute(),!this._isValid)throw new JC(this.getErrorMessage(),this._segInt.getIntersection())}getErrorMessage(){if(this._isValid)return"no intersections found";const t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+WO.toLineString(t[0],t[1])+" and "+WO.toLineString(t[2],t[3])}}class tA{constructor(){tA.constructor_.apply(this,arguments)}static constructor_(){this._nv=null;const t=arguments[0];this._nv=new KC(tA.toSegmentStrings(t))}static toSegmentStrings(t){const e=new Lk;for(let n=t.iterator();n.hasNext();){const t=n.next();e.add(new _C(t.getCoordinates(),t))}return e}static checkValid(t){new tA(t).checkValid()}checkValid(){this._nv.checkValid()}}class eA{constructor(){eA.constructor_.apply(this,arguments)}static constructor_(){this._mapOp=null;const t=arguments[0];this._mapOp=t}static map(t,e){return new eA(e).map(t)}map(t){const e=new Lk;for(let n=0;n<t.getNumGeometries();n++){const i=this._mapOp.map(t.getGeometryN(n));i.isEmpty()||e.add(i)}return t.getFactory().createGeometryCollection(_O.toGeometryArray(e))}}class nA{static opposite(t){return t===nA.LEFT?nA.RIGHT:t===nA.RIGHT?nA.LEFT:t}}nA.ON=0,nA.LEFT=1,nA.RIGHT=2;class iA{constructor(){iA.constructor_.apply(this,arguments)}static constructor_(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){const t=arguments[0];this.init(t.length)}else if(Number.isInteger(arguments[0])){const t=arguments[0];this.init(1),this.location[nA.ON]=t}else if(arguments[0]instanceof iA){const t=arguments[0];if(this.init(t.location.length),null!==t)for(let e=0;e<this.location.length;e++)this.location[e]=t.location[e]}}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this.init(3),this.location[nA.ON]=t,this.location[nA.LEFT]=e,this.location[nA.RIGHT]=n}}setAllLocations(t){for(let e=0;e<this.location.length;e++)this.location[e]=t}isNull(){for(let t=0;t<this.location.length;t++)if(this.location[t]!==iC.NONE)return!1;return!0}setAllLocationsIfNull(t){for(let e=0;e<this.location.length;e++)this.location[e]===iC.NONE&&(this.location[e]=t)}isLine(){return 1===this.location.length}merge(t){if(t.location.length>this.location.length){const t=new Array(3).fill(null);t[nA.ON]=this.location[nA.ON],t[nA.LEFT]=iC.NONE,t[nA.RIGHT]=iC.NONE,this.location=t}for(let e=0;e<this.location.length;e++)this.location[e]===iC.NONE&&e<t.location.length&&(this.location[e]=t.location[e])}getLocations(){return this.location}flip(){if(this.location.length<=1)return null;const t=this.location[nA.LEFT];this.location[nA.LEFT]=this.location[nA.RIGHT],this.location[nA.RIGHT]=t}toString(){const t=new zk;return this.location.length>1&&t.append(iC.toLocationSymbol(this.location[nA.LEFT])),t.append(iC.toLocationSymbol(this.location[nA.ON])),this.location.length>1&&t.append(iC.toLocationSymbol(this.location[nA.RIGHT])),t.toString()}setLocations(t,e,n){this.location[nA.ON]=t,this.location[nA.LEFT]=e,this.location[nA.RIGHT]=n}get(t){return t<this.location.length?this.location[t]:iC.NONE}isArea(){return this.location.length>1}isAnyNull(){for(let t=0;t<this.location.length;t++)if(this.location[t]===iC.NONE)return!0;return!1}setLocation(){if(1===arguments.length){const t=arguments[0];this.setLocation(nA.ON,t)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.location[t]=e}}init(t){this.location=new Array(t).fill(null),this.setAllLocations(iC.NONE)}isEqualOnSide(t,e){return this.location[e]===t.location[e]}allPositionsEqual(t){for(let e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0}}class rA{constructor(){rA.constructor_.apply(this,arguments)}static constructor_(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){const t=arguments[0];this.elt[0]=new iA(t),this.elt[1]=new iA(t)}else if(arguments[0]instanceof rA){const t=arguments[0];this.elt[0]=new iA(t.elt[0]),this.elt[1]=new iA(t.elt[1])}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.elt[0]=new iA(iC.NONE),this.elt[1]=new iA(iC.NONE),this.elt[t].setLocation(e)}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this.elt[0]=new iA(t,e,n),this.elt[1]=new iA(t,e,n)}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.elt[0]=new iA(iC.NONE,iC.NONE,iC.NONE),this.elt[1]=new iA(iC.NONE,iC.NONE,iC.NONE),this.elt[t].setLocations(e,n,i)}}static toLineLabel(t){const e=new rA(iC.NONE);for(let n=0;n<2;n++)e.setLocation(n,t.getLocation(n));return e}getGeometryCount(){let t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t}setAllLocations(t,e){this.elt[t].setAllLocations(e)}isNull(t){return this.elt[t].isNull()}setAllLocationsIfNull(){if(1===arguments.length){const t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.elt[t].setAllLocationsIfNull(e)}}isLine(t){return this.elt[t].isLine()}merge(t){for(let e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new iA(t.elt[e]):this.elt[e].merge(t.elt[e])}flip(){this.elt[0].flip(),this.elt[1].flip()}getLocation(){if(1===arguments.length){const t=arguments[0];return this.elt[t].get(nA.ON)}if(2===arguments.length){const t=arguments[0],e=arguments[1];return this.elt[t].get(e)}}toString(){const t=new zk;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()}isArea(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){const t=arguments[0];return this.elt[t].isArea()}}isAnyNull(t){return this.elt[t].isAnyNull()}setLocation(){if(2===arguments.length){const t=arguments[0],e=arguments[1];this.elt[t].setLocation(nA.ON,e)}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this.elt[t].setLocation(e,n)}}isEqualOnSide(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)}allPositionsEqual(t,e){return this.elt[t].allPositionsEqual(e)}toLine(t){this.elt[t].isArea()&&(this.elt[t]=new iA(this.elt[t].location[0]))}}class sA{constructor(){sA.constructor_.apply(this,arguments)}static constructor_(){if(this._startDe=null,this._maxNodeDegree=-1,this._edges=new Lk,this._pts=new Lk,this._label=new rA(iC.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new Lk,this._geometryFactory=null,0===arguments.length);else if(2===arguments.length){const t=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(t),this.computeRing()}}computeRing(){if(null!==this._ring)return null;const t=new Array(this._pts.size()).fill(null);for(let e=0;e<this._pts.size();e++)t[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=qk.isCCW(this._ring.getCoordinates())}isIsolated(){return 1===this._label.getGeometryCount()}computePoints(t){this._startDe=t;let e=t,n=!0;do{if(null===e)throw new JC("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new JC("Directed Edge visited twice during ring-building at "+e.getCoordinate());this._edges.add(e);const t=e.getLabel();lk.isTrue(t.isArea()),this.mergeLabel(t),this.addPoints(e.getEdge(),e.isForward(),n),n=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this._startDe)}getLinearRing(){return this._ring}getCoordinate(t){return this._pts.get(t)}computeMaxNodeDegree(){this._maxNodeDegree=0;let t=this._startDe;do{const e=t.getNode().getEdges().getOutgoingDegree(this);e>this._maxNodeDegree&&(this._maxNodeDegree=e),t=this.getNext(t)}while(t!==this._startDe);this._maxNodeDegree*=2}addPoints(t,e,n){const i=t.getCoordinates();if(e){let t=1;n&&(t=0);for(let e=t;e<i.length;e++)this._pts.add(i[e])}else{let t=i.length-2;n&&(t=i.length-1);for(let e=t;e>=0;e--)this._pts.add(i[e])}}isHole(){return this._isHole}setInResult(){let t=this._startDe;do{t.getEdge().setInResult(!0),t=t.getNext()}while(t!==this._startDe)}containsPoint(t){const e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!sC.isInRing(t,e.getCoordinates()))return!1;for(let e=this._holes.iterator();e.hasNext();){if(e.next().containsPoint(t))return!1}return!0}addHole(t){this._holes.add(t)}isShell(){return null===this._shell}getLabel(){return this._label}getEdges(){return this._edges}getMaxNodeDegree(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree}getShell(){return this._shell}mergeLabel(){if(1===arguments.length){const t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){const t=arguments[1],e=arguments[0].getLocation(t,nA.RIGHT);if(e===iC.NONE)return null;if(this._label.getLocation(t)===iC.NONE)return this._label.setLocation(t,e),null}}setShell(t){this._shell=t,null!==t&&t.addHole(this)}toPolygon(t){const e=new Array(this._holes.size()).fill(null);for(let t=0;t<this._holes.size();t++)e[t]=this._holes.get(t).getLinearRing();return t.createPolygon(this.getLinearRing(),e)}}class oA extends sA{constructor(){super(),oA.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],e=arguments[1];sA.constructor_.call(this,t,e)}setEdgeRing(t,e){t.setMinEdgeRing(e)}getNext(t){return t.getNextMin()}}class aA extends sA{constructor(){super(),aA.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],e=arguments[1];sA.constructor_.call(this,t,e)}buildMinimalRings(){const t=new Lk;let e=this._startDe;do{if(null===e.getMinEdgeRing()){const n=new oA(e,this._geometryFactory);t.add(n)}e=e.getNext()}while(e!==this._startDe);return t}setEdgeRing(t,e){t.setEdgeRing(e)}linkDirectedEdgesForMinimalEdgeRings(){let t=this._startDe;do{t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!==this._startDe)}getNext(t){return t.getNext()}}class lA{constructor(){lA.constructor_.apply(this,arguments)}static constructor_(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){const t=arguments[0];this._label=t}}setVisited(t){this._isVisited=t}setInResult(t){this._isInResult=t}isCovered(){return this._isCovered}isCoveredSet(){return this._isCoveredSet}setLabel(t){this._label=t}getLabel(){return this._label}setCovered(t){this._isCovered=t,this._isCoveredSet=!0}updateIM(t){lk.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)}isInResult(){return this._isInResult}isVisited(){return this._isVisited}}class cA extends lA{constructor(){super(),cA.constructor_.apply(this,arguments)}static constructor_(){this._coord=null,this._edges=null;const t=arguments[0],e=arguments[1];this._coord=t,this._edges=e,this._label=new rA(0,iC.NONE)}isIncidentEdgeInResult(){for(let t=this.getEdges().getEdges().iterator();t.hasNext();){if(t.next().getEdge().isInResult())return!0}return!1}isIsolated(){return 1===this._label.getGeometryCount()}getCoordinate(){return this._coord}print(t){t.println("node "+this._coord+" lbl: "+this._label)}computeIM(t){}computeMergedLocation(t,e){let n=iC.NONE;if(n=this._label.getLocation(e),!t.isNull(e)){const i=t.getLocation(e);n!==iC.BOUNDARY&&(n=i)}return n}setLabel(){if(2!==arguments.length||!Number.isInteger(arguments[1])||!Number.isInteger(arguments[0]))return super.setLabel.apply(this,arguments);{const t=arguments[0],e=arguments[1];null===this._label?this._label=new rA(t,e):this._label.setLocation(t,e)}}getEdges(){return this._edges}mergeLabel(){if(arguments[0]instanceof cA){const t=arguments[0];this.mergeLabel(t._label)}else if(arguments[0]instanceof rA){const t=arguments[0];for(let e=0;e<2;e++){const n=this.computeMergedLocation(t,e);this._label.getLocation(e)===iC.NONE&&this._label.setLocation(e,n)}}}add(t){this._edges.insert(t),t.setNode(this)}setLabelBoundary(t){if(null===this._label)return null;let e=iC.NONE;null!==this._label&&(e=this._label.getLocation(t));let n=null;switch(e){case iC.BOUNDARY:n=iC.INTERIOR;break;case iC.INTERIOR:default:n=iC.BOUNDARY}this._label.setLocation(t,n)}}class hA{constructor(){hA.constructor_.apply(this,arguments)}static constructor_(){this.nodeMap=new FC,this.nodeFact=null;const t=arguments[0];this.nodeFact=t}find(t){return this.nodeMap.get(t)}addNode(){if(arguments[0]instanceof fk){const t=arguments[0];let e=this.nodeMap.get(t);return null===e&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof cA){const t=arguments[0],e=this.nodeMap.get(t.getCoordinate());return null===e?(this.nodeMap.put(t.getCoordinate(),t),t):(e.mergeLabel(t),e)}}print(t){for(let e=this.iterator();e.hasNext();){e.next().print(t)}}iterator(){return this.nodeMap.values().iterator()}values(){return this.nodeMap.values()}getBoundaryNodes(t){const e=new Lk;for(let n=this.iterator();n.hasNext();){const i=n.next();i.getLabel().getLocation(t)===iC.BOUNDARY&&e.add(i)}return e}add(t){const e=t.getCoordinate();this.addNode(e).add(t)}}class uA{constructor(){uA.constructor_.apply(this,arguments)}static constructor_(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){const t=arguments[0];this._edge=t}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];uA.constructor_.call(this,t,e,n,null)}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];uA.constructor_.call(this,t),this.init(e,n),this._label=i}}compareDirection(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:qk.index(t._p0,t._p1,this._p1)}getDy(){return this._dy}getCoordinate(){return this._p0}setNode(t){this._node=t}print(t){const e=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),i=n.lastIndexOf("."),r=n.substring(i+1);t.print("  "+r+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)}compareTo(t){const e=t;return this.compareDirection(e)}getDirectedCoordinate(){return this._p1}getDx(){return this._dx}getLabel(){return this._label}getEdge(){return this._edge}getQuadrant(){return this._quadrant}getNode(){return this._node}toString(){const t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),n=e.lastIndexOf(".");return"  "+e.substring(n+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label}computeLabel(t){}init(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=$C.quadrant(this._dx,this._dy),lk.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")}get interfaces_(){return[nk]}}class fA extends uA{constructor(){super(),fA.constructor_.apply(this,arguments)}static constructor_(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999];const t=arguments[0],e=arguments[1];if(uA.constructor_.call(this,t),this._isForward=e,e)this.init(t.getCoordinate(0),t.getCoordinate(1));else{const e=t.getNumPoints()-1;this.init(t.getCoordinate(e),t.getCoordinate(e-1))}this.computeDirectedLabel()}static depthFactor(t,e){return t===iC.EXTERIOR&&e===iC.INTERIOR?1:t===iC.INTERIOR&&e===iC.EXTERIOR?-1:0}getNextMin(){return this._nextMin}getDepth(t){return this._depth[t]}setVisited(t){this._isVisited=t}computeDirectedLabel(){this._label=new rA(this._edge.getLabel()),this._isForward||this._label.flip()}getNext(){return this._next}setDepth(t,e){if(-999!==this._depth[t]&&this._depth[t]!==e)throw new JC("assigned depths do not match",this.getCoordinate());this._depth[t]=e}isInteriorAreaEdge(){let t=!0;for(let e=0;e<2;e++)this._label.isArea(e)&&this._label.getLocation(e,nA.LEFT)===iC.INTERIOR&&this._label.getLocation(e,nA.RIGHT)===iC.INTERIOR||(t=!1);return t}setNextMin(t){this._nextMin=t}print(t){super.print.call(this,t),t.print(" "+this._depth[nA.LEFT]+"/"+this._depth[nA.RIGHT]),t.print(" ("+this.getDepthDelta()+")"),this._isInResult&&t.print(" inResult")}setMinEdgeRing(t){this._minEdgeRing=t}isLineEdge(){const t=this._label.isLine(0)||this._label.isLine(1),e=!this._label.isArea(0)||this._label.allPositionsEqual(0,iC.EXTERIOR),n=!this._label.isArea(1)||this._label.allPositionsEqual(1,iC.EXTERIOR);return t&&e&&n}setEdgeRing(t){this._edgeRing=t}getMinEdgeRing(){return this._minEdgeRing}getDepthDelta(){let t=this._edge.getDepthDelta();return this._isForward||(t=-t),t}setInResult(t){this._isInResult=t}getSym(){return this._sym}isForward(){return this._isForward}getEdge(){return this._edge}printEdge(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)}setSym(t){this._sym=t}setVisitedEdge(t){this.setVisited(t),this._sym.setVisited(t)}setEdgeDepths(t,e){let n=this.getEdge().getDepthDelta();this._isForward||(n=-n);let i=1;t===nA.LEFT&&(i=-1);const r=nA.opposite(t),s=e+n*i;this.setDepth(t,e),this.setDepth(r,s)}getEdgeRing(){return this._edgeRing}isInResult(){return this._isInResult}setNext(t){this._next=t}isVisited(){return this._isVisited}}class dA{createNode(t){return new cA(t,null)}}class gA{constructor(){gA.constructor_.apply(this,arguments)}static constructor_(){if(this._edges=new Lk,this._nodes=null,this._edgeEndList=new Lk,0===arguments.length)this._nodes=new hA(new dA);else if(1===arguments.length){const t=arguments[0];this._nodes=new hA(t)}}static linkResultDirectedEdges(t){for(let e=t.iterator();e.hasNext();){e.next().getEdges().linkResultDirectedEdges()}}printEdges(t){t.println("Edges:");for(let e=0;e<this._edges.size();e++){t.println("edge "+e+":");const n=this._edges.get(e);n.print(t),n.eiList.print(t)}}find(t){return this._nodes.find(t)}addNode(){if(arguments[0]instanceof cA){const t=arguments[0];return this._nodes.addNode(t)}if(arguments[0]instanceof fk){const t=arguments[0];return this._nodes.addNode(t)}}getNodeIterator(){return this._nodes.iterator()}linkResultDirectedEdges(){for(let t=this._nodes.iterator();t.hasNext();){t.next().getEdges().linkResultDirectedEdges()}}debugPrintln(t){iO.out.println(t)}isBoundaryNode(t,e){const n=this._nodes.find(e);if(null===n)return!1;const i=n.getLabel();return null!==i&&i.getLocation(t)===iC.BOUNDARY}linkAllDirectedEdges(){for(let t=this._nodes.iterator();t.hasNext();){t.next().getEdges().linkAllDirectedEdges()}}matchInSameDirection(t,e,n,i){return!!t.equals(n)&&(qk.index(t,e,i)===qk.COLLINEAR&&$C.quadrant(t,e)===$C.quadrant(n,i))}getEdgeEnds(){return this._edgeEndList}debugPrint(t){iO.out.print(t)}getEdgeIterator(){return this._edges.iterator()}findEdgeInSameDirection(t,e){for(let n=0;n<this._edges.size();n++){const i=this._edges.get(n),r=i.getCoordinates();if(this.matchInSameDirection(t,e,r[0],r[1]))return i;if(this.matchInSameDirection(t,e,r[r.length-1],r[r.length-2]))return i}return null}insertEdge(t){this._edges.add(t)}findEdgeEnd(t){for(let e=this.getEdgeEnds().iterator();e.hasNext();){const n=e.next();if(n.getEdge()===t)return n}return null}addEdges(t){for(let e=t.iterator();e.hasNext();){const t=e.next();this._edges.add(t);const n=new fA(t,!0),i=new fA(t,!1);n.setSym(i),i.setSym(n),this.add(n),this.add(i)}}add(t){this._nodes.add(t),this._edgeEndList.add(t)}getNodes(){return this._nodes.values()}findEdge(t,e){for(let n=0;n<this._edges.size();n++){const i=this._edges.get(n),r=i.getCoordinates();if(t.equals(r[0])&&e.equals(r[1]))return i}return null}}class pA{constructor(){pA.constructor_.apply(this,arguments)}static constructor_(){this._geometryFactory=null,this._shellList=new Lk;const t=arguments[0];this._geometryFactory=t}static findEdgeRingContaining(t,e){const n=t.getLinearRing(),i=n.getEnvelopeInternal();let r=n.getCoordinateN(0),s=null,o=null;for(let t=e.iterator();t.hasNext();){const e=t.next(),a=e.getLinearRing(),l=a.getEnvelopeInternal();if(l.equals(i))continue;if(!l.contains(i))continue;r=rO.ptNotInList(n.getCoordinates(),a.getCoordinates());let c=!1;sC.isInRing(r,a.getCoordinates())&&(c=!0),c&&(null===s||o.contains(l))&&(s=e,o=s.getLinearRing().getEnvelopeInternal())}return s}sortShellsAndHoles(t,e,n){for(let i=t.iterator();i.hasNext();){const t=i.next();t.isHole()?n.add(t):e.add(t)}}computePolygons(t){const e=new Lk;for(let n=t.iterator();n.hasNext();){const t=n.next().toPolygon(this._geometryFactory);e.add(t)}return e}placeFreeHoles(t,e){for(let n=e.iterator();n.hasNext();){const e=n.next();if(null===e.getShell()){const n=pA.findEdgeRingContaining(e,t);if(null===n)throw new JC("unable to assign hole to a shell",e.getCoordinate(0));e.setShell(n)}}}buildMinimalEdgeRings(t,e,n){const i=new Lk;for(let r=t.iterator();r.hasNext();){const t=r.next();if(t.getMaxNodeDegree()>2){t.linkDirectedEdgesForMinimalEdgeRings();const i=t.buildMinimalRings(),r=this.findShell(i);null!==r?(this.placePolygonHoles(r,i),e.add(r)):n.addAll(i)}else i.add(t)}return i}buildMaximalEdgeRings(t){const e=new Lk;for(let n=t.iterator();n.hasNext();){const t=n.next();if(t.isInResult()&&t.getLabel().isArea()&&null===t.getEdgeRing()){const n=new aA(t,this._geometryFactory);e.add(n),n.setInResult()}}return e}placePolygonHoles(t,e){for(let n=e.iterator();n.hasNext();){const e=n.next();e.isHole()&&e.setShell(t)}}getPolygons(){return this.computePolygons(this._shellList)}findShell(t){let e=0,n=null;for(let i=t.iterator();i.hasNext();){const t=i.next();t.isHole()||(n=t,e++)}return lk.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),n}add(){if(1===arguments.length){const t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){const t=arguments[0],e=arguments[1];gA.linkResultDirectedEdges(e);const n=this.buildMaximalEdgeRings(t),i=new Lk,r=this.buildMinimalEdgeRings(n,this._shellList,i);this.sortShellsAndHoles(r,this._shellList,i),this.placeFreeHoles(this._shellList,i)}}}class _A{constructor(){_A.constructor_.apply(this,arguments)}static constructor_(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new Lk,this._resultLineList=new Lk;const t=arguments[0],e=arguments[1],n=arguments[2];this._op=t,this._geometryFactory=e,this._ptLocator=n}collectLines(t){for(let e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){const n=e.next();this.collectLineEdge(n,t,this._lineEdgesList),this.collectBoundaryTouchEdge(n,t,this._lineEdgesList)}}labelIsolatedLine(t,e){const n=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(e));t.getLabel().setLocation(e,n)}build(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList}collectLineEdge(t,e,n){const i=t.getLabel(),r=t.getEdge();t.isLineEdge()&&(t.isVisited()||!HA.isResultOfOp(i,e)||r.isCovered()||(n.add(r),t.setVisitedEdge(!0)))}findCoveredLineEdges(){for(let t=this._op.getGraph().getNodes().iterator();t.hasNext();){t.next().getEdges().findCoveredLineEdges()}for(let t=this._op.getGraph().getEdgeEnds().iterator();t.hasNext();){const e=t.next(),n=e.getEdge();if(e.isLineEdge()&&!n.isCoveredSet()){const t=this._op.isCoveredByA(e.getCoordinate());n.setCovered(t)}}}labelIsolatedLines(t){for(let e=t.iterator();e.hasNext();){const t=e.next(),n=t.getLabel();t.isIsolated()&&(n.isNull(0)?this.labelIsolatedLine(t,0):this.labelIsolatedLine(t,1))}}buildLines(t){for(let t=this._lineEdgesList.iterator();t.hasNext();){const e=t.next(),n=this._geometryFactory.createLineString(e.getCoordinates());this._resultLineList.add(n),e.setInResult(!0)}}collectBoundaryTouchEdge(t,e,n){const i=t.getLabel();return t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult()?null:(lk.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(HA.isResultOfOp(i,e)&&e===HA.INTERSECTION&&(n.add(t.getEdge()),t.setVisitedEdge(!0))))}}class yA{constructor(){yA.constructor_.apply(this,arguments)}static constructor_(){this._op=null,this._geometryFactory=null,this._resultPointList=new Lk;const t=arguments[0],e=arguments[1];this._op=t,this._geometryFactory=e}filterCoveredNodeToPoint(t){const e=t.getCoordinate();if(!this._op.isCoveredByLA(e)){const t=this._geometryFactory.createPoint(e);this._resultPointList.add(t)}}extractNonCoveredResultNodes(t){for(let e=this._op.getGraph().getNodes().iterator();e.hasNext();){const n=e.next();if(!n.isInResult()&&(!n.isIncidentEdgeInResult()&&(0===n.getEdges().getDegree()||t===HA.INTERSECTION))){const e=n.getLabel();HA.isResultOfOp(e,t)&&this.filterCoveredNodeToPoint(n)}}}build(t){return this.extractNonCoveredResultNodes(t),this._resultPointList}}class mA{locate(t){}}class xA{constructor(){xA.constructor_.apply(this,arguments)}static constructor_(){this._geom=null;const t=arguments[0];this._geom=t}static locatePointInPolygon(t,e){if(e.isEmpty())return iC.EXTERIOR;const n=e.getExteriorRing(),i=xA.locatePointInRing(t,n);if(i!==iC.INTERIOR)return i;for(let n=0;n<e.getNumInteriorRing();n++){const i=e.getInteriorRingN(n),r=xA.locatePointInRing(t,i);if(r===iC.BOUNDARY)return iC.BOUNDARY;if(r===iC.INTERIOR)return iC.EXTERIOR}return iC.INTERIOR}static locatePointInRing(t,e){return e.getEnvelopeInternal().intersects(t)?sC.locateInRing(t,e.getCoordinates()):iC.EXTERIOR}static containsPointInPolygon(t,e){return iC.EXTERIOR!==xA.locatePointInPolygon(t,e)}static locateInGeometry(t,e){if(e instanceof Yk)return xA.locatePointInPolygon(t,e);if(e instanceof Vk){const n=new fC(e);for(;n.hasNext();){const i=n.next();if(i!==e){const e=xA.locateInGeometry(t,i);if(e!==iC.EXTERIOR)return e}}}return iC.EXTERIOR}static isContained(t,e){return iC.EXTERIOR!==xA.locate(t,e)}static locate(t,e){return e.isEmpty()?iC.EXTERIOR:e.getEnvelopeInternal().intersects(t)?xA.locateInGeometry(t,e):iC.EXTERIOR}locate(t){return xA.locate(t,this._geom)}get interfaces_(){return[mA]}}class vA{constructor(){vA.constructor_.apply(this,arguments)}static constructor_(){this._edgeMap=new FC,this._edgeList=null,this._ptInAreaLocation=[iC.NONE,iC.NONE]}getNextCW(t){this.getEdges();const e=this._edgeList.indexOf(t);let n=e-1;return 0===e&&(n=this._edgeList.size()-1),this._edgeList.get(n)}propagateSideLabels(t){let e=iC.NONE;for(let n=this.iterator();n.hasNext();){const i=n.next().getLabel();i.isArea(t)&&i.getLocation(t,nA.LEFT)!==iC.NONE&&(e=i.getLocation(t,nA.LEFT))}if(e===iC.NONE)return null;let n=e;for(let e=this.iterator();e.hasNext();){const i=e.next(),r=i.getLabel();if(r.getLocation(t,nA.ON)===iC.NONE&&r.setLocation(t,nA.ON,n),r.isArea(t)){const e=r.getLocation(t,nA.LEFT),s=r.getLocation(t,nA.RIGHT);if(s!==iC.NONE){if(s!==n)throw new JC("side location conflict",i.getCoordinate());e===iC.NONE&&lk.shouldNeverReachHere("found single null side (at "+i.getCoordinate()+")"),n=e}else lk.isTrue(r.getLocation(t,nA.LEFT)===iC.NONE,"found single null side"),r.setLocation(t,nA.RIGHT,n),r.setLocation(t,nA.LEFT,n)}}}getCoordinate(){const t=this.iterator();if(!t.hasNext())return null;return t.next().getCoordinate()}print(t){iO.out.println("EdgeEndStar:   "+this.getCoordinate());for(let e=this.iterator();e.hasNext();){e.next().print(t)}}isAreaLabelsConsistent(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)}checkAreaLabelsConsistent(t){const e=this.getEdges();if(e.size()<=0)return!0;const n=e.size()-1,i=e.get(n).getLabel().getLocation(t,nA.LEFT);lk.isTrue(i!==iC.NONE,"Found unlabelled area edge");let r=i;for(let e=this.iterator();e.hasNext();){const n=e.next().getLabel();lk.isTrue(n.isArea(t),"Found non-area edge");const i=n.getLocation(t,nA.LEFT),s=n.getLocation(t,nA.RIGHT);if(i===s)return!1;if(s!==r)return!1;r=i}return!0}findIndex(t){this.iterator();for(let e=0;e<this._edgeList.size();e++){if(this._edgeList.get(e)===t)return e}return-1}iterator(){return this.getEdges().iterator()}getEdges(){return null===this._edgeList&&(this._edgeList=new Lk(this._edgeMap.values())),this._edgeList}getLocation(t,e,n){return this._ptInAreaLocation[t]===iC.NONE&&(this._ptInAreaLocation[t]=xA.locate(e,n[t].getGeometry())),this._ptInAreaLocation[t]}toString(){const t=new zk;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(let e=this.iterator();e.hasNext();){const n=e.next();t.append(n),t.append("\n")}return t.toString()}computeEdgeEndLabels(t){for(let e=this.iterator();e.hasNext();){e.next().computeLabel(t)}}computeLabelling(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);const e=[!1,!1];for(let t=this.iterator();t.hasNext();){const n=t.next().getLabel();for(let t=0;t<2;t++)n.isLine(t)&&n.getLocation(t)===iC.BOUNDARY&&(e[t]=!0)}for(let n=this.iterator();n.hasNext();){const i=n.next(),r=i.getLabel();for(let n=0;n<2;n++)if(r.isAnyNull(n)){let s=iC.NONE;if(e[n])s=iC.EXTERIOR;else{const e=i.getCoordinate();s=this.getLocation(n,e,t)}r.setAllLocationsIfNull(n,s)}}}getDegree(){return this._edgeMap.size()}insertEdgeEnd(t,e){this._edgeMap.put(t,e),this._edgeList=null}}class bA extends vA{constructor(){super(),bA.constructor_.apply(this,arguments)}static constructor_(){this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}linkResultDirectedEdges(){this.getResultAreaEdges();let t=null,e=null,n=this._SCANNING_FOR_INCOMING;for(let i=0;i<this._resultAreaEdgeList.size();i++){const r=this._resultAreaEdgeList.get(i),s=r.getSym();if(r.getLabel().isArea())switch(null===t&&r.isInResult()&&(t=r),n){case this._SCANNING_FOR_INCOMING:if(!s.isInResult())continue;e=s,n=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!r.isInResult())continue;e.setNext(r),n=this._SCANNING_FOR_INCOMING}}if(n===this._LINKING_TO_OUTGOING){if(null===t)throw new JC("no outgoing dirEdge found",this.getCoordinate());lk.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}}insert(t){const e=t;this.insertEdgeEnd(e,e)}getRightmostEdge(){const t=this.getEdges(),e=t.size();if(e<1)return null;const n=t.get(0);if(1===e)return n;const i=t.get(e-1),r=n.getQuadrant(),s=i.getQuadrant();return $C.isNorthern(r)&&$C.isNorthern(s)?n:$C.isNorthern(r)||$C.isNorthern(s)?0!==n.getDy()?n:0!==i.getDy()?i:(lk.shouldNeverReachHere("found two horizontal edges incident on node"),null):i}print(t){iO.out.println("DirectedEdgeStar: "+this.getCoordinate());for(let e=this.iterator();e.hasNext();){const n=e.next();t.print("out "),n.print(t),t.println(),t.print("in "),n.getSym().print(t),t.println()}}getResultAreaEdges(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new Lk;for(let t=this.iterator();t.hasNext();){const e=t.next();(e.isInResult()||e.getSym().isInResult())&&this._resultAreaEdgeList.add(e)}return this._resultAreaEdgeList}updateLabelling(t){for(let e=this.iterator();e.hasNext();){const n=e.next().getLabel();n.setAllLocationsIfNull(0,t.getLocation(0)),n.setAllLocationsIfNull(1,t.getLocation(1))}}linkAllDirectedEdges(){this.getEdges();let t=null,e=null;for(let n=this._edgeList.size()-1;n>=0;n--){const i=this._edgeList.get(n),r=i.getSym();null===e&&(e=r),null!==t&&r.setNext(t),t=i}e.setNext(t)}computeDepths(){if(1===arguments.length){const t=arguments[0],e=this.findIndex(t),n=t.getDepth(nA.LEFT),i=t.getDepth(nA.RIGHT),r=this.computeDepths(e+1,this._edgeList.size(),n);if(this.computeDepths(0,e,r)!==i)throw new JC("depth mismatch at "+t.getCoordinate())}else if(3===arguments.length){const t=arguments[1];let e=arguments[2];for(let n=arguments[0];n<t;n++){const t=this._edgeList.get(n);t.setEdgeDepths(nA.RIGHT,e),e=t.getDepth(nA.LEFT)}return e}}mergeSymLabels(){for(let t=this.iterator();t.hasNext();){const e=t.next();e.getLabel().merge(e.getSym().getLabel())}}linkMinimalDirectedEdges(t){let e=null,n=null,i=this._SCANNING_FOR_INCOMING;for(let r=this._resultAreaEdgeList.size()-1;r>=0;r--){const s=this._resultAreaEdgeList.get(r),o=s.getSym();switch(null===e&&s.getEdgeRing()===t&&(e=s),i){case this._SCANNING_FOR_INCOMING:if(o.getEdgeRing()!==t)continue;n=o,i=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(s.getEdgeRing()!==t)continue;n.setNextMin(s),i=this._SCANNING_FOR_INCOMING}}i===this._LINKING_TO_OUTGOING&&(lk.isTrue(null!==e,"found null for first outgoing dirEdge"),lk.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),n.setNextMin(e))}getOutgoingDegree(){if(0===arguments.length){let t=0;for(let e=this.iterator();e.hasNext();){e.next().isInResult()&&t++}return t}if(1===arguments.length){const t=arguments[0];let e=0;for(let n=this.iterator();n.hasNext();){n.next().getEdgeRing()===t&&e++}return e}}getLabel(){return this._label}findCoveredLineEdges(){let t=iC.NONE;for(let e=this.iterator();e.hasNext();){const n=e.next(),i=n.getSym();if(!n.isLineEdge()){if(n.isInResult()){t=iC.INTERIOR;break}if(i.isInResult()){t=iC.EXTERIOR;break}}}if(t===iC.NONE)return null;let e=t;for(let t=this.iterator();t.hasNext();){const n=t.next(),i=n.getSym();n.isLineEdge()?n.getEdge().setCovered(e===iC.INTERIOR):(n.isInResult()&&(e=iC.EXTERIOR),i.isInResult()&&(e=iC.INTERIOR))}}computeLabelling(t){super.computeLabelling.call(this,t),this._label=new rA(iC.NONE);for(let t=this.iterator();t.hasNext();){const e=t.next().getEdge().getLabel();for(let t=0;t<2;t++){const n=e.getLocation(t);n!==iC.INTERIOR&&n!==iC.BOUNDARY||this._label.setLocation(t,iC.INTERIOR)}}}}class MA extends dA{constructor(){super()}createNode(t){return new cA(t,new bA)}}class wA{constructor(){wA.constructor_.apply(this,arguments)}static constructor_(){this.mce=null,this.chainIndex=null;const t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e}computeIntersections(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)}}class EA{constructor(){EA.constructor_.apply(this,arguments)}static constructor_(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){const t=arguments[0],e=arguments[1];this._eventType=EA.DELETE,this._xValue=t,this._insertEvent=e}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this._eventType=EA.INSERT,this._label=t,this._xValue=e,this._obj=n}}isDelete(){return this._eventType===EA.DELETE}setDeleteEventIndex(t){this._deleteEventIndex=t}getObject(){return this._obj}compareTo(t){const e=t;return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0}getInsertEvent(){return this._insertEvent}isInsert(){return this._eventType===EA.INSERT}isSameLabel(t){return null!==this._label&&this._label===t._label}getDeleteEventIndex(){return this._deleteEventIndex}get interfaces_(){return[nk]}}EA.INSERT=1,EA.DELETE=2;class SA{}class NA{constructor(){NA.constructor_.apply(this,arguments)}static constructor_(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;const t=arguments[0],e=arguments[1],n=arguments[2];this._li=t,this._includeProper=e,this._recordIsolated=n}static isAdjacentSegments(t,e){return 1===Math.abs(t-e)}isTrivialIntersection(t,e,n,i){if(t===n&&1===this._li.getIntersectionNum()){if(NA.isAdjacentSegments(e,i))return!0;if(t.isClosed()){const n=t.getNumPoints()-1;if(0===e&&i===n||0===i&&e===n)return!0}}return!1}getProperIntersectionPoint(){return this._properIntersectionPoint}setIsDoneIfProperInt(t){this._isDoneWhenProperInt=t}hasProperInteriorIntersection(){return this._hasProperInterior}isBoundaryPointInternal(t,e){for(let n=e.iterator();n.hasNext();){const e=n.next().getCoordinate();if(t.isIntersection(e))return!0}return!1}hasProperIntersection(){return this._hasProper}hasIntersection(){return this._hasIntersection}isDone(){return this._isDone}isBoundaryPoint(t,e){return null!==e&&(!!this.isBoundaryPointInternal(t,e[0])||!!this.isBoundaryPointInternal(t,e[1]))}setBoundaryNodes(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e}addIntersections(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;const r=t.getCoordinates()[e],s=t.getCoordinates()[e+1],o=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,s,o,a),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),n.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))}}class IA extends SA{constructor(){super(),IA.constructor_.apply(this,arguments)}static constructor_(){this.events=new Lk,this.nOverlaps=null}prepareEvents(){MC.sort(this.events);for(let t=0;t<this.events.size();t++){const e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}}computeIntersections(){if(1===arguments.length){const t=arguments[0];this.nOverlaps=0,this.prepareEvents();for(let e=0;e<this.events.size();e++){const n=this.events.get(e);if(n.isInsert()&&this.processOverlaps(e,n.getDeleteEventIndex(),n,t),t.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof NA&&XI(arguments[0],Tk)&&XI(arguments[1],Tk)){const t=arguments[0],e=arguments[1],n=arguments[2];this.addEdges(t,t),this.addEdges(e,e),this.computeIntersections(n)}else if("boolean"==typeof arguments[2]&&XI(arguments[0],Tk)&&arguments[1]instanceof NA){const t=arguments[0],e=arguments[1];arguments[2]?this.addEdges(t,null):this.addEdges(t),this.computeIntersections(e)}}addEdge(t,e){const n=t.getMonotoneChainEdge(),i=n.getStartIndexes();for(let t=0;t<i.length-1;t++){const i=new wA(n,t),r=new EA(e,n.getMinX(t),i);this.events.add(r),this.events.add(new EA(n.getMaxX(t),r))}}processOverlaps(t,e,n,i){const r=n.getObject();for(let s=t;s<e;s++){const t=this.events.get(s);if(t.isInsert()){const e=t.getObject();n.isSameLabel(t)||(r.computeIntersections(e,i),this.nOverlaps++)}}}addEdges(){if(1===arguments.length){for(let t=arguments[0].iterator();t.hasNext();){const e=t.next();this.addEdge(e,e)}}else if(2===arguments.length){const t=arguments[1];for(let e=arguments[0].iterator();e.hasNext();){const n=e.next();this.addEdge(n,t)}}}}class kA{constructor(){kA.constructor_.apply(this,arguments)}static constructor_(){this._min=HI.POSITIVE_INFINITY,this._max=HI.NEGATIVE_INFINITY}getMin(){return this._min}intersects(t,e){return!(this._min>e||this._max<t)}getMax(){return this._max}toString(){return WO.toLineString(new fk(this._min,0),new fk(this._max,0))}}kA.NodeComparator=class{compare(t,e){const n=t,i=e,r=(n._min+n._max)/2,s=(i._min+i._max)/2;return r<s?-1:r>s?1:0}get interfaces_(){return[sk]}};class OA extends kA{constructor(){super(),OA.constructor_.apply(this,arguments)}static constructor_(){this._item=null;const t=arguments[0],e=arguments[1],n=arguments[2];this._min=t,this._max=e,this._item=n}query(t,e,n){if(!this.intersects(t,e))return null;n.visitItem(this._item)}}class CA extends kA{constructor(){super(),CA.constructor_.apply(this,arguments)}static constructor_(){this._node1=null,this._node2=null;const t=arguments[0],e=arguments[1];this._node1=t,this._node2=e,this.buildExtent(this._node1,this._node2)}buildExtent(t,e){this._min=Math.min(t._min,e._min),this._max=Math.max(t._max,e._max)}query(t,e,n){if(!this.intersects(t,e))return null;null!==this._node1&&this._node1.query(t,e,n),null!==this._node2&&this._node2.query(t,e,n)}}class AA{constructor(){AA.constructor_.apply(this,arguments)}static constructor_(){this._leaves=new Lk,this._root=null,this._level=0}buildTree(){MC.sort(this._leaves,new kA.NodeComparator);let t=this._leaves,e=null,n=new Lk;for(;;){if(this.buildLevel(t,n),1===n.size())return n.get(0);e=t,t=n,n=e}}insert(t,e,n){if(null!==this._root)throw new Ik("Index cannot be added to once it has been queried");this._leaves.add(new OA(t,e,n))}query(t,e,n){if(this.init(),null===this._root)return null;this._root.query(t,e,n)}buildRoot(){if(null!==this._root)return null;this._root=this.buildTree()}printNode(t){iO.out.println(WO.toLineString(new fk(t._min,this._level),new fk(t._max,this._level)))}init(){return null!==this._root||0===this._leaves.size()?null:void this.buildRoot()}buildLevel(t,e){this._level++,e.clear();for(let n=0;n<t.size();n+=2){const i=t.get(n);if(null===(n+1<t.size()?t.get(n):null))e.add(i);else{const i=new CA(t.get(n),t.get(n+1));e.add(i)}}}}class TA{constructor(){TA.constructor_.apply(this,arguments)}static constructor_(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length){const t=arguments[0];this._lines=t}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this._lines=t,this._isForcedToLineString=e}}static getGeometry(){if(1===arguments.length){const t=arguments[0];return t.getFactory().buildGeometry(TA.getLines(t))}if(2===arguments.length){const t=arguments[0],e=arguments[1];return t.getFactory().buildGeometry(TA.getLines(t,e))}}static getLines(){if(1===arguments.length){const t=arguments[0];return TA.getLines(t,!1)}if(2===arguments.length){if(XI(arguments[0],Ck)&&XI(arguments[1],Ck)){const t=arguments[1];for(let e=arguments[0].iterator();e.hasNext();){const n=e.next();TA.getLines(n,t)}return t}if(arguments[0]instanceof pk&&"boolean"==typeof arguments[1]){const t=arguments[0],e=arguments[1],n=new Lk;return t.apply(new TA(n,e)),n}if(arguments[0]instanceof pk&&XI(arguments[1],Ck)){const t=arguments[0],e=arguments[1];return t instanceof Sk?e.add(t):t.apply(new TA(e)),e}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&XI(arguments[0],Ck)&&XI(arguments[1],Ck)){const t=arguments[1],e=arguments[2];for(let n=arguments[0].iterator();n.hasNext();){const i=n.next();TA.getLines(i,t,e)}return t}if("boolean"==typeof arguments[2]&&arguments[0]instanceof pk&&XI(arguments[1],Ck)){const t=arguments[1],e=arguments[2];return arguments[0].apply(new TA(t,e)),t}}}filter(t){if(this._isForcedToLineString&&t instanceof Jk){const e=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(e),null}t instanceof Sk&&this._lines.add(t)}setForceToLineString(t){this._isForcedToLineString=t}get interfaces_(){return[ek]}}class RA{constructor(){RA.constructor_.apply(this,arguments)}static constructor_(){this._items=new Lk}visitItem(t){this._items.add(t)}getItems(){return this._items}get interfaces_(){return[SC]}}class LA{constructor(){LA.constructor_.apply(this,arguments)}static constructor_(){this._geom=null,this._index=null;const t=arguments[0];if(!(XI(t,Bk)||t instanceof Jk))throw new tk("Argument must be Polygonal or LinearRing");this._geom=t}locate(t){null===this._index&&(this._index=new DA(this._geom),this._geom=null);const e=new rC(t),n=new PA(e);return this._index.query(t.y,t.y,n),e.getLocation()}get interfaces_(){return[mA]}}class PA{constructor(){PA.constructor_.apply(this,arguments)}static constructor_(){this._counter=null;const t=arguments[0];this._counter=t}visitItem(t){const e=t;this._counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))}get interfaces_(){return[SC]}}class DA{constructor(){DA.constructor_.apply(this,arguments)}static constructor_(){this._isEmpty=!1,this._index=new AA;const t=arguments[0];t.isEmpty()?this._isEmpty=!0:this.init(t)}init(t){for(let e=TA.getLines(t).iterator();e.hasNext();){const t=e.next().getCoordinates();this.addLine(t)}}addLine(t){for(let e=1;e<t.length;e++){const n=new HO(t[e-1],t[e]),i=Math.min(n.p0.y,n.p1.y),r=Math.max(n.p0.y,n.p1.y);this._index.insert(i,r,n)}}query(){if(2===arguments.length){const t=arguments[0],e=arguments[1];if(this._isEmpty)return new Lk;const n=new RA;return this._index.query(t,e,n),n.getItems()}if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];if(this._isEmpty)return null;this._index.query(t,e,n)}}}LA.SegmentVisitor=PA,LA.IntervalIndexedGeometry=DA;class zA{constructor(){zA.constructor_.apply(this,arguments)}static constructor_(){this.coord=null,this.segmentIndex=null,this.dist=null;const t=arguments[0],e=arguments[1],n=arguments[2];this.coord=new fk(t),this.segmentIndex=e,this.dist=n}getSegmentIndex(){return this.segmentIndex}getCoordinate(){return this.coord}print(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)}compareTo(t){const e=t;return this.compare(e.segmentIndex,e.dist)}isEndPoint(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t}toString(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist}getDistance(){return this.dist}compare(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0}get interfaces_(){return[nk]}}class FA{constructor(){FA.constructor_.apply(this,arguments)}static constructor_(){this._nodeMap=new FC,this.edge=null;const t=arguments[0];this.edge=t}print(t){t.println("Intersections:");for(let e=this.iterator();e.hasNext();){e.next().print(t)}}iterator(){return this._nodeMap.values().iterator()}addSplitEdges(t){this.addEndpoints();const e=this.iterator();let n=e.next();for(;e.hasNext();){const i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}}addEndpoints(){const t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)}createSplitEdge(t,e){let n=e.segmentIndex-t.segmentIndex+2;const i=this.edge.pts[e.segmentIndex],r=e.dist>0||!e.coord.equals2D(i);r||n--;const s=new Array(n).fill(null);let o=0;s[o++]=new fk(t.coord);for(let n=t.segmentIndex+1;n<=e.segmentIndex;n++)s[o++]=this.edge.pts[n];return r&&(s[o]=e.coord),new $A(s,new rA(this.edge._label))}add(t,e,n){const i=new zA(t,e,n),r=this._nodeMap.get(i);return null!==r?r:(this._nodeMap.put(i,i),i)}isIntersection(t){for(let e=this.iterator();e.hasNext();){if(e.next().coord.equals(t))return!0}return!1}}class GA{constructor(){GA.constructor_.apply(this,arguments)}static constructor_(){if(this._matrix=null,0===arguments.length)this._matrix=Array(3).fill().map((()=>Array(3))),this.setAll(Mk.FALSE);else if(1===arguments.length)if("string"==typeof arguments[0]){const t=arguments[0];GA.constructor_.call(this),this.set(t)}else if(arguments[0]instanceof GA){const t=arguments[0];GA.constructor_.call(this),this._matrix[iC.INTERIOR][iC.INTERIOR]=t._matrix[iC.INTERIOR][iC.INTERIOR],this._matrix[iC.INTERIOR][iC.BOUNDARY]=t._matrix[iC.INTERIOR][iC.BOUNDARY],this._matrix[iC.INTERIOR][iC.EXTERIOR]=t._matrix[iC.INTERIOR][iC.EXTERIOR],this._matrix[iC.BOUNDARY][iC.INTERIOR]=t._matrix[iC.BOUNDARY][iC.INTERIOR],this._matrix[iC.BOUNDARY][iC.BOUNDARY]=t._matrix[iC.BOUNDARY][iC.BOUNDARY],this._matrix[iC.BOUNDARY][iC.EXTERIOR]=t._matrix[iC.BOUNDARY][iC.EXTERIOR],this._matrix[iC.EXTERIOR][iC.INTERIOR]=t._matrix[iC.EXTERIOR][iC.INTERIOR],this._matrix[iC.EXTERIOR][iC.BOUNDARY]=t._matrix[iC.EXTERIOR][iC.BOUNDARY],this._matrix[iC.EXTERIOR][iC.EXTERIOR]=t._matrix[iC.EXTERIOR][iC.EXTERIOR]}}static matches(){if(Number.isInteger(arguments[0])&&"string"==typeof arguments[1]){const t=arguments[0],e=arguments[1];return e===Mk.SYM_DONTCARE||(e===Mk.SYM_TRUE&&(t>=0||t===Mk.TRUE)||(e===Mk.SYM_FALSE&&t===Mk.FALSE||(e===Mk.SYM_P&&t===Mk.P||(e===Mk.SYM_L&&t===Mk.L||e===Mk.SYM_A&&t===Mk.A))))}if("string"==typeof arguments[0]&&"string"==typeof arguments[1]){const t=arguments[1];return new GA(arguments[0]).matches(t)}}static isTrue(t){return t>=0||t===Mk.TRUE}isIntersects(){return!this.isDisjoint()}isCovers(){return(GA.isTrue(this._matrix[iC.INTERIOR][iC.INTERIOR])||GA.isTrue(this._matrix[iC.INTERIOR][iC.BOUNDARY])||GA.isTrue(this._matrix[iC.BOUNDARY][iC.INTERIOR])||GA.isTrue(this._matrix[iC.BOUNDARY][iC.BOUNDARY]))&&this._matrix[iC.EXTERIOR][iC.INTERIOR]===Mk.FALSE&&this._matrix[iC.EXTERIOR][iC.BOUNDARY]===Mk.FALSE}isCoveredBy(){return(GA.isTrue(this._matrix[iC.INTERIOR][iC.INTERIOR])||GA.isTrue(this._matrix[iC.INTERIOR][iC.BOUNDARY])||GA.isTrue(this._matrix[iC.BOUNDARY][iC.INTERIOR])||GA.isTrue(this._matrix[iC.BOUNDARY][iC.BOUNDARY]))&&this._matrix[iC.INTERIOR][iC.EXTERIOR]===Mk.FALSE&&this._matrix[iC.BOUNDARY][iC.EXTERIOR]===Mk.FALSE}set(){if(1===arguments.length){const t=arguments[0];for(let e=0;e<t.length;e++){const n=Math.trunc(e/3),i=e%3;this._matrix[n][i]=Mk.toDimensionValue(t.charAt(e))}}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this._matrix[t][e]=n}}isContains(){return GA.isTrue(this._matrix[iC.INTERIOR][iC.INTERIOR])&&this._matrix[iC.EXTERIOR][iC.INTERIOR]===Mk.FALSE&&this._matrix[iC.EXTERIOR][iC.BOUNDARY]===Mk.FALSE}setAtLeast(){if(1===arguments.length){const t=arguments[0];for(let e=0;e<t.length;e++){const n=Math.trunc(e/3),i=e%3;this.setAtLeast(n,i,Mk.toDimensionValue(t.charAt(e)))}}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this._matrix[t][e]<n&&(this._matrix[t][e]=n)}}setAtLeastIfValid(t,e,n){t>=0&&e>=0&&this.setAtLeast(t,e,n)}isWithin(){return GA.isTrue(this._matrix[iC.INTERIOR][iC.INTERIOR])&&this._matrix[iC.INTERIOR][iC.EXTERIOR]===Mk.FALSE&&this._matrix[iC.BOUNDARY][iC.EXTERIOR]===Mk.FALSE}isTouches(t,e){return t>e?this.isTouches(e,t):(t===Mk.A&&e===Mk.A||t===Mk.L&&e===Mk.L||t===Mk.L&&e===Mk.A||t===Mk.P&&e===Mk.A||t===Mk.P&&e===Mk.L)&&(this._matrix[iC.INTERIOR][iC.INTERIOR]===Mk.FALSE&&(GA.isTrue(this._matrix[iC.INTERIOR][iC.BOUNDARY])||GA.isTrue(this._matrix[iC.BOUNDARY][iC.INTERIOR])||GA.isTrue(this._matrix[iC.BOUNDARY][iC.BOUNDARY])))}isOverlaps(t,e){return t===Mk.P&&e===Mk.P||t===Mk.A&&e===Mk.A?GA.isTrue(this._matrix[iC.INTERIOR][iC.INTERIOR])&&GA.isTrue(this._matrix[iC.INTERIOR][iC.EXTERIOR])&&GA.isTrue(this._matrix[iC.EXTERIOR][iC.INTERIOR]):t===Mk.L&&e===Mk.L&&(1===this._matrix[iC.INTERIOR][iC.INTERIOR]&&GA.isTrue(this._matrix[iC.INTERIOR][iC.EXTERIOR])&&GA.isTrue(this._matrix[iC.EXTERIOR][iC.INTERIOR]))}isEquals(t,e){return t===e&&(GA.isTrue(this._matrix[iC.INTERIOR][iC.INTERIOR])&&this._matrix[iC.INTERIOR][iC.EXTERIOR]===Mk.FALSE&&this._matrix[iC.BOUNDARY][iC.EXTERIOR]===Mk.FALSE&&this._matrix[iC.EXTERIOR][iC.INTERIOR]===Mk.FALSE&&this._matrix[iC.EXTERIOR][iC.BOUNDARY]===Mk.FALSE)}toString(){const t=new sO("123456789");for(let e=0;e<3;e++)for(let n=0;n<3;n++)t.setCharAt(3*e+n,Mk.toDimensionSymbol(this._matrix[e][n]));return t.toString()}setAll(t){for(let e=0;e<3;e++)for(let n=0;n<3;n++)this._matrix[e][n]=t}get(t,e){return this._matrix[t][e]}transpose(){let t=this._matrix[1][0];return this._matrix[1][0]=this._matrix[0][1],this._matrix[0][1]=t,t=this._matrix[2][0],this._matrix[2][0]=this._matrix[0][2],this._matrix[0][2]=t,t=this._matrix[2][1],this._matrix[2][1]=this._matrix[1][2],this._matrix[1][2]=t,this}matches(t){if(9!==t.length)throw new tk("Should be length 9: "+t);for(let e=0;e<3;e++)for(let n=0;n<3;n++)if(!GA.matches(this._matrix[e][n],t.charAt(3*e+n)))return!1;return!0}add(t){for(let e=0;e<3;e++)for(let n=0;n<3;n++)this.setAtLeast(e,n,t.get(e,n))}isDisjoint(){return this._matrix[iC.INTERIOR][iC.INTERIOR]===Mk.FALSE&&this._matrix[iC.INTERIOR][iC.BOUNDARY]===Mk.FALSE&&this._matrix[iC.BOUNDARY][iC.INTERIOR]===Mk.FALSE&&this._matrix[iC.BOUNDARY][iC.BOUNDARY]===Mk.FALSE}isCrosses(t,e){return t===Mk.P&&e===Mk.L||t===Mk.P&&e===Mk.A||t===Mk.L&&e===Mk.A?GA.isTrue(this._matrix[iC.INTERIOR][iC.INTERIOR])&&GA.isTrue(this._matrix[iC.INTERIOR][iC.EXTERIOR]):t===Mk.L&&e===Mk.P||t===Mk.A&&e===Mk.P||t===Mk.A&&e===Mk.L?GA.isTrue(this._matrix[iC.INTERIOR][iC.INTERIOR])&&GA.isTrue(this._matrix[iC.EXTERIOR][iC.INTERIOR]):t===Mk.L&&e===Mk.L&&0===this._matrix[iC.INTERIOR][iC.INTERIOR]}get interfaces_(){return[JI]}}class jA{constructor(){jA.constructor_.apply(this,arguments)}static constructor_(){if(this._data=null,this._size=0,0===arguments.length)jA.constructor_.call(this,10);else if(1===arguments.length){const t=arguments[0];this._data=new Array(t).fill(null)}}size(){return this._size}addAll(t){return null===t||0===t.length?null:(this.ensureCapacity(this._size+t.length),iO.arraycopy(t,0,this._data,this._size,t.length),void(this._size+=t.length))}ensureCapacity(t){if(t<=this._data.length)return null;const e=Math.max(t,2*this._data.length);this._data=Dk.copyOf(this._data,e)}toArray(){const t=new Array(this._size).fill(null);return iO.arraycopy(this._data,0,t,0,this._size),t}add(t){this.ensureCapacity(this._size+1),this._data[this._size]=t,++this._size}}class qA{static toIntArray(t){const e=new Array(t.size()).fill(null);for(let n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e}getChainStartIndices(t){let e=0;const n=new jA(Math.trunc(t.length/2));n.add(e);do{const i=this.findChainEnd(t,e);n.add(i),e=i}while(e<t.length-1);return n.toArray()}findChainEnd(t,e){const n=$C.quadrant(t[e],t[e+1]);let i=e+1;for(;i<t.length;){if($C.quadrant(t[i-1],t[i])!==n)break;i++}return i-1}OLDgetChainStartIndices(t){let e=0;const n=new Lk;n.add(e);do{const i=this.findChainEnd(t,e);n.add(i),e=i}while(e<t.length-1);return qA.toIntArray(n)}}class BA{constructor(){BA.constructor_.apply(this,arguments)}static constructor_(){this.e=null,this.pts=null,this.startIndex=null;const t=arguments[0];this.e=t,this.pts=t.getCoordinates();const e=new qA;this.startIndex=e.getChainStartIndices(this.pts)}getCoordinates(){return this.pts}getMaxX(t){const e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e>n?e:n}getMinX(t){const e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e<n?e:n}computeIntersectsForChain(){if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[n],e.startIndex[n+1],i)}else if(6===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=arguments[4],s=arguments[5];if(e-t==1&&r-i==1)return s.addIntersections(this.e,t,n.e,i),null;if(!this.overlaps(t,e,n,i,r))return null;const o=Math.trunc((t+e)/2),a=Math.trunc((i+r)/2);t<o&&(i<a&&this.computeIntersectsForChain(t,o,n,i,a,s),a<r&&this.computeIntersectsForChain(t,o,n,a,r,s)),o<e&&(i<a&&this.computeIntersectsForChain(o,e,n,i,a,s),a<r&&this.computeIntersectsForChain(o,e,n,a,r,s))}}overlaps(t,e,n,i,r){return gk.intersects(this.pts[t],this.pts[e],n.pts[i],n.pts[r])}getStartIndexes(){return this.startIndex}computeIntersects(t,e){for(let n=0;n<this.startIndex.length-1;n++)for(let i=0;i<t.startIndex.length-1;i++)this.computeIntersectsForChain(n,t,i,e)}}class YA{constructor(){YA.constructor_.apply(this,arguments)}static constructor_(){this._depth=Array(2).fill().map((()=>Array(3)));for(let t=0;t<2;t++)for(let e=0;e<3;e++)this._depth[t][e]=YA.NULL_VALUE}static depthAtLocation(t){return t===iC.EXTERIOR?0:t===iC.INTERIOR?1:YA.NULL_VALUE}getDepth(t,e){return this._depth[t][e]}setDepth(t,e,n){this._depth[t][e]=n}isNull(){if(0===arguments.length){for(let t=0;t<2;t++)for(let e=0;e<3;e++)if(this._depth[t][e]!==YA.NULL_VALUE)return!1;return!0}if(1===arguments.length){const t=arguments[0];return this._depth[t][1]===YA.NULL_VALUE}if(2===arguments.length){const t=arguments[0],e=arguments[1];return this._depth[t][e]===YA.NULL_VALUE}}normalize(){for(let t=0;t<2;t++)if(!this.isNull(t)){let e=this._depth[t][1];this._depth[t][2]<e&&(e=this._depth[t][2]),e<0&&(e=0);for(let n=1;n<3;n++){let i=0;this._depth[t][n]>e&&(i=1),this._depth[t][n]=i}}}getDelta(t){return this._depth[t][nA.RIGHT]-this._depth[t][nA.LEFT]}getLocation(t,e){return this._depth[t][e]<=0?iC.EXTERIOR:iC.INTERIOR}toString(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]}add(){if(1===arguments.length){const t=arguments[0];for(let e=0;e<2;e++)for(let n=1;n<3;n++){const i=t.getLocation(e,n);i!==iC.EXTERIOR&&i!==iC.INTERIOR||(this.isNull(e,n)?this._depth[e][n]=YA.depthAtLocation(i):this._depth[e][n]+=YA.depthAtLocation(i))}}else if(3===arguments.length){const t=arguments[0],e=arguments[1];arguments[2]===iC.INTERIOR&&this._depth[t][e]++}}}YA.NULL_VALUE=-1;class $A extends lA{constructor(){super(),$A.constructor_.apply(this,arguments)}static constructor_(){if(this.pts=null,this._env=null,this.eiList=new FA(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new YA,this._depthDelta=0,1===arguments.length){const t=arguments[0];$A.constructor_.call(this,t,null)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.pts=t,this._label=e}}static updateIM(){if(!(2===arguments.length&&arguments[1]instanceof GA&&arguments[0]instanceof rA))return super.updateIM.apply(this,arguments);{const t=arguments[0],e=arguments[1];e.setAtLeastIfValid(t.getLocation(0,nA.ON),t.getLocation(1,nA.ON),1),t.isArea()&&(e.setAtLeastIfValid(t.getLocation(0,nA.LEFT),t.getLocation(1,nA.LEFT),2),e.setAtLeastIfValid(t.getLocation(0,nA.RIGHT),t.getLocation(1,nA.RIGHT),2))}}getDepth(){return this._depth}getCollapsedEdge(){const t=new Array(2).fill(null);t[0]=this.pts[0],t[1]=this.pts[1];return new $A(t,rA.toLineLabel(this._label))}isIsolated(){return this._isIsolated}getCoordinates(){return this.pts}setIsolated(t){this._isIsolated=t}setName(t){this._name=t}equals(t){if(!(t instanceof $A))return!1;const e=t;if(this.pts.length!==e.pts.length)return!1;let n=!0,i=!0,r=this.pts.length;for(let t=0;t<this.pts.length;t++)if(this.pts[t].equals2D(e.pts[t])||(n=!1),this.pts[t].equals2D(e.pts[--r])||(i=!1),!n&&!i)return!1;return!0}getCoordinate(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){const t=arguments[0];return this.pts[t]}}print(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(let e=0;e<this.pts.length;e++)e>0&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this._label+" "+this._depthDelta)}computeIM(t){$A.updateIM(this._label,t)}isCollapsed(){return!!this._label.isArea()&&(3===this.pts.length&&!!this.pts[0].equals(this.pts[2]))}isClosed(){return this.pts[0].equals(this.pts[this.pts.length-1])}getMaximumSegmentIndex(){return this.pts.length-1}getDepthDelta(){return this._depthDelta}getNumPoints(){return this.pts.length}printReverse(t){t.print("edge "+this._name+": ");for(let e=this.pts.length-1;e>=0;e--)t.print(this.pts[e]+" ");t.println("")}getMonotoneChainEdge(){return null===this._mce&&(this._mce=new BA(this)),this._mce}getEnvelope(){if(null===this._env){this._env=new gk;for(let t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env}addIntersection(t,e,n,i){const r=new fk(t.getIntersection(i));let s=e,o=t.getEdgeDistance(n,i);const a=s+1;if(a<this.pts.length){const t=this.pts[a];r.equals2D(t)&&(s=a,o=0)}this.eiList.add(r,s,o)}toString(){const t=new sO;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(let e=0;e<this.pts.length;e++)e>0&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()}isPointwiseEqual(t){if(this.pts.length!==t.pts.length)return!1;for(let e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0}setDepthDelta(t){this._depthDelta=t}getEdgeIntersectionList(){return this.eiList}addIntersections(t,e,n){for(let i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)}}class UA extends gA{constructor(){super(),UA.constructor_.apply(this,arguments)}static constructor_(){if(this._parentGeom=null,this._lineEdgeMap=new fO,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new dC,2===arguments.length){const t=arguments[0],e=arguments[1];UA.constructor_.call(this,t,e,oC.OGC_SFS_BOUNDARY_RULE)}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this._argIndex=t,this._parentGeom=e,this._boundaryNodeRule=n,null!==e&&this.add(e)}}static determineBoundary(t,e){return t.isInBoundary(e)?iC.BOUNDARY:iC.INTERIOR}insertBoundaryPoint(t,e){const n=this._nodes.addNode(e).getLabel();let i=1,r=iC.NONE;r=n.getLocation(t,nA.ON),r===iC.BOUNDARY&&i++;const s=UA.determineBoundary(this._boundaryNodeRule,i);n.setLocation(t,s)}computeSelfNodes(){if(2===arguments.length){const t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){const t=arguments[1],e=arguments[2],n=new NA(arguments[0],!0,!1);n.setIsDoneIfProperInt(e);const i=this.createEdgeSetIntersector(),r=this._parentGeom instanceof Jk||this._parentGeom instanceof Yk||this._parentGeom instanceof lO,s=t||!r;return i.computeIntersections(this._edges,n,s),this.addSelfIntersectionNodes(this._argIndex),n}}computeSplitEdges(t){for(let e=this._edges.iterator();e.hasNext();){e.next().eiList.addSplitEdges(t)}}computeEdgeIntersections(t,e,n){const i=new NA(e,n,!0);i.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes());return this.createEdgeSetIntersector().computeIntersections(this._edges,t._edges,i),i}getGeometry(){return this._parentGeom}getBoundaryNodeRule(){return this._boundaryNodeRule}hasTooFewPoints(){return this._hasTooFewPoints}addPoint(){if(arguments[0]instanceof kk){const t=arguments[0].getCoordinate();this.insertPoint(this._argIndex,t,iC.INTERIOR)}else if(arguments[0]instanceof fk){const t=arguments[0];this.insertPoint(this._argIndex,t,iC.INTERIOR)}}addPolygon(t){this.addPolygonRing(t.getExteriorRing(),iC.EXTERIOR,iC.INTERIOR);for(let e=0;e<t.getNumInteriorRing();e++){const n=t.getInteriorRingN(e);this.addPolygonRing(n,iC.INTERIOR,iC.EXTERIOR)}}addEdge(t){this.insertEdge(t);const e=t.getCoordinates();this.insertPoint(this._argIndex,e[0],iC.BOUNDARY),this.insertPoint(this._argIndex,e[e.length-1],iC.BOUNDARY)}addLineString(t){const e=rO.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=e[0],null;const n=new $A(e,new rA(this._argIndex,iC.INTERIOR));this._lineEdgeMap.put(t,n),this.insertEdge(n),lk.isTrue(e.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,e[0]),this.insertBoundaryPoint(this._argIndex,e[e.length-1])}getInvalidPoint(){return this._invalidPoint}getBoundaryPoints(){const t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null);let n=0;for(let i=t.iterator();i.hasNext();){const t=i.next();e[n++]=t.getCoordinate().copy()}return e}getBoundaryNodes(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes}addSelfIntersectionNode(t,e,n){if(this.isBoundaryNode(t,e))return null;n===iC.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,n)}addPolygonRing(t,e,n){if(t.isEmpty())return null;const i=rO.removeRepeatedPoints(t.getCoordinates());if(i.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=i[0],null;let r=e,s=n;qk.isCCW(i)&&(r=n,s=e);const o=new $A(i,new rA(this._argIndex,iC.BOUNDARY,r,s));this._lineEdgeMap.put(t,o),this.insertEdge(o),this.insertPoint(this._argIndex,i[0],iC.BOUNDARY)}insertPoint(t,e,n){const i=this._nodes.addNode(e),r=i.getLabel();null===r?i._label=new rA(t,n):r.setLocation(t,n)}createEdgeSetIntersector(){return new IA}addSelfIntersectionNodes(t){for(let e=this._edges.iterator();e.hasNext();){const n=e.next(),i=n.getLabel().getLocation(t);for(let e=n.eiList.iterator();e.hasNext();){const n=e.next();this.addSelfIntersectionNode(t,n.coord,i)}}}add(){if(!(1===arguments.length&&arguments[0]instanceof pk))return super.add.apply(this,arguments);{const t=arguments[0];if(t.isEmpty())return null;if(t instanceof lO&&(this._useBoundaryDeterminationRule=!1),t instanceof Yk)this.addPolygon(t);else if(t instanceof Sk)this.addLineString(t);else if(t instanceof kk)this.addPoint(t);else if(t instanceof Hk)this.addCollection(t);else if(t instanceof pO)this.addCollection(t);else if(t instanceof lO)this.addCollection(t);else{if(!(t instanceof Vk))throw new vk(t.getGeometryType());this.addCollection(t)}}}addCollection(t){for(let e=0;e<t.getNumGeometries();e++){const n=t.getGeometryN(e);this.add(n)}}locate(t){return XI(this._parentGeom,Bk)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new LA(this._parentGeom)),this._areaPtLocator.locate(t)):this._ptLocator.locate(t,this._parentGeom)}findEdge(){if(1===arguments.length&&arguments[0]instanceof Sk){const t=arguments[0];return this._lineEdgeMap.get(t)}return super.findEdge.apply(this,arguments)}}class WA{constructor(){WA.constructor_.apply(this,arguments)}static constructor_(){if(this._li=new VO,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){const t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new UA(0,t)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];WA.constructor_.call(this,t,e,oC.OGC_SFS_BOUNDARY_RULE)}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];t.getPrecisionModel().compareTo(e.getPrecisionModel())>=0?this.setComputationPrecision(t.getPrecisionModel()):this.setComputationPrecision(e.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new UA(0,t,n),this._arg[1]=new UA(1,e,n)}}getArgGeometry(t){return this._arg[t].getGeometry()}setComputationPrecision(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)}}class XA{constructor(){XA.constructor_.apply(this,arguments)}static constructor_(){this._pts=null,this._orientation=null;const t=arguments[0];this._pts=t,this._orientation=XA.orientation(t)}static orientation(t){return 1===rO.increasingDirection(t)}static compareOriented(t,e,n,i){const r=e?1:-1,s=i?1:-1,o=e?t.length:-1,a=i?n.length:-1;let l=e?0:t.length-1,c=i?0:n.length-1;for(;;){const e=t[l].compareTo(n[c]);if(0!==e)return e;l+=r,c+=s;const i=l===o,h=c===a;if(i&&!h)return-1;if(!i&&h)return 1;if(i&&h)return 0}}compareTo(t){const e=t;return XA.compareOriented(this._pts,this._orientation,e._pts,e._orientation)}get interfaces_(){return[nk]}}class VA{constructor(){VA.constructor_.apply(this,arguments)}static constructor_(){this._edges=new Lk,this._ocaMap=new FC}print(t){t.print("MULTILINESTRING ( ");for(let e=0;e<this._edges.size();e++){const n=this._edges.get(e);e>0&&t.print(","),t.print("(");const i=n.getCoordinates();for(let e=0;e<i.length;e++)e>0&&t.print(","),t.print(i[e].x+" "+i[e].y);t.println(")")}t.print(")  ")}addAll(t){for(let e=t.iterator();e.hasNext();)this.add(e.next())}findEdgeIndex(t){for(let e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(t))return e;return-1}iterator(){return this._edges.iterator()}getEdges(){return this._edges}get(t){return this._edges.get(t)}findEqualEdge(t){const e=new XA(t.getCoordinates());return this._ocaMap.get(e)}add(t){this._edges.add(t);const e=new XA(t.getCoordinates());this._ocaMap.put(e,t)}}class HA extends WA{constructor(){super(),HA.constructor_.apply(this,arguments)}static constructor_(){this._ptLocator=new dC,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new VA,this._resultPolyList=new Lk,this._resultLineList=new Lk,this._resultPointList=new Lk;const t=arguments[0],e=arguments[1];WA.constructor_.call(this,t,e),this._graph=new gA(new MA),this._geomFact=t.getFactory()}static overlayOp(t,e,n){return new HA(t,e).getResultGeometry(n)}static union(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return HA.createEmptyResult(HA.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}if(t.isGeometryCollection()||e.isGeometryCollection())throw new tk("This method does not support GeometryCollection arguments");return ZA.overlayOp(t,e,HA.UNION)}static intersection(t,e){if(t.isEmpty()||e.isEmpty())return HA.createEmptyResult(HA.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){const n=e;return eA.map(t,new class{get interfaces_(){return[MapOp]}map(t){return HA.intersection(t,n)}})}return ZA.overlayOp(t,e,HA.INTERSECTION)}static symDifference(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return HA.createEmptyResult(HA.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}if(t.isGeometryCollection()||e.isGeometryCollection())throw new tk("This method does not support GeometryCollection arguments");return ZA.overlayOp(t,e,HA.SYMDIFFERENCE)}static resultDimension(t,e,n){const i=e.getDimension(),r=n.getDimension();let s=-1;switch(t){case HA.INTERSECTION:s=Math.min(i,r);break;case HA.UNION:s=Math.max(i,r);break;case HA.DIFFERENCE:s=i;break;case HA.SYMDIFFERENCE:s=Math.max(i,r)}return s}static createEmptyResult(t,e,n,i){const r=HA.resultDimension(t,e,n);return i.createEmpty(r)}static difference(t,e){if(t.isEmpty())return HA.createEmptyResult(HA.DIFFERENCE,t,e,t.getFactory());if(e.isEmpty())return t.copy();if(t.isGeometryCollection()||e.isGeometryCollection())throw new tk("This method does not support GeometryCollection arguments");return ZA.overlayOp(t,e,HA.DIFFERENCE)}static isResultOfOp(){if(2===arguments.length){const t=arguments[0],e=arguments[1],n=t.getLocation(0),i=t.getLocation(1);return HA.isResultOfOp(n,i,e)}if(3===arguments.length){let t=arguments[0],e=arguments[1],n=arguments[2];switch(t===iC.BOUNDARY&&(t=iC.INTERIOR),e===iC.BOUNDARY&&(e=iC.INTERIOR),n){case HA.INTERSECTION:return t===iC.INTERIOR&&e===iC.INTERIOR;case HA.UNION:return t===iC.INTERIOR||e===iC.INTERIOR;case HA.DIFFERENCE:return t===iC.INTERIOR&&e!==iC.INTERIOR;case HA.SYMDIFFERENCE:return t===iC.INTERIOR&&e!==iC.INTERIOR||t!==iC.INTERIOR&&e===iC.INTERIOR}return!1}}insertUniqueEdge(t){const e=this._edgeList.findEqualEdge(t);if(null!==e){const n=e.getLabel();let i=t.getLabel();e.isPointwiseEqual(t)||(i=new rA(t.getLabel()),i.flip());const r=e.getDepth();r.isNull()&&r.add(n),r.add(i),n.merge(i)}else this._edgeList.add(t)}getGraph(){return this._graph}cancelDuplicateResultEdges(){for(let t=this._graph.getEdgeEnds().iterator();t.hasNext();){const e=t.next(),n=e.getSym();e.isInResult()&&n.isInResult()&&(e.setInResult(!1),n.setInResult(!1))}}isCoveredByLA(t){return!!this.isCovered(t,this._resultLineList)||!!this.isCovered(t,this._resultPolyList)}computeGeometry(t,e,n,i){const r=new Lk;return r.addAll(t),r.addAll(e),r.addAll(n),r.isEmpty()?HA.createEmptyResult(i,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(r)}mergeSymLabels(){for(let t=this._graph.getNodes().iterator();t.hasNext();){t.next().getEdges().mergeSymLabels()}}isCovered(t,e){for(let n=e.iterator();n.hasNext();){const e=n.next();if(this._ptLocator.locate(t,e)!==iC.EXTERIOR)return!0}return!1}replaceCollapsedEdges(){const t=new Lk;for(let e=this._edgeList.iterator();e.hasNext();){const n=e.next();n.isCollapsed()&&(e.remove(),t.add(n.getCollapsedEdge()))}this._edgeList.addAll(t)}updateNodeLabelling(){for(let t=this._graph.getNodes().iterator();t.hasNext();){const e=t.next(),n=e.getEdges().getLabel();e.getLabel().merge(n)}}getResultGeometry(t){return this.computeOverlay(t),this._resultGeom}insertUniqueEdges(t){for(let e=t.iterator();e.hasNext();){const t=e.next();this.insertUniqueEdge(t)}}computeOverlay(t){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);const e=new Lk;this._arg[0].computeSplitEdges(e),this._arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),tA.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();const n=new pA(this._geomFact);n.add(this._graph),this._resultPolyList=n.getPolygons();const i=new _A(this,this._geomFact,this._ptLocator);this._resultLineList=i.build(t);const r=new yA(this,this._geomFact,this._ptLocator);this._resultPointList=r.build(t),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,t)}labelIncompleteNode(t,e){const n=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setLocation(e,n)}copyPoints(t){for(let e=this._arg[t].getNodeIterator();e.hasNext();){const n=e.next();this._graph.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}}findResultAreaEdges(t){for(let e=this._graph.getEdgeEnds().iterator();e.hasNext();){const n=e.next(),i=n.getLabel();i.isArea()&&!n.isInteriorAreaEdge()&&HA.isResultOfOp(i.getLocation(0,nA.RIGHT),i.getLocation(1,nA.RIGHT),t)&&n.setInResult(!0)}}computeLabelsFromDepths(){for(let t=this._edgeList.iterator();t.hasNext();){const e=t.next(),n=e.getLabel(),i=e.getDepth();if(!i.isNull()){i.normalize();for(let t=0;t<2;t++)n.isNull(t)||!n.isArea()||i.isNull(t)||(0===i.getDelta(t)?n.toLine(t):(lk.isTrue(!i.isNull(t,nA.LEFT),"depth of LEFT side has not been initialized"),n.setLocation(t,nA.LEFT,i.getLocation(t,nA.LEFT)),lk.isTrue(!i.isNull(t,nA.RIGHT),"depth of RIGHT side has not been initialized"),n.setLocation(t,nA.RIGHT,i.getLocation(t,nA.RIGHT))))}}}computeLabelling(){for(let t=this._graph.getNodes().iterator();t.hasNext();){t.next().getEdges().computeLabelling(this._arg)}this.mergeSymLabels(),this.updateNodeLabelling()}labelIncompleteNodes(){for(let t=this._graph.getNodes().iterator();t.hasNext();){const e=t.next(),n=e.getLabel();e.isIsolated()&&(n.isNull(0)?this.labelIncompleteNode(e,0):this.labelIncompleteNode(e,1)),e.getEdges().updateLabelling(n)}}isCoveredByA(t){return!!this.isCovered(t,this._resultPolyList)}}HA.INTERSECTION=1,HA.UNION=2,HA.DIFFERENCE=3,HA.SYMDIFFERENCE=4;class JA{constructor(){JA.constructor_.apply(this,arguments)}static constructor_(){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null;const t=arguments[0],e=arguments[1];this._geom[0]=t,this._geom[1]=e,this.computeSnapTolerance()}static overlayOp(t,e,n){return new JA(t,e).getResultGeometry(n)}static union(t,e){return JA.overlayOp(t,e,HA.UNION)}static intersection(t,e){return JA.overlayOp(t,e,HA.INTERSECTION)}static symDifference(t,e){return JA.overlayOp(t,e,HA.SYMDIFFERENCE)}static difference(t,e){return JA.overlayOp(t,e,HA.DIFFERENCE)}selfSnap(t){return new ZO(t).snapTo(t,this._snapTolerance)}removeCommonBits(t){this._cbr=new tC,this._cbr.add(t[0]),this._cbr.add(t[1]);const e=new Array(2).fill(null);return e[0]=this._cbr.removeCommonBits(t[0].copy()),e[1]=this._cbr.removeCommonBits(t[1].copy()),e}prepareResult(t){return this._cbr.addCommonBits(t),t}getResultGeometry(t){const e=this.snap(this._geom),n=HA.overlayOp(e[0],e[1],t);return this.prepareResult(n)}checkValid(t){t.isValid()||iO.out.println("Snapped geometry is invalid")}computeSnapTolerance(){this._snapTolerance=ZO.computeOverlaySnapTolerance(this._geom[0],this._geom[1])}snap(t){const e=this.removeCommonBits(t);return ZO.snap(e[0],e[1],this._snapTolerance)}}class ZA{constructor(){ZA.constructor_.apply(this,arguments)}static constructor_(){this._geom=new Array(2).fill(null);const t=arguments[0],e=arguments[1];this._geom[0]=t,this._geom[1]=e}static overlayOp(t,e,n){return new ZA(t,e).getResultGeometry(n)}static union(t,e){return ZA.overlayOp(t,e,HA.UNION)}static intersection(t,e){return ZA.overlayOp(t,e,HA.INTERSECTION)}static symDifference(t,e){return ZA.overlayOp(t,e,HA.SYMDIFFERENCE)}static difference(t,e){return ZA.overlayOp(t,e,HA.DIFFERENCE)}getResultGeometry(t){let e=null,n=!1,i=null;try{e=HA.overlayOp(this._geom[0],this._geom[1],t);!0&&(n=!0)}catch(t){if(!(t instanceof ok))throw t;i=t}if(!n)try{e=JA.overlayOp(this._geom[0],this._geom[1],t)}catch(t){throw t instanceof ok?i:t}return e}}class QA{constructor(){QA.constructor_.apply(this,arguments)}static constructor_(){if(this._quadrantSegments=QA.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=QA.CAP_ROUND,this._joinStyle=QA.JOIN_ROUND,this._mitreLimit=QA.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=QA.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){const t=arguments[0];this.setQuadrantSegments(t)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.setQuadrantSegments(t),this.setEndCapStyle(e)}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.setQuadrantSegments(t),this.setEndCapStyle(e),this.setJoinStyle(n),this.setMitreLimit(i)}}static bufferDistanceError(t){const e=Math.PI/2/t;return 1-Math.cos(e/2)}getEndCapStyle(){return this._endCapStyle}isSingleSided(){return this._isSingleSided}setQuadrantSegments(t){this._quadrantSegments=t,0===this._quadrantSegments&&(this._joinStyle=QA.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=QA.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==QA.JOIN_ROUND&&(this._quadrantSegments=QA.DEFAULT_QUADRANT_SEGMENTS)}getJoinStyle(){return this._joinStyle}setJoinStyle(t){this._joinStyle=t}setSimplifyFactor(t){this._simplifyFactor=t<0?0:t}getSimplifyFactor(){return this._simplifyFactor}getQuadrantSegments(){return this._quadrantSegments}setEndCapStyle(t){this._endCapStyle=t}getMitreLimit(){return this._mitreLimit}setMitreLimit(t){this._mitreLimit=t}setSingleSided(t){this._isSingleSided=t}}QA.CAP_ROUND=1,QA.CAP_FLAT=2,QA.CAP_SQUARE=3,QA.JOIN_ROUND=1,QA.JOIN_MITRE=2,QA.JOIN_BEVEL=3,QA.DEFAULT_QUADRANT_SEGMENTS=8,QA.DEFAULT_MITRE_LIMIT=5,QA.DEFAULT_SIMPLIFY_FACTOR=.01;class KA extends KI{constructor(t){super(t),this.name=Object.keys({EmptyStackException:KA})[0]}}class tT extends Tk{constructor(){super(),this.array=[]}add(t){return this.array.push(t),!0}get(t){if(t<0||t>=this.size())throw new Ak;return this.array[t]}push(t){return this.array.push(t),t}pop(){if(0===this.array.length)throw new KA;return this.array.pop()}peek(){if(0===this.array.length)throw new KA;return this.array[this.array.length-1]}empty(){return 0===this.array.length}isEmpty(){return this.empty()}search(t){return this.array.indexOf(t)}size(){return this.array.length}toArray(){return this.array.slice()}}class eT{constructor(){eT.constructor_.apply(this,arguments)}static constructor_(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null}getCoordinate(){return this._minCoord}getRightmostSide(t,e){let n=this.getRightmostSideOfSegment(t,e);return n<0&&(n=this.getRightmostSideOfSegment(t,e-1)),n<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),n}findRightmostEdgeAtVertex(){const t=this._minDe.getEdge().getCoordinates();lk.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");const e=t[this._minIndex-1],n=t[this._minIndex+1],i=qk.index(this._minCoord,n,e);let r=!1;(e.y<this._minCoord.y&&n.y<this._minCoord.y&&i===qk.COUNTERCLOCKWISE||e.y>this._minCoord.y&&n.y>this._minCoord.y&&i===qk.CLOCKWISE)&&(r=!0),r&&(this._minIndex=this._minIndex-1)}getRightmostSideOfSegment(t,e){const n=t.getEdge().getCoordinates();if(e<0||e+1>=n.length)return-1;if(n[e].y===n[e+1].y)return-1;let i=nA.LEFT;return n[e].y<n[e+1].y&&(i=nA.RIGHT),i}getEdge(){return this._orientedDe}checkForRightmostCoordinate(t){const e=t.getEdge().getCoordinates();for(let n=0;n<e.length-1;n++)(null===this._minCoord||e[n].x>this._minCoord.x)&&(this._minDe=t,this._minIndex=n,this._minCoord=e[n])}findRightmostEdgeAtNode(){const t=this._minDe.getNode().getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)}findEdge(t){for(let e=t.iterator();e.hasNext();){const t=e.next();t.isForward()&&this.checkForRightmostCoordinate(t)}lk.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe;this.getRightmostSide(this._minDe,this._minIndex)===nA.LEFT&&(this._orientedDe=this._minDe.getSym())}}class nT{constructor(){this.array=[]}addLast(t){this.array.push(t)}removeFirst(){return this.array.shift()}isEmpty(){return 0===this.array.length}}class iT{constructor(){iT.constructor_.apply(this,arguments)}static constructor_(){this._finder=null,this._dirEdgeList=new Lk,this._nodes=new Lk,this._rightMostCoord=null,this._env=null,this._finder=new eT}clearVisitedEdges(){for(let t=this._dirEdgeList.iterator();t.hasNext();){t.next().setVisited(!1)}}getRightmostCoordinate(){return this._rightMostCoord}computeNodeDepth(t){let e=null;for(let n=t.getEdges().iterator();n.hasNext();){const t=n.next();if(t.isVisited()||t.getSym().isVisited()){e=t;break}}if(null===e)throw new JC("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(let e=t.getEdges().iterator();e.hasNext();){const t=e.next();t.setVisited(!0),this.copySymDepths(t)}}computeDepth(t){this.clearVisitedEdges();const e=this._finder.getEdge();e.getNode(),e.getLabel(),e.setEdgeDepths(nA.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)}create(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()}findResultEdges(){for(let t=this._dirEdgeList.iterator();t.hasNext();){const e=t.next();e.getDepth(nA.RIGHT)>=1&&e.getDepth(nA.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}}computeDepths(t){const e=new hO,n=new nT,i=t.getNode();for(n.addLast(i),e.add(i),t.setVisited(!0);!n.isEmpty();){const t=n.removeFirst();e.add(t),this.computeNodeDepth(t);for(let i=t.getEdges().iterator();i.hasNext();){const t=i.next().getSym();if(t.isVisited())continue;const r=t.getNode();e.contains(r)||(n.addLast(r),e.add(r))}}}compareTo(t){const e=t;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0}getEnvelope(){if(null===this._env){const t=new gk;for(let e=this._dirEdgeList.iterator();e.hasNext();){const n=e.next().getEdge().getCoordinates();for(let e=0;e<n.length-1;e++)t.expandToInclude(n[e])}this._env=t}return this._env}addReachable(t){const e=new tT;for(e.add(t);!e.empty();){const t=e.pop();this.add(t,e)}}copySymDepths(t){const e=t.getSym();e.setDepth(nA.LEFT,t.getDepth(nA.RIGHT)),e.setDepth(nA.RIGHT,t.getDepth(nA.LEFT))}add(t,e){t.setVisited(!0),this._nodes.add(t);for(let n=t.getEdges().iterator();n.hasNext();){const t=n.next();this._dirEdgeList.add(t);const i=t.getSym().getNode();i.isVisited()||e.push(i)}}getNodes(){return this._nodes}getDirectedEdges(){return this._dirEdgeList}get interfaces_(){return[nk]}}class rT{constructor(){rT.constructor_.apply(this,arguments)}static constructor_(){this._inputLine=null,this._distanceTol=null,this._isDeleted=null,this._angleOrientation=qk.COUNTERCLOCKWISE;const t=arguments[0];this._inputLine=t}static simplify(t,e){return new rT(t).simplify(e)}isDeletable(t,e,n,i){const r=this._inputLine[t],s=this._inputLine[e],o=this._inputLine[n];return!!this.isConcave(r,s,o)&&(!!this.isShallow(r,s,o,i)&&this.isShallowSampled(r,s,t,n,i))}deleteShallowConcavities(){let t=1,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e),i=!1;for(;n<this._inputLine.length;){let r=!1;this.isDeletable(t,e,n,this._distanceTol)&&(this._isDeleted[e]=rT.DELETE,r=!0,i=!0),t=r?n:e,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e)}return i}isShallowConcavity(t,e,n,i){if(!(qk.index(t,e,n)===this._angleOrientation))return!1;return SO.pointToSegment(e,t,n)<i}isShallowSampled(t,e,n,i,r){let s=Math.trunc((i-n)/rT.NUM_PTS_TO_CHECK);s<=0&&(s=1);for(let o=n;o<i;o+=s)if(!this.isShallow(t,e,this._inputLine[o],r))return!1;return!0}isConcave(t,e,n){return qk.index(t,e,n)===this._angleOrientation}simplify(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=qk.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);let e=!1;do{e=this.deleteShallowConcavities()}while(e);return this.collapseLine()}findNextNonDeletedIndex(t){let e=t+1;for(;e<this._inputLine.length&&this._isDeleted[e]===rT.DELETE;)e++;return e}isShallow(t,e,n,i){return SO.pointToSegment(e,t,n)<i}collapseLine(){const t=new eO;for(let e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==rT.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()}}rT.INIT=0,rT.DELETE=1,rT.KEEP=1,rT.NUM_PTS_TO_CHECK=10;class sT{constructor(){sT.constructor_.apply(this,arguments)}static constructor_(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new Lk}getCoordinates(){return this._ptList.toArray(sT.COORDINATE_ARRAY_TYPE)}setPrecisionModel(t){this._precisionModel=t}addPt(t){const e=new fk(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)}reverse(){}addPts(t,e){if(e)for(let e=0;e<t.length;e++)this.addPt(t[e]);else for(let e=t.length-1;e>=0;e--)this.addPt(t[e])}isRedundant(t){if(this._ptList.size()<1)return!1;const e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance}toString(){return(new _O).createLineString(this.getCoordinates()).toString()}closeRing(){if(this._ptList.size()<1)return null;const t=new fk(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)}setMinimumVertexDistance(t){this._minimimVertexDistance=t}}sT.COORDINATE_ARRAY_TYPE=new Array(0).fill(null);class oT{static toDegrees(t){return 180*t/Math.PI}static normalize(t){for(;t>Math.PI;)t-=oT.PI_TIMES_2;for(;t<=-Math.PI;)t+=oT.PI_TIMES_2;return t}static angle(){if(1===arguments.length){const t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){const t=arguments[0],e=arguments[1],n=e.x-t.x,i=e.y-t.y;return Math.atan2(i,n)}}static isAcute(t,e,n){const i=t.x-e.x,r=t.y-e.y;return i*(n.x-e.x)+r*(n.y-e.y)>0}static isObtuse(t,e,n){const i=t.x-e.x,r=t.y-e.y;return i*(n.x-e.x)+r*(n.y-e.y)<0}static interiorAngle(t,e,n){const i=oT.angle(e,t),r=oT.angle(e,n);return Math.abs(r-i)}static normalizePositive(t){if(t<0){for(;t<0;)t+=oT.PI_TIMES_2;t>=oT.PI_TIMES_2&&(t=0)}else{for(;t>=oT.PI_TIMES_2;)t-=oT.PI_TIMES_2;t<0&&(t=0)}return t}static angleBetween(t,e,n){const i=oT.angle(e,t),r=oT.angle(e,n);return oT.diff(i,r)}static diff(t,e){let n=null;return n=t<e?e-t:t-e,n>Math.PI&&(n=2*Math.PI-n),n}static toRadians(t){return t*Math.PI/180}static getTurn(t,e){const n=Math.sin(e-t);return n>0?oT.COUNTERCLOCKWISE:n<0?oT.CLOCKWISE:oT.NONE}static angleBetweenOriented(t,e,n){const i=oT.angle(e,t),r=oT.angle(e,n)-i;return r<=-Math.PI?r+oT.PI_TIMES_2:r>Math.PI?r-oT.PI_TIMES_2:r}}oT.PI_TIMES_2=2*Math.PI,oT.PI_OVER_2=Math.PI/2,oT.PI_OVER_4=Math.PI/4,oT.COUNTERCLOCKWISE=qk.COUNTERCLOCKWISE,oT.CLOCKWISE=qk.CLOCKWISE,oT.NONE=qk.COLLINEAR;class aT{constructor(){aT.constructor_.apply(this,arguments)}static constructor_(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new HO,this._seg1=new HO,this._offset0=new HO,this._offset1=new HO,this._side=0,this._hasNarrowConcaveAngle=!1;const t=arguments[0],e=arguments[1],n=arguments[2];this._precisionModel=t,this._bufParams=e,this._li=new VO,this._filletAngleQuantum=Math.PI/2/e.getQuadrantSegments(),e.getQuadrantSegments()>=8&&e.getJoinStyle()===QA.JOIN_ROUND&&(this._closingSegLengthFactor=aT.MAX_CLOSING_SEG_LEN_FACTOR),this.init(n)}addNextSegment(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;const n=qk.index(this._s0,this._s1,this._s2),i=n===qk.CLOCKWISE&&this._side===nA.LEFT||n===qk.COUNTERCLOCKWISE&&this._side===nA.RIGHT;0===n?this.addCollinear(e):i?this.addOutsideTurn(n,e):this.addInsideTurn(n,e)}addLineEndCap(t,e){const n=new HO(t,e),i=new HO;this.computeOffsetSegment(n,nA.LEFT,this._distance,i);const r=new HO;this.computeOffsetSegment(n,nA.RIGHT,this._distance,r);const s=e.x-t.x,o=e.y-t.y,a=Math.atan2(o,s);switch(this._bufParams.getEndCapStyle()){case QA.CAP_ROUND:this._segList.addPt(i.p1),this.addDirectedFillet(e,a+Math.PI/2,a-Math.PI/2,qk.CLOCKWISE,this._distance),this._segList.addPt(r.p1);break;case QA.CAP_FLAT:this._segList.addPt(i.p1),this._segList.addPt(r.p1);break;case QA.CAP_SQUARE:const t=new fk;t.x=Math.abs(this._distance)*Math.cos(a),t.y=Math.abs(this._distance)*Math.sin(a);const n=new fk(i.p1.x+t.x,i.p1.y+t.y),s=new fk(r.p1.x+t.x,r.p1.y+t.y);this._segList.addPt(n),this._segList.addPt(s)}}getCoordinates(){return this._segList.getCoordinates()}addMitreJoin(t,e,n,i){const r=EO.intersection(e.p0,e.p1,n.p0,n.p1);if(null!==r){if((i<=0?1:r.distance(t)/Math.abs(i))<=this._bufParams.getMitreLimit())return this._segList.addPt(r),null}this.addLimitedMitreJoin(e,n,i,this._bufParams.getMitreLimit())}addOutsideTurn(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*aT.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===QA.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===QA.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))}createSquare(t){this._segList.addPt(new fk(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new fk(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new fk(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new fk(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()}addSegments(t,e){this._segList.addPts(t,e)}addFirstSegment(){this._segList.addPt(this._offset1.p0)}addCornerFillet(t,e,n,i,r){const s=e.x-t.x,o=e.y-t.y;let a=Math.atan2(o,s);const l=n.x-t.x,c=n.y-t.y,h=Math.atan2(c,l);i===qk.CLOCKWISE?a<=h&&(a+=2*Math.PI):a>=h&&(a-=2*Math.PI),this._segList.addPt(e),this.addDirectedFillet(t,a,h,i,r),this._segList.addPt(n)}addLastSegment(){this._segList.addPt(this._offset1.p1)}initSideSegments(t,e,n){this._s1=t,this._s2=e,this._side=n,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,n,this._distance,this._offset1)}addLimitedMitreJoin(t,e,n,i){const r=this._seg0.p1,s=oT.angle(r,this._seg0.p0),o=oT.angleBetweenOriented(this._seg0.p0,r,this._seg1.p1)/2,a=oT.normalize(s+o),l=oT.normalize(a+Math.PI),c=i*n,h=n-c*Math.abs(Math.sin(o)),u=r.x+c*Math.cos(l),f=r.y+c*Math.sin(l),d=new fk(u,f),g=new HO(r,d),p=g.pointAlongOffset(1,h),_=g.pointAlongOffset(1,-h);this._side===nA.LEFT?(this._segList.addPt(p),this._segList.addPt(_)):(this._segList.addPt(_),this._segList.addPt(p))}addDirectedFillet(t,e,n,i,r){const s=i===qk.CLOCKWISE?-1:1,o=Math.abs(e-n),a=Math.trunc(o/this._filletAngleQuantum+.5);if(a<1)return null;const l=o/a,c=new fk;for(let n=0;n<a;n++){const i=e+s*n*l;c.x=t.x+r*Math.cos(i),c.y=t.y+r*Math.sin(i),this._segList.addPt(c)}}computeOffsetSegment(t,e,n,i){const r=e===nA.LEFT?1:-1,s=t.p1.x-t.p0.x,o=t.p1.y-t.p0.y,a=Math.sqrt(s*s+o*o),l=r*n*s/a,c=r*n*o/a;i.p0.x=t.p0.x-c,i.p0.y=t.p0.y+l,i.p1.x=t.p1.x-c,i.p1.y=t.p1.y+l}addInsideTurn(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*aT.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){const t=new fk((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(t);const e=new fk((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(e)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}}createCircle(t){const e=new fk(t.x+this._distance,t.y);this._segList.addPt(e),this.addDirectedFillet(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()}addBevelJoin(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)}init(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new sT,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*aT.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)}addCollinear(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2);this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===QA.JOIN_BEVEL||this._bufParams.getJoinStyle()===QA.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,qk.CLOCKWISE,this._distance))}closeRing(){this._segList.closeRing()}hasNarrowConcaveAngle(){return this._hasNarrowConcaveAngle}}aT.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,aT.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,aT.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,aT.MAX_CLOSING_SEG_LEN_FACTOR=80;class lT{constructor(){lT.constructor_.apply(this,arguments)}static constructor_(){this._distance=0,this._precisionModel=null,this._bufParams=null;const t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e}static copyCoordinates(t){const e=new Array(t.length).fill(null);for(let n=0;n<e.length;n++)e[n]=new fk(t[n]);return e}getOffsetCurve(t,e){if(this._distance=e,0===e)return null;const n=e<0,i=Math.abs(e),r=this.getSegGen(i);t.length<=1?this.computePointCurve(t[0],r):this.computeOffsetCurve(t,n,r);const s=r.getCoordinates();return n&&rO.reverse(s),s}computeSingleSidedBufferCurve(t,e,n){const i=this.simplifyTolerance(this._distance);if(e){n.addSegments(t,!0);const e=rT.simplify(t,-i),r=e.length-1;n.initSideSegments(e[r],e[r-1],nA.LEFT),n.addFirstSegment();for(let t=r-2;t>=0;t--)n.addNextSegment(e[t],!0)}else{n.addSegments(t,!1);const e=rT.simplify(t,i),r=e.length-1;n.initSideSegments(e[0],e[1],nA.LEFT),n.addFirstSegment();for(let t=2;t<=r;t++)n.addNextSegment(e[t],!0)}n.addLastSegment(),n.closeRing()}computeRingBufferCurve(t,e,n){let i=this.simplifyTolerance(this._distance);e===nA.RIGHT&&(i=-i);const r=rT.simplify(t,i),s=r.length-1;n.initSideSegments(r[s-1],r[0],e);for(let t=1;t<=s;t++){const e=1!==t;n.addNextSegment(r[t],e)}n.closeRing()}computeLineBufferCurve(t,e){const n=this.simplifyTolerance(this._distance),i=rT.simplify(t,n),r=i.length-1;e.initSideSegments(i[0],i[1],nA.LEFT);for(let t=2;t<=r;t++)e.addNextSegment(i[t],!0);e.addLastSegment(),e.addLineEndCap(i[r-1],i[r]);const s=rT.simplify(t,-n),o=s.length-1;e.initSideSegments(s[o],s[o-1],nA.LEFT);for(let t=o-2;t>=0;t--)e.addNextSegment(s[t],!0);e.addLastSegment(),e.addLineEndCap(s[1],s[0]),e.closeRing()}computePointCurve(t,e){switch(this._bufParams.getEndCapStyle()){case QA.CAP_ROUND:e.createCircle(t);break;case QA.CAP_SQUARE:e.createSquare(t)}}getLineCurve(t,e){if(this._distance=e,this.isLineOffsetEmpty(e))return null;const n=Math.abs(e),i=this.getSegGen(n);if(t.length<=1)this.computePointCurve(t[0],i);else if(this._bufParams.isSingleSided()){const n=e<0;this.computeSingleSidedBufferCurve(t,n,i)}else this.computeLineBufferCurve(t,i);return i.getCoordinates()}getBufferParameters(){return this._bufParams}simplifyTolerance(t){return t*this._bufParams.getSimplifyFactor()}getRingCurve(t,e,n){if(this._distance=n,t.length<=2)return this.getLineCurve(t,n);if(0===n)return lT.copyCoordinates(t);const i=this.getSegGen(n);return this.computeRingBufferCurve(t,e,i),i.getCoordinates()}computeOffsetCurve(t,e,n){const i=this.simplifyTolerance(this._distance);if(e){const e=rT.simplify(t,-i),r=e.length-1;n.initSideSegments(e[r],e[r-1],nA.LEFT),n.addFirstSegment();for(let t=r-2;t>=0;t--)n.addNextSegment(e[t],!0)}else{const e=rT.simplify(t,i),r=e.length-1;n.initSideSegments(e[0],e[1],nA.LEFT),n.addFirstSegment();for(let t=2;t<=r;t++)n.addNextSegment(e[t],!0)}n.addLastSegment()}isLineOffsetEmpty(t){return 0===t||t<0&&!this._bufParams.isSingleSided()}getSegGen(t){return new aT(this._precisionModel,this._bufParams,t)}}class cT{constructor(){cT.constructor_.apply(this,arguments)}static constructor_(){this._subgraphs=null,this._seg=new HO;const t=arguments[0];this._subgraphs=t}findStabbedSegments(){if(1===arguments.length){const t=arguments[0],e=new Lk;for(let n=this._subgraphs.iterator();n.hasNext();){const i=n.next(),r=i.getEnvelope();t.y<r.getMinY()||t.y>r.getMaxY()||this.findStabbedSegments(t,i.getDirectedEdges(),e)}return e}if(3===arguments.length)if(XI(arguments[2],Tk)&&arguments[0]instanceof fk&&arguments[1]instanceof fA){const t=arguments[0],e=arguments[1],n=arguments[2],i=e.getEdge().getCoordinates();for(let r=0;r<i.length-1;r++){this._seg.p0=i[r],this._seg.p1=i[r+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse();if(Math.max(this._seg.p0.x,this._seg.p1.x)<t.x)continue;if(this._seg.isHorizontal())continue;if(t.y<this._seg.p0.y||t.y>this._seg.p1.y)continue;if(qk.index(this._seg.p0,this._seg.p1,t)===qk.RIGHT)continue;let s=e.getDepth(nA.LEFT);this._seg.p0.equals(i[r])||(s=e.getDepth(nA.RIGHT));const o=new hT(this._seg,s);n.add(o)}}else if(XI(arguments[2],Tk)&&arguments[0]instanceof fk&&XI(arguments[1],Tk)){const t=arguments[0],e=arguments[2];for(let n=arguments[1].iterator();n.hasNext();){const i=n.next();i.isForward()&&this.findStabbedSegments(t,i,e)}}}getDepth(t){const e=this.findStabbedSegments(t);if(0===e.size())return 0;return MC.min(e)._leftDepth}}class hT{constructor(){hT.constructor_.apply(this,arguments)}static constructor_(){this._upwardSeg=null,this._leftDepth=null;const t=arguments[0],e=arguments[1];this._upwardSeg=new HO(t),this._leftDepth=e}compareTo(t){const e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;let n=this._upwardSeg.orientationIndex(e._upwardSeg);return 0!==n?n:(n=-1*e._upwardSeg.orientationIndex(this._upwardSeg),0!==n?n:this._upwardSeg.compareTo(e._upwardSeg))}compareX(t,e){const n=t.p0.compareTo(e.p0);return 0!==n?n:t.p1.compareTo(e.p1)}toString(){return this._upwardSeg.toString()}get interfaces_(){return[nk]}}cT.DepthSegment=hT;class uT extends KI{constructor(){super(),uT.constructor_.apply(this,arguments)}static constructor_(){KI.constructor_.call(this,"Projective point not representable on the Cartesian plane.")}}class fT{constructor(){fT.constructor_.apply(this,arguments)}static constructor_(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){const t=arguments[0];this.x=t.x,this.y=t.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1];this.x=t,this.y=e,this.w=1}else if(arguments[0]instanceof fT&&arguments[1]instanceof fT){const t=arguments[0],e=arguments[1];this.x=t.y*e.w-e.y*t.w,this.y=e.x*t.w-t.x*e.w,this.w=t.x*e.y-e.x*t.y}else if(arguments[0]instanceof fk&&arguments[1]instanceof fk){const t=arguments[0],e=arguments[1];this.x=t.y-e.y,this.y=e.x-t.x,this.w=t.x*e.y-e.x*t.y}}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this.x=t,this.y=e,this.w=n}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=t.y-e.y,s=e.x-t.x,o=t.x*e.y-e.x*t.y,a=n.y-i.y,l=i.x-n.x,c=n.x*i.y-i.x*n.y;this.x=s*c-l*o,this.y=a*o-r*c,this.w=r*l-a*s}}getY(){const t=this.y/this.w;if(HI.isNaN(t)||HI.isInfinite(t))throw new uT;return t}getX(){const t=this.x/this.w;if(HI.isNaN(t)||HI.isInfinite(t))throw new uT;return t}getCoordinate(){const t=new fk;return t.x=this.getX(),t.y=this.getY(),t}}class dT{constructor(){dT.constructor_.apply(this,arguments)}static constructor_(){this.p0=null,this.p1=null,this.p2=null;const t=arguments[0],e=arguments[1],n=arguments[2];this.p0=t,this.p1=e,this.p2=n}static area(t,e,n){return Math.abs(((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2)}static signedArea(t,e,n){return((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2}static det(t,e,n,i){return t*i-e*n}static interpolateZ(t,e,n,i){const r=e.x,s=e.y,o=n.x-r,a=i.x-r,l=n.y-s,c=i.y-s,h=o*c-a*l,u=t.x-r,f=t.y-s,d=(c*u-a*f)/h,g=(-l*u+o*f)/h;return e.getZ()+d*(n.getZ()-e.getZ())+g*(i.getZ()-e.getZ())}static longestSideLength(t,e,n){const i=t.distance(e),r=e.distance(n),s=n.distance(t);let o=i;return r>o&&(o=r),s>o&&(o=s),o}static circumcentreDD(t,e,n){const i=Gk.valueOf(t.x).subtract(n.x),r=Gk.valueOf(t.y).subtract(n.y),s=Gk.valueOf(e.x).subtract(n.x),o=Gk.valueOf(e.y).subtract(n.y),a=Gk.determinant(i,r,s,o).multiply(2),l=i.sqr().add(r.sqr()),c=s.sqr().add(o.sqr()),h=Gk.determinant(r,l,o,c),u=Gk.determinant(i,l,s,c),f=Gk.valueOf(n.x).subtract(h.divide(a)).doubleValue(),d=Gk.valueOf(n.y).add(u.divide(a)).doubleValue();return new fk(f,d)}static isAcute(t,e,n){return!!oT.isAcute(t,e,n)&&(!!oT.isAcute(e,n,t)&&!!oT.isAcute(n,t,e))}static circumcentre(t,e,n){const i=n.x,r=n.y,s=t.x-i,o=t.y-r,a=e.x-i,l=e.y-r,c=2*dT.det(s,o,a,l),h=dT.det(o,s*s+o*o,l,a*a+l*l),u=dT.det(s,s*s+o*o,a,a*a+l*l);return new fk(i-h/c,r+u/c)}static perpendicularBisector(t,e){const n=e.x-t.x,i=e.y-t.y,r=new fT(t.x+n/2,t.y+i/2,1),s=new fT(t.x-i+n/2,t.y+n+i/2,1);return new fT(r,s)}static angleBisector(t,e,n){const i=e.distance(t),r=i/(i+e.distance(n)),s=n.x-t.x,o=n.y-t.y;return new fk(t.x+r*s,t.y+r*o)}static area3D(t,e,n){const i=e.x-t.x,r=e.y-t.y,s=e.getZ()-t.getZ(),o=n.x-t.x,a=n.y-t.y,l=n.getZ()-t.getZ(),c=r*l-s*a,h=s*o-i*l,u=i*a-r*o,f=c*c+h*h+u*u;return Math.sqrt(f)/2}static centroid(t,e,n){const i=(t.x+e.x+n.x)/3,r=(t.y+e.y+n.y)/3;return new fk(i,r)}static inCentre(t,e,n){const i=e.distance(n),r=t.distance(n),s=t.distance(e),o=i+r+s,a=(i*t.x+r*e.x+s*n.x)/o,l=(i*t.y+r*e.y+s*n.y)/o;return new fk(a,l)}area(){return dT.area(this.p0,this.p1,this.p2)}signedArea(){return dT.signedArea(this.p0,this.p1,this.p2)}interpolateZ(t){if(null===t)throw new tk("Supplied point is null.");return dT.interpolateZ(t,this.p0,this.p1,this.p2)}longestSideLength(){return dT.longestSideLength(this.p0,this.p1,this.p2)}isAcute(){return dT.isAcute(this.p0,this.p1,this.p2)}circumcentre(){return dT.circumcentre(this.p0,this.p1,this.p2)}area3D(){return dT.area3D(this.p0,this.p1,this.p2)}centroid(){return dT.centroid(this.p0,this.p1,this.p2)}inCentre(){return dT.inCentre(this.p0,this.p1,this.p2)}}class gT{constructor(){gT.constructor_.apply(this,arguments)}static constructor_(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new Lk;const t=arguments[0],e=arguments[1],n=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=n}addRingSide(t,e,n,i,r){if(0===e&&t.length<Jk.MINIMUM_VALID_SIZE)return null;let s=i,o=r;t.length>=Jk.MINIMUM_VALID_SIZE&&qk.isCCW(t)&&(s=r,o=i,n=nA.opposite(n));const a=this._curveBuilder.getRingCurve(t,n,e);this.addCurve(a,s,o)}addRingBothSides(t,e){this.addRingSide(t,e,nA.LEFT,iC.EXTERIOR,iC.INTERIOR),this.addRingSide(t,e,nA.RIGHT,iC.INTERIOR,iC.EXTERIOR)}addPoint(t){if(this._distance<=0)return null;const e=t.getCoordinates(),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,iC.EXTERIOR,iC.INTERIOR)}addPolygon(t){let e=this._distance,n=nA.LEFT;this._distance<0&&(e=-this._distance,n=nA.RIGHT);const i=t.getExteriorRing(),r=rO.removeRepeatedPoints(i.getCoordinates());if(this._distance<0&&this.isErodedCompletely(i,this._distance))return null;if(this._distance<=0&&r.length<3)return null;this.addRingSide(r,e,n,iC.EXTERIOR,iC.INTERIOR);for(let i=0;i<t.getNumInteriorRing();i++){const r=t.getInteriorRingN(i),s=rO.removeRepeatedPoints(r.getCoordinates());this._distance>0&&this.isErodedCompletely(r,-this._distance)||this.addRingSide(s,e,nA.opposite(n),iC.INTERIOR,iC.EXTERIOR)}}isTriangleErodedCompletely(t,e){const n=new dT(t[0],t[1],t[2]),i=n.inCentre();return SO.pointToSegment(i,n.p0,n.p1)<Math.abs(e)}addLineString(t){if(this._curveBuilder.isLineOffsetEmpty(this._distance))return null;const e=rO.removeRepeatedPoints(t.getCoordinates());if(rO.isRing(e)&&!this._curveBuilder.getBufferParameters().isSingleSided())this.addRingBothSides(e,this._distance);else{const t=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(t,iC.EXTERIOR,iC.INTERIOR)}}addCurve(t,e,n){if(null===t||t.length<2)return null;const i=new qC(t,new rA(0,iC.BOUNDARY,e,n));this._curveList.add(i)}getCurves(){return this.add(this._inputGeom),this._curveList}add(t){if(t.isEmpty())return null;if(t instanceof Yk)this.addPolygon(t);else if(t instanceof Sk)this.addLineString(t);else if(t instanceof kk)this.addPoint(t);else if(t instanceof Hk)this.addCollection(t);else if(t instanceof pO)this.addCollection(t);else if(t instanceof lO)this.addCollection(t);else{if(!(t instanceof Vk))throw new vk(t.getGeometryType());this.addCollection(t)}}isErodedCompletely(t,e){const n=t.getCoordinates();if(n.length<4)return e<0;if(4===n.length)return this.isTriangleErodedCompletely(n,e);const i=t.getEnvelopeInternal(),r=Math.min(i.getHeight(),i.getWidth());return e<0&&2*Math.abs(e)>r}addCollection(t){for(let e=0;e<t.getNumGeometries();e++){const n=t.getGeometryN(e);this.add(n)}}}class pT{constructor(){pT.constructor_.apply(this,arguments)}static constructor_(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;const t=arguments[0];this._li=t}static isAdjacentSegments(t,e){return 1===Math.abs(t-e)}isTrivialIntersection(t,e,n,i){if(t===n&&1===this._li.getIntersectionNum()){if(pT.isAdjacentSegments(e,i))return!0;if(t.isClosed()){const n=t.size()-1;if(0===e&&i===n||0===i&&e===n)return!0}}return!1}getProperIntersectionPoint(){return this._properIntersectionPoint}hasProperInteriorIntersection(){return this._hasProperInterior}getLineIntersector(){return this._li}hasProperIntersection(){return this._hasProper}processIntersections(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;const r=t.getCoordinates()[e],s=t.getCoordinates()[e+1],o=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,s,o,a),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))}hasIntersection(){return this._hasIntersection}isDone(){return!1}hasInteriorIntersection(){return this._hasInterior}get interfaces_(){return[ZC]}}class _T{constructor(){_T.constructor_.apply(this,arguments)}static constructor_(){this._bufParams=null,this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new VA;const t=arguments[0];this._bufParams=t}static depthDelta(t){const e=t.getLocation(0,nA.LEFT),n=t.getLocation(0,nA.RIGHT);return e===iC.INTERIOR&&n===iC.EXTERIOR?1:e===iC.EXTERIOR&&n===iC.INTERIOR?-1:0}static convertSegStrings(t){const e=new _O,n=new Lk;for(;t.hasNext();){const i=t.next(),r=e.createLineString(i.getCoordinates());n.add(r)}return e.buildGeometry(n)}setWorkingPrecisionModel(t){this._workingPrecisionModel=t}insertUniqueEdge(t){const e=this._edgeList.findEqualEdge(t);if(null!==e){const n=e.getLabel();let i=t.getLabel();e.isPointwiseEqual(t)||(i=new rA(t.getLabel()),i.flip()),n.merge(i);const r=_T.depthDelta(i),s=e.getDepthDelta()+r;e.setDepthDelta(s)}else this._edgeList.add(t),t.setDepthDelta(_T.depthDelta(t.getLabel()))}buildSubgraphs(t,e){const n=new Lk;for(let i=t.iterator();i.hasNext();){const t=i.next(),r=t.getRightmostCoordinate(),s=new cT(n).getDepth(r);t.computeDepth(s),t.findResultEdges(),n.add(t),e.add(t.getDirectedEdges(),t.getNodes())}}createSubgraphs(t){const e=new Lk;for(let n=t.getNodes().iterator();n.hasNext();){const t=n.next();if(!t.isVisited()){const n=new iT;n.create(t),e.add(n)}}return MC.sort(e,MC.reverseOrder()),e}createEmptyResultGeometry(){return this._geomFact.createPolygon()}getNoder(t){if(null!==this._workingNoder)return this._workingNoder;const e=new VC,n=new VO;return n.setPrecisionModel(t),e.setSegmentIntersector(new pT(n)),e}buffer(t,e){let n=this._workingPrecisionModel;null===n&&(n=t.getPrecisionModel()),this._geomFact=t.getFactory();const i=new lT(n,this._bufParams),r=new gT(t,e,i).getCurves();if(r.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(r,n),this._graph=new gA(new MA),this._graph.addEdges(this._edgeList.getEdges());const s=this.createSubgraphs(this._graph),o=new pA(this._geomFact);this.buildSubgraphs(s,o);const a=o.getPolygons();if(a.size()<=0)return this.createEmptyResultGeometry();return this._geomFact.buildGeometry(a)}computeNodedEdges(t,e){const n=this.getNoder(e);n.computeNodes(t);for(let t=n.getNodedSubstrings().iterator();t.hasNext();){const e=t.next(),n=e.getCoordinates();if(2===n.length&&n[0].equals2D(n[1]))continue;const i=e.getData(),r=new $A(e.getCoordinates(),new rA(i));this.insertUniqueEdge(r)}}setNoder(t){this._workingNoder=t}}class yT{constructor(){yT.constructor_.apply(this,arguments)}static constructor_(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){const t=arguments[0],e=arguments[1];yT.constructor_.call(this,t,e,0,0)}else if(4===arguments.length){const t=arguments[0],e=arguments[1];this._noder=t,this._scaleFactor=e,this._isScaled=!this.isIntegerPrecision()}}rescale(){if(XI(arguments[0],Ck)){for(let t=arguments[0].iterator();t.hasNext();){const e=t.next();this.rescale(e.getCoordinates())}}else if(arguments[0]instanceof Array){const t=arguments[0];for(let e=0;e<t.length;e++)t[e].x=t[e].x/this._scaleFactor+this._offsetX,t[e].y=t[e].y/this._scaleFactor+this._offsetY;2===t.length&&t[0].equals2D(t[1])&&iO.out.println(t)}}scale(){if(XI(arguments[0],Ck)){const t=arguments[0],e=new Lk(t.size());for(let n=t.iterator();n.hasNext();){const t=n.next();e.add(new qC(this.scale(t.getCoordinates()),t.getData()))}return e}if(arguments[0]instanceof Array){const t=arguments[0],e=new Array(t.length).fill(null);for(let n=0;n<t.length;n++)e[n]=new fk(Math.round((t[n].x-this._offsetX)*this._scaleFactor),Math.round((t[n].y-this._offsetY)*this._scaleFactor),t[n].getZ());return rO.removeRepeatedPoints(e)}}isIntegerPrecision(){return 1===this._scaleFactor}getNodedSubstrings(){const t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t}computeNodes(t){let e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)}get interfaces_(){return[WC]}}class mT{constructor(){mT.constructor_.apply(this,arguments)}static constructor_(){this._li=new VO,this._segStrings=null;const t=arguments[0];this._segStrings=t}checkEndPtVertexIntersections(){if(0===arguments.length)for(let t=this._segStrings.iterator();t.hasNext();){const e=t.next().getCoordinates();this.checkEndPtVertexIntersections(e[0],this._segStrings),this.checkEndPtVertexIntersections(e[e.length-1],this._segStrings)}else if(2===arguments.length){const t=arguments[0];for(let e=arguments[1].iterator();e.hasNext();){const n=e.next().getCoordinates();for(let e=1;e<n.length-1;e++)if(n[e].equals(t))throw new ok("found endpt/interior pt intersection at index "+e+" :pt "+t)}}}checkInteriorIntersections(){if(0===arguments.length)for(let t=this._segStrings.iterator();t.hasNext();){const e=t.next();for(let t=this._segStrings.iterator();t.hasNext();){const n=t.next();this.checkInteriorIntersections(e,n)}}else if(2===arguments.length){const t=arguments[0],e=arguments[1],n=t.getCoordinates(),i=e.getCoordinates();for(let r=0;r<n.length-1;r++)for(let n=0;n<i.length-1;n++)this.checkInteriorIntersections(t,r,e,n)}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];if(t===n&&e===i)return null;const r=t.getCoordinates()[e],s=t.getCoordinates()[e+1],o=n.getCoordinates()[i],a=n.getCoordinates()[i+1];if(this._li.computeIntersection(r,s,o,a),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,r,s)||this.hasInteriorIntersection(this._li,o,a)))throw new ok("found non-noded intersection at "+r+"-"+s+" and "+o+"-"+a)}}checkValid(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()}checkCollapses(){if(0===arguments.length)for(let t=this._segStrings.iterator();t.hasNext();){const e=t.next();this.checkCollapses(e)}else if(1===arguments.length){const t=arguments[0].getCoordinates();for(let e=0;e<t.length-2;e++)this.checkCollapse(t[e],t[e+1],t[e+2])}}hasInteriorIntersection(t,e,n){for(let i=0;i<t.getIntersectionNum();i++){const r=t.getIntersection(i);if(!r.equals(e)&&!r.equals(n))return!0}return!1}checkCollapse(t,e,n){if(t.equals(n))throw new ok("found non-noded collapse at "+mT.fact.createLineString([t,e,n]))}}mT.fact=new _O;class xT{constructor(){xT.constructor_.apply(this,arguments)}static constructor_(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;const t=arguments[0],e=arguments[1],n=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=n,e<=0)throw new tk("Scale factor must be non-zero");1!==e&&(this._pt=new fk(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new fk,this._p1Scaled=new fk),this.initCorners(this._pt)}intersectsScaled(t,e){const n=Math.min(t.x,e.x),i=Math.max(t.x,e.x),r=Math.min(t.y,e.y),s=Math.max(t.y,e.y),o=this._maxx<n||this._minx>i||this._maxy<r||this._miny>s;if(o)return!1;const a=this.intersectsToleranceSquare(t,e);return lk.isTrue(!(o&&a),"Found bad envelope test"),a}initCorners(t){const e=.5;this._minx=t.x-e,this._maxx=t.x+e,this._miny=t.y-e,this._maxy=t.y+e,this._corner[0]=new fk(this._maxx,this._maxy),this._corner[1]=new fk(this._minx,this._maxy),this._corner[2]=new fk(this._minx,this._miny),this._corner[3]=new fk(this._maxx,this._miny)}intersects(t,e){return 1===this._scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))}scale(t){return Math.round(t*this._scaleFactor)}getCoordinate(){return this._originalPt}copyScaled(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)}getSafeEnvelope(){if(null===this._safeEnv){const t=xT.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new gk(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv}intersectsPixelClosure(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))}intersectsToleranceSquare(t,e){let n=!1,i=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(i=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),!!this._li.isProper()||(!(!n||!i)||(!!t.equals(this._pt)||!!e.equals(this._pt))))))}addSnappedNode(t,e){const n=t.getCoordinate(e),i=t.getCoordinate(e+1);return!!this.intersects(n,i)&&(t.addIntersection(this.getCoordinate(),e),!0)}}xT.SAFE_ENV_EXPANSION_FACTOR=.75;class vT{constructor(){vT.constructor_.apply(this,arguments)}static constructor_(){this.selectedSegment=new HO}select(){if(1===arguments.length);else if(2===arguments.length){const t=arguments[1];arguments[0].getLineSegment(t,this.selectedSegment),this.select(this.selectedSegment)}}}class bT{constructor(){bT.constructor_.apply(this,arguments)}static constructor_(){this._index=null;const t=arguments[0];this._index=t}snap(){if(1===arguments.length){const t=arguments[0];return this.snap(t,null,-1)}if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=t.getSafeEnvelope(),r=new MT(t,e,n);return this._index.query(i,new class{get interfaces_(){return[SC]}visitItem(t){t.select(i,r)}}),r.isNodeAdded()}}}class MT extends vT{constructor(){super(),MT.constructor_.apply(this,arguments)}static constructor_(){this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;const t=arguments[0],e=arguments[1],n=arguments[2];this._hotPixel=t,this._parentEdge=e,this._hotPixelVertexIndex=n}isNodeAdded(){return this._isNodeAdded}select(){if(!(2===arguments.length&&Number.isInteger(arguments[1])&&arguments[0]instanceof YC))return super.select.apply(this,arguments);{const t=arguments[1],e=arguments[0].getContext();if(this._parentEdge===e&&(t===this._hotPixelVertexIndex||t+1===this._hotPixelVertexIndex))return null;this._isNodeAdded|=this._hotPixel.addSnappedNode(e,t)}}}bT.HotPixelSnapAction=MT;class wT{constructor(){wT.constructor_.apply(this,arguments)}static constructor_(){this._li=null,this._interiorIntersections=null;const t=arguments[0];this._li=t,this._interiorIntersections=new Lk}processIntersections(t,e,n,i){if(t===n&&e===i)return null;const r=t.getCoordinates()[e],s=t.getCoordinates()[e+1],o=n.getCoordinates()[i],a=n.getCoordinates()[i+1];if(this._li.computeIntersection(r,s,o,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(let t=0;t<this._li.getIntersectionNum();t++)this._interiorIntersections.add(this._li.getIntersection(t));t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1)}}isDone(){return!1}getInteriorIntersections(){return this._interiorIntersections}get interfaces_(){return[ZC]}}class ET{constructor(){ET.constructor_.apply(this,arguments)}static constructor_(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;const t=arguments[0];this._pm=t,this._li=new VO,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()}checkCorrectness(t){const e=qC.getNodedSubstrings(t),n=new mT(e);try{n.checkValid()}catch(t){if(!(t instanceof KI))throw t;t.printStackTrace()}}getNodedSubstrings(){return qC.getNodedSubstrings(this._nodedSegStrings)}snapRound(t,e){const n=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(n),this.computeVertexSnaps(t)}findInteriorIntersections(t,e){const n=new wT(e);return this._noder.setSegmentIntersector(n),this._noder.computeNodes(t),n.getInteriorIntersections()}computeVertexSnaps(){if(XI(arguments[0],Ck)){for(let t=arguments[0].iterator();t.hasNext();){const e=t.next();this.computeVertexSnaps(e)}}else if(arguments[0]instanceof qC){const t=arguments[0],e=t.getCoordinates();for(let n=0;n<e.length;n++){const i=new xT(e[n],this._scaleFactor,this._li);this._pointSnapper.snap(i,t,n)&&t.addIntersection(e[n],n)}}}computeNodes(t){this._nodedSegStrings=t,this._noder=new VC,this._pointSnapper=new bT(this._noder.getIndex()),this.snapRound(t,this._li)}computeIntersectionSnaps(t){for(let e=t.iterator();e.hasNext();){const t=e.next(),n=new xT(t,this._scaleFactor,this._li);this._pointSnapper.snap(n)}}get interfaces_(){return[WC]}}class ST{constructor(){ST.constructor_.apply(this,arguments)}static constructor_(){if(this._argGeom=null,this._distance=null,this._bufParams=new QA,this._resultGeometry=null,this._saveException=null,1===arguments.length){const t=arguments[0];this._argGeom=t}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this._argGeom=t,this._bufParams=e}}static bufferOp(){if(2===arguments.length){const t=arguments[1];return new ST(arguments[0]).getResultGeometry(t)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof pk&&"number"==typeof arguments[1]){const t=arguments[1],e=arguments[2],n=new ST(arguments[0]);n.setQuadrantSegments(e);return n.getResultGeometry(t)}if(arguments[2]instanceof QA&&arguments[0]instanceof pk&&"number"==typeof arguments[1]){const t=arguments[1];return new ST(arguments[0],arguments[2]).getResultGeometry(t)}}else if(4===arguments.length){const t=arguments[1],e=arguments[2],n=arguments[3],i=new ST(arguments[0]);i.setQuadrantSegments(e),i.setEndCapStyle(n);return i.getResultGeometry(t)}}static precisionScaleFactor(t,e,n){const i=t.getEnvelopeInternal(),r=nO.max(Math.abs(i.getMaxX()),Math.abs(i.getMaxY()),Math.abs(i.getMinX()),Math.abs(i.getMinY()))+2*(e>0?e:0),s=n-Math.trunc(Math.log(r)/Math.log(10)+1);return Math.pow(10,s)}bufferFixedPrecision(t){const e=new yT(new ET(new dO(1)),t.getScale()),n=new _T(this._bufParams);n.setWorkingPrecisionModel(t),n.setNoder(e),this._resultGeometry=n.buffer(this._argGeom,this._distance)}bufferReducedPrecision(){if(0===arguments.length){for(let t=ST.MAX_PRECISION_DIGITS;t>=0;t--){try{this.bufferReducedPrecision(t)}catch(t){if(!(t instanceof JC))throw t;this._saveException=t}if(null!==this._resultGeometry)return null}throw this._saveException}if(1===arguments.length){const t=arguments[0],e=ST.precisionScaleFactor(this._argGeom,this._distance,t),n=new dO(e);this.bufferFixedPrecision(n)}}computeGeometry(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;const t=this._argGeom.getFactory().getPrecisionModel();t.getType()===dO.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()}setQuadrantSegments(t){this._bufParams.setQuadrantSegments(t)}bufferOriginalPrecision(){try{const t=new _T(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof ok))throw t;this._saveException=t}}getResultGeometry(t){return this._distance=t,this.computeGeometry(),this._resultGeometry}setEndCapStyle(t){this._bufParams.setEndCapStyle(t)}}function NT(t){return 180*(t/6371.0088%(2*Math.PI))/Math.PI}ST.CAP_ROUND=QA.CAP_ROUND,ST.CAP_BUTT=QA.CAP_FLAT,ST.CAP_FLAT=QA.CAP_FLAT,ST.CAP_SQUARE=QA.CAP_SQUARE,ST.MAX_PRECISION_DIGITS=12;const IT=Object.assign({},{GeoJSONReader:bO,GeoJSONWriter:MO,BufferOp:ST});function kT(t,e={}){let n=e.step?e.step:8,i=!1!==e.wgs84,r=0;switch(typeof e.dist){case"number":r=i?NT(e.dist):e.dist;break;case"string":r=e.dist;break;default:r=0}let s=(new IT.GeoJSONReader).read(Mc(t)),o=[];return s.features.forEach((t=>{let e=0;e="number"==typeof r?r:i?NT(t.properties[r]):t.properties[r];let s=(new IT.GeoJSONWriter).write(IT.BufferOp.bufferOp(t.geometry,e,n));0!==s.coordinates[0].length&&o.push({type:"Feature",properties:t.properties,geometry:s})})),o={type:"FeatureCollection",features:o},e.merge&&(o=CT(o)),o}const OT=Object.assign({},{GeoJSONReader:bO,GeoJSONWriter:MO,UnionOp:class{static union(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return HA.createEmptyResult(HA.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return pk.checkNotGeometryCollection(t),pk.checkNotGeometryCollection(e),ZA.overlayOp(t,e,HA.UNION)}}});function CT(t,e={}){let n=(new OT.GeoJSONReader).read(kT(t));if(null!=e.id&&null!=e.id){let t=Array.from(new Set(n.features.map((t=>t.properties[e.id])))),i=[];return t.forEach((t=>{let r=n.features.filter((n=>n.properties[e.id]==t)),s=r[0].geometry;for(let t=1;t<r.length;t++)s=OT.UnionOp.union(s,r[t].geometry);i.push({type:"Feature",properties:{id:t},geometry:(new OT.GeoJSONWriter).write(s)})})),{type:"FeatureCollection",features:i}}{let t=n.features[0].geometry;for(let e=1;e<n.features.length;e++)t=OT.UnionOp.union(t,n.features[e].geometry);return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:(new OT.GeoJSONWriter).write(t)}]}}}const AT=Object.assign({},{geoPath:Mr});const TT=Object.assign({},{scaleLinear:lm,geoPath:Mr,geoProject:jf});const RT=Object.assign({},{geoPath:Mr});function LT(){this.reset()}LT.prototype={constructor:LT,reset:function(){this.s=this.t=0},add:function(t){DT(PT,t,this.t),DT(this,PT.s,this.s),this.s?this.t+=PT.t:this.s=PT.t},valueOf:function(){return this.s}};const PT=new LT;function DT(t,e,n){const i=t.s=e+n,r=i-e,s=i-r;t.t=e-s+(n-r)}function zT(t,e){t&&GT.hasOwnProperty(t.type)&&GT[t.type](t,e)}const FT={Feature:function(t,e){zT(t.geometry,e)},FeatureCollection:function(t,e){let n=t.features,i=-1,r=n.length;for(;++i<r;)zT(n[i].geometry,e)}},GT={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){let n=t.coordinates,i=-1,r=n.length;for(;++i<r;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){jT(t.coordinates,e,0)},MultiLineString:function(t,e){let n=t.coordinates,i=-1,r=n.length;for(;++i<r;)jT(n[i],e,0)},Polygon:function(t,e){qT(t.coordinates,e)},MultiPolygon:function(t,e){let n=t.coordinates,i=-1,r=n.length;for(;++i<r;)qT(n[i],e)},GeometryCollection:function(t,e){let n=t.geometries,i=-1,r=n.length;for(;++i<r;)zT(n[i],e)}};function jT(t,e,n){let i,r=-1,s=t.length-n;for(e.lineStart();++r<s;)i=t[r],e.point(i[0],i[1],i[2]);e.lineEnd()}function qT(t,e){let n=-1,i=t.length;for(e.polygonStart();++n<i;)jT(t[n],e,1);e.polygonEnd()}let BT,YT,$T,UT=new LT;const WT={sphere:t=>{},point:t=>{},lineStart:function(){WT.point=VT,WT.lineEnd=XT},lineEnd:t=>{},polygonStart:t=>{},polygonEnd:t=>{}};function XT(){WT.point=WT.lineEnd=t=>{}}function VT(t,e){t*=Math.PI/180,e*=Math.PI/180,BT=t,YT=Math.sin(e),$T=Math.cos(e),WT.point=HT}function HT(t,e){t*=Math.PI/180,e*=Math.PI/180;const n=Math.sin(e),i=Math.cos(e),r=Math.abs(t-BT),s=Math.cos(r),o=i*Math.sin(r),a=$T*n-YT*i*s,l=YT*n+$T*i*s;UT.add(Math.atan2(Math.sqrt(o*o+a*a),l)),BT=t,YT=n,$T=i}function JT(t){return UT.reset(),function(t,e){t&&FT.hasOwnProperty(t.type)?FT[t.type](t,e):zT(t,e)}(t,WT),+UT}const ZT=[null,null],QT={type:"LineString",coordinates:ZT};function KT(t,e){return ZT[0]=t,ZT[1]=e,JT(QT)}function tR(){return 1}var eR={units:"kilometers",radius:6371.0088};var nR=Object.freeze({__proto__:null,geoScaleBar:function(){let t,e,n,i,r,s=null,o=0,a=0,l=1,c=eR.radius,h=eR.units,u=t=>+t.toFixed(2),f=2,d=4,g="start",p=1,_=!0;function y(y){r=null===r?null:r||h.charAt(0).toUpperCase()+h.slice(1);let m=s[1][0]-s[0][0],x=s[1][1]-s[0][1],v=s[0][0]+m*o,b=s[0][1]+x*a,M=t.invert([v,b]),w=0,E=0;if(e)w=e,E=w/(KT(M,t.invert([v+1,b]))*c);else{let e=.01,i=80/(_?1:p),r=0,s=100,o=[1,2,4,5];for(;E<i&&r<s;){for(let n=0,r=o.length;n<r&&(w=e*o[n],E=w/(KT(M,t.invert([v+1,b]))*c),!(E>=i));n++);e*=10,r++}n=w}let S=w/(_?p:1),N=null===i?[]:i||[0,S/4,S/2,S],I=t=>t*E/(w/p),k=y.selection?y.selection():y,O=k.selectAll(".label").data([r]),C=k.selectAll(".domain").data([null]),A=k.selectAll(".tick").data(N,I).order(),T=A.exit(),R=A.enter().append("g").attr("class","tick"),L=A.select("line"),P=A.select("text"),D=A.select("rect");k.attr("font-family","sans-serif").attr("transform",`translate(${[v,b]})`),C=C.merge(C.enter().insert("path",".tick").attr("class","domain").attr("fill","none").attr("stroke","currentColor")),A=A.merge(R),L=L.merge(R.append("line").attr("stroke","currentColor").attr("y2",d*l)),P=P.merge(R.append("text").attr("fill","currentColor").attr("y",d*l+f*l).attr("font-size",10).attr("text-anchor","middle").attr("dy",(1===l?.71:0)+"em")),D=D.merge(R.append("rect").attr("fill",((t,e)=>e%2==0?"currentColor":"#fff")).attr("stroke","currentColor").attr("stroke-width",.5).attr("width",((t,e,n)=>e===n.length-1?0:I(N[e+1]-t))).attr("y",1===l?0:-d).attr("height",d)),y!==k&&(A=A.transition(y),C=C.transition(y),D=D.transition(y),T=T.transition(y).attr("opacity",1e-6).attr("transform",(t=>`translate(${I(t)})`)),R.attr("opacity",1e-6).attr("transform",(t=>`translate(${I(t)})`))),T.remove(),C.attr("d",`M${I(0)},${d*l} L${I(0)},0 L${I(S)},0 L${I(S)},${d*l}`),A.attr("transform",(t=>`translate(${I(t)})`)).attr("opacity",1),L.attr("y2",d*l),P.attr("y",d*l+f*l).text(u),D.attr("fill",((t,e)=>e%2==0?"currentColor":"#fff")).attr("width",((t,e,n)=>e===n.length-1?0:I(N[e+1]-t))).attr("y",1===l?0:-d).attr("height",d),null===O?O.remove():(y!==k?O.transition(y).attr("x","start"===g?0:I("middle"===g?S/2:S)).attr("y",1===l?0:"1.3em").attr("text-anchor",g).text((t=>t)):O.attr("x","start"===g?0:I("middle"===g?S/2:S)).attr("y",1===l?0:"1.3em").attr("text-anchor",g).text((t=>t)),O.enter().append("text").attr("class","label").attr("fill","currentColor").attr("font-size",12).attr("dy","-0.32em").attr("x","start"===g?0:I("middle"===g?S/2:S)).attr("y",1===l?0:"1.3em").attr("text-anchor",g).text((t=>t)))}return y.distance=function(t){return arguments.length?(e=+t,y):e||n},y.extent=function(t){return arguments.length?(s=t,y):s},y.label=function(t){return arguments.length?(r=t,y):r},y.labelAnchor=function(t){return arguments.length?(g=t,y):g},y.left=function(t){return arguments.length?(o=+t>1?1:+t<0?0:+t,y):o},y.orient=function(t){return arguments.length?(l=t(),y):1===l?"bottom":"top"},y.projection=function(e){return arguments.length?(t=e,y):t},y.radius=function(t){return arguments.length?(c=+t,y):c},y.size=function(t){return arguments.length?(s=[[0,0],t],y):s[1]},y.top=function(t){return arguments.length?(a=+t>1?1:+t<0?0:+t,y):a},y.tickFormat=function(t){return arguments.length?(u=t,y):u},y.tickPadding=function(t){return arguments.length?(f=+t,y):f},y.tickSize=function(t){return arguments.length?(d=+t,y):d},y.tickValues=function(t){return arguments.length?(i=t,y):i},y.units=function(t){return arguments.length?(({units:h,radius:c}=t),y):h},y.zoomClamp=function(t){return arguments.length?(_=!!t,y):_},y.zoomFactor=function(t){return arguments.length?(p=+t,y):p},y},geoScaleBottom:tR,geoScaleTop:function(){return-1},geoScaleFeet:{units:"feet",radius:20902259.664},geoScaleKilometers:eR,geoScaleMeters:{units:"meters",radius:6371008.8},geoScaleMiles:{units:"miles",radius:3958.7613}});const iR=Object.assign({},nR);function rR(t,e,n,i={}){let r,s,o,a,l,c,h=i.position?i.position:"topright",u=i.text?i.text:"Your text here!",f=i.fontSize?i.fontSize:15,d=i.fontFamily?i.fontFamily:"Roboto",g=i.margin?i.margin:0,p=i.textDecoration?i.textDecoration:"none",_=i.fontWeight?i.fontWeight:"normal",y=i.fontStyle?i.fontStyle:"normal",m=i.anchor?i.anchor:"start",x=i.baseline?i.baseline:"baseline",v=i.fill?i.fill:"#474342",b=i.stroke?i.stroke:"none",M=i.frame_fill?i.frame_fill:"none",w=i.frame_stroke?i.frame_stroke:"none",E=i.strokeWidth?i.strokeWidth:1,S=i.frame_opacity?i.frame_opacity:1;switch(h){case"topleft":m="start",x="hanging",r=5,s=5;break;case"topright":m="end",x="hanging",r=e-5,s=5;break;case"top":m="middle",x="hanging",r=e/2,s=5;break;case"left":m="start",x="middle",r=5,s=n/2;break;case"middle":m="middle",x="middle",r=e/2,s=n/2;break;case"right":m="end",x="middle",r=e-5,s=n/2;break;case"bottomleft":m="start",x="baseline",r=5,s=n-5;break;case"bottom":m="middle",x="baseline",r=e/2,s=n-5;break;case"bottomright":m="end",x="baseline",r=e-5,s=n-5;break;default:r=h[0],s=h[1]}let N=u.split("\n"),I=[];N.forEach((t=>I.push(t.length)));let k=I.indexOf(Math.max(...I)),O=t.append("text").attr("font-size",`${f}px`).attr("font-family",d).attr("font-style",y).attr("text-decoration",p).attr("font-weight",_).text(N[k]);t.node().appendChild(O.node()),document.body.appendChild(t.node());const C=O.node().getBBox().width;document.body.removeChild(t.node()),O.remove();let A=f*I.length;"hanging"==x&&(l=0,a=g),"middle"==x&&(l=f*N.length/2,a=0),"baseline"==x&&(l=f*N.length,a=-g),"start"==m&&(c=0,o=g),"middle"==m&&(c=C/2,o=0),"end"==m&&(c=C,o=-g);let T=t.append("g").attr("class",i.id).attr("data-layer",JSON.stringify({_type:"text"}));T.append("rect").attr("x",r-g-c+o).attr("y",s-g-l+a).attr("height",A+2*g).attr("width",C+2*g).attr("fill",M).attr("stroke-width",E).attr("fill-opacity",S).attr("stroke",w),T.selectAll("text").data(N).join("text").attr("x",r+o).attr("y",s-+l+a).attr("font-size",`${f}px`).attr("font-style",y).attr("text-decoration",p).attr("font-weight",_).attr("font-family",d).attr("dy",((t,e)=>e*f)).attr("text-anchor",m).attr("dominant-baseline","hanging").attr("fill",v).attr("stroke",b).text((t=>t))}const sR=Object.assign({},{select:Oo,pointer:Po,min:ot,max:rt,descending:n,scaleLinear:lm,geoPath:Mr});const oR=Object.assign({},{sum:bt,select:Oo,pointer:Po,forceX:OS,forceY:CS,forceCollide:SS,forceSimulation:kS});function aR(t){return Array.isArray(t)?cR(t):t&&t.bbox?cR(t.bbox):[360*lR(),180*lR()]}function lR(){return Math.random()-.5}function cR(t){return[Math.random()*(t[2]-t[0])+t[0],Math.random()*(t[3]-t[1])+t[1]]}function hR(t,e,n){let i=[];t.features.forEach((t=>{i.push(function(t,e,n){let i=[],r=0,s=0;const o=Math.round(+t.properties[e]/n),a=gN(t);for(;r<o&&s<10*o;){const e=aR(a),n={type:"Feature",properties:t.properties,geometry:{type:"Point",coordinates:e}};uN(n,t)&&(i.push(n),r++),s++}return JSON.parse(JSON.stringify(i))}(t,e,n))}));const r=Object.keys(t).filter((t=>"features"!=t)),s={};return r.forEach((e=>{s[e]=t[e]})),s.features=i.flat(),s}const uR=Object.assign({},{sum:bt});function fR(t){return t.k}function dR(t){return[t.x,t.y]}function gR(t){return function(){return t}}const pR=Object.assign({},{tile:function(){let t=0,e=0,n=960,i=500,r=!0,s=!0,o=256,a=fR,l=dR,c=0;function h(){const h=+a.apply(this,arguments),u=l.apply(this,arguments),f=Math.log2(h/o),d=Math.round(Math.max(f+c,0)),g=Math.pow(2,f-d)*o,p=+u[0]-h/2,_=+u[1]-h/2,y=Math.max(r?0:-1/0,Math.floor((t-p)/g)),m=Math.min(r?1<<d:1/0,Math.ceil((n-p)/g)),x=Math.max(s?0:-1/0,Math.floor((e-_)/g)),v=Math.min(s?1<<d:1/0,Math.ceil((i-_)/g)),b=[];for(let t=x;t<v;++t)for(let e=y;e<m;++e)b.push([e,t,d]);return b.translate=[p/g,_/g],b.scale=g,b}return h.size=function(r){return arguments.length?(t=e=0,n=+r[0],i=+r[1],h):[n-t,i-e]},h.extent=function(r){return arguments.length?(t=+r[0][0],e=+r[0][1],n=+r[1][0],i=+r[1][1],h):[[t,e],[n,i]]},h.scale=function(t){return arguments.length?(a="function"==typeof t?t:gR(+t),h):a},h.translate=function(t){return arguments.length?(l="function"==typeof t?t:gR([+t[0],+t[1]]),h):l},h.zoomDelta=function(t){return arguments.length?(c=+t,h):c},h.tileSize=function(t){return arguments.length?(o=+t,h):o},h.clamp=function(t){return arguments.length?(r=s=!!t,h):r&&s},h.clampX=function(t){return arguments.length?(r=!!t,h):r},h.clampY=function(t){return arguments.length?(s=!!t,h):s},h},geoPath:Mr});const _R=Object.assign({},{geoPath:Mr,geoArea:Oe});const yR={type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"MultiPolygon",coordinates:[[[[9.8,1],[4.41,6.36],[-7.54,4.35],[-16.73,12.33],[-17.01,21.2],[-5.91,35.81],[11.31,37],[10.33,33.7],[19.06,30.27],[21.61,32.93],[34.48,31.58],[36.02,36.93],[27.67,36.66],[26.74,40.4],[41.5,42.64],[31.19,46.63],[22.57,40.05],[13.71,45.59],[15.61,40.07],[3.94,43.53],[-2.13,36.74],[-9,37.02],[-9.29,42.92],[-1.79,43.39],[-1.37,48.66],[9.44,54.81],[21.04,55.3],[21.85,65.54],[13.28,55.35],[7.42,62.6],[18.6,70.1],[27.77,71.19],[41.02,67.7],[34.77,64.56],[66.93,71.3],[102.03,77.22],[111.14,76.75],[106.36,73.19],[124.38,73.81],[130.57,70.96],[141.55,72.77],[160.54,69.36],[179.95,68.97],[179.61,62.71],[163.39,59.62],[156.72,50.89],[155.55,55.28],[164.03,61.35],[146.33,59.71],[135.22,54.89],[141.53,53.18],[140.17,48.45],[126.67,37.83],[117.76,39.11],[121.63,28.54],[116.49,22.94],[106.79,21.01],[109.44,14.1],[104.89,9.85],[91.62,22.54],[80.26,15.67],[76.54,8.94],[70.98,20.71],[66.25,25.47],[57.33,25.78],[47.95,29.99],[51.22,24.63],[56.08,26.11],[57.84,19.02],[43.95,12.6],[35.22,28.05],[39.72,15.26],[44.27,10.46],[51.29,11.83],[47.95,4.46],[40.17,-2.76],[39.86,-16.43],[27.1,-33.53],[19.95,-34.81],[11.85,-18.14],[13.64,-12.25],[9.8,1]],[[27.64,58],[27.64,58]],[[5.07,52.92],[5.07,52.92]],[[133.26,45.54],[133.26,45.54]],[[57.64,42.15],[57.64,42.15]],[[60.06,44.85],[60.06,44.85]],[[34.86,-13.51],[34.86,-13.51]],[[29.21,-3.33],[29.21,-3.33]],[[34,.25],[34,.25]],[[48.87,38.43],[54.01,36.82],[50.3,44.66],[48.87,38.43]]],[[[8.72,3.8],[8.72,3.8]]],[[[179.08,-8.36],[179.08,-8.36]]],[[[179.18,-8],[179.18,-8]]],[[[73.71,4.23],[73.71,4.23]]],[[[73.41,5.19],[73.41,5.19]]],[[[73.37,3.53],[73.37,3.53]]],[[[-61.77,17.13],[-61.77,17.13]]],[[[50.42,26.6],[50.42,26.6]]],[[[-78.15,25.26],[-78.15,25.26]]],[[[-77.25,25.13],[-77.25,25.13]]],[[[-59.53,13.06],[-59.53,13.06]]],[[[43.87,-12.2],[43.87,-12.2]]],[[[-23.9,15.8],[-23.9,15.8]]],[[[-61.45,15.56],[-61.45,15.56]]],[[[11.95,55.99],[11.95,55.99]]],[[[-16.13,28.6],[-16.13,28.6]]],[[[3.2,39.88],[3.2,39.88]]],[[[-7.41,62.14],[-7.41,62.14]]],[[[158.06,6.98],[158.06,6.98]]],[[[-2.51,49.41],[-2.51,49.41]]],[[[-61.56,12.03],[-61.56,12.03]]],[[[-4.6,54.09],[-4.6,54.09]]],[[[15.66,38.42],[15.66,38.42]]],[[[9.12,41.24],[9.12,41.24]]],[[[-2.12,49.26],[-2.12,49.26]]],[[[-158.96,2.2],[-158.96,2.2]]],[[[-62.67,17.34],[-62.67,17.34]]],[[[-60.95,13.71],[-60.95,13.71]]],[[[171.05,7.14],[171.05,7.14]]],[[[14.55,35.76],[14.55,35.76]]],[[[57.71,-20.1],[57.71,-20.1]]],[[[167.02,-.55],[167.02,-.55]]],[[[134.66,7.59],[134.66,7.59]]],[[[104.28,1.37],[104.28,1.37]]],[[[6.69,.07],[6.69,.07]]],[[[55.49,-4.52],[55.49,-4.52]]],[[[-175.25,-20.99],[-175.25,-20.99]]],[[[-61.2,13.1],[-61.2,13.1]]],[[[-172.27,-13.44],[-172.27,-13.44]]],[[[-53.38,-33.74],[-64.89,-40.71],[-65.97,-48.05],[-71.03,-53.81],[-75.43,-47.25],[-72.46,-41.99],[-70.39,-18.34],[-81.1,-6.07],[-77.34,6.54],[-94.85,16.43],[-103.5,18.33],[-123.73,38.92],[-122.21,47.99],[-134.24,58.21],[-151.57,60.99],[-156.55,56.98],[-166.37,63.1],[-166.55,68.36],[-156.82,71.31],[-135.87,68.91],[-127.84,70.24],[-113.86,67.7],[-96.46,67.47],[-96.88,71.01],[-81.24,67.46],[-92.45,62.79],[-92.42,57.35],[-79.77,54.65],[-77.49,62.59],[-67.03,58.18],[-64.07,60.45],[-55.81,53.33],[-66.41,50.26],[-64.51,46.24],[-73.65,41],[-76.07,35.38],[-84.02,30.11],[-97.55,27.01],[-95.75,18.77],[-86.83,21.43],[-88.69,15.84],[-83.13,15],[-82.25,9.01],[-62.62,9.74],[-52.99,5.46],[-50.4,-.07],[-35.51,-5.14],[-42.06,-22.95],[-48.58,-25.87],[-53.38,-33.74]],[[-79.06,43.28],[-79.06,43.28]],[[-82.64,42.56],[-82.64,42.56]],[[-89.58,48],[-89.58,48]],[[-69.37,-15.52],[-69.37,-15.52]],[[-84.11,46.35],[-84.11,46.35]]],[[[9.44,42.77],[9.44,42.77]]],[[[-61.9,16.22],[-61.9,16.22]]],[[[-60.6,14.51],[-60.6,14.51]]],[[[55.75,-20.58],[55.75,-20.58]]],[[[143.1,54.4],[143.1,54.4]]],[[[-179.96,65.13],[-179.94,68.93],[-170.01,66.09],[-179.96,65.13]]],[[[50.59,69.33],[50.59,69.33]]],[[[-179.92,70.99],[-179.92,70.99]]],[[[143.02,74.29],[143.02,74.29]]],[[[146.73,75.49],[146.73,75.49]]],[[[139.11,76.1],[139.11,76.1]]],[[[67.15,76.1],[67.15,76.1]]],[[[102.93,79.28],[102.93,79.28]]],[[[97.77,80.13],[97.77,80.13]]],[[[48.83,80.81],[48.83,80.81]]],[[[96.49,81.64],[96.49,81.64]]],[[[-68.63,-52.64],[-68.63,-52.64]]],[[[180,-90],[-180,-90],[-180,-84.35],[-157.56,-83.39],[-149.08,-79.48],[-157.93,-77.06],[-133.87,-74.93],[-98.4,-75.24],[-102.72,-73],[-77.24,-73.81],[-67.51,-72.83],[-64.78,-67.02],[-59.9,-72.99],[-63.16,-75.41],[-80.3,-78.85],[-61.85,-83.37],[-29.76,-80.18],[-33.72,-77.31],[-18.87,-75.25],[-9.45,-71.1],[26.45,-71.03],[50.32,-66.39],[69.56,-67.74],[67,-72.9],[84.96,-67.08],[113.2,-65.77],[130.73,-66.15],[167.7,-70.79],[162.19,-75.39],[166.09,-78.57],[160.13,-81.2],[180,-84.35],[180,-90]]],[[[-60.07,-79.69],[-60.07,-79.69]]],[[[-160.29,-79.27],[-160.29,-79.27]]],[[[-66.83,-78.44],[-66.83,-78.44]]],[[[-45.35,-78.69],[-45.35,-78.69]]],[[[-121.2,-73.5],[-121.2,-73.5]]],[[[-126.08,-73.3],[-126.08,-73.3]]],[[[-73.93,-72.46],[-73.93,-72.46]]],[[[-96.74,-71.63],[-96.74,-71.63]]],[[[-70.02,-69.19],[-70.02,-69.19]]],[[[144.4,-40.46],[144.4,-40.46]]],[[[137.56,-35.64],[137.56,-35.64]]],[[[130.24,-11.09],[130.24,-11.09]]],[[[142.55,-10.71],[146.28,-18.87],[153.21,-25.93],[150.01,-37.7],[140.36,-37.88],[131.18,-31.48],[115.12,-34.36],[113.65,-22.58],[130.99,-12.24],[140,-17.71],[142.55,-10.71]]],[[[109.65,2.08],[116.78,7.03],[115.97,-3.61],[109.65,2.08]]],[[[-66.84,-55.18],[-66.84,-55.18]]],[[[-73.17,-53.52],[-73.17,-53.52]]],[[[-74.68,-50],[-74.68,-50]]],[[[-73.89,-42.06],[-73.89,-42.06]]],[[[-75.1,19.9],[-75.1,19.9]]],[[[33.02,34.57],[33.02,34.57]]],[[[-71.76,19.71],[-71.76,19.71]]],[[[179.99,-16.17],[179.99,-16.17]]],[[[178.27,-17.35],[178.27,-17.35]]],[[[-59.2,-51.32],[-59.2,-51.32]]],[[[-58.78,-51.32],[-58.78,-51.32]]],[[[-7.25,55.07],[-7.25,55.07]]],[[[-3.35,58.65],[1.36,51.13],[-5.44,50.19],[-3.35,58.65]]],[[[23.9,35.53],[23.9,35.53]]],[[[23.39,39.02],[23.39,39.02]]],[[[-52.73,69.93],[-52.73,69.93]]],[[[-25.45,70.62],[-25.45,70.62]]],[[[-32.21,83.61],[-13.54,81.21],[-19.08,80.28],[-22.37,70.12],[-41.06,65.1],[-43.14,60.08],[-48.64,61.24],[-59.82,75.91],[-72.59,78.52],[-61,81.49],[-32.21,83.61]]],[[[120.01,-9.36],[120.01,-9.36]]],[[[124.47,-8.97],[124.47,-8.97]]],[[[116.82,-8.31],[116.82,-8.31]]],[[[117.97,-8.1],[117.97,-8.1]]],[[[124.04,-7.96],[124.04,-7.96]]],[[[115.49,-8.15],[115.49,-8.15]]],[[[138.52,-8.15],[138.52,-8.15]]],[[[115,-6.89],[115,-6.89]]],[[[106.16,-6.01],[106.16,-6.01]]],[[[134.58,-5.42],[134.58,-5.42]]],[[[127.07,-3.18],[127.07,-3.18]]],[[[129.1,-2.86],[129.1,-2.86]]],[[[107.85,-2.55],[107.85,-2.55]]],[[[124.53,-1.64],[124.53,-1.64]]],[[[135.48,-1.59],[135.48,-1.59]]],[[[105.88,-1.49],[105.88,-1.49]]],[[[98.86,-.79],[98.86,-.79]]],[[[140.98,-9.11],[133.89,-3.81],[137.79,-1.48],[147.45,-5.96],[140.98,-9.11]]],[[[97.41,1.72],[97.41,1.72]]],[[[125.06,1.67],[125.06,1.67]]],[[[128.17,1.92],[128.17,1.92]]],[[[95.5,5.61],[103.76,.24],[104.54,-5.84],[95.5,5.61]]],[[[92.79,13.31],[92.79,13.31]]],[[[-16.04,66.54],[-16.04,66.54]]],[[[-76.7,18.45],[-76.7,18.45]]],[[[130.98,33.79],[130.98,33.79]]],[[[134.16,34.36],[134.16,34.36]]],[[[141.28,41.35],[141.28,41.35]]],[[[142.02,45.46],[142.02,45.46]]],[[[80.41,9.71],[80.41,9.71]]],[[[49.35,-12.09],[47.13,-24.93],[43.94,-17.46],[49.35,-12.09]]],[[[22.85,78.36],[22.85,78.36]]],[[[16.82,79.88],[16.82,79.88]]],[[[23.14,80.38],[23.14,80.38]]],[[[172.9,-40.51],[172.9,-40.51]]],[[[173.08,-34.41],[173.08,-34.41]]],[[[125.64,9.61],[125.64,9.61]]],[[[123.27,10.98],[123.27,10.98]]],[[[124,11.08],[124,11.08]]],[[[119.82,11.47],[119.82,11.47]]],[[[124.44,11.45],[124.44,11.45]]],[[[122.3,11.76],[122.3,11.76]]],[[[124.92,12.56],[124.92,12.56]]],[[[121.17,13.38],[121.17,13.38]]],[[[120.91,18.57],[120.91,18.57]]],[[[154.81,-5.48],[154.81,-5.48]]],[[[152.23,-4.19],[152.23,-4.19]]],[[[151.04,-2.71],[151.04,-2.71]]],[[[-67.11,18.55],[-67.11,18.55]]],[[[161.69,-10.04],[161.69,-10.04]]],[[[159.62,-9.38],[159.62,-9.38]]],[[[160.8,-8.36],[160.8,-8.36]]],[[[158.6,-7.59],[158.6,-7.59]]],[[[-60.22,10.8],[-60.22,10.8]]],[[[121.64,25.22],[121.64,25.22]]],[[[-155.73,20.19],[-155.73,20.19]]],[[[-163.76,55.06],[-163.76,55.06]]],[[[-133.53,56.59],[-133.53,56.59]]],[[[-135.67,57.36],[-135.67,57.36]]],[[[-153.01,57.93],[-153.01,57.93]]],[[[-135.71,58.23],[-135.71,58.23]]],[[[-135.43,58.33],[-135.43,58.33]]],[[[-166.09,60.46],[-166.09,60.46]]],[[[-171.67,63.8],[-171.67,63.8]]],[[[166.95,-15.02],[166.95,-15.02]]],[[[-83.84,46.15],[-83.84,46.15]]],[[[-64.34,47.05],[-64.34,47.05]]],[[[-60.5,47],[-60.5,47]]],[[[-64.13,49.95],[-64.13,49.95]]],[[[-55.7,51.32],[-55.7,51.32]]],[[[-81.43,53.37],[-81.43,53.37]]],[[[-132.69,53.93],[-132.69,53.93]]],[[[-81.74,63.06],[-81.74,63.06]]],[[[-85.49,65.8],[-85.49,65.8]]],[[[-75.44,68.71],[-75.44,68.71]]],[[[-99.03,70.19],[-99.03,70.19]]],[[[-114.2,73.31],[-104.87,73.13],[-101.81,69.01],[-113.35,68.59],[-114.2,73.31]]],[[[-81.06,73.85],[-81.06,73.85]]],[[[-86.56,73.86],[-68.36,70.58],[-61.89,66.88],[-64.54,61.74],[-73.2,64.22],[-72.99,68.24],[-88.69,70.47],[-86.56,73.86]]],[[[-99.83,73.9],[-99.83,73.9]]],[[[-92.75,74.09],[-92.75,74.09]]],[[[-121.58,74.56],[-121.58,74.56]]],[[[-94.39,75.6],[-94.39,75.6]]],[[[-98.41,76.67],[-98.41,76.67]]],[[[-108.67,76.82],[-108.67,76.82]]],[[[-95.24,77.01],[-79.65,75.47],[-89.95,74.53],[-95.24,77.01]]],[[[-116.13,77.47],[-116.13,77.47]]],[[[-109.6,78.07],[-109.6,78.07]]],[[[-96.23,78.64],[-96.23,78.64]]],[[[-111.36,79.26],[-111.36,79.26]]],[[[-103.66,79.34],[-103.66,79.34]]],[[[-94.75,82.12],[-94.75,82.12]]],[[[-69.69,83.12],[-61.31,82.2],[-77.77,76.66],[-86.91,77.27],[-90.81,81.72],[-69.69,83.12]]],[[[-127.81,50.44],[-127.81,50.44]]],[[[163.52,-20.03],[163.52,-20.03]]],[[[110.69,20.15],[110.69,20.15]]]]}}]},mR=Object.assign({},{geoMercator:Wr,create:Co,geoPath:Mr,transition:lc});function xR({params:t={},layers:e={}}={}){let n="user"==t.projection,i=t.projection,r=t.height,s=!t.reverse;const o=e.map((t=>t.type));i=o.includes("tiles")?mR.geoMercator():iy(i),e.forEach((t=>{void 0!==t.geojson&&(t.geojson=uy(t.geojson,{rewind:t.rewind}))}));let a=t.width?t.width:1e3,l=t.extent?t.extent:null;l=Array.isArray(l)&&Array.isArray(l[0])&&Array.isArray(l[1])?Ec(l):l;let c=t.margin?t.margin:1;Array.isArray(c)||(c=[c,c,c,c]);let h=t.background,u=1==t.clip,f=function(t,e,n,i,r,s){let o;const a=t.map((t=>t.geojson)).filter((t=>void 0!==t)).length,l=t.map((t=>t.type));if(e||!(l.includes("outline")||l.includes("tissot")||l.includes("geolines"))||r||(o={type:"Sphere"}),!e&&a>0&&!l.includes("outline")&&!l.includes("tissot")&&!l.includes("geolines")||r){let e=t.map((t=>t.geojson)).filter((t=>void 0!==t)),n=[];e.forEach((t=>n.push(t.features))),o={type:"FeatureCollection",features:n.flat()}}!e&&0==a&&l.includes("tiles")&&(o={type:"Sphere"}),e&&(o=e);const[[c,h],[u,f]]=dc.geoPath(i.fitWidth(s-n[1]-n[3],o)).bounds(o);let d=i.translate();return i.translate([d[0]+n[3],d[1]+n[0]]),{height:Math.ceil(f-h)+n[0]+n[2],bbox:dc.geoBounds(o)}}(e,l,c,i,n,a);r=null==r?f.height:r;let d=0,g=e.find((t=>"header"==t.type));g&&(g.text&&(d=25*g.text.split("\n").length+10),g.fontSize&&(d=g.fontSize*g.text.split("\n").length+10));let p=0,_=e.find((t=>"footer"==t.type));_&&(_.text&&(p=10*_.text.split("\n").length+10),_.fontSize&&(p=_.fontSize*_.text.split("\n").length+10));const y=mR.create("svg").attr("id","bertinmap").attr("width",a).attr("height",r+d+p).attr("viewBox",[0,-d,a,r+d+p]).attr("style","max-width: 100%; height: auto; height: intrinsic; background-color: white;");y.append("defs").append("style").attr("type","text/css").text("@import url('https://fonts.googleapis.com/css2?family=Pacifico&family=Roboto&family=Rubik&family=Ubuntu&display=swap');");let m=null;u&&(m=Date.now().toString(36)+Math.random().toString(36).substring(2),y.append("clipPath").attr("id",`clip_${m}`).append("path").datum({type:"Sphere"}).attr("d",mR.geoPath(i))),h&&y.append("rect").attr("x",0).attr("y",0).attr("width",a).attr("height",r).attr("fill",h);let x=e.find((t=>"outline"==t.type));x&&QS(y,i,n,{id:x.id,fill:x.fill,fillOpacity:x.fillOpacity,stroke:"none",strokeWidth:"none"}),(s?[...e].reverse():[...e]).forEach((t=>{if("graticule"==t.type&&function(t,e,n,i={},r,s){if(!n){let n=i.stroke?i.stroke:"white",o=null!=i.strokeWidth?i.strokeWidth:.8,a=null!=i.strokeOpacity?i.strokeOpacity:.5,l=null!=i.strokeDasharray?i.strokeDasharray:2,c=i.strokeLinecap?i.strokeLinecap:"round",h=i.strokeLinejoin?i.strokeLinejoin:"round",u=i.spread?i.spread:0,f=[[isNaN(s[0][0])||s[0][0]-u<-180||s[0][0]-u>180?-180:s[0][0]-u,isNaN(s[0][1])||s[0][1]-u<-90||s[0][1]-u>90?-90:s[0][1]-u],[isNaN(s[1][0])||s[1][0]+u<-180||s[1][0]+u>180?180:s[1][0]+u,isNaN(s[1][1])||s[1][1]+u<-90||s[1][1]+u>90?90:s[1][1]+u]],d=i.step?i.step:[10,10];d=Array.isArray(d)?d:[d,d],t.append("g").attr("class",i.id).attr("data-layer",JSON.stringify({_type:"graticule"})).attr("clip-path",null==r?"none":`url(#clip_${r})`).append("path").datum(XS.geoGraticule().step(d).extent(f)).attr("class","onglobe").attr("d",XS.geoPath(e)).style("fill","none").style("stroke",n).style("stroke-width",o).style("stroke-opacity",a).style("stroke-linecap",c).style("stroke-linejoin",h).style("stroke-dasharray",l)}}(y,i,n,{id:t.id,stroke:t.stroke,strokeWidth:t.strokeWidth,strokeOpacity:t.strokeOpacity,strokeDasharray:t.strokeDasharray,strokeLinecap:t.strokeLinecap,strokeLinejoin:t.strokeLinejoin,step:t.step,spread:t.spread},m,f.bbox),"geolines"==t.type&&JS(y,i,n,{id:t.id,stroke:t.stroke,strokeWidth:t.strokeWidth,strokeOpacity:t.strokeOpacity,strokeDasharray:t.strokeDasharray,strokeLinecap:t.strokeLinecap},m),"minimap"!=t.type&&"location"!=t.type||function({mainmap:t={selection:null,projection:null,width:null,height:null},id:e,x:n=5,y:i=5,geojson:r=yR,extent:s=null,threshold:o=.1,precision:a=10,projection:l="Equirectangular",width:c=200,background:h={stroke:"black",strokeWidth:1,strokeOpacity:1,fill:"white",fillOpacity:1},frame:u={stroke:"none",strokeWidth:1,strokeOpacity:1,fill:"red",fillOpacity:.25},geometries:f={fill:"#CCC",stroke:"none",strokeWidth:1,fillOpacity:1,strokeOpacity:1},raise:d={fill:"red",stroke:"none",strokeWidth:1,fillOpacity:1,strokeOpacity:1},dot:g={fill:"red",r:5,stroke:"none",strokeWidth:1,fillOpacity:1,strokeOpacity:1}}={}){const p=Date.now().toString(36)+Math.random().toString(36).substring(2);s=Array.isArray(s)&&Array.isArray(s[0])&&Array.isArray(s[1])?Ec(s):s;const _={type:"Sphere"};let y=t.selection.append("g").attr("class",e).attr("data-layer",JSON.stringify({_type:"minimap"}));l=(l=iy(l)).fitWidth(c,s||_);const m=_R.geoPath(l);let x="";null!=s&&(x=m.bounds(s),y.append("clipPath").attr("id",`extent_${p}`).append("rect").attr("x",0).attr("y",0).attr("width",x[1][0]).attr("height",x[1][1])),null==s?y.append("g").append("path").attr("d",m(_)).attr("fill",h.fill).attr("fill-opacity",h.fillOpacity).attr("stroke","none").attr("transform",`translate(${n} ${i})`):y.append("g").append("rect").attr("x",0).attr("y",0).attr("width",x[1][0]).attr("height",x[1][1]).attr("fill",h.fill).attr("fill-opacity",h.fillOpacity).attr("stroke","none").attr("transform",`translate(${n} ${i})`),y.append("g").append("path").datum(r).attr("fill",f.fill).attr("fill-opacity",f.fillOpacity).attr("stroke",f.stroke).attr("stroke-width",f.strokeWidth).attr("stroke-opacity",f.strokeOpacity).attr("d",m).attr("transform",`translate(${n} ${i})`).attr("clip-path",`url(#extent_${p})`),null==s?y.append("g").append("path").attr("d",m(_)).attr("fill","none").attr("stroke",h.stroke).attr("stroke-width",h.strokeWidth).attr("stroke-opacity",h.strokeOpacity).attr("transform",`translate(${n} ${i})`):y.append("g").append("rect").attr("x",0).attr("y",0).attr("width",x[1][0]).attr("height",x[1][1]).attr("fill","none").attr("stroke",h.stroke).attr("stroke-width",h.strokeWidth).attr("stroke-opacity",h.strokeOpacity).attr("transform",`translate(${n} ${i})`);let v=[];for(let e=0;e<=t.width;e+=t.width/a)v.push(e);let b=[];for(let e=0;e<=t.height;e+=t.width/a)b.push(e);let M=[];M.push(v.map((e=>t.projection.invert([e,0])))),M.push(b.map((e=>t.projection.invert([t.width,e])))),M.push(v.reverse().map((e=>t.projection.invert([e,t.height])))),M.push(b.reverse().map((e=>t.projection.invert([0,e]))));const w={type:"Feature",geometry:{type:"Polygon",coordinates:[M.flat()]}};if(_R.geoArea(w)>o)y.append("g").append("path").datum(w).attr("fill",u.fill).attr("fill-opacity",u.fillOpacity).attr("stroke",u.stroke).attr("stroke-width",u.strokeWidth).attr("stroke-opacity",u.strokeOpacity).attr("d",m).attr("transform",`translate(${n} ${i})`),y.append("clipPath").attr("id",`clipminimap_${p}`).append("path").datum(w).attr("d",_R.geoPath(l)),y.append("g").append("path").attr("clip-path",`url(#clipminimap_${p})`).datum(r).attr("fill",d.fill).attr("fill-opacity",d.fillOpacity).attr("stroke",d.stroke).attr("stroke-width",d.strokeWidth).attr("stroke-opacity",d.strokeOpacity).attr("d",m).attr("transform",`translate(${n} ${i})`);else{const e=t.projection.invert([t.width/2,t.height/2]);y.append("circle").attr("cx",l(e)[0]).attr("cy",l(e)[1]).attr("fill",g.fill).attr("fill-opacity",g.fillOpacity).attr("stroke",g.stroke).attr("stroke-width",g.strokeWidth).attr("stroke-opacity",g.strokeOpacity).attr("r",g.r).attr("transform",`translate(${n} ${i})`)}}({id:t.id,x:t.x,y:t.y,width:t.width,projection:t.projection,geojson:t.geojson,rewind:t.rewind,extent:t.extent,threshold:t.threshold,background:t.background,geometries:t.geometries,raise:t.raise,frame:t.frame,dot:t.dot,mainmap:{selection:y,projection:i,width:a,height:r}}),"tiles"==t.type&&function(t,e,n,i,r={}){let s=null!=r.opacity?r.opacity:1,o=null!=r.tileSize?r.tileSize:512,a=null!=r.clip?r.clip:void 0,l=r.style?r.style:"opentopomap",c=null!=r.zoomDelta?r.zoomDelta:1,h=null!=r.increasetilesize?r.increasetilesize:1,u=r.source?r.source:"bottomright";const f=[{name:"openstreetmap",provider:"OpenStreetMap contributors",url:(t,e,n)=>`https://tile.openstreetmap.org/${n}/${t}/${e}.png`},{name:"opentopomap",provider:"OpenStreetMap contributors",url:(t,e,n)=>`https://tile.opentopomap.org/${n}/${t}/${e}.png`},{name:"worldterrain",provider:"USGS, Esri, TANA, DeLorme, and NPS",url:(t,e,n)=>`https://server.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/${n}/${e}/${t}.png`},{name:"worldimagery",provider:"Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community",url:(t,e,n)=>`https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/${n}/${e}/${t}.png`},{name:"worldStreet",provider:"Esri, DeLorme, NAVTEQ, USGS, Intermap, iPC, NRCAN, Esri Japan, METI, Esri China (Hong Kong), Esri (Thailand), TomTom, 2012",url:(t,e,n)=>`https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/${n}/${e}/${t}.png`},{name:"worldphysical",provider:"Esri, US National Park Service",url:(t,e,n)=>`https://server.arcgisonline.com/ArcGIS/rest/services/World_Physical_Map/MapServer/tile/${n}/${e}/${t}`},{name:"shadedrelief",provider:"ESRI",url:(t,e,n)=>`https://server.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/${n}/${e}/${t}.png`},{name:"oceanbasemap",provider:"GEBCO, NOAA, CHS, OSU, UNH, CSUMB, National Geographic, DeLorme, NAVTEQ, and Esri",url:(t,e,n)=>`https://server.arcgisonline.com/ArcGIS/rest/services/Ocean_Basemap/MapServer/tile/${n}/${e}/${t}.png`}];Object.hasOwn(l,"provider")&&Object.hasOwn(l,"url")&&(l.name="user",f.push(l),l=l.name);let d=f.find((t=>t.name==l)).url,g=pR.tile().size([e,n]).scale(2*i.scale()*Math.PI).translate(i([0,0])).tileSize(o).zoomDelta(c);const p=Date.now().toString(36)+Math.random().toString(36).substring(2);let _=t.append("g").attr("class",r.id).attr("data-layer",JSON.stringify({_type:"tiles"}));a&&_.append("clipPath").attr("id",`tileclip_${p}`).append("path").datum(a).attr("d",pR.geoPath(i)),_.append("g").attr("clip-path",`url(#tileclip_${p})`).selectAll("image").data(g()).join("image").attr("xlink:href",(t=>d(t[0],t[1],t[2]))).attr("x",(t=>Math.round((t[0]+g().translate[0])*g().scale))).attr("y",(t=>Math.round((t[1]+g().translate[1])*g().scale))).attr("width",g().scale+h+"px").attr("height",g().scale+h+"px").attr("opacity",s),rR(t,e,n,r={text:`Source: ${f.find((t=>t.name==l)).provider}`,position:u,fontSize:12,fill:"white",frame_fill:"black",frame_opacity:.3,fontFamily:"Roboto",margin:6})}(y,a,r,i,{id:t.id,opacity:t.opacity,tileSize:t.tileSize,zoomDelta:t.zoomDelta,style:t.style,clip:t.clip,increasetilesize:t.increasetilesize,source:t.source}),"layer"!=t.type&&"simple"!=t.type&&null!=t.type||nN(y,i,{id:t.id,geojson:t.geojson,rewind:t.rewind,fill:t.fill,stroke:t.stroke,strokeWidth:t.strokeWidth,strokeLinecap:t.strokeLinecap,strokeLinejoin:t.strokeLinejoin,fillOpacity:t.fillOpacity,strokeOpacity:t.strokeOpacity,strokeDasharray:t.strokeDasharray,symbol:t.symbol,symbol_size:t.symbol_size,symbol_iteration:t.symbol_iteration,symbol_shift:t.symbol_shift,tooltip:t.tooltip,leg_x:t.leg_x,leg_y:t.leg_y,leg_w:t.leg_w,leg_h:t.leg_h,leg_title:t.leg_title,leg_text:t.leg_text,leg_type:t.leg_type,leg_fontSize:t.leg_fontSize,leg_fontSize2:t.leg_fontSize2,leg_stroke:t.leg_stroke,leg_fillOpacity:t.leg_fillOpacity,leg_fill:t.leg_fill,leg_strokeWidth:t.leg_strokeWidth,leg_txtcol:t.leg_txtcol,viewof:t.viewof},m,a,r),"dotdensity"==t.type&&function(t,e,n={},i,r,s){let o=null!=n.nbdots?n.nbdots:uR.sum(n.geojson.features.map((t=>+t.properties[n.values])))/1e3;n.dotvalue=null!=n.dotvalue?n.dotvalue:o,n.symbol_size=null!=n.symbol_size?n.symbol_size:8,n.fill=n.fill?n.fill:"#cc190c",n.leg_text=n.leg_text?n.leg_text:`= ${n.dotvalue}`,n.leg_type=n.symbol?n.symbol:"circle";let a=hy(n.geojson);a.features.forEach(((t,e)=>{t.properties.__value=+t.properties[n.values]*t.__share,t.__test=+t.properties[n.values]*t.__share}));const l=hR(a,"__value",n.dotvalue);n.geojson=JSON.parse(JSON.stringify(l)),n._type="dotdensity",nN(t,e,n,i,r,s)}(y,i,{id:t.id,geojson:t.geojson,rewind:t.rewind,values:t.values,dotvalue:t.dotvalue,fill:t.fill,stroke:t.stroke,strokeWidth:t.strokeWidth,strokeLinecap:t.strokeLinecap,strokeLinejoin:t.strokeLinejoin,fillOpacity:t.fillOpacity,strokeOpacity:t.strokeOpacity,strokeDasharray:t.strokeDasharray,symbol:t.symbol,symbol_size:t.symbol_size,symbol_iteration:t.symbol_iteration,symbol_shift:t.symbol_shift,tooltip:t.tooltip,leg_type:t.leg_type,leg_x:t.leg_x,leg_y:t.leg_y,leg_w:t.leg_w,leg_h:t.leg_h,leg_title:t.leg_title,leg_text:t.leg_text,leg_fontSize:t.leg_fontSize,leg_fontSize2:t.leg_fontSize2,leg_stroke:t.leg_stroke,leg_fillOpacity:t.leg_fillOpacity,leg_fill:t.leg_fill,leg_strokeWidth:t.leg_strokeWidth,leg_txtcol:t.leg_txtcol},m,a,r),"spikes"==t.type&&function(t,e,n,i={},r,s,o){let a=i.geojson,l=i.values,c=null!=i.k?i.k:50,h=null!=i.w?i.w:10,u=i.fill?i.fill:"#ffa3e3",f=i.stroke?i.stroke:"#a31d88",d=null!=i.strokeWidth?i.strokeWidth:1,g=null!=i.fillOpacity?i.fillOpacity:1,p=i.strokeLinecap?i.strokeLinecap:"round",_=i.strokeLinejoin?i.strokeLinejoin:"round",y=null!=i.strokeDasharray?i.strokeDasharray:"none",m=null!=i.strokeOpacity?i.strokeOpacity:1,x=!!i.tooltip&&i.tooltip;Array.isArray(x)&&(x={fields:x}),"function"!=typeof x&&"string"!=typeof x||(x={fields:[x]});let v,b=!!i.viewof,M={};v="p"==ry(a)?a.features:rN(a,{planar:n}).features;const w=sR.scaleLinear().domain([0,sR.max(v.map((t=>+t.properties[l])))]).range([0,c]),E=v.filter((t=>""!=t.properties[l])).map((t=>+t.properties[l]));let S={legval:[sR.min(E),w.invert(c/3),w.invert(c/1.5),sR.max(E)],leg_x:i.leg_x?i.leg_x:null,leg_y:i.leg_y?i.leg_y:null,leg_title:i.leg_title?i.leg_title:null,leg_fontSize:i.leg_fontSize?i.leg_fontSize:14,leg_fontSize2:i.leg_fontSize2?i.leg_fontSize2:10,leg_stroke:i.leg_stroke?i.leg_stroke:f,fillOpacity:i.fillOpacity,leg_fill:i.leg_fill?i.leg_fill:u,leg_fillOpacity:i.leg_fillOpacity?i.leg_fillOpacity:g,leg_strokeWidth:i.leg_strokeWidth?i.leg_strokeWidth:.5,leg_txtcol:i.leg_txtcol?i.leg_txtcol:"#363636",leg_round:void 0!==i.leg_round?i.leg_round:void 0,w:h,k:c},N=i.id?`info_${i.id}`:`info_${Date.now().toString(36)+Math.random().toString(36).substring(2)}`;t.append("g").attr("id",N).attr("class","info"),v.forEach((t=>{t.coords=sR.geoPath(e).centroid(t.geometry)})),t.append("g").attr("class",i.id).attr("data-layer",JSON.stringify({_type:"spikes",fill:u,stroke:f,strokeWidth:d,values:l,k:c,w:h,leg:S})).selectAll("path").data(v.filter((t=>null!=t.geometry.coordinates)).filter((t=>null!=t.properties[l])).sort(((t,e)=>sR.descending(+t.properties[l],+e.properties[l])))).join("path").attr("class","onglobe_translate").attr("fill",(t=>cS(v,u).getcol(t.properties[u.values]))).attr("stroke",(t=>cS(v,f).getcol(t.properties[f.values]))).attr("stroke-width",(t=>uS(v,d).getthickness(t.properties[d.values]||void 0))).attr("fill-opacity",g).attr("stroke-opacity",m).attr("stroke-linecap",p).attr("stroke-linejoin",_).attr("stroke-dasharray",y).attr("d",(t=>`M ${-h/2}, 0 0, ${0-w(t.properties[l])} ${h/2}, 0`)).attr("transform",(t=>`translate(\n     ${t.coords[0]},\n     ${t.coords[1]})`)).on("touchmove mousemove",(function(n,i){b&&(sR.select(this).attr("stroke-opacity",m-.3).attr("fill-opacity",g-.3),M=i.properties,t.dispatch("input"),Object.defineProperty(t.node(),"value",{get:()=>M,configurable:!0})),x&&t.select(`#${N}`).call(tN,{fields:function(){const t=x.fields;let e=[];return t.forEach((t=>{let n="";"function"==typeof t?n=[i].map(t)[0]:"string"==typeof t&&"$"==t[0]?n=`${i.properties[t.substring(1,t.length)]}`:"string"==typeof t&&(n=t),e.push(""==n?"N/A":n)})),e}(),fontWeight:x.fontWeight,fontSize:x.fontSize,fontStyle:x.fontStyle,fill:x.fill,stroke:x.stroke,strokeWidth:x.strokeWidth,fillOpacity:x.fillOpacity,strokeOpacity:x.strokeOpacity,col:x.col,type:KS(i.coords,s,o)}),x&&(t.select(`#${N}`).attr("transform",`translate(\n                ${e(i.geometry.coordinates)[0]+sR.pointer(n,this)[0]},\n                ${e(i.geometry.coordinates)[1]+sR.pointer(n,this)[1]})`),sR.select(this).attr("stroke-opacity",m-.3).attr("fill-opacity",g-.3).raise())})).on("touchend mouseleave",(function(){b&&(M={},t.dispatch("input")),t.select(`#${N}`).call(tN,null),sR.select(this).attr("stroke-opacity",m).attr("fill-opacity",g).lower()})),b&&Object.defineProperty(t.node(),"value",{get:()=>M,configurable:!0}),YS(t,S,i.id),fS(a,t,u,f,d,i.id)}(y,i,n,{id:t.id,geojson:t.geojson,rewind:t.rewind,values:t.values,k:t.k,w:t.w,fill:t.fill,stroke:t.stroke,strokeWidth:t.strokeWidth,fillOpacity:t.fillOpacity,strokeLinecap:t.strokeLinecap,strokeLinejoin:t.strokeLinejoin,strokeDasharray:t.strokeDasharray,strokeOpacity:t.strokeOpacity,tooltip:t.tooltip,leg_x:t.leg_x,leg_y:t.leg_y,leg_w:t.leg_w,leg_h:t.leg_h,leg_title:t.leg_title,leg_fontSize:t.leg_fontSize,leg_fontSize2:t.leg_fontSize2,leg_stroke:t.leg_stroke,leg_fill:t.leg_fill,leg_fillOpacity:t.leg_fillOpacity,leg_strokeWidth:t.leg_strokeWidth,leg_txtcol:t.leg_txtcol,leg_round:t.leg_round,viewof:t.viewof},0,a,r),"mushroom"==t.type&&function(t,e,n,i={},r,s){let o=Date.now().toString(36)+Math.random().toString(36).substring(2),a=i.geojson,l=i.top_values,c=i.bottom_values,h=i.top_fill?i.top_fill:"#d64f4f",u=i.bottom_fill?i.bottom_fill:"#4fabd6",f=i.k?i.k:50,d=i.stroke?i.stroke:"white",g=i.strokeWidth?i.strokeWidth:.5,p=i.fillOpacity?i.fillOpacity:1,_=i.strokeOpacity?i.strokeOpacity:1,y=!!i.top_tooltip&&i.top_tooltip;Array.isArray(y)&&(y={fields:y}),"function"!=typeof y&&"string"!=typeof y||(y={fields:[y]});let m=!!i.bottom_tooltip&&i.bottom_tooltip;Array.isArray(m)&&(m={fields:m}),"function"!=typeof m&&"string"!=typeof m||(m={fields:[m]}),Array.isArray(m)&&(m={fields:m}),"string"==typeof m&&(m={fields:[m]});let x=i.leg_x?i.leg_x:null,v=i.leg_y?i.leg_y:null,b=i.leg_fontSize?i.leg_fontSize:14,M=i.leg_fontSize2?i.leg_fontSize2:10,w=i.leg_round?i.leg_round:void 0,E=i.leg_txtcol?i.leg_txtcol:"#363636",S=i.leg_title?i.leg_title:"Title, year",N=i.leg_top_txt?i.leg_top_txt:l,I=i.leg_bottom_txt?i.leg_bottom_txt:c,k=i.leg_top_fill?i.leg_top_fill:h,O=i.leg_bottom_fill?i.leg_bottom_fill:u,C=i.leg_stroke?i.leg_stroke:E,A=i.leg_strokeWidth?i.leg_strokeWidth:.8,T=!!i.viewof,R={};const L=rN(a,{planar:n}).features.sort(((t,e)=>UI.descending(+t.properties[l],+e.properties[l]))).filter((t=>null!=t.geometry.coordinates)).filter((t=>!isNaN(t.geometry.coordinates[0]))),P=UI.max(L,(t=>+t.properties[l])),D=UI.max(L,(t=>+t.properties[c]));let z=UI.scaleSqrt([0,Math.max(P,D)],[0,f]);for(let n=0;n<L.length;n++){const a=e(L[n].geometry.coordinates)[0],f=e(L[n].geometry.coordinates)[1],x=z(L[n].properties[l]),v=z(L[n].properties[c]),b=Math.max(x,v);let M=i.id?`info_${i.id}`:`info_${Date.now().toString(36)+Math.random().toString(36).substring(2)}`;t.append("g").attr("id",M).attr("class","info");let w=t.append("g").attr("class",i.id).attr("data-layer",JSON.stringify({_type:"mushroom"}));w.append("circle").attr("cx",a).attr("cy",f).attr("r",x).style("fill",h).attr("stroke",d).attr("stroke-width",g).attr("clip-path","url(#top-clip_"+o+n+")").on("touchmove mousemove",(function(e){if(T&&(UI.select(this).attr("stroke-opacity",_-.3).attr("fill-opacity",p-.3),R=L[n].properties,t.dispatch("input"),Object.defineProperty(t.node(),"value",{get:()=>R,configurable:!0})),y){let i=L[n];t.select(`#${M}`).call(tN,{fields:function(){const t=y.fields;let e=[];return t.forEach((t=>{let n="";"function"==typeof t?n=[i].map(t)[0]:"string"==typeof t&&"$"==t[0]?n=`${i.properties[t.substring(1,t.length)]}`:"string"==typeof t&&(n=t),e.push(""==n?"N/A":n)})),e}(),fontWeight:y.fontWeight,fontSize:y.fontSize,fontStyle:y.fontStyle,fill:y.fill,stroke:y.stroke,strokeWidth:y.strokeWidth,fillOpacity:y.fillOpacity,strokeOpacity:y.strokeOpacity,col:y.col,type:KS(UI.pointer(e,this),r,s)})}y&&(t.select(`#${M}`).attr("transform",`translate(${UI.pointer(e,this)})`),UI.select(this).attr("stroke-opacity",_-.3).attr("fill-opacity",p-.3))})).on("touchend mouseleave",(function(){T&&(R={},t.dispatch("input")),t.select(`#${M}`).call(tN,null),UI.select(this).attr("stroke-opacity",_).attr("fill-opacity",p)})),t.append("clipPath").attr("id","top-clip_"+o+n).append("rect").attr("x",a-x-g).attr("y",f+-x-g).attr("height",x+g).attr("width",2*x+2*g),w.append("circle").attr("cx",a).attr("cy",f).attr("r",v).style("fill",u).attr("stroke",d).attr("stroke-width",g).attr("clip-path","url(#bottom-clip_"+o+n+")").on("touchmove mousemove",(function(e){if(T&&(UI.select(this).attr("stroke-opacity",_-.3).attr("fill-opacity",p-.3),R=L[n].properties,t.dispatch("input"),Object.defineProperty(t.node(),"value",{get:()=>R,configurable:!0})),m){let i=L[n];t.select(`#${M}`).call(tN,{fields:function(){const t=m.fields;let e=[];return t.forEach((t=>{let n="";"function"==typeof t?n=[i].map(t)[0]:"string"==typeof t&&"$"==t[0]?n=`${i.properties[t.substring(1,t.length)]}`:"string"==typeof t&&(n=t),e.push(""==n?"N/A":n)})),e}(),fontWeight:m.fontWeight,fontSize:m.fontSize,fontStyle:m.fontStyle,fill:m.fill,stroke:m.stroke,strokeWidth:m.strokeWidth,fillOpacity:m.fillOpacity,strokeOpacity:m.strokeOpacity,col:m.col,type:KS(UI.pointer(e,this),r,s)})}m&&(t.select(`#${M}`).attr("transform",`translate(${UI.pointer(e,this)})`),UI.select(this).attr("stroke-opacity",_-.3).attr("fill-opacity",p-.3))})).on("touchend mouseleave",(function(){T&&(R={},t.dispatch("input")),t.select(`#${M}`).call(tN,null),UI.select(this).attr("stroke-opacity",_).attr("fill-opacity",p)})),w.append("clipPath").attr("id","bottom-clip_"+o+n).append("rect").attr("x",a-v-g).attr("y",f).attr("height",v+g).attr("width",2*v+2*g).attr("fill","none").attr("stroke","red"),w.append("line").attr("x1",a-b).attr("x2",a+b).attr("y1",f).attr("y2",f).attr("stroke",d).attr("stroke-width",g)}if(T&&Object.defineProperty(t.node(),"value",{get:()=>R,configurable:!0}),null!=x&&null!=v){const e=30,n=3,r=z(Math.max(+P,+D));let s=t.append("g").attr("class","bertinlegend").attr("class","legmushroom_"+i.id),h=s.append("g");const u=z(UI.max(L,(t=>+t.properties[l])));let f=L.map((t=>+t.properties[l])),d=[z.invert(u/3),z.invert(u/1.5),UI.max(f)];h.selectAll("circle").data(d.sort(UI.descending)).join("circle").attr("cx",x+r).attr("cy",v+u+(S.split("\n").length+1)*b).attr("r",(t=>z(t))).attr("fill",k).attr("stroke",C).attr("stroke-width",A).attr("clip-path","url(#legtop-clip_"+o+")"),h.append("clipPath").attr("id","legtop-clip_"+o).append("rect").attr("x",x-A+r-u).attr("y",v+(S.split("\n").length+1)*b-A).attr("height",u+A).attr("width",2*u+2*A),h.selectAll("line").data(d).join("line").attr("x1",x+r).attr("y1",(t=>v+(S.split("\n").length+1)*b+u-z(t))).attr("x2",x+2*r+b).attr("y2",(t=>v+(S.split("\n").length+1)*b+u-z(t))).attr("stroke",C).attr("stroke-width",A).attr("stroke-dasharray",2),h.selectAll("text").data(d).join("text").attr("x",x+2*r+b+M/2).attr("y",(t=>v+(S.split("\n").length+1)*b+u-z(t))).attr("font-size",M).attr("dominant-baseline","central").attr("fill",E).text((t=>void 0!==w||0!==w?t.toFixed(w):t));let g=s.append("g");const p=z(UI.max(L,(t=>+t.properties[c])));let _=a.features.map((t=>+t.properties[c])),y=[z.invert(p/3),z.invert(p/1.5),UI.max(_)];g.selectAll("circle").data(y.sort(UI.descending)).join("circle").attr("cx",x+r).attr("cy",v+u+(S.split("\n").length+1)*b+e).attr("r",(t=>z(t))).attr("fill",O).attr("stroke",C).attr("stroke-width",A).attr("clip-path","url(#legbottom-clip_"+o+")"),g.append("clipPath").attr("id","legbottom-clip_"+o).append("rect").attr("x",x-A+r-p).attr("y",v+(S.split("\n").length+1)*b+e+u).attr("height",p+A).attr("width",2*p+2*A),g.selectAll("line").data(y).join("line").attr("x1",x+r).attr("y1",(t=>v+(S.split("\n").length+1)*b+u+e+z(t))).attr("x2",x+2*r+b).attr("y2",(t=>v+(S.split("\n").length+1)*b+u+e+z(t))).attr("stroke",C).attr("stroke-width",A).attr("stroke-dasharray",2),g.selectAll("text").data(y).join("text").attr("x",x+2*r+b+M/2).attr("y",(t=>v+(S.split("\n").length+1)*b+u+e+z(t))).attr("font-size",M).attr("dominant-baseline","central").attr("fill",E).text((t=>void 0!==w||0!==w?t.toFixed(w):t));let m=s.append("g");m.append("line").attr("x1",x+r-u).attr("x2",x+r+u).attr("y1",v+(S.split("\n").length+1)*b+u).attr("y2",v+(S.split("\n").length+1)*b+u).attr("stroke",E).attr("stroke-width",A),m.append("line").attr("x1",x+r-p).attr("x2",x+r+p).attr("y1",v+(S.split("\n").length+1)*b+u+e).attr("y2",v+(S.split("\n").length+1)*b+u+e).attr("stroke",E).attr("stroke-width",A),m.append("g").selectAll("text").data(S.split("\n")).join("text").attr("x",x).attr("y",v).attr("font-size",`${b}px`).attr("dy",((t,e)=>e*b)).attr("text-anchor","start").attr("dominant-baseline","hanging").attr("fill",E).text((t=>t)),m.append("text").attr("x",x+r).attr("y",v+(S.split("\n").length+1)*b+u+n).text(N).attr("fill",E).attr("font-size",`${M}px`).attr("text-anchor","middle").attr("dominant-baseline","hanging"),m.append("text").attr("x",x+r).attr("y",v+(S.split("\n").length+1)*b+u+e-n).text(I).attr("fill",E).attr("font-size",`${M}px`).attr("text-anchor","middle").attr("dominant-baseline","baseline")}}(y,i,n,{id:t.id,geojson:t.geojson,rewind:t.rewind,top_values:t.top_values,bottom_values:t.bottom_values,top_fill:t.top_fill,bottom_fill:t.bottom_fill,k:t.k,stroke:t.stroke,strokeWidth:t.strokeWidth,fillOpacity:t.fillOpacity,strokeOpacity:t.strokeOpacity,top_tooltip:t.top_tooltip,bottom_tooltip:t.bottom_tooltip,leg_x:t.leg_x,leg_y:t.leg_y,leg_fontSize:t.leg_fontSize,leg_fontSize2:t.leg_fontSize2,leg_round:t.leg_round,leg_txtcol:t.leg_txtcol,leg_title:t.leg_title,leg_top_txt:t.leg_top_txt,leg_bottom_txt:t.leg_bottom_txt,leg_top_fill:t.leg_top_fill,leg_bottom_fill:t.leg_bottom_fill,leg_stroke:t.leg_stroke,leg_strokeWidth:t.leg_strokeWidth,viewof:t.viewof},a,r),"label"==t.type&&function(t,e,n,i={},r){let s,o=i.geojson,a=i.values,l=i.fill?i.fill:"#474342",c=i.fontSize?i.fontSize:10,h=i.fontFamily?i.fontFamily:"Roboto",u=i.textDecoration?i.textDecoration:"none",f=i.fontWeight?i.fontWeight:"normal",d=i.fontStyle?i.fontStyle:"normal",g=null!=i.opacity?i.opacity:1,p=1==i.halo,_=i.halo_style?i.halo_style:["white",4,.5];s="p"==ry(o)?o.features:rN(o,{planar:n}).features,t.append("g").attr("class",i.id).attr("data-layer",JSON.stringify({_type:"label"})).attr("data-layer",void 0).selectAll("text").data(s.filter((t=>null!=t.geometry.coordinates)).filter((t=>null!=t.properties[a]))).join("text").attr("class","onglobe_coords").attr("x",(t=>e(t.geometry.coordinates)[0])).attr("y",(t=>e(t.geometry.coordinates)[1])).attr("fill",l).attr("opacity",g).attr("font-size",c).attr("font-family",h).attr("font-style",d).attr("text-decoration",u).attr("font-weight",f).attr("text-anchor","middle").attr("dominant-baseline","middle").attr("paint-order","stroke").attr("stroke",p?_[0]:"none").attr("stroke-width",p?_[1]:0).attr("stroke-opacity",p?_[2]:0).attr("stroke-linejoin","round").attr("stroke-linecap","round").text((t=>t.properties[a]))}(y,i,n,{id:t.id,geojson:t.geojson,rewind:t.rewind,values:t.values,fill:t.fill,fontSize:t.fontSize,fontFamily:t.fontFamily,textDecoration:t.textDecoration,fontWeight:t.fontWeight,fontStyle:t.fontStyle,opacity:t.opacity,halo:t.halo,halo_style:t.halo_style}),"text"==t.type&&rR(y,a,r,{id:t.id,position:t.position,text:t.text,fill:t.fill,stroke:t.stroke,fontSize:t.fontSize,fontFamily:t.fontFamily,textDecoration:t.textDecoration,fontWeight:t.fontWeight,fontStyle:t.fontStyle,margin:t.margin,anchor:t.anchor,baseline:t.baseline,frame_fill:t.frame_fill,frame_stroke:t.frame_stroke,frame_opacity:t.frame_opacity,frame_strokeWidth:t.frame_strokeWidth}),"logo"==t.type&&function(t,e,n,i={}){let r=i.url?i.url:"https://github.com/neocarto/bertin/raw/main/img/logo.png",s=i.position?i.position:"left";const o=new Image;o.src=r,o.onload=()=>{let a,l,c=null!=i.size?i.size:100,h=o.height*c/o.width;switch(s){case"left":a=10,l=n-10-h;break;case"middle":a=e/2-c/2,l=n-10-h;break;case"right":a=e-10-c,l=n-10-h;break;default:a=s[0],l=s[1]}t.append("g").attr("class",i.id).attr("data-layer",JSON.stringify({_type:"logo"})).append("image").attr("xlink:href",r).attr("width",c).attr("height",h).attr("x",a).attr("y",l)}}(y,a,r,{id:t.id,url:t.url,size:t.size,position:t.position}),"missing"==t.type&&function(t,e,n={},i){let r=n.geojson,s=n.values,o=n.fill?n.fill:"white",a=n.stroke?n.stroke:"white",l=n.strokeWidth?n.strokeWidth:.5,c=n.fillOpacity?n.fillOpacity:1,h=r.features.filter((t=>null==t.properties[s]));"l"==ry(r)&&(a=n.stroke?n.stroke:"white",o=n.fill?n.fill:"none",l=n.strokeWidth?n.strokeWidth:1),t.append("g").attr("class",n.id).attr("data-layer",JSON.stringify({_type:"missing"})).attr("clip-path",null==i?"none":`url(#clip_${i})`).selectAll("path").data(h).join("path").attr("class","onglobe").attr("d",WI.geoPath(e)).attr("fill",o).attr("stroke",a).attr("stroke-width",l).attr("fill-opacity",c),jS(t,{x:n.leg_x,y:n.leg_y,w:n.leg_w,h:n.leg_h,text:n.leg_text?n.leg_text:"Missing data",fontSize:n.leg_fontSize2,stroke:n.leg_stroke,fillOpacity:n.leg_fillOpacity?n.leg_fillOpacity:c,fill:o,strokeWidth:n.leg_strokeWidth,txtcol:n.leg_txtcol})}(y,i,{id:t.id,geojson:t.geojson,rewind:t.rewind,values:t.values,fill:t.fill,stroke:t.stroke,strokeWidth:t.strokeWidth,fillOpacity:t.fillOpacity,leg_x:t.leg_x,leg_y:t.leg_y,leg_w:t.leg_w,leg_h:t.leg_h,leg_text:t.leg_text,leg_fontSize:t.leg_fontSize,leg_stroke:t.leg_stroke,leg_fillOpacity:t.fillOpacity,leg_fill:t.fill,leg_strokeWidth:t.leg_strokeWidth,leg_txtcol:t.leg_txtcol},m),"shadow"==t.type&&function(t,e,n,i={}){let r=i.geojson,s=i.fill?i.fill:"#35383d",o=null!=i.dx?i.dx:3,a=null!=i.dy?i.dy:3,l=null!=i.stdDeviation?i.stdDeviation:1.5,c=null!=i.opacity?i.opacity:.7,h=CT(r);t.append("defs").append("filter").attr("id","blur").append("feGaussianBlur").attr("stdDeviation",l);const u=AT.geoPath(e);t.append("g").attr("class",i.id).attr("data-layer",JSON.stringify({_type:"shadow",dx:o,dy:a})).attr("clip-path",null==n?"none":`url(#clip_${n})`).append("path").datum(h).attr("class","onglobe").attr("d",u).attr("fill",s).attr("opacity",c).attr("stroke","none").attr("filter","url(#blur)").attr("transform",`translate(${o} ${a})`)}(y,i,m,{id:t.id,geojson:t.geojson,rewind:t.rewind,fill:t.fill,dx:t.dx,dy:t.dy,opacity:t.opacity,stdDeviation:t.stdDeviation}),"waterlines"==t.type&&function(t,e,n,i,r={}){let s=null!=r.precision?r.precision:3,o=null!=r.dist?r.dist:5,a=null!=r.nb?r.nb:3;null==r.steps||r.steps;let l=null!=r.stroke?r.stroke:"#5d81ba",c=null!=r.strokeOpacity?r.strokeOpacity:[1,.1],h=null!=r.strokeWidth?r.strokeWidth:[1.2,.2],u=null!=r.strokeDasharray?r.strokeDasharray:"none",f=null!=r.strokeLinecap?r.strokeLinecap:"round",d=null!=r.strokeLinejoin?r.strokeLinejoin:"round",g=[],p=kT(TT.geoProject(CT(n),e),{dist:o,wgs84:!1,step:s});g.push(p.features[0]);for(let t=1;t<=a;t++)p=kT(p,{dist:o,wgs84:!1,step:s}),g.push(p.features[0]);t.append("g").attr("class",r.id).attr("data-layer",JSON.stringify({_type:"waterlines"})).attr("clip-path",null==i?"none":`url(#clip_${i})`).selectAll("path").data(g).join("path").attr("d",TT.geoPath()).attr("fill","none").attr("stroke-opacity",((t,e)=>Array.isArray(c)?TT.scaleLinear().domain([1,a]).range(c)(e):c)).attr("stroke-width",((t,e)=>Array.isArray(h)?TT.scaleLinear().domain([1,a]).range(h)(e):h)).attr("stroke",((t,e)=>Array.isArray(l)?TT.scaleLinear().domain([1,a]).range(l)(e):l)).attr("stroke-dasharray",u).attr("stroke-linecap",f).attr("stroke-linejoin",d)}(y,i,t.geojson,m,{id:t.id,stroke:t.stroke,dist:t.dist,unit:t.unit,nb:t.nb,precision:t.precision,strokeOpacity:t.strokeOpacity,strokeWidth:t.strokeWidth,stroke:t.stroke,strokeDasharray:t.strokeDasharray,strokeLinecap:t.strokeLinecap,strokeLinejoin:t.strokeLinejoin}),"inner"==t.type&&function(t,e,n={}){let i=n.geojson,r=null!=n.thickness&&null!=n.thickness?n.thickness:7,s=null!=n.fill&&null!=n.fill?n.fill:"#9e9477",o=null!=n.fillOpacity&&null!=n.fillOpacity?n.fillOpacity:.2,a=null!=n.blur&&null!=n.blur?n.blur:4;const l=Date.now().toString(36)+Math.random().toString(36).substring(2);t.append("defs").append("filter").attr("id",`blur${l}`).append("feGaussianBlur").attr("stdDeviation",a);let c=CT(i);t.append("clipPath").attr("id",`inner${l}`).append("path").datum(c).attr("d",RT.geoPath(e)).attr("class","onglobe"),t.append("g").attr("class",n.id).attr("data-layer",JSON.stringify({_type:"inner"})).attr("data-layer",void 0).attr("clip-path",`url(#inner${l})`).append("path").datum(c).attr("fill","none").attr("stroke",s).attr("stroke-linecap","round").attr("stroke-linejoin","round").attr("stroke-opacity",o).attr("stroke-width",2*r).attr("filter",`url(#blur${l})`).attr("d",RT.geoPath(e)).attr("class","onglobe")}(y,i,{id:t.id,geojson:t.geojson,rewind:t.rewind,fill:t.fill,fillOpacity:t.fillOpacity,blur:t.blur,thickness:t.thickness}),"rhumbs"==t.type&&function(t,e,n,i,r={}){let s=r.visibility?r.visibility:"visible",o=null!=r.nb?r.nb:16,a=null!=r.position?r.position:[e/4,n-n/4],l=r.stroke?r.stroke:"#394a70",c=null!=r.strokeWidth?r.strokeWidth:1,h=null!=r.strokeOpacity?r.strokeOpacity:.3,u=r.strokeDasharray?r.strokeDasharray:[3,2],f=Oy(o),d=Math.max(e,n);t.append("g").attr("class",r.id).attr("data-layer",JSON.stringify({_type:"rhumbs"})).attr("fill","none").attr("visibility",s).attr("stroke",l).attr("stroke-opacity",h).attr("stroke-width",c).attr("stroke-dasharray",u).attr("clip-path",null==i?"none":`url(#clip_${i})`).selectAll("polyline").data(f).join("polyline").attr("points",(function(t,e){let n=a[0]+Math.cos(t)*d,i=a[1]+Math.sin(t)*d;return a[0]+","+a[1]+" "+n+","+i}))}(y,a,r,m,{id:t.id,nb:t.nb,position:t.position,stroke:t.stroke,strokeWidth:t.strokeWidth,strokeOpacity:t.strokeOpacity,strokeDasharray:t.strokeDasharray}),"tissot"==t.type&&function(t,e,n,i={},r){if(!n){let n=i.fill?i.fill:"#d91848",s=i.fillOpacity?i.fillOpacity:.5,o=i.stroke?i.stroke:"#d91848",a=null!=i.strokeWidth?i.strokeWidth:.2,l=null!=i.strokeOpacity?i.strokeOpacity:.6,c=i.step?i.step:10;t.append("g").attr("class",i.id).attr("data-layer",JSON.stringify({_type:"tissot"})).style("fill",n).style("fill-opacity",s).style("stroke",o).style("stroke-width",a).style("stroke-opacity",l).attr("clip-path",null==r?"none":`url(#clip_${r})`).append("path").datum(ky(c)).attr("class","test").attr("d",Mr(e)).attr("class","onglobe")}}(y,i,n,{id:t.id,step:t.step,fill:t.fill,fillOpacity:t.fillOpacity,stroke:t.stroke,strokeWidth:t.strokeWidth,strokeOpacity:t.strokeOpacity},m),"dotcartogram"==t.type&&function(t,e,n,i={},r,s,o){let a=["#66c2a5","#fc8d62","#8da0cb","#e78ac3"],l=i.geojson,c=i.values,h=null!=i.radius?i.radius:4,u=null!=i.nbmax?i.nbmax:200,f=null!=i.onedot?i.onedot:Math.round(oR.sum(l.features.map((t=>+t.properties[c])))/u),d=null!=i.span?i.span:.5,g=null!=i.fill?i.fill:a[Math.floor(Math.random()*a.length)],p=null!=i.stroke?i.stroke:"none",_=null!=i.strokeWidth?i.strokeWidth:0,y=null!=i.fillOpacity?i.fillOpacity:1,m=null!=i.strokeDasharray?i.strokeDasharray:"none",x=null!=i.strokeOpacity?i.strokeOpacity:1,v=!!i.viewof,b=!!i.tooltip&&i.tooltip;Array.isArray(b)&&(b={fields:b}),"function"!=typeof b&&"string"!=typeof b||(b={fields:[b]});let M,w=null!=i.iteration?i.iteration:200;M="p"==ry(l)?l.features:rN(l,{planar:n}).features.filter((t=>!isNaN(t.geometry.coordinates[0])));let E=[];for(let t=0;t<=M.length-1;t++){let e=Math.round(+M[t].properties[c]/f);for(let n=1;n<=e;n++)E.push({...M[t]})}const S=oR.forceSimulation(E).force("x",oR.forceX((t=>e(t.geometry.coordinates)[0]))).force("y",oR.forceY((t=>e(t.geometry.coordinates)[1]))).force("collide",oR.forceCollide(h+d+_/2));for(let t=0;t<w;t++)S.tick();let N=i.id?`info_${i.id}`:`info_${Date.now().toString(36)+Math.random().toString(36).substring(2)}`;t.append("g").attr("id",N).attr("class","info");let I={};t.append("g").attr("class",i.id).attr("data-layer",JSON.stringify({_type:"dotcartogram"})).selectAll("circle").data(E.filter((t=>null!=t.geometry.coordinates))).join("circle").attr("fill",(t=>cS(E,g).getcol(t.properties[g.values]))).attr("stroke",(t=>cS(E,p).getcol(t.properties[p.values]))).attr("stroke-width",(t=>uS(E,_).getthickness(t.properties[_.values]||void 0))).attr("fill-opacity",y).attr("stroke-dasharray",m).attr("stroke-opacity",x).attr("cx",(t=>t.x)).attr("cy",(t=>t.y)).attr("r",h).on("touchmove mousemove",(function(e,n){v&&(oR.select(this).attr("stroke-opacity",x-.3).attr("fill-opacity",y-.3),I=n.properties,t.dispatch("input"),Object.defineProperty(t.node(),"value",{get:()=>I,configurable:!0})),b&&t.select(`#${N}`).call(tN,{fields:function(){const t=b.fields;let e=[];return t.forEach((t=>{let i="";"function"==typeof t?i=[n].map(t)[0]:"string"==typeof t&&"$"==t[0]?i=`${n.properties[t.substring(1,t.length)]}`:"string"==typeof t&&(i=t),e.push(""==i?"N/A":i)})),e}(),fontWeight:b.fontWeight,fontSize:b.fontSize,fontStyle:b.fontStyle,fill:b.fill,stroke:b.stroke,strokeWidth:b.strokeWidth,fillOpacity:b.fillOpacity,strokeOpacity:b.strokeOpacity,col:b.col,type:KS(oR.pointer(e,this),s,o)}),b&&(t.select(`#${N}`).attr("transform",`translate(${oR.pointer(e,this)})`),oR.select(this).attr("stroke-opacity",x-.3).attr("fill-opacity",y-.3))})).on("touchend mouseleave",(function(){v&&(I={},t.dispatch("input")),t.select(`#${N}`).call(tN,null),oR.select(this).attr("stroke-opacity",x).attr("fill-opacity",y)})),v&&Object.defineProperty(t.node(),"value",{get:()=>I,configurable:!0});const k=null!=i.leg_x?i.leg_x:null,O=null!=i.leg_y?i.leg_y:null,C=i.leg_title?i.leg_title:"leg_title",A=null!=i.leg_fontSize?i.leg_fontSize:14,T=null!=i.leg_fontSize2?i.leg_fontSize2:10,R=i.leg_txtcol?i.leg_txtcol:"#363636",L=i.leg_stroke?i.leg_stroke:p,P=null!=i.leg_strokeWidth?i.leg_strokeWidth:_,D="string"==typeof g?g:i.leg_fill,z=i.leg_txt?i.leg_txt:f;if(null!=k&&null!=O){let e=t.append("g").attr("class","bertinlegend").attr("class","legdotcartogram_"+i.id);null!=C&&(C.split("\n").length,e.append("g").selectAll("text").data(C.split("\n")).join("text").attr("x",k).attr("y",O).attr("font-size",`${A}px`).attr("dy",((t,e)=>e*A)).attr("text-anchor","start").attr("dominant-baseline","hanging").attr("fill",R).text((t=>t))),e.append("circle").attr("r",h).attr("fill",D).attr("stroke",L).attr("stroke-width",P).attr("cx",k+h).attr("cy",O+2*h+C.split("\n").length*A),e.append("text").attr("fill",R).attr("font-size",`${T}px`).attr("dominant-baseline","middle").attr("x",k+2*h+T).attr("y",O+2*h+C.split("\n").length*A).text(z)}fS({type:"FeatureCollection",features:E},t,g,p,_)}(y,i,n,{id:t.id,geojson:t.geojson,rewind:t.rewind,values:t.values,radius:t.radius,nbmax:t.nbmax,onedot:t.onedot,span:t.span,fill:t.fill,stroke:t.stroke,strokeWidth:t.strokeWidth,fillOpacity:t.fillOpacity,strokeDasharray:t.strokeDasharray,strokeOpacity:t.strokeOpacity,iteration:t.iteration,tooltip:t.tooltip,leg_x:t.leg_x,leg_y:t.leg_y,leg_title:t.leg_title,leg_fontSize:t.leg_fontSize,leg_fontSize2:t.leg_fontSize2,leg_txtcol:t.leg_txtcol,leg_stroke:t.leg_stroke,leg_strokeWidth:t.leg_strokeWidth,leg_fill:t.leg_fill,leg_txt:t.leg_txt,viewof:t.viewof},0,a,r),"bubble"==t.type&&oN(y,i,n,{id:t.id,geojson:t.geojson,rewind:t.rewind,values:t.values,planar:t.planar,k:t.k,fixmax:t.fixmax,fill:t.fill,stroke:t.stroke,strokeWidth:t.strokeWidth,fillOpacity:t.fillOpacity,strokeDasharray:t.strokeDasharray,strokeOpacity:t.strokeOpacity,dorling:t.dorling,iteration:t.iteration,tooltip:t.tooltip,leg_x:t.leg_x,leg_y:t.leg_y,leg_stroke:t.leg_stroke,leg_fill:t.leg_fill,leg_strokeWidth:t.leg_strokeWidth,leg_txtcol:t.leg_txtcol,leg_title:t.leg_title,leg_fontSize:t.leg_fontSize,leg_fontSize2:t.leg_fontSize2,leg_round:t.leg_round,leg_divisor:t.leg_divisor,viewof:t.viewof},0,a,r),"square"==t.type&&lN(y,i,n,{id:t.id,geojson:t.geojson,rewind:t.rewind,values:t.values,planar:t.planar,k:t.k,fixmax:t.fixmax,fill:t.fill,stroke:t.stroke,strokeWidth:t.strokeWidth,fillOpacity:t.fillOpacity,strokeDasharray:t.strokeDasharray,strokeOpacity:t.strokeOpacity,dorling:t.dorling,demers:t.demers,iteration:t.iteration,tooltip:t.tooltip,leg_x:t.leg_x,leg_y:t.leg_y,leg_stroke:t.leg_stroke,leg_fill:t.leg_fill,leg_strokeWidth:t.leg_strokeWidth,leg_txtcol:t.leg_txtcol,leg_title:t.leg_title,leg_fontSize:t.leg_fontSize,leg_fontSize2:t.leg_fontSize2,leg_round:t.leg_round,leg_divisor:t.leg_divisor,viewof:t.viewof},0,a,r),"regularbubble"==t.type&&function(t,e,n={},i,r,s){n.geojson=NI({geojson:n.geojson,projection:e,width:r,height:s,step:n.step,values:n.values,blur:n.blur,geoprocessing:n.geoprocessing,operator:n.operator}),n.values="value",n._type="regularbubble",oN(t,as(),!0,n,0,r,s)}(y,i,{id:t.id,geojson:t.geojson,rewind:t.rewind,values:t.values,step:t.step,blur:t.blur,geoprocessing:t.geoprocessing,operator:t.operator,planar:t.planar,k:t.k,fixmax:t.fixmax,fill:t.fill,stroke:t.stroke,strokeWidth:t.strokeWidth,fillOpacity:t.fillOpacity,strokeDasharray:t.strokeDasharray,strokeOpacity:t.strokeOpacity,dorling:t.dorling,iteration:t.iteration,tooltip:t.tooltip,leg_x:t.leg_x,leg_y:t.leg_y,leg_stroke:t.leg_stroke,leg_fill:t.leg_fill,leg_strokeWidth:t.leg_strokeWidth,leg_txtcol:t.leg_txtcol,leg_title:t.leg_title,leg_fontSize:t.leg_fontSize,leg_fontSize2:t.leg_fontSize2,leg_round:t.leg_round,viewof:t.viewof},0,a,r),"ridge"==t.type&&function(t,e,n={},i,r,s){let o=n.k?n.k:100,a=n.fill?n.fill:"#508bab",l=n.stroke?n.stroke:"white",c=n.strokeWidth?n.strokeWidth:.5,h=n.fillOpacity?n.fillOpacity:1,u=n.strokeDasharray?n.strokeDasharray:"none",f=n.strokeOpacity?n.strokeOpacity:1,d=n.operator?n.operator:"sum",g=n.geoprocessing?n.geoprocessing:"dotinpoly",p=NI({geojson:n.geojson,blur:null==n.blur||null==n.blur?.4:n.blur,values:n.values,projection:e,width:r,height:s,keep:!0,step:n.step,operator:d,geoprocessing:g}).features.map((t=>({x:t.geometry.coordinates[0],y:t.geometry.coordinates[1],value:t.properties.value}))).sort(((t,e)=>kI.ascending(t.y,e.y)||kI.ascending(t.x,e.x))),_="ridge"+Date.now().toString(36)+Math.random().toString(36).substring(2),y=JSON.stringify({_type:"ridge",mygrid:p,clip:_,strokeWidth:c}),m=Array.from(new Set(p.map((t=>t.y)))),x=kI.scaleLinear().domain([0,kI.max(p.map((t=>t.value)))]).range([0,o]),v=[];m.forEach((t=>{let e=[];p.filter((e=>e.y==t)).forEach((t=>e.push([t.x,t.y-x(t.value)])));let n={type:"LineString",coordinates:e};v.push({type:"Feature",properties:{y:t},geometry:n})}));let b=t.append("g").attr("class",n.id).attr("data-layer",y).attr("fill",a).attr("stroke",l).attr("stroke-width",c).attr("fill-opacity",h).attr("stroke-opacity",f).attr("stroke-dasharray",u),M=t.append("g");v.forEach(((t,e)=>{M.append("clipPath").attr("id",_+e).append("rect").attr("x",0).attr("y",0).attr("height",t.properties.y-c-1).attr("width",r).attr("fill","blue"),b.append("path").datum(t).attr("d",kI.geoPath()).attr("clip-path","url(#"+_+e+")")}))}(y,i,{id:t.id,geojson:t.geojson,rewind:t.rewind,values:t.values,step:t.step,blur:t.blur,k:t.k,fill:t.fill,stroke:t.stroke,strokeWidth:t.strokeWidth,fillOpacity:t.fillOpacity,strokeDasharray:t.strokeDasharray,strokeOpacity:t.strokeOpacity,operator:t.operator,geoprocessing:t.geoprocessing},0,a,r),"regularsquare"==t.type&&function(t,e,n={},i,r,s){n.geojson=NI({geojson:n.geojson,projection:e,width:r,height:s,step:n.step,values:n.values,blur:n.blur,geoprocessing:n.geoprocessing,operator:n.operator}),n.values="value",n._type="regularsquare",lN(t,as(),!0,n,0,r,s)}(y,i,{id:t.id,geojson:t.geojson,rewind:t.rewind,values:t.values,step:t.step,blur:t.blur,geoprocessing:t.geoprocessing,operator:t.operator,planar:t.planar,k:t.k,fixmax:t.fixmax,fill:t.fill,stroke:t.stroke,strokeWidth:t.strokeWidth,fillOpacity:t.fillOpacity,strokeDasharray:t.strokeDasharray,strokeOpacity:t.strokeOpacity,dorling:t.dorling,demers:t.demers,iteration:t.iteration,tooltip:t.tooltip,leg_x:t.leg_x,leg_y:t.leg_y,leg_stroke:t.leg_stroke,leg_fill:t.leg_fill,leg_strokeWidth:t.leg_strokeWidth,leg_txtcol:t.leg_txtcol,leg_title:t.leg_title,leg_fontSize:t.leg_fontSize,leg_fontSize2:t.leg_fontSize2,leg_round:t.leg_round,viewof:t.viewof},0,a,r),"regulargrid"!=t.type&&"grid"!=t.type||function(t,e,n={},i,r,s){n.geojson=NI({geojson:n.geojson,output:"square",projection:e,width:r,height:s,step:n.step,values:n.values,blur:n.blur,geoprocessing:n.geoprocessing,operator:n.operator}),null==n.fill&&(n.fill={nbreaks:6,method:"quantile",colors:"Blues"}),"object"==typeof n.fill&&null==n.fill.values&&(n.fill.values="value"),"object"==typeof n.fill&&null==n.fill.type&&(n.fill.type="choro"),n._type="regulargrid",nN(t,as(),n,i,r,s)}(y,i,{id:t.id,geojson:t.geojson,rewind:t.rewind,values:t.values,step:t.step,blur:t.blur,geoprocessing:t.geoprocessing,operator:t.operator,planar:t.planar,fill:t.fill,stroke:t.stroke,strokeWidth:t.strokeWidth,strokeLinecap:t.strokeLinecap,strokeLinejoin:t.strokeLinejoin,fillOpacity:t.fillOpacity,strokeOpacity:t.strokeOpacity,strokeDasharray:t.strokeDasharray,symbol:t.symbol,symbol_size:t.symbol_size,symbol_iteration:t.symbol_iteration,symbol_shift:t.symbol_shift,tooltip:t.tooltip,leg_x:t.leg_x,leg_y:t.leg_y,leg_w:t.leg_w,leg_h:t.leg_h,leg_title:t.leg_title,leg_text:t.leg_text,leg_type:t.leg_type,leg_fontSize:t.leg_fontSize,leg_fontSize2:t.leg_fontSize2,leg_stroke:t.leg_stroke,leg_fillOpacity:t.leg_fillOpacity,leg_fill:t.leg_fill,leg_strokeWidth:t.leg_strokeWidth,leg_txtcol:t.leg_txtcol,viewof:t.viewof},m,a,r),"smooth"!=t.type&&"contour"!=t.type&&"heatmap"!=t.type||function(t,e,n={},i,r,s){null!=n.clip&&n.clip;let o,a=null!=n.reverse&&n.reverse,l=n.fill?n.fill:"RdYlGn",c=n.strokeLinecap?n.strokeLinecap:"round",h=n.strokeLinejoin?n.strokeLinejoin:"round",u=null!=n.strokeDasharray?n.strokeDasharray:"none",f=n.stroke?n.stroke:"none",d=null!=n.strokeWidth?n.strokeWidth:.5,g=null!=n.fillOpacity?n.fillOpacity:.5,p=null!=n.strokeOpacity?n.strokeOpacity:1,_=null!=n.remove?n.remove:0,y=null!=n.thresholds?n.thresholds:100,m=null!=n.bandwidth?n.bandwidth:5,x=null!=n.cellSize?n.cellSize:1,v=null!=n.colorcurve?n.colorcurve:2,b=1e3,M=Date.now().toString(36)+Math.random().toString(36).substring(2);if("z"==ry(n.geojson))if(n.clip&&t.append("clipPath").attr("id",`clip_${M}`).append("path").datum(n.geojson).attr("d",YI.geoPath(e)),null!=n.grid_step||null!=n.grid_blur){let t=null!=n.grid_step?n.grid_step:20,i=null!=n.grid_blur?n.grid_blur:0,a=null!=n.grid_geoprocessing?n.grid_geoprocessing:"intersection",l=null!=n.grid_operator?n.grid_operator:"sum";o=$I({geojson:NI({geojson:n.geojson,projection:e,width:r,height:s,step:t,blur:i,operator:l,geoprocessing:a,values:n.values}),values:"value",nb:b,projection:YI.geoIdentity()})}else n.geojson=rN(n.geojson),o=$I({geojson:n.geojson,values:n.values,nb:b,projection:e});"p"==ry(n.geojson)&&(o=$I({geojson:n.geojson,values:n.values,nb:b,projection:e}));let w,E=YI.contourDensity().x((t=>t[0])).y((t=>t[1])).size([r,s]).bandwidth(m).thresholds(y).cellSize(x)(o),S=new Map([["Blues",YI.interpolateBlues],["Greens",YI.interpolateGreens],["Greys",YI.interpolateGreys],["Oranges",YI.interpolateOranges],["Purples",YI.interpolatePurples],["Reds",YI.interpolateReds],["BrBG",YI.interpolateBrBG],["PRGn",YI.interpolatePRGn],["PiYG",YI.interpolatePiYG],["PuOr",YI.interpolatePuOr],["RdBu",YI.interpolateRdBu],["RdYlBu",YI.interpolateRdYlBu],["RdYlGn",YI.interpolateRdYlGn],["Spectral",YI.interpolateSpectral],["Turbo",YI.interpolateTurbo],["Viridis",YI.interpolateViridis],["Inferno",YI.interpolateInferno],["Magma",YI.interpolateMagma],["Plasma",YI.interpolatePlasma],["Cividis",YI.interpolateCividis],["Warm",YI.interpolateWarm],["Cool",YI.interpolateCool],["CubehelixDefault",YI.interpolateCubehelixDefault],["BuGn",YI.interpolateBuGn],["BuPu",YI.interpolateBuPu],["GnBu",YI.interpolateGnBu],["OrRd",YI.interpolateOrRd],["PuBuGn",YI.interpolatePuBuGn],["PuBu",YI.interpolatePuBu],["PuRd",YI.interpolatePuRd],["RdPu",YI.interpolateRdPu],["YlGnBu",YI.interpolateYlGnBu],["YlGn",YI.interpolateYlGn],["YlOrBr",YI.interpolateYlOrBr],["YlOrRd",YI.interpolateYlOrRd],["Rainbow",YI.interpolateRainbow],["Sinebow",YI.interpolateSinebow]]);w=a?YI.scaleSequentialQuantile([...E.map((t=>t.value))],(t=>S.get(l)(Math.pow(.01+t,1/v)))):YI.scaleSequentialQuantile([...E.map((t=>t.value))],(t=>S.get(l)(1-Math.pow(.01+t,1/v)))),E.splice(0,_),t.append("g").attr("class",n.id).attr("data-layer",JSON.stringify({_type:"smooth"})).attr("clip-path",null==n.clip?"none":`url(#clip_${M})`).selectAll("path").data(E).join("path").attr("d",YI.geoPath()).attr("fill",(t=>w(t.value))).attr("stroke",f).attr("stroke-width",d).attr("fill-opacity",g).attr("stroke-opacity",p).attr("stroke-linecap",c).attr("stroke-linejoin",h).attr("stroke-dasharray",u)}(y,i,{id:t.id,clip:t.clip,geojson:t.geojson,rewind:t.rewind,values:t.values,grid_step:t.grid_step,grid_blur:t.grid_blur,grid_operator:t.grid_operator,grid_geoprocessing:t.grid_geoprocessing,remove:t.remove,fill:t.fill,reverse:t.reverse,stroke:t.stroke,strokeWidth:t.strokeWidth,strokeLinecap:t.strokeLinecap,strokeLinejoin:t.strokeLinejoin,fillOpacity:t.fillOpacity,strokeOpacity:t.strokeOpacity,strokeDasharray:t.strokeDasharray,thresholds:t.thresholds,bandwidth:t.bandwidth,cellsize:t.cellsize,colorcurve:t.colorcurve},0,a,r),"custom"==t.type||"function"==t.type){const{render:e,type:n,...s}=t;e(y,{projection:i,width:a,height:r,clipid:m},{...s})}"header"==t.type&&function(t,e,n={}){let i;n.text&&(i=25),n.fontSize&&(i=n.fontSize);let r=n.text?n.text:"",s=n.fill?n.fill:"#9e9696",o=n.background?n.background:"white",a=null!=n.backgroundOpacity?n.backgroundOpacity:1,l=n.anchor?n.anchor:"middle";const c=i*r.split("\n").length;let h;"start"==l&&(h=5),"middle"==l&&(h=e/2),"end"==l&&(h=e-5);let u=t.append("g").attr("class",n.id).attr("data-layer",JSON.stringify({_type:"header"}));u.append("rect").attr("x",0).attr("y",0-c-10).attr("width",e).attr("height",c+10).attr("fill",o).attr("fill-opacity",a),u.selectAll("text").data(n.text.split("\n")).join("text").attr("x",h).attr("y",-c-5).attr("font-size",`${i}px`).attr("dy",((t,e)=>e*i+i/2)).attr("text-anchor",l).attr("dominant-baseline","central").attr("fill",s).attr("font-family","sans-serif").attr("font-weight","bold").attr("fill-opacity",1).text((t=>t))}(y,a,{fontSize:t.fontSize,text:t.text,fill:t.fill,background:t.background,backgroundOpacity:t.backgroundOpacity,anchor:t.anchor,id:t.id}),"footer"==t.type&&function(t,e,n,i={}){let r;i.text&&(r=10),i.fontSize&&(r=i.fontSize);let s=i.text?i.text:"",o=i.fill?i.fill:"#9e9696",a=i.background?i.background:"white",l=i.backgroundOpacity?i.backgroundOpacity:1,c=i.anchor?i.anchor:"end";const h=r*s.split("\n").length;let u;"start"==c&&(u=5),"middle"==c&&(u=e/2),"end"==c&&(u=e-5);let f=t.append("g").attr("class",i.id).attr("data-layer",JSON.stringify({_type:"footer"}));f.append("rect").attr("x",0).attr("y",n).attr("width",e).attr("height",h+10).attr("fill",a).attr("fill-opacity",l),f.selectAll("text").data(i.text.split("\n")).join("text").attr("x",u).attr("y",n+5).attr("font-size",`${r}px`).attr("dy",((t,e)=>e*r)).attr("text-anchor",c).attr("dominant-baseline","hanging").attr("fill",o).attr("font-family","sans-serif").attr("fill-opacity",1).text((t=>t))}(y,a,r,{fontSize:t.fontSize,text:t.text,fill:t.fill,background:t.background,backgroundOpacity:t.backgroundOpacity,anchor:t.anchor,id:t.id}),"hatch"!=t.type&&"hatching"!=t.type||function(t,e={},n,i){let r=t.append("defs"),s=e.visibility?e.visibility:"visible";const o=e.stroke?e.stroke:"#786d6c",a=null!=e.strokeWidth?e.strokeWidth:2,l=null!=e.strokeOpacity?e.strokeOpacity:.1,c=null!=e.angle?e.angle:45,h=null!=e.spacing?e.spacing:8,u=e.strokeDasharray?e.strokeDasharray:"none",f=Date.now().toString(36)+Math.random().toString(36).substring(2);r.append("pattern").attr("class","pattern"+e.id).attr("id",`hatch${f}`).attr("patternUnits","userSpaceOnUse").attr("width",h).attr("height",h).attr("patternTransform",`rotate(${c})`).append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y1",h).attr("visibility",s).attr("stroke",o).attr("stroke-linejoin","butt").attr("stroke-width",a).attr("stroke-dasharray",u).attr("stroke-opacity",l),t.append("g").attr("class",e.id).attr("data-layer",JSON.stringify({_type:"hatch"})).append("rect").attr("x",0).attr("y",0).attr("width",n).attr("height",i).attr("fill","url('#hatch"+f+"')")}(y,{id:t.id,stroke:t.stroke,strokeWidth:t.strokeWidth,strokeOpacity:t.strokeOpacity,angle:t.angle,spacing:t.spacing,strokeDasharray:t.strokeDasharray},a,r),"path"==t.type&&CI(y,a,r,{id:t.id,d:t.d,x:t.x,y:t.y,rotate:t.rotate,margin:t.margin,style:t.style,scale:t.scale,fill:t.fill,stroke:t.stroke,strokeWidth:t.strokeWidth,strokeLinecap:t.strokeLinecap,strokeLinejoin:t.strokeLinejoin,fillOpacity:t.fillOpacity,strokeOpacity:t.strokeOpacity,strokeDasharray:t.strokeDasharray},m)}));let v=e.find((t=>"scalebar"==t.type));if(v&&function(t,e,n,i,r,s={}){if(!n){let n=s.x?s.x:20,o=s.y?s.y:r-30,a=s.units?s.units:"kilometers";n/=i,o/=r;const l=iR.geoScaleBar().projection(e).size([i,r]).left(n).top(o).label("miles"==a?"Miles":"Km").units("miles"==a?iR.geoScaleMiles:iR.geoScaleKilometers).orient(iR.geoScaleBottom).tickPadding(5).tickSize(0);t.append("g").attr("class",s.id).attr("data-layer",JSON.stringify({_type:"scalebar"})).attr("transform",`translate(${n}, ${o})`).append("g").call(l)}}(y,i,n,a,r,{id:v.id,x:v.x,y:v.y,units:v.units}),x&&QS(y,i,n,{id:x.id,fill:"none",stroke:x.stroke,strokeWidth:x.strokeWidth}),y.selectAll(".info").raise(),y.selectAll(".bertinlegend").raise(),void 0===e.find((t=>t.viewof))){let t=[];y.on("mousemove",(function(e){const{offsetX:n,offsetY:r}=e;t=i.invert([n,r]),y.dispatch("input")})),Object.defineProperty(y.node(),"value",{get:()=>t})}return Object.assign(y.node(),{info:{width:a,height:r+d+p,height_map:r,height_header:d,height_footer:p,projection:i,bbox:f.bbox}}),y.node().update=function({id:t=null,attr:e=null,value:n=null,legend:s=null,duration:o=0,delay:l=0}={}){WS({svg:y,projection:i,width:a,height:r,id:t,attr:e,value:n,legend:s,duration:o,delay:l})},t.projection&&"string"==typeof t.projection&&"globe"==t.projection.substring(0,5).toLowerCase()&&Ny(y,i),y.node()}const vR=Object.assign({},{create:Co,scaleLinear:lm});const bR=Object.assign({},{index:G});var MR=Object.prototype.hasOwnProperty;function wR(t,e,n,i,r,s){3===arguments.length&&(i=s=Array,r=null);for(var o=new i(t=1<<Math.max(4,Math.ceil(Math.log(t)/Math.LN2))),a=new s(t),l=t-1,c=0;c<t;++c)o[c]=r;function h(i,s){for(var c=e(i)&l,h=o[c],u=0;h!=r;){if(n(h,i))return a[c]=s;if(++u>=t)throw new Error("full hashmap");h=o[c=c+1&l]}return o[c]=i,a[c]=s,s}function u(i,s){for(var c=e(i)&l,h=o[c],u=0;h!=r;){if(n(h,i))return a[c];if(++u>=t)throw new Error("full hashmap");h=o[c=c+1&l]}return o[c]=i,a[c]=s,s}function f(i,s){for(var c=e(i)&l,h=o[c],u=0;h!=r;){if(n(h,i))return a[c];if(++u>=t)break;h=o[c=c+1&l]}return s}function d(){for(var t=[],e=0,n=o.length;e<n;++e){var i=o[e];i!=r&&t.push(i)}return t}return{set:h,maybeSet:u,get:f,keys:d}}function ER(t,e){return t[0]===e[0]&&t[1]===e[1]}var SR=new ArrayBuffer(16),NR=new Float64Array(SR),IR=new Uint32Array(SR);function kR(t){NR[0]=t[0],NR[1]=t[1];var e=IR[0]^IR[1];return 2147483647&(e=e<<5^e>>7^IR[2]^IR[3])}function OR(t){var e,n,i,r,s=t.coordinates,o=t.lines,a=t.rings,l=function(){for(var t=wR(1.4*s.length,b,M,Int32Array,-1,Int32Array),e=new Int32Array(s.length),n=0,i=s.length;n<i;++n)e[n]=t.maybeSet(n,n);return e}(),c=new Int32Array(s.length),h=new Int32Array(s.length),u=new Int32Array(s.length),f=new Int8Array(s.length),d=0;for(e=0,n=s.length;e<n;++e)c[e]=h[e]=u[e]=-1;for(e=0,n=o.length;e<n;++e){var g=o[e],p=g[0],_=g[1];for(i=l[p],r=l[++p],++d,f[i]=1;++p<=_;)v(e,i,i=r,r=l[p]);++d,f[r]=1}for(e=0,n=s.length;e<n;++e)c[e]=-1;for(e=0,n=a.length;e<n;++e){var y=a[e],m=y[0]+1,x=y[1];for(v(e,l[x-1],i=l[m-1],r=l[m]);++m<=x;)v(e,i,i=r,r=l[m])}function v(t,e,n,i){if(c[n]!==t){c[n]=t;var r=h[n];if(r>=0){var s=u[n];r===e&&s===i||r===i&&s===e||(++d,f[n]=1)}else h[n]=e,u[n]=i}}function b(t){return kR(s[t])}function M(t,e){return ER(s[t],s[e])}c=h=u=null;var w,E=function(t,e,n,i,r){3===arguments.length&&(i=Array,r=null);for(var s=new i(t=1<<Math.max(4,Math.ceil(Math.log(t)/Math.LN2))),o=t-1,a=0;a<t;++a)s[a]=r;function l(i){for(var a=e(i)&o,l=s[a],c=0;l!=r;){if(n(l,i))return!0;if(++c>=t)throw new Error("full hashset");l=s[a=a+1&o]}return s[a]=i,!0}function c(i){for(var a=e(i)&o,l=s[a],c=0;l!=r;){if(n(l,i))return!0;if(++c>=t)break;l=s[a=a+1&o]}return!1}function h(){for(var t=[],e=0,n=s.length;e<n;++e){var i=s[e];i!=r&&t.push(i)}return t}return{add:l,has:c,values:h}}(1.4*d,kR,ER);for(e=0,n=s.length;e<n;++e)f[w=l[e]]&&E.add(s[w]);return E}function CR(t,e,n,i){AR(t,e,n),AR(t,e,e+i),AR(t,e+i,n)}function AR(t,e,n){for(var i,r=e+(n---e>>1);e<r;++e,--n)i=t[e],t[e]=t[n],t[n]=i}function TR(t){var e,n,i={};for(e in t)i[e]=null==(n=t[e])?{type:null}:("FeatureCollection"===n.type?RR:"Feature"===n.type?LR:PR)(n);return i}function RR(t){var e={type:"GeometryCollection",geometries:t.features.map(LR)};return null!=t.bbox&&(e.bbox=t.bbox),e}function LR(t){var e,n=PR(t.geometry);for(e in null!=t.id&&(n.id=t.id),null!=t.bbox&&(n.bbox=t.bbox),t.properties){n.properties=t.properties;break}return n}function PR(t){if(null==t)return{type:null};var e="GeometryCollection"===t.type?{type:"GeometryCollection",geometries:t.geometries.map(PR)}:"Point"===t.type||"MultiPoint"===t.type?{type:t.type,coordinates:t.coordinates}:{type:t.type,arcs:t.coordinates};return null!=t.bbox&&(e.bbox=t.bbox),e}function DR(t){var e,n=t[0],i=t[1];return i<n&&(e=n,n=i,i=e),n+31*i}function zR(t,e){var n,i=t[0],r=t[1],s=e[0],o=e[1];return r<i&&(n=i,i=r,r=n),o<s&&(n=s,s=o,o=n),i===s&&r===o}const FR=Object.assign({},{topology:function(t,e){var n=function(t){var e=1/0,n=1/0,i=-1/0,r=-1/0;function s(t){null!=t&&MR.call(o,t.type)&&o[t.type](t)}var o={GeometryCollection:function(t){t.geometries.forEach(s)},Point:function(t){a(t.coordinates)},MultiPoint:function(t){t.coordinates.forEach(a)},LineString:function(t){l(t.arcs)},MultiLineString:function(t){t.arcs.forEach(l)},Polygon:function(t){t.arcs.forEach(l)},MultiPolygon:function(t){t.arcs.forEach(c)}};function a(t){var s=t[0],o=t[1];s<e&&(e=s),s>i&&(i=s),o<n&&(n=o),o>r&&(r=o)}function l(t){t.forEach(a)}function c(t){t.forEach(l)}for(var h in t)s(t[h]);return i>=e&&r>=n?[e,n,i,r]:void 0}(t=TR(t)),i=e>0&&n&&function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=s-i?(n-1)/(s-i):1,l=o-r?(n-1)/(o-r):1;function c(t){return[Math.round((t[0]-i)*a),Math.round((t[1]-r)*l)]}function h(t,e){for(var n,s,o,c,h,u=-1,f=0,d=t.length,g=new Array(d);++u<d;)n=t[u],c=Math.round((n[0]-i)*a),h=Math.round((n[1]-r)*l),c===s&&h===o||(g[f++]=[s=c,o=h]);for(g.length=f;f<e;)f=g.push([g[0][0],g[0][1]]);return g}function u(t){return h(t,2)}function f(t){return h(t,4)}function d(t){return t.map(f)}function g(t){null!=t&&MR.call(p,t.type)&&p[t.type](t)}var p={GeometryCollection:function(t){t.geometries.forEach(g)},Point:function(t){t.coordinates=c(t.coordinates)},MultiPoint:function(t){t.coordinates=t.coordinates.map(c)},LineString:function(t){t.arcs=u(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(u)},Polygon:function(t){t.arcs=d(t.arcs)},MultiPolygon:function(t){t.arcs=t.arcs.map(d)}};for(var _ in t)g(t[_]);return{scale:[1/a,1/l],translate:[i,r]}}(t,n,e),r=function(t){var e,n,i,r,s=t.coordinates,o=t.lines,a=t.rings,l=o.length+a.length;for(delete t.lines,delete t.rings,i=0,r=o.length;i<r;++i)for(e=o[i];e=e.next;)++l;for(i=0,r=a.length;i<r;++i)for(n=a[i];n=n.next;)++l;var c=wR(2*l*1.4,kR,ER),h=t.arcs=[];for(i=0,r=o.length;i<r;++i){e=o[i];do{u(e)}while(e=e.next)}for(i=0,r=a.length;i<r;++i)if((n=a[i]).next)do{u(n)}while(n=n.next);else f(n);function u(t){var e,n,i,r,o,a,l,u;if(i=c.get(e=s[t[0]]))for(l=0,u=i.length;l<u;++l)if(d(r=i[l],t))return t[0]=r[0],void(t[1]=r[1]);if(o=c.get(n=s[t[1]]))for(l=0,u=o.length;l<u;++l)if(g(a=o[l],t))return t[1]=a[0],void(t[0]=a[1]);i?i.push(t):c.set(e,[t]),o?o.push(t):c.set(n,[t]),h.push(t)}function f(t){var e,n,i,r,o;if(n=c.get(s[t[0]]))for(r=0,o=n.length;r<o;++r){if(p(i=n[r],t))return t[0]=i[0],void(t[1]=i[1]);if(_(i,t))return t[0]=i[1],void(t[1]=i[0])}if(n=c.get(e=s[t[0]+y(t)]))for(r=0,o=n.length;r<o;++r){if(p(i=n[r],t))return t[0]=i[0],void(t[1]=i[1]);if(_(i,t))return t[0]=i[1],void(t[1]=i[0])}n?n.push(t):c.set(e,[t]),h.push(t)}function d(t,e){var n=t[0],i=e[0],r=t[1];if(n-r!=i-e[1])return!1;for(;n<=r;++n,++i)if(!ER(s[n],s[i]))return!1;return!0}function g(t,e){var n=t[0],i=e[0],r=t[1],o=e[1];if(n-r!=i-o)return!1;for(;n<=r;++n,--o)if(!ER(s[n],s[o]))return!1;return!0}function p(t,e){var n=t[0],i=e[0],r=t[1]-n;if(r!==e[1]-i)return!1;for(var o=y(t),a=y(e),l=0;l<r;++l)if(!ER(s[n+(l+o)%r],s[i+(l+a)%r]))return!1;return!0}function _(t,e){var n=t[0],i=e[0],r=t[1],o=e[1],a=r-n;if(a!==o-i)return!1;for(var l=y(t),c=a-y(e),h=0;h<a;++h)if(!ER(s[n+(h+l)%a],s[o-(h+c)%a]))return!1;return!0}function y(t){for(var e=t[0],n=t[1],i=e,r=i,o=s[i];++i<n;){var a=s[i];(a[0]<o[0]||a[0]===o[0]&&a[1]<o[1])&&(r=i,o=a)}return r-e}return t}(function(t){var e,n,i,r=OR(t),s=t.coordinates,o=t.lines,a=t.rings;for(n=0,i=o.length;n<i;++n)for(var l=o[n],c=l[0],h=l[1];++c<h;)r.has(s[c])&&(e={0:c,1:l[1]},l[1]=c,l=l.next=e);for(n=0,i=a.length;n<i;++n)for(var u=a[n],f=u[0],d=f,g=u[1],p=r.has(s[f]);++d<g;)r.has(s[d])&&(p?(e={0:d,1:u[1]},u[1]=d,u=u.next=e):(CR(s,f,g,g-d),s[g]=s[f],p=!0,d=f));return t}(function(t){var e=-1,n=[],i=[],r=[];function s(t){t&&MR.call(o,t.type)&&o[t.type](t)}var o={GeometryCollection:function(t){t.geometries.forEach(s)},LineString:function(t){t.arcs=a(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(a)},Polygon:function(t){t.arcs=t.arcs.map(l)},MultiPolygon:function(t){t.arcs=t.arcs.map(c)}};function a(t){for(var i=0,s=t.length;i<s;++i)r[++e]=t[i];var o={0:e-s+1,1:e};return n.push(o),o}function l(t){for(var n=0,s=t.length;n<s;++n)r[++e]=t[n];var o={0:e-s+1,1:e};return i.push(o),o}function c(t){return t.map(l)}for(var h in t)s(t[h]);return{type:"Topology",coordinates:r,lines:n,rings:i,objects:t}}(t))),s=r.coordinates,o=wR(1.4*r.arcs.length,DR,zR);function a(t){t&&MR.call(l,t.type)&&l[t.type](t)}t=r.objects,r.bbox=n,r.arcs=r.arcs.map((function(t,e){return o.set(t,e),s.slice(t[0],t[1]+1)})),delete r.coordinates,s=null;var l={GeometryCollection:function(t){t.geometries.forEach(a)},LineString:function(t){t.arcs=c(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(c)},Polygon:function(t){t.arcs=t.arcs.map(c)},MultiPolygon:function(t){t.arcs=t.arcs.map(h)}};function c(t){var e=[];do{var n=o.get(t);e.push(t[0]<t[1]?n:~n)}while(t=t.next);return e}function h(t){return t.map(c)}for(var u in t)a(t[u]);return i&&(r.transform=i,r.arcs=function(t){for(var e=-1,n=t.length;++e<n;){for(var i,r,s=t[e],o=0,a=1,l=s.length,c=s[0],h=c[0],u=c[1];++o<l;)i=(c=s[o])[0],r=c[1],i===h&&r===u||(s[a++]=[i-h,r-u],h=i,u=r);1===a&&(s[a++]=[0,0]),s.length=a}return t}(r.arcs)),r},neighbors:function(t){var e={},n=t.map((function(){return[]}));function i(t,n){t.forEach((function(t){t<0&&(t=~t);var i=e[t];i?i.push(n):e[t]=[n]}))}function r(t,e){t.forEach((function(t){i(t,e)}))}var s={LineString:i,MultiLineString:r,Polygon:r,MultiPolygon:function(t,e){t.forEach((function(t){r(t,e)}))}};for(var o in t.forEach((function t(e,n){"GeometryCollection"===e.type?e.geometries.forEach((function(e){t(e,n)})):e.type in s&&s[e.type](e.arcs,n)})),e)for(var a=e[o],l=a.length,c=0;c<l;++c)for(var h=c+1;h<l;++h){var u,f=a[c],d=a[h];(u=n[f])[o=vc(u,d)]!==d&&u.splice(o,0,d),(u=n[d])[o=vc(u,f)]!==f&&u.splice(o,0,f)}return n},mesh:function(t){return _c(t,mc.apply(this,arguments))}}),GR=Object.assign({},kt);function jR(t,e={}){let n=Mc(t);if(null==e.values&&null==e.id){const t=FR.topology({d:n});return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:FR.mesh(t,Object.entries(t.objects)[0][1],((t,e)=>t!==e))}]}}{const t=e.id,i=e.values,r=e.type?e.type:"rel",s=e.share?e.share:null,o=FR.topology({d:n}),a=n.features.map((e=>e.properties[t])),l=FR.neighbors(o.objects.d.geometries),c=new Map(n.features.map((e=>[e.properties[t],e.properties[i]])));let h=[];a.forEach((e=>{l[a.indexOf(e)].map((t=>({properties:{i:e,j:a[t],varoptionsi:+c.get(e),varoptionsj:+c.get(a[t]),disc:"rel"==r?0!=GR.min([+c.get(e),+c.get(a[t])])?GR.max([+c.get(e),+c.get(a[t])])/GR.min([+c.get(e),+c.get(a[t])]):null:GR.max([+c.get(e),+c.get(a[t])])-GR.min([+c.get(e),+c.get(a[t])])}}))).forEach((e=>{let n=FR.mesh(o,o.objects.d,((n,i)=>n.properties[t]==e.properties.i&i.properties[t]==e.properties.j)),i=Object.assign({type:"Feature"},e);h.push(Object.assign(i,{geometry:n}))}))})),h.sort(((t,e)=>GR.descending(t.properties.disc,e.properties.disc)));const u=h.length;return h.map((t=>t.properties)).forEach(((t,e)=>{Object.assign(t,{share:(e+1)/u})})),null!=s&&(h=h.filter((t=>t.properties.share<s))),n.features=h,n}}function qR({x:t,field:e}){let n=[...t.features.map((t=>({...t.properties})))];n.forEach((t=>{Array.isArray(e)?e.forEach((e=>delete t[e])):delete t[e]}));let i=JSON.parse(JSON.stringify(t));return i.features.map(((t,e)=>t.properties={...n[e]})),i}function BR(t){return new Function(`return (${t})`)()}const YR=Object.assign({},{table:function(t){return JSON.parse(JSON.stringify(t.features.map((t=>t.properties))))},remove:qR,keep:function({x:t,field:e}){let n=[];t.features.map((t=>t.properties)).forEach((t=>{n.push(Object.keys(t))})),n=Array.from(new Set(n.flat()));let i=n.filter((t=>!e.includes(t)));return qR({x:t,field:i})},add:function({x:t,field:e,expression:n}){let i=[...t.features.map((t=>({...t.properties})))],r=[];t.features.map((t=>t.properties)).forEach((t=>{r.push(Object.keys(t))})),r=Array.from(new Set(r.flat())),r.forEach((t=>{n=n.replace(t,`d.${t}`)})),n="d=> "+n;let s=i.map(BR(n));i.forEach(((t,n)=>{t=Object.assign(t,{[e]:s[n]})}));let o=JSON.parse(JSON.stringify(t));return o.features.map(((t,e)=>t.properties={...i[e]})),o},filter:function({x:t,expression:e}){let n=[...t.features],i=[];t.features.map((t=>t.properties)).forEach((t=>{i.push(Object.keys(t))})),i=Array.from(new Set(i.flat())),i.forEach((t=>{e=e.replace(t,`d.properties.${t}`)})),e="d => "+e;let r=JSON.parse(JSON.stringify(t));return r.features=n.filter(BR(e)),r},subset:function({x:t,field:e,selection:n,inverse:i=!1}){let r=[...t.features];n=Array.isArray(n)?n:[n],i&&(n=Array.from(new Set(r.map((t=>t.properties[e])))).filter((t=>!n.includes(t))));let s=[];n.forEach((t=>{s.push(r.filter((n=>n.properties[e]==t)))}));let o=JSON.parse(JSON.stringify(t));return o.features=s.flat(),o},head:function({x:t,field:e,nb:n=10}){let i=[...t.features];i=i.filter((t=>""!=t.properties[e])).filter((t=>null!=t.properties[e])).filter((t=>null!=t.properties[e])).filter((t=>t.properties[e]!=1/0)).filter((t=>t.properties[e]!=-1/0)).filter((t=>NaN!=t.properties[e])),i.sort(((t,n)=>+n.properties[e]-+t.properties[e])),i=i.slice(0,n);let r=JSON.parse(JSON.stringify(t));return r.features=i,r},tail:function({x:t,field:e,nb:n=10}){let i=[...t.features];i=i.filter((t=>""!=t.properties[e])).filter((t=>null!=t.properties[e])).filter((t=>null!=t.properties[e])).filter((t=>t.properties[e]!=1/0)).filter((t=>t.properties[e]!=-1/0)).filter((t=>NaN!=t.properties[e])),i.sort(((t,n)=>+t.properties[e]-+n.properties[e])),i=i.slice(0,n);let r=JSON.parse(JSON.stringify(t));return r.features=i,r}});let $R={table:YR.table,remove:function({geojson:t,field:e}){return YR.remove({x:t,field:e})},keep:function({geojson:t,field:e}){return YR.keep({x:t,field:e})},add:function({geojson:t,field:e,expression:n}){return YR.add({x:t,field:e,expression:n})},filter:function({geojson:t,expression:e}){return YR.filter({x:t,expression:e})},subset:function({geojson:t,field:e,selection:n,inverse:i}){return YR.subset({x:t,field:e,selection:n,inverse:i})},head:function({geojson:t,field:e,nb:n}){return YR.head({x:t,field:e,nb:n})},tail:function({geojson:t,field:e,nb:n}){return YR.tail({x:t,field:e,nb:n})}};t.bbox=Ec,t.borders=function({geojson:t,id:e,values:n,type:i="rel",share:r=null}){return null==e||null==n?jR(t):jR(t,{id:e,values:n,type:i,share:r})},t.draw=xR,t.links=function(t={}){let e,n=uy(t.geojson),i=t.geojson_id,r=t.data,s=null!=t.data_i?t.data_i:"i",o=null!=t.data_j?t.data_j:"j",a=!!t.planar;e="p"==ry(n)?n.features:rN(n,{planar:a}).features;const l=new Map(e.map((t=>[t.properties[i],t.geometry.coordinates])));let c=[];return r.forEach((t=>{null!=l.get(t[s])&&null!=l.get(t[o])&&c.push({type:"Feature",properties:t,geometry:{type:"LineString",coordinates:[l.get(t[s]),l.get(t[o])]}})})),{type:"FeatureCollection",features:c}},t.match=function(t,e,n,i){let r=(t=uy(t)).features.map((t=>t.properties[e])),s=n.map((t=>t[i])),o=Array.from(new Set(r.concat(s))),a=r.filter((t=>s.includes(t))),l=r.filter((t=>!s.includes(t))),c=s.filter((t=>!r.includes(t))),h=a.filter((t=>s.includes(t))),u=a.filter((t=>r.includes(t))),f=1e3,d=100,g=30,p=vR.scaleLinear().domain([0,o.length]).range([0,f]);const _=vR.create("svg").attr("width",f).attr("height",d).attr("viewBox",[0,0,f,d]).attr("style","max-width: 100%; height: auto; height: intrinsic; background-color: white;");return _.append("defs").append("pattern").attr("id","hatch").attr("patternUnits","userSpaceOnUse").attr("width",5).attr("height",5).append("line").attr("x1",0).attr("y1",0).attr("x2",5).attr("y1",5).attr("stroke","#ffcc36").attr("stroke-width",1).attr("stroke-opacity",1),_.append("rect").attr("x",0).attr("y",25).attr("height",10).attr("width",p(l.length+a.length)).attr("stroke","none").attr("fill","#CCC").attr("fill-opacity",.35),_.append("rect").attr("x",f-p(c.length+a.length)).attr("y",65).attr("height",10).attr("width",p(c.length+a.length)).attr("stroke","none").attr("fill","#CCC").attr("fill-opacity",.35),_.append("rect").attr("x",p(l.length)).attr("y",g).attr("height",40).attr("width",p(a.length)).attr("fill","#ffe599"),_.append("rect").attr("x",p(l.length)).attr("y",g).attr("height",40).attr("width",p(a.length)).attr("fill","url('#hatch')"),_.append("text").attr("x",f-p(s.length)+p(a.length)/2).attr("y",53).attr("text-anchor","middle").attr("dominant-baseline","middle").text(`${Math.round(a.length/o.length*100)}%`).attr("font-size",40).attr("fill","black"),_.append("text").attr("x",f-p(s.length)+5).attr("y",37).attr("text-anchor","start").attr("dominant-baseline","hanging").text("Matched geom").attr("font-size",12).attr("fill","black"),_.append("text").attr("x",f-p(s.length)+5).attr("y",62).attr("text-anchor","start").attr("dominant-baseline","baseline").text(`${a.length}/${r.length}`).attr("font-size",14).attr("fill","black"),_.append("text").attr("x",f-p(c.length)-5).attr("y",37).attr("text-anchor","end").attr("dominant-baseline","hanging").text("Matched data").attr("font-size",12).attr("fill","black"),_.append("text").attr("x",f-p(c.length)-5).attr("y",62).attr("text-anchor","end").attr("dominant-baseline","baseline").text(`${a.length}/${s.length}`).attr("font-size",14).attr("fill","black"),_.append("line").attr("x1",0).attr("y1",g).attr("x2",p(r.length)).attr("y2",g).attr("stroke","black").attr("stroke-width",.5),_.append("line").attr("x1",.5).attr("y1",25).attr("x2",.5).attr("y2",35).attr("stroke","black").attr("stroke-width",.5),_.append("line").attr("x1",p(r.length)-.5).attr("y1",25).attr("x2",p(r.length)-.5).attr("y2",35).attr("stroke","black").attr("stroke-width",.5),_.append("line").attr("x1",f-p(s.length)).attr("y1",70).attr("x2",f).attr("y2",70).attr("stroke","black").attr("stroke-width",.5),_.append("line").attr("x1",999.5).attr("y1",65).attr("x2",999.5).attr("y2",75).attr("stroke","black").attr("stroke-width",.5),_.append("line").attr("x1",f-p(s.length)+.5).attr("y1",65).attr("x2",f-p(s.length)+.5).attr("y2",75).attr("stroke","black").attr("stroke-width",.5),_.append("text").attr("x",f-p(s.length/2)).attr("y",95).attr("text-anchor","middle").text("DATA").attr("font-size",28).attr("font-weight","bold").attr("fill","#CCC").attr("opacity",.45),_.append("text").attr("x",p(r.length/2)).attr("y",22).attr("text-anchor","middle").text("GEOMETRIES").attr("font-size",28).attr("font-weight","bold").attr("fill","#CCC").attr("opacity",.45),Object.assign(_.node(),{matched:a,unmatched_geom:l,unmatched_data:c,matched_data:h,matched_geom:u})},t.merge=function(t,e,n,i,r=!0){let s=uy(t),o=JSON.parse(JSON.stringify(n)),a=s.features.map((t=>t.properties[e])),l=n.map((t=>t[i]));a.filter((t=>l.includes(t)));let c=Object.keys(s.features[0].properties);if(Object.keys(o[0]).includes(i)){let t=bR.index(o,(t=>t[i]));s.features.forEach((n=>{const i=t.get(n.properties[e]);null!=i&&Object.keys(i).forEach((t=>{void 0!==c.find((e=>e==t))&&(i[`_${t}`]=i[t],delete i[t])})),n.properties=Object.assign(n.properties,i)})),!1===r&&(s.features=s.features.filter((t=>l.includes(t.properties[e]))))}return s},t.properties=$R,t.quickdraw=function(t,e=1e3,n=5){let i=["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],r=[];if(Array.isArray(t)){let s=[];return t.forEach((t=>{let e,n,o,a=i.filter((t=>!r.includes(t)));a.length>0?(e=a[Math.floor(Math.random()*a.length)],r.push(e)):e="#"+(16777215*Math.random()<<0).toString(16),"l"==ry(t)&&(n=e,o="none"),"p"!=ry(t)&&"z"!=ry(t)||(n="none",o=e),s.push({type:"layer",geojson:t,fill:o,stroke:n})})),xR({params:{margin:n,width:e},layers:s})}return xR({params:{margin:n,width:e},layers:[{type:"layer",geojson:t}]})},t.table2geo=sy,Object.defineProperty(t,"__esModule",{value:!0})}));
